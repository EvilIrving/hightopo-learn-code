!function(J,w){"use strict";function U(J){return J*J}var y="ht.layout.",Z=J.ht||module.parent.exports.ht,_=Z.List,x=Z.DataModel,k=Z.Node,c=Z.Edge,I=Z.Group,J=Math,P=J.sqrt,X=J.random,n=J.max,q=J.min,W=(Z.Default.getInternal().addMSMap({ms_force:function(J,w){J._interval=50,J._stepCount=10,J._motionLimit=.01,J._edgeRepulsion=.65,J._nodeRepulsion=.65,J._damper=1,J._maxMotion=0,J._motionRatio=0,J.init=function(J){var w=this;J instanceof x?w.dm=J:w.gv=J,w._nodeMap={},w._nodes=new _,w._edges=new _},J.start=function(){var J,y=this,w=y.gv;y._timer||((J=y.cdm=w?w.dm():y.dm).mm(y.handleDataModelChange,y),J.md(y.handleDataPropertyChange,y),w&&w.mp(y.handleGV,y),J.each(function(J){var w;y.isVisible(J)&&y.isLayoutable(J)&&J instanceof k&&(y instanceof W?(w=J.p3(),J.p3([w[0]+X(),w[1]+X(),w[2]+X()])):(w=J.p(),J.p(w.x+X(),w.y+X())))}),y._timer=setInterval(function(){y.relax()},y._interval),y._damper=1)},J.stop=function(){var J=this;J._timer&&(J.cdm.umm(J.handleDataModelChange,J),J.cdm.umd(J.handleDataPropertyChange,J),J.gv&&J.gv.ump(J.handleGV,J),clearInterval(J._timer),delete J._timer,delete J.cdm)},J.handleGV=function(J){var w,y=this;"dataModel"===J.property&&(w=J.oldValue,J=J.newValue,w&&(w.umm(y.handleDataModelChange,y),w.umd(y.handleDataPropertyChange,y)),(this.cdm=J).mm(y.handleDataModelChange,y),J.md(y.handleDataPropertyChange,y))},J.relax=function(){var w=this;if(!(w._damper<.1&&w._maxMotion<w._motionLimit)){this.cdm.each(function(J){w.isVisible(J)&&(J instanceof c?w.addEdge(J):J instanceof k&&w.addNode(J))});for(var J,y,_=0,U=w._edges,Z=w._nodes,x=Z.size();_<w._stepCount;_++){for(U.each(w.relaxEdge,w),J=0;J<x;J++)for(y=0;y<x;y++)w.relaxNode(Z.get(J),Z.get(y));w.moveNode()}w._isAdjusting=1,Z.each(function(J){J.fix||(J.p?J.v.p3(J.p):J.v.p(J.x,J.y))}),delete w._isAdjusting,w._nodeMap={},Z.clear(),U.clear(),w.onRelaxed()}},J.onRelaxed=function(){},J.isRunning=function(){return!!this._timer},J.isVisible=function(J){return!1!==J.s("layoutable")&&(!this.gv||this.gv.isVisible(J))},J.isLayoutable=function(J){if(!1===J.s("layoutable"))return!1;if(J instanceof I)return!1;var w=this;return w.gv?w.gv.isMovable(J)&&!w.gv.isSelected(J):!(w.cdm||w.dm).sm().co(J)},J.getNodeRepulsion=function(){return this._nodeRepulsion},J.setNodeRepulsion=function(J){this._nodeRepulsion=J,this._damper=1},J.getEdgeRepulsion=function(){return this._edgeRepulsion},J.setEdgeRepulsion=function(J){this._edgeRepulsion=J,this._damper=1},J.getStepCount=function(){return this._stepCount},J.setStepCount=function(J){this._stepCount=J,this._damper=1},J.getInterval=function(){return this._interval},J.setInterval=function(J){var w=this;w._interval!==J&&(w._interval=J,w._timer&&(clearInterval(w._timer),w._timer=setInterval(function(){w.relax()},J)))},J.handleDataPropertyChange=function(J){!this._isAdjusting&&this.isVisible(J.data)&&(this._damper=1)},J.handleDataModelChange=function(J){this._damper=1},J.damp=function(){var J=this._maxMotion,w=this._damper;this._motionRatio<=.001&&((J<.2||1<J&&w<.9)&&.01<w?this._damper-=.01:J<.4&&.003<w?this._damper-=.003:1e-4<w&&(this._damper-=1e-4)),J<this._motionLimit&&(this._damper=0)}}}),Z.layout.ForceLayout=function(J){this.init(J)},Z.Default.def(y+"ForceLayout",w,{ms_force:1,getLimitBounds:function(){return this._limitBounds},setLimitBounds:function(J){this._limitBounds=J,this._damper=1},getNodeSize:function(J){var w=this.gv;return w&&w.getDataUIBounds?w.getDataUIBounds(J):J.getRect()},addNode:function(J){var w=this,y=w._nodeMap[J._id];if(y)return y;var _=J.p(),_=(y={v:J,x:_.x,y:_.y,dx:0,dy:0,fix:!w.isLayoutable(J),s:w.getNodeSize(J)}).s,_=P(U(_.width)+U(_.height))*w._nodeRepulsion;return y.r=_<1?100:_,w._nodeMap[J._id]=y,w._nodes.add(y),y},addEdge:function(J){var w,y,_;J._40I&&J._41I&&(w={s:y=this.addNode(J._40I),t:J=this.addNode(J._41I)},J=J.s,y=y.s,_=J.width+y.width,J=J.height+y.height,w.length=P(_*_+J*J)*this._edgeRepulsion,w.length<=0&&(w.length=100),this._edges.add(w))},relaxEdge:function(J){var w=J.t,y=J.s,_=w.x-y.x,U=w.y-y.y,Z=P(_*_+U*U),J=100*J.length,_=.25*_/J*Z,U=.25*U/J*Z;w.dx=w.dx-_,w.dy=w.dy-U,y.dx=y.dx+_,y.dy=y.dy+U},relaxNode:function(J,w){var y,_,U,Z,x;J!==w&&((_=y=0)==(Z=(x=J.x-w.x)*x+(U=J.y-w.y)*U)?(y=X(),_=X()):Z<36e4&&(y=x/Z,_=U/Z),_*=x=J.r*w.r/400,J.dx+=y*=x,J.dy+=_,w.dx-=y,w.dy-=_)},moveNode:function(){var _=this,U=_._limitBounds,J=_._maxMotion,Z=0,x=_._damper;_._nodes.each(function(J){var w,y;J.fix||(y=J.dx*x,w=J.dy*x,J.dx=y/2,J.dy=w/2,Z=n(P(y*y+w*w),Z),J.x+=n(-40,q(40,y)),J.y+=n(-40,q(40,w)),U&&(J.x<U.x&&(J.x=U.x,_.adjust(1,0)),J.y<U.y&&(J.y=U.y,_.adjust(0,1)),y=J.s,J.x+y.width>U.x+U.width&&(J.x=U.x+U.width-y.width,_.adjust(-1,0)),J.y+y.height>U.y+U.height&&(J.y=U.y+U.height-y.height,_.adjust(0,-1))))}),_._maxMotion=Z,_._motionRatio=0<Z?J/Z-1:0,_.damp()},adjust:function(w,y){var _=this._limitBounds;this._nodes.each(function(J){0<w?(!_||J.x+J.s.width+w<_.x+_.width)&&(J.x+=w):(!_||J.x+w>_.x)&&(J.x+=w),0<y?(!_||J.y+J.s.height+y<_.y+_.height)&&(J.y+=y):(!_||J.y+y>_.y)&&(J.y+=y)})}}),Z.layout.Force3dLayout=function(J){this.init(J)});Z.Default.def(y+"Force3dLayout",w,{ms_force:1,getNodeSize3d:function(J){return J.s3()},addNode:function(J){var w=this,y=w._nodeMap[J._id];if(y)return y;var _=(y={v:J,p:J.p3(),d:[0,0,0],fix:!w.isLayoutable(J),s:w.getNodeSize3d(J)}).s,_=Z.Default.getDistance(_)*w._nodeRepulsion;return y.r=_<1?100:_,w._nodeMap[J._id]=y,w._nodes.add(y),y},addEdge:function(J){var w,y;J._40I&&J._41I&&(w={s:y=this.addNode(J._40I),t:J=this.addNode(J._41I)},J=J.s,y=y.s,w.length=P(U(J[0]+y[0])+U(J[1]+y[1])+U(J[2]+y[2]))*this._edgeRepulsion,w.length<=0&&(w.length=100),this._edges.add(w))},relaxEdge:function(J){var w=J.t.p,y=J.s.p,_=J.t.d,U=J.s.d,Z=w[0]-y[0],x=w[1]-y[1],w=w[2]-y[2],y=P(Z*Z+x*x+w*w),J=100*J.length,Z=.25*Z/J*y,x=.25*x/J*y,w=.25*w/J*y;_[0]-=Z,_[1]-=x,_[2]-=w,U[0]+=Z,U[1]+=x,U[2]+=w},relaxNode:function(J,w){var y,_,U,Z,x,k,c;J!==w&&(c=J.p,Z=w.p,(U=_=y=0)==(Z=(x=c[0]-Z[0])*x+(k=c[1]-Z[1])*k+(c=c[2]-Z[2])*c)?(y=X(),_=X(),U=X()):Z<216e6&&(y=x/Z,_=k/Z,U=c/Z),x=J.r*w.r/400,k=J.d,c=w.d,_*=x,U*=x,k[0]+=y*=x,k[1]+=_,k[2]+=U,c[0]-=y,c[1]-=_,c[2]-=U)},moveNode:function(){var J=this,w=J._maxMotion,Z=0,x=J._damper;J._nodes.each(function(J){var w,y,_,U;J.fix||(w=J.p,y=(J=J.d)[0]*x,_=J[1]*x,U=J[2]*x,J[0]=y/2,J[1]=_/2,J[2]=U/2,Z=n(P(y*y+_*_+U*U),Z),w[0]+=n(-40,q(40,y)),w[1]+=n(-40,q(40,_)),w[2]+=n(-40,q(40,U)))}),J._maxMotion=Z,J._motionRatio=0<Z?w/Z-1:0,J.damp()}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);
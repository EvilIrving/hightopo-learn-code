!function(h,k){"use strict";function K(h,K,b){v("ht."+h,K,b)}function s(h,K,b){b?h.push(K.x,K.y):h.push(K.x,K.y,K.z)}function _(Q,h,K){var b,O=Q.data.getAttaches();if(O&&O.each(function(h){h instanceof f&&h.s("attach.operation")&&(b=b||[]).push(h)}),b){Y.forEach(function(h){h=function(h,K,b,O){var A,p,Z,w,r=0,k=[];if(O)for(A=O.length;r<A;r+=3)p=O[r],Z=O[r+1],w=O[r+2],$(k,new a([K[3*p],K[3*p+1],K[3*p+2]],null,b?[b[2*p],b[2*p+1],0]:q),new a([K[3*Z],K[3*Z+1],K[3*Z+2]],null,b?[b[2*Z],b[2*Z+1],0]:q),new a([K[3*w],K[3*w+1],K[3*w+2]],null,b?[b[2*w],b[2*w+1],0]:q),h);else for(A=K.length/3;r<A;r+=3)Z=(p=r)+1,w=r+2,$(k,new a([K[3*p],K[3*p+1],K[3*p+2]],null,b?[b[2*p],b[2*p+1],0]:q),new a([K[3*Z],K[3*Z+1],K[3*Z+2]],null,b?[b[2*Z],b[2*Z+1],0]:q),new a([K[3*w],K[3*w+1],K[3*w+2]],null,b?[b[2*w],b[2*w+1],0]:q),h);return k}(h,Q[h].vs,Q[h].tuv);A=A?A.concat(h):h}),A=I.$15n(A),b.forEach(function(h){var K=h.s("attach.operation");A[K]&&(A=A[K](function(h,K,b){var O,A=B(h),p=[],Z=(h.appendAnchorMatrix3d(A),K?K.getData3dUI(h):null);if(Z&&Z.s("shape3d")&&!Z.s("csg.cull.box")&&(O=Z.shapeModel,O=Z.shapeModel?O:x.getShapeModel(Z,Z.s("shape3d"))))for(var w=x.createNormalMatrix(A),r=0,k=rC.length;r<k;r++){var Q=(T=rC[r]).length?T+"_":T,G=O[Q+"vs"],s=O[Q+"uv"],e=O[Q+"is"],d=O[Q+"ns"];if(G&&G.length)for(var C,t,V,y=0,X=e?e.length:G.length/3;y<X;y+=3)V=e?(C=e[y],t=e[y+1],e[y+2]):(t=(C=y)+1,y+2),$(p,new a(c([G[3*C],G[3*C+1],G[3*C+2]],A),d?c([d[3*C],d[3*C+1],d[3*C+2]],w):null,[s[2*C],s[2*C+1],0]),new a(c([G[3*t],G[3*t+1],G[3*t+2]],A),d?c([d[3*t],d[3*t+1],d[3*t+2]],w):null,[s[2*t],s[2*t+1],0]),new a(c([G[3*V],G[3*V+1],G[3*V+2]],A),d?c([d[3*V],d[3*V+1],d[3*V+2]],w):null,[s[2*V],s[2*V+1],0]),h)}if(!O)for(r=0;r<6;r++)for(var T=Y[r],j=QC[r],s=b?K.getFaceUv(h,T):q,F=b?K.getFaceUvScale(h,T):q,S=b?K.getFaceUvOffset(h,T):q,f=0;f<2;f++){var L,_,E,D=l[j+3*f],H=l[j+3*f+1],m=l[j+3*f+2];b&&(E=s?(L=[s[2*D-(E=8*r)],s[2*D+1-E],0],_=[s[2*H-E],s[2*H+1-E],0],[s[2*m-E],s[2*m+1-E],0]):(L=[i[2*D],i[2*D+1],0],_=[i[2*H],i[2*H+1],0],[i[2*m],i[2*m+1],0]),F&&(L[0]*=F[0],L[1]*=F[1],_[0]*=F[0],_[1]*=F[1],E[0]*=F[0],E[1]*=F[1]),S&&(L[0]+=S[0],L[1]+=S[1],_[0]+=S[0],_[1]+=S[1],E[0]+=S[0],E[1]+=S[1])),$(p,new a(c([W[3*D],W[3*D+1],W[3*D+2]],A),null,L),new a(c([W[3*H],W[3*H+1],W[3*H+2]],A),null,_),new a(c([W[3*m],W[3*m+1],W[3*m+2]],A),null,E),h)}return I.$15n(p)}(h,Q.gv,Q.csg.tuv)))}),Y.forEach(function(h){(h=Q[h]).vs=[],h.ns=[],h.tuv&&(h.tuv=[])}),Q.csg&&!Q.csg.ns&&(Q.csg.ns=[]);var A,G=[];if(A.$19n().forEach(function(h){var K,b=h.$10n;if(b instanceof f){if(b.s("attach.cull"))return;K=(K=b.s("csg.cull.color"))&&x.toColorArray(K),b="csg"}for(var b=Q[b],O=b.vs,A=b.ns,p=b.tuv,Z=h.$9n,w=2;w<Z.length;w++)if(s(O,Z[0].$24n),s(O,Z[w-1].$24n),s(O,Z[w].$24n),A&&(s(A,Z[0].$22n),s(A,Z[w-1].$22n),s(A,Z[w].$22n)),p&&(s(p,Z[0].uv,!0),s(p,Z[w-1].uv,!0),s(p,Z[w].uv,!0)),K)for(var r=O.length/3*4,k=0;k<3;k++)G[--r]=K[3],G[--r]=K[2],G[--r]=K[1],G[--r]=K[0]}),G.length){for(var p=x.toColorArray(Q.csg.color),Z=0,w=Q.csg.vs.length/3*4;Z<w;Z+=4)G[Z]==k&&(G[Z]=p[0],G[Z+1]=p[1],G[Z+2]=p[2],G[Z+3]=p[3]);Q.csg.cs=G}}kC.forEach(function(h){var K=Q[h];K.visible&&K.vs.length?(K.ns&&K.ns.length?e(K,"ns"):K.ns=o(K.vs),e(K,"vs"),e(K,"tuv"),K.cs&&e(K,"cs")):delete Q[h]}),h&&(P(Q,q,h,q,K),Q.clear())}function O(h,K){this.$22n=h,this.w=K}function E(h,K,b,O,s){var A=[],p=[],Z=[],w=new X;if((h=h.getData3dUI(K)).mat){var r,k=(new T).fromArray(h.mat),K=new T,Q=(K.makeRotationFromEuler(O),K.setPosition(b),(new T).getInverse(K)),G=(new T).scale({x:1/s.x,y:1/s.y,z:1/s.z}),e=[],d=new X,C=new X;for(h.eachShapeModel(function(h,K,b){for(var O,A,p,Z=0,w=K?K.length:h.length/3;Z<w;Z++)K?(d.fromArray(h,3*K[Z]),C.fromArray(b,3*K[Z])):(d.fromArray(h,3*Z),C.fromArray(b,3*Z)),O=e,p=C,(A=d).applyMatrix4(k),A.applyMatrix4(Q),p.transformDirection(k),p.transformDirection(Q),O.push(new VC(A.clone(),p.clone()))}),e=V(e,w.set(1,0,0)),e=V(e,w.set(-1,0,0)),e=V(e,w.set(0,1,0)),e=V(e,w.set(0,-1,0)),e=V(e,w.set(0,0,1)),e=V(e,w.set(0,0,-1)),r=0;r<e.length;r++){var t=e[r];Z.push(.5+t.position.x/s.x,.5-t.position.y/s.y),t.position.applyMatrix4(G),A.push(t.position.x,t.position.y,t.position.z),p.push(t.$22n.x,t.$22n.y,t.$22n.z)}return{vs:A,ns:p,uv:Z}}function V(h,K){for(var b=[],O=.5*Math.abs(s.dot(K)),A=0;A<h.length;A+=3){var p,Z,w,r,k=0<h[A+0].position.dot(K)-O,Q=0<h[A+1].position.dot(K)-O,G=0<h[A+2].position.dot(K)-O;switch((k?1:0)+(Q?1:0)+(G?1:0)){case 0:b.push(h[A]),b.push(h[A+1]),b.push(h[A+2]);break;case 1:if(k&&(p=h[A+1],Z=h[A+2],w=y(h[A],p,K,O),r=y(h[A],Z,K,O)),Q){p=h[A],Z=h[A+2],w=y(h[A+1],p,K,O),r=y(h[A+1],Z,K,O),b.push(w),b.push(Z.clone()),b.push(p.clone()),b.push(Z.clone()),b.push(w.clone()),b.push(r);break}G&&(p=h[A],Z=h[A+1],w=y(h[A+2],p,K,O),r=y(h[A+2],Z,K,O)),b.push(p.clone()),b.push(Z.clone()),b.push(w),b.push(r),b.push(w.clone()),b.push(Z.clone());break;case 2:k||(Z=y(p=h[A].clone(),h[A+1],K,O),w=y(p,h[A+2],K,O),b.push(p),b.push(Z),b.push(w)),Q||(Z=y(p=h[A+1].clone(),h[A+2],K,O),w=y(p,h[A],K,O),b.push(p),b.push(Z),b.push(w)),G||(Z=y(p=h[A+2].clone(),h[A],K,O),w=y(p,h[A+1],K,O),b.push(p),b.push(Z),b.push(w))}}return b}function y(h,K,b,O){var A=h.position.dot(b)-O,A=A/(A-(K.position.dot(b)-O));return new VC(new X(h.position.x+A*(K.position.x-h.position.x),h.position.y+A*(K.position.y-h.position.y),h.position.z+A*(K.position.z-h.position.z)),new X(h.$22n.x+A*(K.$22n.x-h.$22n.x),h.$22n.y+A*(K.$22n.y-h.$22n.y),h.$22n.z+A*(K.$22n.z-h.$22n.z)))}}var Z,w,r,Q=h.ht,q=null,h=Math,t=h.PI,D=h.cos,V=h.sin,H=h.abs,m=h.max,z=h.sqrt,n=1e-5,p=Q.Default,v=p.def,g=p.startAnim,N=p.createMatrix,c=p.transformVec,x=p.getInternal(),b=x.addMethod,A=x.superCall,R=x.toPointsArray,o=x.createNormals,e=x.toFloatArray,U=x.glMV,h=(x.glPop,Q.graph3d.Graph3dView,Q.Math),X=h.Vector3,T=h.Matrix4,J=h.Euler,P=(h.Quaternion,x.batchShape),B=x.createNodeMatrix,u=x.getFaceInfo,M=x.transformAppend,hC=x.drawFaceInfo,KC=x.createAnim,h=x.cube(),l=h.is,W=h.vs,i=h.uv,h=x.ui(),bC=Q.Node,OC=Q.Shape,AC="left",pC="right",ZC="top",wC="bottom",G="dw.expanded",d=".expanded",C="dw.angle",y=".angle",$=(Z=new Q.Math.Vector3,w=new Q.Math.Vector3,r=new Q.Math.Vector3,function(h,K,b,O,A){var p;Z.copy(K.$24n),w.copy(b.$24n),r.copy(O.$24n),r.equals(Z)||w.equals(Z)||w.equals(r)||(K.$22n&&b.$22n&&O.$22n||(p=w.sub(Z).cross(r.sub(Z)).normalize().multiplyScalar(1).toArray(),K.$22n||(K.$22n=new j(p)),b.$22n||(b.$22n=new j(p)),O.$22n||(O.$22n=new j(p))),h.push(new F([K,b,O],A)))}),Y=[AC,"front",pC,"back",ZC,wC],rC=["",ZC,wC],kC=Y.concat("csg"),QC=[0,6,12,18,24,30],I=(b(p,{createFrameModel:function(h,K,b,O){h=h==q?.07:h,K=K==q?h:K,b=b==q?h:b;var A=(O=O||{}).top,p=O.bottom,Z=O.left,w=O.right,r=O.front,O=O.back,k=[],Q=[];return!0===r?(k.push(-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5),Q.push(0,0,0,1,1,1,1,1,1,0,0,0)):!1!==r&&(k.push(-.5,.5,.5,-.5,-.5,.5,-.5+h,-.5,.5,-.5+h,-.5,.5,-.5+h,.5,.5,-.5,.5,.5,.5-h,.5,.5,.5-h,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5-h,.5,.5,-.5+h,.5,.5,-.5+h,.5-K,.5,.5-h,.5-K,.5,.5-h,.5-K,.5,.5-h,.5,.5,-.5+h,.5,.5,-.5+h,-.5+K,.5,-.5+h,-.5,.5,.5-h,-.5,.5,.5-h,-.5,.5,.5-h,-.5+K,.5,-.5+h,-.5+K,.5),Q.push(0,0,0,1,h,1,h,1,h,0,0,0,1-h,0,1-h,1,1,1,1,1,1,0,1-h,0,h,0,h,K,1-h,K,1-h,K,1-h,0,h,0,h,1-K,h,1,1-h,1,1-h,1,1-h,1-K,h,1-K)),!0===O?(k.push(-.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5),Q.push(1,0,0,1,1,1,0,1,1,0,0,0)):!1!==O&&(k.push(-.5,.5,-.5,-.5+h,-.5,-.5,-.5,-.5,-.5,-.5+h,-.5,-.5,-.5,.5,-.5,-.5+h,.5,-.5,.5-h,.5,-.5,.5,-.5,-.5,.5-h,-.5,-.5,.5,-.5,-.5,.5-h,.5,-.5,.5,.5,-.5,-.5+h,.5,-.5,.5-h,.5-K,-.5,-.5+h,.5-K,-.5,.5-h,.5-K,-.5,-.5+h,.5,-.5,.5-h,.5,-.5,-.5+h,-.5+K,-.5,.5-h,-.5,-.5,-.5+h,-.5,-.5,.5-h,-.5,-.5,-.5+h,-.5+K,-.5,.5-h,-.5+K,-.5),Q.push(1,0,1-h,1,1,1,1-h,1,1,0,1-h,0,h,0,0,1,h,1,0,1,h,0,0,0,1-h,0,h,K,1-h,K,h,K,1-h,0,h,0,1-h,1-K,h,1,1-h,1,h,1,1-h,1-K,h,1-K)),!0===Z?(k.push(-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,-.5),Q.push(0,0,0,1,1,1,1,1,1,0,0,0)):!1!==Z&&(k.push(-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5+b,-.5,-.5,-.5+b,-.5,.5,-.5+b,-.5,.5,-.5,-.5,.5,.5-b,-.5,-.5,.5-b,-.5,-.5,.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5-b,-.5,.5,-.5+b,-.5,.5-K,-.5+b,-.5,.5-K,.5-b,-.5,.5-K,.5-b,-.5,.5,.5-b,-.5,.5,-.5+b,-.5,-.5+K,-.5+b,-.5,-.5,-.5+b,-.5,-.5,.5-b,-.5,-.5,.5-b,-.5,-.5+K,.5-b,-.5,-.5+K,-.5+b),Q.push(0,0,0,1,b,1,b,1,b,0,0,0,1-b,0,1-b,1,1,1,1,1,1,0,1-b,0,b,0,b,K,1-b,K,1-b,K,1-b,0,b,0,b,1-K,b,1,1-b,1,1-b,1,1-b,1-K,b,1-K)),!0===w?(k.push(.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,-.5,.5,.5,.5),Q.push(1,0,0,1,1,1,0,1,1,0,0,0)):!1!==w&&(k.push(.5,.5,-.5,.5,-.5,-.5+b,.5,-.5,-.5,.5,-.5,-.5+b,.5,.5,-.5,.5,.5,-.5+b,.5,.5,.5-b,.5,-.5,.5,.5,-.5,.5-b,.5,-.5,.5,.5,.5,.5-b,.5,.5,.5,.5,.5,-.5+b,.5,.5-K,.5-b,.5,.5-K,-.5+b,.5,.5-K,.5-b,.5,.5,-.5+b,.5,.5,.5-b,.5,-.5+K,-.5+b,.5,-.5,.5-b,.5,-.5,-.5+b,.5,-.5,.5-b,.5,-.5+K,-.5+b,.5,-.5+K,.5-b),Q.push(1,0,1-b,1,1,1,1-b,1,1,0,1-b,0,b,0,0,1,b,1,0,1,b,0,0,0,1-b,0,b,K,1-b,K,b,K,1-b,0,b,0,1-b,1-K,b,1,1-b,1,b,1,1-b,1-K,b,1-K)),!0===A?(k.push(.5,.5,.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5),Q.push(1,1,1,0,0,0,0,0,0,1,1,1)):!1!==A&&(k.push(.5,.5,.5,.5,.5,-.5,.5-h,.5,-.5,.5-h,.5,-.5,.5-h,.5,.5,.5,.5,.5,-.5+h,.5,.5,-.5+h,.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5+h,.5,.5,.5-h,.5,.5,.5-h,.5,.5-b,-.5+h,.5,.5-b,-.5+h,.5,.5-b,-.5+h,.5,.5,.5-h,.5,.5,.5-h,.5,-.5+b,.5-h,.5,-.5,-.5+h,.5,-.5,-.5+h,.5,-.5,-.5+h,.5,-.5+b,.5-h,.5,-.5+b),Q.push(1,1,1,0,1-h,0,1-h,0,1-h,1,1,1,h,1,h,0,0,0,0,0,0,1,h,1,1-h,1,1-h,1-b,h,1-b,h,1-b,h,1,1-h,1,1-h,b,1-h,0,h,0,h,0,h,b,1-h,b)),!0===p?(k.push(.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,-.5,-.5,.5),Q.push(1,0,0,1,1,1,0,1,1,0,0,0)):!1!==p&&(k.push(.5,-.5,.5,.5-h,-.5,-.5,.5,-.5,-.5,.5-h,-.5,-.5,.5,-.5,.5,.5-h,-.5,.5,-.5+h,-.5,.5,-.5,-.5,-.5,-.5+h,-.5,-.5,-.5,-.5,-.5,-.5+h,-.5,.5,-.5,-.5,.5,.5-h,-.5,.5,-.5+h,-.5,.5-b,.5-h,-.5,.5-b,-.5+h,-.5,.5-b,.5-h,-.5,.5,-.5+h,-.5,.5,.5-h,-.5,-.5+b,-.5+h,-.5,-.5,.5-h,-.5,-.5,-.5+h,-.5,-.5,.5-h,-.5,-.5+b,-.5+h,-.5,-.5+b),Q.push(1,0,1-h,1,1,1,1-h,1,1,0,1-h,0,h,0,0,1,h,1,0,1,h,0,0,0,1-h,0,h,b,1-h,b,h,b,1-h,0,h,0,1-h,1-b,h,1,1-h,1,h,1,1-h,1-b,h,1-b)),{vs:k,uv:Q}}}),b(Q.Style,{"csg.cull.color":k,"csg.cull.box":!0,"dw.flip":!1,"dw.s3":[.999,.999,.5],"dw.t3":k,"dw.expanded":!1,"dw.toggleable":!0,"dw.axis":"left","dw.start":0,"dw.end":t/2,"dw.angle":0,"attach.cull":!1,"attach.operation":"subtract"},!0),Y.forEach(function(h){var K={};K[h+d]=!1,K[h+".toggleable"]=!1,K[h+".axis"]=AC,K[h+".start"]=0,K[h+".end"]=t/2,K[h+y]=0,b(Q.Style,K,!0)}),function(){this.$4n=[]}),j=(I.$15n=function(h){var K=new I;return K.$4n=h,K},I.prototype={clone:function(){var h=new I;return h.$4n=this.$4n.map(function(h){return h.clone()}),h},$19n:function(){return this.$4n},union:function(h){var K=new S(this.clone().$4n),h=new S(h.clone().$4n);return K.$3n(h),h.$3n(K),h.$6n(),h.$3n(K),h.$6n(),K.$7n(h.$2n()),I.$15n(K.$2n())},subtract:function(h){var K=new S(this.clone().$4n),h=new S(h.clone().$4n);return K.$6n(),K.$3n(h),h.$3n(K),h.$6n(),h.$3n(K),h.$6n(),K.$7n(h.$2n()),K.$6n(),I.$15n(K.$2n())},intersect:function(h){var K=new S(this.clone().$4n),h=new S(h.clone().$4n);return K.$6n(),h.$3n(K),h.$6n(),K.$3n(h),h.$3n(K),K.$7n(h.$2n()),K.$6n(),I.$15n(K.$2n())},inverse:function(){var h=this.clone();return h.$4n.map(function(h){h.flip()}),h}},I.cube=function(h){var b=new j((h=h||{}).center||[0,0,0]),O=h.radius?h.radius.length?h.radius:[h.radius,h.radius,h.radius]:[1,1,1];return I.$15n([[[0,4,6,2],[-1,0,0]],[[1,3,7,5],[1,0,0]],[[0,1,5,4],[0,-1,0]],[[2,6,7,3],[0,1,0]],[[0,2,3,1],[0,0,-1]],[[4,5,7,6],[0,0,1]]].map(function(K){return new F(K[0].map(function(h){h=new j(b.x+O[0]*(2*!!(1&h)-1),b.y+O[1]*(2*!!(2&h)-1),b.z+O[2]*(2*!!(4&h)-1));return new a(h,new j(K[1]))}))}))},I.sphere=function(h){var b,O=new j((h=h||{}).center||[0,0,0]),A=h.radius||1,K=h.slices||16,p=h.stacks||8,Z=[];function w(h,K){K*=t;h=new j(D(h*=2*t)*V(K),D(K),V(h)*V(K));b.push(new a(O.$20n(h.$21n(A)),h))}for(var r=0;r<K;r++)for(var k=0;k<p;k++)b=[],w(r/K,k/p),0<k&&w((r+1)/K,k/p),k<p-1&&w((r+1)/K,(k+1)/p),w(r/K,(k+1)/p),Z.push(new F(b));return I.$15n(Z)},I.cylinder=function(h){var O=new j((h=h||{}).start||[0,-1,0]),K=new j(h.end||[0,1,0]),A=K.$13n(O),p=h.radius||1,b=h.slices||16,Z=A.$14n(),h=.5<H(Z.y),w=new j(h,!h,0).cross(Z).$14n(),r=w.cross(Z).$14n(),k=new a(O,Z.$11n()),Q=new a(K,Z.$14n()),G=[];function s(h,K,b){K=K*t*2,K=w.$21n(D(K)).$20n(r.$21n(V(K))),h=O.$20n(A.$21n(h)).$20n(K.$21n(p)),K=K.$21n(1-H(b)).$20n(Z.$21n(b));return new a(h,K)}for(var e=0;e<b;e++){var d=e/b,C=(e+1)/b;G.push(new F([k,s(0,d,-1),s(0,C,-1)])),G.push(new F([s(0,C,0),s(0,d,0),s(1,d,0),s(1,C,0)])),G.push(new F([Q,s(1,C,1),s(1,d,1)]))}return I.$15n(G)},function(h,K,b){var O=this;3==arguments.length?(O.x=h,O.y=K,O.z=b):"x"in h?(O.x=h.x,O.y=h.y,O.z=h.z):(O.x=h[0],O.y=h[1],O.z=h[2])}),a=(j.prototype={clone:function(){return new j(this.x,this.y,this.z)},$11n:function(){return new j(-this.x,-this.y,-this.z)},$20n:function(h){return new j(this.x+h.x,this.y+h.y,this.z+h.z)},$13n:function(h){return new j(this.x-h.x,this.y-h.y,this.z-h.z)},$21n:function(h){return new j(this.x*h,this.y*h,this.z*h)},$16n:function(h){return new j(this.x/h,this.y/h,this.z/h)},dot:function(h){return this.x*h.x+this.y*h.y+this.z*h.z},lerp:function(h,K){return this.$20n(h.$13n(this).$21n(K))},length:function(){return z(this.dot(this))},$14n:function(){return this.$16n(this.length())},cross:function(h){var K=this;return new j(K.y*h.z-K.z*h.y,K.z*h.x-K.x*h.z,K.x*h.y-K.y*h.x)}},function(h,K,b){this.$24n=new j(h),this.$22n=K?new j(K):null,this.uv=b?new j(b):null}),F=(a.prototype={clone:function(){return new a(this.$24n.clone(),this.$22n.clone(),this.uv?this.uv.clone():null)},flip:function(){this.$22n=this.$22n.$11n()},$18n:function(h,K){return new a(this.$24n.lerp(h.$24n,K),this.$22n.lerp(h.$22n,K),this.uv?this.uv.lerp(h.uv,K):null)}},O.$17n=function(h,K,b){K=K.$13n(h).cross(b.$13n(h)).$14n();return new O(K,K.dot(h))},O.prototype={clone:function(){return new O(this.$22n.clone(),this.w)},flip:function(){this.$22n=this.$22n.$11n(),this.w=-this.w},$5n:function(h,K,b,O,A){for(var p=this,Z=0,w=[],r=0;r<h.$9n.length;r++){var k=(s=p.$22n.dot(h.$9n[r].$24n)-p.w)<-n?2:n<s?1:0;Z|=k,w.push(k)}switch(Z){case 0:(0<p.$22n.dot(h.$8n.$22n)?K:b).push(h);break;case 1:O.push(h);break;case 2:A.push(h);break;case 3:for(var Q=[],G=[],r=0;r<h.$9n.length;r++){var s,e=(r+1)%h.$9n.length,d=w[r],C=w[e],t=h.$9n[r],e=h.$9n[e];2!=d&&Q.push(t),1!=d&&G.push(2!=d?t.clone():t),3==(d|C)&&(s=(p.w-this.$22n.dot(t.$24n))/p.$22n.dot(e.$24n.$13n(t.$24n)),d=t.$18n(e,s),Q.push(d),G.push(d.clone()))}3<=Q.length&&O.push(new F(Q,h.$10n)),3<=G.length&&A.push(new F(G,h.$10n))}}},function(h,K){this.$9n=h,this.$10n=K,this.$8n=O.$17n(h[0].$24n,h[1].$24n,h[2].$24n)}),S=(F.prototype={clone:function(){var h=this.$9n.map(function(h){return h.clone()});return new F(h,this.$10n)},flip:function(){this.$9n.reverse().map(function(h){h.flip()}),this.$8n.flip()}},function(h){var K=this;K.$8n=null,K.front=null,K.back=null,K.$4n=[],h&&K.$7n(h)}),GC=(S.prototype={clone:function(){var h=this,K=new S;return K.$8n=h.$8n&&h.$8n.clone(),K.front=h.front&&h.front.clone(),K.back=h.back&&h.back.clone(),K.$4n=h.$4n.map(function(h){return h.clone()}),K},$6n:function(){for(var h=this,K=0;K<h.$4n.length;K++)h.$4n[K].flip();h.$8n&&h.$8n.flip(),h.front&&h.front.$6n(),h.back&&h.back.$6n();var b=h.front;h.front=h.back,h.back=b},$1n:function(h){var K=this;if(!K.$8n)return h.slice();for(var b=[],O=[],A=0;A<h.length;A++)K.$8n.$5n(h[A],b,O,b,O);return K.front&&(b=K.front.$1n(b)),O=K.back?K.back.$1n(O):[],b.concat(O)},$3n:function(h){var K=this;K.$4n=h.$1n(K.$4n),K.front&&K.front.$3n(h),K.back&&K.back.$3n(h)},$2n:function(){var h=this,K=h.$4n.slice();return h.front&&(K=K.concat(h.front.$2n())),K=h.back?K.concat(h.back.$2n()):K},$7n:function(h){var K=this;if(h.length){K.$8n||(K.$8n=h[0].$8n.clone());for(var b=[],O=[],A=0;A<h.length;A++)this.$8n.$5n(h[A],K.$4n,K.$4n,b,O);b.length&&(K.front||(K.front=new S),this.front.$7n(b)),O.length&&(K.back||(K.back=new S),K.back.$7n(O))}}},Q.Symbol=function(h,K,b){A(GC,this),this.s3(20,20,20),this.s({"all.visible":!1,shape:"rect"}),this.setIcon(h,K,b)}),f=(K("Symbol",bC,{setIcon:function(h,K,b){var O,A=this;return GC.superClass.setIcon.call(A,h),h?(O={for3d:!0,face:"center",position:44,names:[h]},b&&(O.transaprent=!0),K&&(O.autorotate=K),A.addStyleIcon("symbol",O)):A.removeStyleIcon("symbol"),A.setWidth(x.getImageWidth(p.getImage(h),A)||20),O}}),Q.CSGNode=function(){A(f,this),this.s({shape:"rect","attach.thickness":1.001,"2d.attachable":!0})}),sC={position:1,width:1,height:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,tall:1,elevation:1,anchor:1,anchorElevation:1,"s:attach.cull":1,"s:attach.operation":1},L=(K("CSGNode",bC,{_22Q:function(){return L},onPropertyChanged:function(h){var K=this.getHost();f.superClass.onPropertyChanged.call(this,h),sC[h.property]&&(K instanceof eC||K instanceof f)&&K.fp("csgNodeChange",!0,!1)}}),function(h,K){A(L,this,[h,K])}),eC=(v(L,h.Node3dUI,{_80o:function(K,b,O){var A=this;A._shape3d?L.superClass._80o.call(A,K,b,O):(U(A.gv),kC.forEach(function(h){hC(A,K,b,h,O)}))},validate:function(h,K){var b=this,O=b.gv,A=b.data;if(A.s("shape3d"))return L.superClass.validate.call(b,h,K),void(b._shape3d=!0);b._shape3d=!1;var p=B(A,O.getMat(A)),Z=(A.appendAnchorMatrix3d(p),h&&h.uv);b.vf2("csg",Z);for(var w=0;w<6;w++)for(var r=Y[w],k=QC[w],r=b.vf2(r,Z,K),Q=r.mat||p,G=r.vs,s=r.uv,e=r.tuv,d=0;d<2;d++){var C,t=l[k+3*d],V=l[k+3*d+1],y=l[k+3*d+2];M(G,Q,[W[3*t],W[3*t+1],W[3*t+2]]),M(G,Q,[W[3*V],W[3*V+1],W[3*V+2]]),M(G,Q,[W[3*y],W[3*y+1],W[3*y+2]]),e&&(s?e.push(s[2*t-(C=8*w)],s[2*t+1-C],s[2*V-C],s[2*V+1-C],s[2*y-C],s[2*y+1-C]):e.push(i[2*t],i[2*t+1],i[2*V],i[2*V+1],i[2*y],i[2*y+1]))}_(b,h,K)},vf2:function(h,K,b){var O=this.gv.getFaceVisible(this.data,h),h=u(this,h,b);return h.vs=[],h.tuv=O&&(h.texture||K)?[]:q,h.visible=O,h}}),Q.CSGShape=function(){var h=this;A(eC,h),h.s({"shape.background":q,"2d.hostable":!0,"shape.border.width":8}),h.setTall(240),h.setElevation(120),h.setThickness(14)}),dC=(K("CSGShape",OC,{IRotatable:!1,_22Q:function(){return dC},setRotationX:function(h){},setRotation:function(h){},setRotationZ:function(h){},setSegments:function(h){}}),function(h,K){A(dC,this,[h,K])}),CC=(v(dC,h.Shape3dUI,{_80o:function(K,b,O){var A=this;A.undrawable||(U(A.gv),kC.forEach(function(h){hC(A,K,b,h,O)}))},validate:function(K,b){var h,O,A,p,Z=this,w=Z.data,r=w.getPoints();(Z.undrawable=r.size()<2)?Z.clear():(h=w.isClosePath(),O=m(w._thickness/2,n),r=R(r,q,q,h),kC.forEach(function(h){Z.vf(h,K&&K.uv,!0,b)}),h&&(Z.left.visible=!1,Z.right.visible=!1),Z._12O(r,O),Z._20Q(r),A=w.getPointsMatrix3d(),p=Q.Math.requestVector3(),Y.forEach(function(h){if(Z[h])for(var K=Z[h].vs,b=0,O=K.length;b<O;b+=3)p.set(K[b],K[b+1],K[b+2]).applyMatrix4(A),K[b]=p.x,K[b+1]=p.y,K[b+2]=p.z}),Q.Math.releaseVector3(p),_(Z,K,b))}}),Q.DoorWindow=function(){A(CC,this),this.setElevation(100),this.s3(100,200,14)}),tC=(K("DoorWindow",f,{IDoorWindow:!0,toggle:function(h){this.setExpanded(!this.s(G),h)},isExpanded:function(){return this.s(G)},setExpanded:function(h,K){var b,O=this,A=O.$25n,p=O.s(G);A&&(A.stop(!0),delete O.$25n),p!==h&&(O.beginTransaction(),b=h?O.s("dw.end"):O.s("dw.start"),O.s(G,h),(K=KC(K))?(p=O.s(C),K.action=function(h){O.s(C,p+(b-p)*h)},K.finishFunc=function(){O.endTransaction()},O.$25n=g(K)):(O.s(C,b),O.endTransaction()))},getMat:function(){var h,K,b=this,O=b.s("dw.s3"),A=b.s("dw.t3"),p=b.s("dw.flip"),Z=b.s(C);return O||Z||A||p?(h=[],p&&h.push({r3:[0,t,0]}),O&&h.push({s3:O}),Z&&(O=b.getFinalScale3d(),p=b.s("dw.axis"),b=O[0]/2,K=O[1]/2,O[2],p===AC?h.push({t3:[b,0,0]},{r3:[0,-Z,0]},{t3:[-b,0,0]}):p===pC?h.push({t3:[-b,0,0]},{r3:[0,Z,0]},{t3:[b,0,0]}):p===ZC?h.push({t3:[0,-K,0]},{r3:[-Z,0,0]},{t3:[0,K,0]}):p===wC?h.push({t3:[0,K,0]},{r3:[Z,0,0]},{t3:[0,-K,0]}):"v"===p?h.push({r3:[0,Z,0]}):"h"===p&&h.push({r3:[Z,0,0]})),A&&h.push({t3:A}),N(h)):q}}),Q.CSGBox=function(){A(tC,this),this.setElevation(100),this.s3(100,200,100)});K("CSGBox",f,{ICSGBox:!0,toggleFace:function(h,K){this.setFaceExpanded(h,!this.s(h+d),K)},isFaceExpanded:function(h){return this.s(h+d)},setFaceExpanded:function(K,h,b){var O,A=this,p=A.$25n,Z=A.s(K+d);p&&(p.stop(!0),delete A.$25n),Z!==h&&(O=h?A.s(K+".end"):A.s(K+".start"),A.s(K+d,h),(b=KC(b))?(Z=A.s(K+y),b.action=function(h){A.s(K+y,Z+(O-Z)*h)},A.$25n=g(b)):A.s(K+y,O))},getFaceMat:function(h){var K=this.s(h+y);if(!K)return q;var b,O,A,p,Z,w,r=this.s(h+".axis"),k=this.getFinalScale3d(),Q=this.getAnchor3d(),G=k[0]*Q.x,s=k[1]*Q.y,e=k[2]*Q.z,d=k[0]-G,C=k[1]-s,t=k[2]-e;switch(h+"_"+r){case"front_left":b=-G,A=t,Z=-K,w=p=O=0;break;case"front_right":b=d,A=t,Z=K,w=p=O=0;break;case"front_top":O=C,A=t,p=-K,w=Z=b=0;break;case"front_bottom":O=-s,A=t,p=K,w=Z=b=0;break;case"front_h":A=t,p=K,w=Z=O=b=0;break;case"front_v":A=t,Z=K,w=p=O=b=0;break;case"back_left":b=d,A=-e,Z=-K,w=p=O=0;break;case"back_right":b=-G,A=-e,Z=K,w=p=O=0;break;case"back_top":O=C,A=-e,p=K,w=Z=b=0;break;case"back_bottom":O=-s,A=-e,p=-K,w=Z=b=0;break;case"back_h":A=-e,p=K,w=Z=O=b=0;break;case"back_v":A=-e,Z=K,w=p=O=b=0;break;case"left_left":b=-G,A=-e,Z=-K,w=p=O=0;break;case"left_right":b=-G,A=t,Z=K,w=p=O=0;break;case"left_top":b=-G,O=C,Z=p=A=0,w=-K;break;case"left_bottom":b=-G,O=-s,Z=p=A=0,w=K;break;case"left_h":b=-G,Z=p=A=O=0,w=K;break;case"left_v":b=-G,Z=K,w=p=A=O=0;break;case"right_left":b=d,A=t,Z=-K,w=p=O=0;break;case"right_right":b=d,A=-e,Z=K,w=p=O=0;break;case"right_top":b=d,O=C,Z=p=A=0,w=K;break;case"right_bottom":b=d,O=-s,Z=p=A=0,w=-K;break;case"right_h":b=d,Z=p=A=O=0,w=K;break;case"right_v":b=d,Z=K,w=p=A=O=0;break;case"top_left":b=-G,O=C,Z=p=A=0,w=K;break;case"top_right":b=d,O=C,Z=p=A=0,w=-K;break;case"top_top":O=C,A=-e,p=-K,w=Z=b=0;break;case"top_bottom":O=C,A=t,p=K,w=Z=b=0;break;case"top_h":O=C,p=K,w=Z=A=b=0;break;case"top_v":O=C,Z=p=A=b=0,w=K;break;case"bottom_left":b=-G,O=-s,Z=p=A=0,w=-K;break;case"bottom_right":b=d,O=-s,Z=p=A=0,w=K;break;case"bottom_top":O=-s,A=t,p=-K,w=Z=b=0;break;case"bottom_bottom":O=-s,A=-e,p=K,w=Z=b=0;break;case"bottom_h":O=-s,p=K,w=Z=A=b=0;break;case"bottom_v":O=-s,Z=p=A=b=0,w=K}return N([{t3:[-b,-O,-A]},{r3:[p,Z,w]},{t3:[b,O,A]}])}});function VC(h,K){this.position=h,this.$22n=K}VC.prototype.clone=function(){return new VC(this.position.clone(),this.$22n.clone())};b(Q.graph3d.Graph3dView,{createDecal:function(h,K,b,O){var A=this,p=A.getDataAt(h);if(p){var Z,w,r,h=A.intersectObject(h,p);if(h)return K="object"==typeof K?K.x?new X(K.x,K.y,K.z):new X(K[0],K[1],K[2]):new X(K=K||20,K,K),b=b===k?.1:b,r=new X(A.getUp()),Z=(w=new X(A.getCenter()).sub(new X(A.getEye())).normalize()).clone().cross(r).normalize(),r.copy(Z).cross(w).normalize(),O&&r.applyAxisAngle(h.worldNormal,-O),Z=new Q.Node,w=h.worldNormal.clone().setLength(b).add(h.world),O=(new T).lookAt(h.worldNormal.clone(),new X(0,0,0),r),b=(new J).setFromRotationMatrix(O),r=E(A,p,h.world.clone(),b,K),Z.p3(w.x,w.y,w.z),Z.setEuler(b),Z.s3(K.x,K.y,K.z),Z.s({shape3d:r,"shape3d.reverse.flip":!0}),Z}}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),void Object);
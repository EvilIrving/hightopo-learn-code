/* 
 * @Date: 2023-06-06 17:02:18
 * @Author: 
 * @Description: 
 * @LastEditors: dtb
 * @LastEditTime: 2023-06-06 17:02:19
 * @FilePath: /Documents/hightopo demo/dataModel/lib/core/ht.js
 */
!function(h,d,K){"use strict";var l0="ht";if(!h.ht){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),h.performance&&h.performance.now||(O=Date.now(),h.performance||(h.performance={}),h.performance.now=function(){return Date.now()-O});for(var O,W=Date.now(),l=["ms","moz","webkit","o"],t=0;t<l.length&&!h.requestAnimationFrame;++t)h.requestAnimationFrame=h[l[t]+"RequestAnimationFrame"],h.cancelAnimationFrame=h[l[t]+"CancelAnimationFrame"]||h[l[t]+"CancelRequestAnimationFrame"];h.requestAnimationFrame||(h.requestAnimationFrame=function(p){var G=Date.now(),v=16+W-G;return W=G,h.setTimeout(function(){W=Date.now(),p(performance.now())},v=v<0?0:v)}),h.cancelAnimationFrame||(h.cancelAnimationFrame=function(p){return h.clearTimeout(p)}),d.assign===K&&(d.assign=function(p){if(p===K||null===p)throw new TypeError("Cannot convert undefined or null to object");for(var G=d(p),v=1;v<arguments.length;v++){var J=arguments[v];if(J!==K&&null!==J)for(var $ in J)d.prototype.hasOwnProperty.call(J,$)&&(G[$]=J[$])}return G}),h.btoa===K&&(h.btoa=function(p){for(var G,v,J=String(p),$=0,S="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",O="";J.charAt(0|$)||(S="=",$%1);O+=S.charAt(63&G>>8-$%1*8)){if(255<(v=J.charCodeAt($+=.75)))throw new Error("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");G=G<<8|v}return O});var B=(Ci=h.location)&&h.document,v0=null,z=K,E=h.ht={},Z=h.htconfig,N=E.Default=Z&&Z.Default||{},F=E.Style=Z&&Z.Style||{},f=E.Attr=Z&&Z.Attr||{},X=function(){return!0},q=function(){return!1},M=function(p){return p},L=function(p){return!p},s=E.Color=Z&&Z.Color||{},g=E.IsGetter=Z&&Z.IsGetter||{},_=!1;try{var b=d.defineProperty({},"passive",{get:function(){return _=!0,K}});Ci&&h.addEventListener("test",b,b),Ci&&h.removeEventListener("test",b,b)}catch(p){_=!1}N.passiveSupported=_;var t0,z0,n,Z0,D,B0,f0,Y,c,e,X0,q0,A,C,Q,p0,G0,g0,Z=N.passiveSupported,M0=N.eventListenerOptionsFalse=!!Z&&{passive:!1,capture:!1},L0=N.eventListenerOptionsTrue=!Z||{passive:!1,capture:!0},H0=function(p,G,v,J){p.addEventListener(G,v,J?L0:M0)},_0=function(p,G,v,J){p.removeEventListener(G,v,J?L0:M0)},b0=(b=Math).round,n0=b.floor,D0=b.ceil,Y0=b.sqrt,J0=b.max,$0=b.min,I=b.abs,S0=b.cos,s0=b.acos,O0=b.sin,c0=b.pow,h0=b.asin,j=(b.exp,b.PI),W0=2*j,w0=j/2,d0=b.tan,P0=b.atan2,j0=b.random,Z=b.log,i0=c0(2,1),r0=h.parseInt||global.parseInt,e0="2023-6-15",A0=Ci&&!!h.navigator&&-1<h.navigator.platform.indexOf("Win"),k0=function(p){return p*p},I0=Ci&&h.setTimeout,E0=Ci&&h.clearTimeout,y0=Ci&&(h.navigator?h.navigator.userAgent.toLowerCase():""),x0=(ZJ=function(p){return p.test(y0)})(/msie/),R0=ZJ(/msie/)||ZJ(/trident/),N0=ZJ(/msie 10/),m0=ZJ(/edge/),K0=ZJ(/firefox/),a0=ZJ(/mac/),u0=(ZJ(/mscAndroid/),N.isTouchable===K?!A0&&!!B&&"ontouchend"in B:N.isTouchable),T0="default",V0="single",o0="multiple",U0="front",F0="back",C0="left",Q0="right",pJ="top",GJ="bottom",vJ="center",JJ="eye",$J="middle",SJ="east",OJ="west",WJ="north",lJ="none",tJ="px",zJ="absolute",ZJ="border",BJ="triangle",y="rect",fJ="circle",XJ="cylinder",qJ="shape",gJ="items",MJ="normal",LJ="remove",HJ="clear",_J="width",bJ="height",nJ="ingroup",DJ="check",YJ="uncheck",sJ="radioOn",cJ="radioOff",hJ="points",wJ="values",dJ="series",PJ="body",jJ="label",iJ="label2",rJ="note",eJ="note2",AJ="icons",kJ="labelFont",IJ="labelColor",EJ="labelSelectColor",yJ="note.expanded",xJ="note2.expanded",RJ="edge.expanded",NJ="edge.points",mJ="edge.type",KJ="rotation",aJ="hidden",uJ="visible",TJ="tuv",VJ="no",oJ="draw",UJ="select",FJ="currentSubGraph",A0="selectBackground",CJ="autoMakeVisible",QJ="autoHideScrollBar",pl="scrollBarColor",Gl="scrollBarSize",vl="indent",Jl="rowHeight",$l="columnLineColor",Sl="rowLineColor",Ol="columnLineVisible",Wl="rowLineVisible",ll="visibleFunc",tl="expandIcon",zl="collapseIcon",Zl="checkMode",Bl="sortFunc",fl="editable",Xl="batchEditable",ql="tristate",gl="asc",Ml="desc",Ll="position",Hl="elevation",_l="children",bl="translateX",nl="translateY",Dl="dataModel",Yl="state",sl="encode",cl="shape3d",hl="shape3d.resolution",wl="shape3d.visible",dl="shape3d.from.visible",Pl="shape3d.to.visible",jl="shape3d.top.visible",il="shape3d.bottom.visible",rl="repeat.uv.length",el="serializeValue",Al="deserializeValue",kl="centerUniform",Il="uniform",El="rgba(255,255,255,0)",yl="style",xl="string",Rl="boolean",Nl="color",ml="int",Kl="number",al="ew-resize",ul="ns-resize",Tl="pointer",Vl="auto",ol="mousedown",Ul="mousemove",Fl="mouseup",Cl="mouseout",Ql="touchstart",pi="touchmove",Gi="touchend",vi="keydown",Ji=["DOMMouseScroll","mousewheel"],$i=K0?Ji[0]:Ji[1],Si="__ht__"+sl,Oi=[Ql,pi,Gi],Wi=[ol,Ul,Fl,Cl,$i,"wheel","mouseenter","mouseleave","mouseover"],li=[vi,"keyup","keypress","input","contextmenu","compositionstart","compositionupdate","compositionend"],ti=(u0?Oi:Wi).concat(li),zi=v0,Zi=v0,Bi=v0,fi=v0,Xi=Fl.length,qi=function(){Bi&&(E0(Bi.timeout),Bi=v0)},gi=function(){Bi&&Kh(Bi.e,Bi.info)},Mi=(h.addEventListener&&(z=Ci)&&(u0||(H0(h,Cl,function(){qi()}),H0(h,$i,function(){ah()})),H0(h,"keyup",function(p){91===p.keyCode?ci={}:delete ci[p.keyCode]},!0),H0(h,vi,function(p){ci[p.keyCode]=!0},!0),H0(h,"blur",function(p){ci={}})),0),Li=v0,Hi=function(p,G){var v=I0(function(){delete Li[v],nS(Li)&&(Li=v0),p()},G);return v},K0=v0,_i={},bi={},ni={},Di={},Yi={},si={},ci={},hi={},wi={},di={},Pi={},ji=/.json$/,ii=/\.(json|bin)$/,ri=/^data:image\/svg\+xml/,ei=[],Ai={},ki=v0,Ii=function(){},Ei=function(){throw"Oops!"},yi=[0,0,0],xi={x:0,y:0,width:0,height:0},Ri=v0,Ni=v0,mi=v0,Ki=function(p,G){(bi[p]=G)&&G.comps&&!G.uuid&&(G.uuid=E.Math.generateUUID()),dj[p]&&(G.cacheRule=dj[p],delete dj[p])},ai=function(p){Ni&&!p._72O&&((mi=mi||{})[p._72O=fA()]=p),Z0!=v0?(p=1e4*O0(Xi++))-n0(p)<.05&&n&&!f0&&(vE=qi):vE=SS},ui=function(v,J,$,S){var O,W,p=(Ni=Ni||{})[v];if(p){if(p.url===J)return;p.image?(p.image.onload=Ii,p.image.onerror=Ii):p.request&&(p.request.onload=Ii,p.request.onerror=Ii)}ji.test(J)?(O=new kI,Ni[v]={request:O,url:J},(J=N.beforeLoadURL(J,v)).data?(W=N.parse(J.data),Ti(v,W),N.handleImageLoaded(v,W)):(O.onload=function(p){var G;200===this.status||0===this.status?(G=N.parse(O.getResponseText()),Ti(v,G),N.handleImageLoaded(v,G)):Ti(v,N.handleUnfoundImage(v,J)||v0)},O.onerror=function(p){Ti(v,N.handleUnfoundImage(v,J)||v0)},(p={}).url=encodeURI(J),p.sync=!1,O.send(p))):(W=new Image,Ni[v]={image:W,url:J},/^data:image/.test(J)||(J=N.beforeLoadURL(J,v),J=N.appendTimeStamp(J),J=encodeURI(J),W.crossOrigin=N.crossOrigin),N.convertImageSrc(J,function(p){R0&&(0<J.toLowerCase().indexOf(".svg")||ri.test(J))?(B.body.appendChild(W),W.style.visibility="hidden",W.onload=function(){I0(function(){var p,G;$&&(W.width=$),S&&(W.height=S),W.width&&W.height||(p=W.width||W.clientWidth,G=W.height||W.clientHeight,W.width=p,W.height=G),N.handleImageLoaded(v,W),Ti(v,W),B.body.removeChild(W),W.style.visibility=""},180)},W.onerror=function(){Ti(v,N.handleUnfoundImage(v,J)||v0),B.body.removeChild(W),W.style.visibility=""}):(W.onload=function(){$&&(W.width=$),S&&(W.height=S),N.handleImageLoaded(v,W),Ti(v,W)},W.onerror=function(){Ti(v,N.handleUnfoundImage(v,J)||v0)}),W.src=p}))},Ti=function(p,G){if(Ki(p,G),delete Ni[p],nS(Ni)&&(Ni=v0,mi)){for(var v in mi)(J=mi[v])._2O&&J._2O[p]&&(J.deleteTexture(p),delete J._2O[p]),J.invalidateAll&&J.invalidateAll(K,"imageLoaded",p),J.redraw&&J.redraw(),J.iv(),J instanceof n3&&J.dm().each(function(p){p instanceof LI&&p.updateLayoutAttaches()}),delete J._72O;mi=v0}if(G&&mi)for(var v in mi){var J;(J=mi[v]).invalidateAll&&J.invalidateAll(K,"imageLoading",p),J.redraw&&J.redraw(),J.iv(),J instanceof n3&&J.dm().each(function(p){p instanceof LI&&p.updateLayoutAttaches()})}},Vi=(Z=b&&Date,function(){return(h.performance&&h.performance.now?h.performance:Date).now()}),oi=function(p,G,v){return{width:p,height:G,comps:lS(v)?v:[v]}},Ui=function(p,G){return{type:fJ,rect:[p,G,1.6,1.6],borderWidth:1,borderColor:v,gradient:mh,gradientColor:i4,background:v}},Fi=function(p,G){return oi(16,16,{type:BJ,rect:[4,4,10,8],background:p,rotation:G?1.57:3.14})},Ci=function(p,G){return oi(16,16,{type:BJ,rect:[4,4,8,7],background:p,rotation:G?3.14:0})},Qi=function(p){return"horizontal"===(p=p._orientation)||"h"===p},pS=function(p,G,v,J){return v||(v=u0?5:3,v/=J||1),{x:p-v,y:G-v,width:2*v,height:2*v}},GS=function(p){return(/ble$/.test(p)||/ed$/.test(p)||g[p]?"is":"get")+p.charAt(0).toUpperCase()+p.slice(1)},vS=function(p){return"set"+p.charAt(0).toUpperCase()+p.slice(1)},JS=function(p){return typeof p==xl||p instanceof String},$S=function(p){return typeof p==Kl},SS=function(p){return typeof p===Rl},OS=function(p){return p&&"object"==typeof p},WS=function(p){return"function"==typeof p},lS=function(p){return p instanceof Array},tS=function(p){return p instanceof o},k=function(p){return p instanceof LI},zS=function(p){return p instanceof YI},ZS=function(p){return p instanceof sI},BS=function(p,G){return p instanceof E.Group&&(G?!(!(G=G.getDataUI(p))||!G._88I):p.isExpanded())},fS=function(p){return p instanceof hI},XS=function(p){return p&&"IFRAME"===p.tagName},qS=function(p,G,v){var J,$=G.length;if(v)for(var S=0;S<v;S++)if(3===$)p.push(G[0]),p.push(G[1]),p.push(G[2]);else for(J=0;J<$;J++)p.push(G[J]);else if(3===$)p.push(G[0]),p.push(G[1]),p.push(G[2]);else for(J=0;J<$;J++)p.push(G[J])},gS=function(p){return!!p&&(OS(p)?p:{})},MS=function(p,G,v){var J,$=OS(p)?p:p.prototype;for(J in G)v&&J in $?$[J]===K&&console.warn("class",$,"has own undefined property",J,", keep exist!"):$[J]=G[J];return p},LS=function(p,G){var v;"wheelDelta"in G||((v=G.deltaMode)===G.DOM_DELTA_PIXEL?G.wheelDelta=-G.deltaY:v===G.DOM_DELTA_LINE?G.wheelDelta=40*-G.deltaY:G.wheelDelta=120*-G.deltaY),p.handle_mousewheel(G)},HS=function(p){return String.fromCharCode(p)},_S=function(p){for(var G,v=0,J="";v<p.length;v++)"%"===(G=p[p.length-1-v])?G="'":"a"===G?G='"':"]"===G&&(G="\\"),J+=HS(G.charCodeAt(0)-1);return J},bS=function(p,G,v){p.superClass.constructor.apply(G,v)},nS=function(p){for(var G in p)return!1;return!0},DS=function(p){return!p||0===p.length},YS=(e="",[YJ[0],Sl[0],jJ[0]].forEach(function(p){e+=vS(p).slice(3)}),Il=B&&B[e]||kl,function(p,G){return p===G||p.x===G.x&&p.y===G.y&&p.width===G.width&&p.height===G.height}),sS=function(p,G,v){return p<G?G:v<p?v:p},cS=function(p){return p<0?-1:0<p?1:0},hS=function(p,G,v){return wS(p.x,p.y,G.x,G.y,v.x,v.y,v.x+v.width,v.y,!0)||wS(p.x,p.y,G.x,G.y,v.x+v.width,v.y,v.x+v.width,v.y+v.height,!0)||wS(p.x,p.y,G.x,G.y,v.x+v.width,v.y+v.height,v.x,v.y+v.height,!0)||wS(p.x,p.y,G.x,G.y,v.x,v.y+v.height,v.x,v.y,!0)},wS=function(p,G,v,J,$,S,O,W,l){var t,z=(W-S)*(v-p)-(O-$)*(J-G);return 0!=z?(t=p+(z=((O-$)*(G-S)-(W-S)*(p-$))/z)*(v-p),z=G+z*(J-G),l&&(t+FA<$0(p,v)||t-FA>J0(p,v)||t+FA<$0($,O)||t-FA>J0($,O)||z+FA<$0(G,J)||z-FA>J0(G,J)||z+FA<$0(S,W)||z-FA>J0(S,W))?v0:[t,z]):v0},dS=function(p,G,v){if(p&&v)if(G){if(G===yl)return p.getStyle(v);if("attr"===G)return p.getAttr(v);if("field"===G)return p[v]}else if(p[v=GS(v)])return p[v]();return K},PS=function(p,G,v,J){p&&v&&(G?G===yl?p.s(v,J):"attr"===G?p.a(v,J):"field"===G&&(G=p[v],p[v]=J,p.fp("f:"+v,G,J)):p[v=vS(v)]&&p[v](J))},jS=function(p,G,v){var J=100*Math.max(p.width,p.height);return G&&"top"!==G?"bottom"===G?{x:p.x-J,y:p.y-J,width:p.width+2*J,height:p.height*v+J}:"right"===G?{x:p.x-J,y:p.y-J,width:p.width*v+J,height:p.height+2*J}:"left"===G?{x:p.x+p.width*(1-v),y:p.y-J,width:p.width*v+J,height:p.height+2*J}:void 0:{x:p.x-J,y:p.y+p.height*(1-v),width:p.width+2*J,height:p.height*v+J}},iS=function(p,G,v,J,$){G&&VE(p,v,J,1,$,G)},rS=function(p,G,v,J){var $=1-p;return $*$*G+2*p*$*v+p*p*J},eS=function(p,G,v,J,$){var S=1-p;return S*S*S*G+3*S*S*p*v+3*S*p*p*J+p*p*p*$},AS=function(p){var G,v,J,$,S=0;return p.forEach(function(p){if(0<(G=p.length))for(v=p[0],$=1;$<G;$++)J=p[$],S+=iA(v,J),v=J}),S},kS=function(p){return d.create(p)},IS=function(p){var G,v;p.element||((G=p.textField)?v=lA(Tk.TextField,G):(G=p.textArea)?v=lA(Tk.TextArea,G):(G=p.button)?v=lA(Tk.Button,G):(G=p.comboBox)?v=lA(Tk.ComboBox,G):(G=p.checkBox)?v=lA(Tk.CheckBox,G):(G=p.radioButton)?v=lA(Tk.RadioButton,G):(G=p.slider)?v=lA(Tk.Slider,G):(G=p.colorPicker)?v=lA(Tk.ColorPicker,G):(G=p.image)&&(v=lA(Tk.Image,G)),v&&(p.element=v))},ES=function(p,G){return(p=yS(p))._ht=G,p},Cl=h.top===h?h.top:h||h.document,yS=function(p,G){var v=B.createElement("div"),J=v.style;return v.tabIndex=-1,v.onkeydown=tA,J.msTouchAction=lJ,RS(v,v0,0),u0&&J.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",v0),p&&(J.overflow=aJ),G&&KS(G,v),v},xS=function(p,G){var v=B.createElement("canvas"),J=v.style;return J.msTouchAction=lJ,G||(J.pointerEvents=lJ),RS(v,v0,0),p&&KS(p,v),v},RS=function(p,G,v){var J=p.style;J.border=G?G+" solid 1px":0,J.outline=0,J.padding=v?"0 "+v+tJ:0,NS(p)},NS=function(p){(p=p.style).position=zJ,p.margin=0,p.setProperty("box-sizing","border-box",v0),p.setProperty("-moz-box-sizing","border-box",v0)},mS=function(p,G,v,J){J=J||Rh,G!=v0&&(p.width=G*J,p.style.width=G+tJ),v!=v0&&(p.height=v*J,p.style.height=v+tJ)},KS=function(p,G,v){p.appendChild(G),v&&(G.style.position=zJ)},aS=function(p,G){G.split||(G+="");for(var v,J=G.split("\n"),$=0,S=J.length,O=0;O<S;O++){var W=DA(p.font,J[O]);W.width>$&&($=W.width),v=v||W.height}return p.ss=J,{width:$,height:v*S}},uS=(c=B?xS().getContext("2d"):v0,function(p,W,l,t,z,Z){var G=p.split("\n"),B=[],f=DA(l,p).height;return t=t||0,c.font=l,c.textBaseline=pJ,G.forEach(function(p){for(var G=0,v=1,J=0,$=p.length;v<=$;v++){var S=p.substring(G,v),O=z?c.measureText(p[v]):DA(l,S),O=(z&&(J+=O.fontBoundingBoxDescent||f),z?J+(S.length-1)*Z:O.width+(S.length-1)*t);W<O&&(v-1===G?(B.push(p.substring(G,v)),G=v):(B.push(p.substring(G,v-1)),G=v-1,v--),J=0)}G!==v-1&&B.push(p.substring(G,v))}),B}),TS=function(p,G,v,J,$,S,O,W){p.font=v;var l,t=p.measureText(G);p.beginPath(),p.strokeStyle=J,p.lineWidth=1,"underline"===W?(l=t.actualBoundingBoxDescent?t.actualBoundingBoxDescent+1:DA(v,G).size/2,p.moveTo($-O/2,S+l),p.lineTo($+O/2,S+l)):"strikethrough"===W?(p.moveTo($-O/2,S),p.lineTo($+O/2,S)):"overline"===W&&(l=t.fontBoundingBoxAscent||DA(v,G).size/2,p.moveTo($-O/2,S-l),p.lineTo($+O/2,S-l)),p.stroke()},VS=function(p,G,v,J,$,S,O,W,l,t,z){var Z,B,f=$.x,X=$.y,q=$.width,$=$.height;G!=v0&&(Z=DA(v,G),B={},l&&(Z.width+=(G.length-1)*l),B.y=O&&O!==$J?O===pJ?X+Z.height/2:X+$-Z.height/2:X+$/2,B.x=S&&S!==C0?S===Q0?f+q-Z.width/2:f+q/2:f+Z.width/2,US(p,G,B,v,J,l,t,z),W&&TS(p,G,v,J,B.x,B.y,Z.width,W))},oS=function(p,G,v,J,$,S,O,W,l,t){var z=G.length;if(1===z){var Z=G[0];US(p,Z,v,J,$,W,l,t),O&&(B=DA(J,Z),TS(p,Z,J,$,v.x+v.width/2,v.y+v.height/2,B.width,O))}else for(var B,f=v.height/z,X={x:v.x,y:v.y,width:v.width,height:f},q=0;q<G.length;q++)S?VS(p,G[q],J,$,X,S,null,O,W,l,t):(US(p,G[q],X,J,$,W,l,t),O&&(B=DA(J,G[q]),TS(p,G[q],J,$,X.x+X.width/2,X.y+X.height/2,B.width,O))),X.y+=f},US=function(p,G,v,J,$,S,O,W){p.font=J||Uh,p.fillStyle=$||oh,p.textAlign=vJ,p.textBaseline=$J;var l,t,t=v?v.width===K?(l=v.x,v.y):(l=v.x+v.width/2,v.y+v.height/2):l=0,z=O&&W;if(z&&(p.strokeStyle=W,p.lineWidth=O),S){l-=(DA(J,G).width+S*(G.length-1))/2;for(var Z=(G+"").length,B=0;B<Z;B++){var f=G[B],X=p.measureText(f);z&&p.strokeText(f,b0(l+(X.width+4)/2),b0(t)),p.fillText(f,b0(l+(X.width+4)/2),b0(t)),l+=X.width+S}}else z&&p.strokeText(G,b0(l),b0(t)),p.fillText(G,b0(l),b0(t))},FS=function(p){var G=(p=p.getView?p.getView():p).offsetWidth||p.scrollWidth;return!G&&p.style.width?r0(p.style.width):G},CS=function(p){var G=(p=p.getView?p.getView():p).offsetHeight||p.scrollHeight;return!G&&p.style.height?r0(p.style.height):G},QS=function(p,G,v){var J=G[0].toUpperCase()+G.substring(1,G.length);p["webkit"+J]=v,p["moz"+J]=v,p["ms"+J]=v,p["o"+J]=v,p[G]=v},pE=function(p,G){var v=yS(),J=v.style;return J.backgroundColor=N.disabledBackground,p&&(J.backgroundImage="url("+p+")",J.backgroundPosition="50% 50%",J.backgroundRepeat="no-repeat no-repeat"),!1===G?Y.forEach(function(p){H0(v,p,BM)}):Y.forEach(function(p){H0(v,p,ZM)}),v},GE=function(p){return(p=p.getContext("2d")).save(),p.lineCap=Th,p.lineJoin=Vh,p},vE=function(p,G,v,J){JE(p,G*Rh,v*Rh),1!=(J*=Rh)&&p.scale(J,J)},JE=function(p,G,v){p.translate(G,v)},$E=function(p,G){G&&p.rotate(G)},SE=function(p,G,v){v===K&&(v=1),1===(G=G===K?1:G)&&1===v||p.scale(G,v)},OE=!(Y=[Ql,vi,ol]),WE=Cl[DJ[1]+bl[0]],lE=function(p){var G=B.activeElement;if(B.activeElement!==p){G&&G.forceOnblur&&G.forceOnblur();for(var v=[],J=p.parentNode;J;)v.push([J,J.scrollLeft,J.scrollTop]),J=J.parentNode;if(!OE){var $=[],S=[];try{for(var O=h.parent,W=h;O!==W;)$.push([O,O.scrollX,O.scrollY]),W=O,O=h.parent;var l=h.frameElement;if(l)for(var t=l.parentNode;t;)S.push([t,t.scrollLeft,t.scrollTop]),t=t.parentNode}catch(p){OE=!0}}u0?p.focus():(l=(G=yA()).target,p.focus(),l.scrollLeft=G.left,l.scrollTop=G.top),v.forEach(function(p){p[0].scrollLeft=p[1],p[0].scrollTop=p[2]}),OE||($.forEach(function(p){p[0].scrollTo(p[1],p[2])}),S.forEach(function(p){p[0].scrollLeft=p[1],p[0].scrollTop=p[2]}))}},tE=function(p){return p&&p.getView?p.getView():p},P=function(p,G,v,J,$){var S,O;2===arguments.length&&(v=G.y,J=G.width,$=G.height,G=G.x),p.isSelfViewEvent?(p.setX(G),p.setY(v),p.setWidth(J),p.setHeight($)):(S=(O=tE(p)).style,(B.fullscreenElement||B.mozFullScreenElement||B.webkitFullscreenElement||B.msFullscreenElement)!==O?(G!==K&&(S.left=G+tJ),v!==K&&(S.top=v+tJ),J!==K&&(S.width=J+tJ),$!==K&&(S.height=$+tJ)):(O=N.getWindowInfo(),S.left=(G=O.left)+tJ,S.top=(v=O.top)+tJ,S.width=(J=O.width)+tJ,S.height=($=O.height)+tJ),p.endEditing&&!u0&&p.endEditing(),p.redraw&&p.redraw(),p.invalidate&&p.invalidate(),p.onLayouted&&p.onLayouted(G,v,J,$),p.fireViewEvent&&p.fireViewEvent("layout"))},zE=function(p){return p.touches?p.touches[0]||p.changedTouches[0]:p},ZE=function(p){return p&&"object"==typeof p&&"touches"in p},BE=function(p){N.popup&&N.popup.close(),N.popup=p},fE=v0,XE=function(p){fE.handleWindowTouchMove(p)},qE=function(p){fE.handleWindowTouchEnd(p),_0(h,pi,XE),_0(h,Gi,qE),_0(h,"blur",qE),fE=v0},gE=function(p){fE.handleWindowMouseMove(p)},ME=function(p){fE.handleWindowMouseUp(p),_0(h,Ul,gE),_0(h,Fl,ME),_0(h,"blur",ME),fE=v0},LE=function(p){return 1===hA(p)},HE=function(p,G){return G?G.keyCode===p:ci[p]},_E=function(p){return PA(p)&&HE(65,p)},bE=function(p){return HE(46,p)||HE(8,p)},nE=(Cl=function(G){return function(p){return p?p.keyCode===G:ci[G]}})((p=[65,83,68,87,37,38,39,40,32,13,27])[0]),DE=Cl(p[1]),YE=Cl(p[2]),sE=Cl(p[3]),cE=Cl(p[4]),hE=Cl(p[5]),wE=Cl(p[6]),dE=Cl(p[7]),PE=Cl(p[8]),jE=Cl(p[9]),iE=Cl(p[10]),rE={65:1,83:1,68:1,87:1,37:1,38:1,39:1,40:1},eE=[2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,5,5,5,5,5,7321],AE=v0,kE=function(p,G){AE=AE||xS(),mS(AE,p,G,1);var v=GE(AE);return v.clearRect(0,0,p,G),v},IE=function(p,G,v){var J,$,S,O,W,l,t,z,Z,B;return G&&p?"override"===v?G:"override_rgb"===v?(B=yE(G),p=EE(p),"rgba("+b0(255*B[0])+","+b0(255*B[1])+","+b0(255*B[2])+","+p[3]/255+")"):"override_a"===v?(B=yE(G),"rgba("+(p=EE(p))[0]+","+p[1]+","+p[2]+","+B[3]+")"):"multiply_destinationAtop"===v?(z=(v=MA(yE(p)))[3],J=MA(yE(G)),$=J[3],S=MA(v),O=S[3],W=v.map(function(p,G){return p*J[G]}),Z=1-z,t=(l=1-$)*z+$,v=v.map(function(p,G){return($*Z*J[G]+$*z*W[G]+l*z*p)/t}),Z=1-(z=t),v=v.map(function(p,G){return(O*S[G]*Z+z*p*O)/O}),z=O,"rgba("+b0(255*v[0])+","+b0(255*v[1])+","+b0(255*v[2])+","+z+")"):(B=yE(G),p=EE(p),"rgba("+b0(p[0]*B[0])+","+b0(p[1]*B[1])+","+b0(p[2]*B[2])+","+p[3]/255*B[3]+")"):p},EE=function(){var J,p,$={};for(p in h){var G=o0.length;if(p.length==G&&p[0]===o0[2]&&p[1]===lJ[1]&&p[4]===o0[3]&&p[5]===o0[4]&&p.substr(G-2)===lJ[1]+lJ[2]){var v,S=h[p];for(v in S)v.length===G&&v.substr(0,3)===Q0[3]+LJ[3]+UJ[0]&&v.substr(G-2)===o0[0]+rJ[3]&&(Ji=S[v])}}return function(p){var G,v=$[p];return v||(J||(J=xS(),mS(J,1,1,1)),(G=J.getContext("2d")).clearRect(0,0,1,1),VE(G,0,0,1,1,p),v=G.getImageData(0,0,1,1).data,v=$[p]=[v[0],v[1],v[2],v[3]]),v}}(),yE=function(p){return JS(p)?((p=EE(p)).CA||(p.CA=[p[0]/255,p[1]/255,p[2]/255,p[3]/255]),p.CA):p},xE=function(p,G,v){return G&&(G="miter"===v?8*G+20:G+1,p&&xA(p,G)),G},RE=function(p,G){p&&p.beginPath();for(var v,J,$=[],S=function(p){for(var G,v=/(\-{0,1}[\d\.]+)/gi,J=[];G=v.exec(p);)J.push(parseFloat(G[0]));return J},O=/([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi,W={x:0,y:0};l=O.exec(G);){var l=l[0],t=l.substr(0,1);if("M"===t||"m"===t){for(var z=S(l),Z=0;Z<z.length;Z+=2){var B=z[Z],f=z[Z+1];"m"===t&&(B+=W.x,f+=W.y),p&&p.moveTo(B,f),$.push({x:B,y:f}),W.x=B,W.y=f}v=J=null}else if("H"===t||"h"===t){for(z=S(l),Z=0;Z<z.length;Z+=1)B=z[Z],"h"===t&&(B+=W.x),p&&p.lineTo(B,W.y),$.push({x:B,y:W.y}),W.x=B;v=J=null}else if("C"===t||"c"===t){for(z=S(l),Z=0;Z<z.length;Z+=6){var X=z[Z],q=z[Z+1],g=z[Z+2],M=z[Z+3],B=z[Z+4],f=z[Z+5];"c"===t&&(X+=W.x,q+=W.y,g+=W.x,M+=W.y,B+=W.x,f+=W.y),p&&p.bezierCurveTo(X,q,g,M,B,f),$.push({x:X,y:q}),$.push({x:g,y:M}),$.push({x:B,y:f}),W.x=B,W.y=f}v=[X,q,g,M,B,f],J=null}else if("S"===t||"s"===t){for(z=S(l),Z=0;Z<z.length;Z+=4)q=v?(X=2*v[4]-v[2],2*v[5]-v[3]):(X=W.x,W.y),g=z[Z],M=z[Z+1],B=z[Z+2],f=z[Z+3],"s"===t&&(g+=W.x,M+=W.y,B+=W.x,f+=W.y),p&&p.bezierCurveTo(X,q,g,M,B,f),$.push({x:X,y:q}),$.push({x:g,y:M}),$.push({x:B,y:f}),W.x=B,W.y=f;v=[X,q,g,M,B,f],J=null}else if("Q"===t||"q"===t){for(z=S(l),Z=0;Z<z.length;Z+=4)X=z[Z],q=z[Z+1],B=z[Z+2],f=z[Z+3],"q"===t&&(X+=W.x,q+=W.y,B+=W.x,f+=W.y),p&&p.quadraticCurveTo(X,q,B,f),$.push({x:X,y:q}),$.push({x:B,y:f}),W.x=B,W.y=f;v=null,J=[X,q,B,f]}else if("T"===t||"t"===t){for(z=S(l),Z=0;Z<z.length;Z+=2)q=J?(X=2*J[2]-J[0],2*J[3]-J[1]):(X=W.x,W.y),B=z[Z],f=z[Z+1],"t"===t&&(B+=W.x,f+=W.y),p&&p.quadraticCurveTo(X,q,B,f),$.push({x:X,y:q}),$.push({x:B,y:f}),W.x=B,W.y=f;v=null,J=[X,q,B,f]}else if("V"===t||"v"===t){for(z=S(l),Z=0;Z<z.length;Z+=1)f=z[Z],"v"===t&&(f+=W.y),p&&p.lineTo(W.x,f),$.push({x:W.x,y:f}),W.y=f;v=J=null}else if("L"===t||"l"===t){for(z=S(l),Z=0;Z<z.length;Z+=2)B=z[Z],f=z[Z+1],"l"===t&&(B+=W.x,f+=W.y),p&&p.lineTo(B,f),$.push({x:B,y:f}),W.x=B,W.y=f;v=J=null}else if("A"===t||"a"===t){for(z=S(l),Z=0;Z<z.length;Z+=7){var L=z[Z],H=z[Z+1],_=z[Z+2],b=z[Z+3],n=z[Z+4],B=z[Z+5],f=z[Z+6];"a"===t&&(B+=W.x,f+=W.y),(L=function(p,G,v,J,$,S,O,W){function l(p,G){return(p[0]*G[1]<p[1]*G[0]?-1:1)*Math.acos(B(p,G))}J*=Math.PI/180;var t={x:Math.cos(J)*(p.x-O.x)/2+Math.sin(J)*(p.y-O.y)/2,y:-Math.sin(J)*(p.x-O.x)/2+Math.cos(J)*(p.y-O.y)/2},z=(1<(z=Math.pow(t.x,2)/Math.pow(G,2)+Math.pow(t.y,2)/Math.pow(v,2))&&(G*=Math.sqrt(z),v*=Math.sqrt(z)),($==S?-1:1)*Math.sqrt((Math.pow(G,2)*Math.pow(v,2)-Math.pow(G,2)*Math.pow(t.y,2)-Math.pow(v,2)*Math.pow(t.x,2))/(Math.pow(G,2)*Math.pow(t.y,2)+Math.pow(v,2)*Math.pow(t.x,2)))),$=(z=isNaN(z)?0:z)*G*t.y/v,z=z*-v*t.x/G,p={x:(p.x+O.x)/2+Math.cos(J)*$-Math.sin(J)*z,y:(p.y+O.y)/2+Math.sin(J)*$+Math.cos(J)*z},Z=function(p){return Math.sqrt(Math.pow(p[0],2)+Math.pow(p[1],2))},B=function(p,G){return(p[0]*G[0]+p[1]*G[1])/(Z(p)*Z(G))},O=l([1,0],[(t.x-$)/G,(t.y-z)/v]),t=l(f=[(t.x-$)/G,(t.y-z)/v],$=[(-t.x-$)/G,(-t.y-z)/v]),B=(B(f,$)<=-1&&(t=Math.PI),1<=B(f,$)&&(t=0),v<G?G:v),z=v<G?1:G/v,f=v<G?v/G:1;if(null==W)return xA($={x:0,y:0,width:0,height:0},B),$.x*=z,$.width*=z,$.y*=f,$.height*=f,v=new hh(J),($=rA([v.tf($.x,$.y),v.tf($.x+$.width,$.y),v.tf($.x+$.width,$.y+$.height),v.tf($.x,$.y+$.height)])).x+=p.x,$.y+=p.y,[{x:$.x,y:$.y},{x:$.x+$.width,y:$.y},{x:$.x+$.width,y:$.y+$.height},{x:$.x,y:$.y+$.height}];W.translate(p.x,p.y),W.rotate(J),W.scale(z,f),W.arc(0,0,B,O,O+t,1-S),W.scale(1/z,1/f),W.rotate(-J),W.translate(-p.x,-p.y)}(W,L,H,_,b,n,{x:B,y:f},p))&&($=$.concat(L)),W.x=B,W.y=f}v=J=null}"z"!==(l=l.substr(l.length-1))&&"Z"!==l||p&&p.closePath()}return $},NE=function(p,G,v,J,$){var S=G[0];if(p.save(),lS(G))if(S&&1===S.length)for(var O="L"===G[0],W=G.length,l=(g=O?(p.transform(G[5],G[6],G[7],G[8],G[9],G[10]),B=p.createLinearGradient(G[1],G[2],G[3],G[4]),11):(p.transform(G[7],G[8],G[9],G[10],G[11],G[12]),B=p.createRadialGradient(G[1],G[2],G[3],G[4],G[5],G[6]),13),p.compGray);g<W;)f=v(f=G[g+1]),B.addColorStop(G[g],l?N.toGrayColor(f):f),g+=2;else for(var t,z,Z,B,f,O="linear"===S,S=$.x,X=$.y,q=$.width,$=$.height,W=G.length,l=p.compGray,g=O?(B=p.createLinearGradient(S+q*G[1],X+$*G[2],S+q*G[3],X+$*G[4]),5):(O=Math.min(q,$),Z=G[1]*q+S,t=G[2]*$+X,z=G[3]*O,JS(G[5])?(B=p.createRadialGradient(Z,t,0,Z,t,z),4):(p.transform(G[7],G[8],G[9],G[10],G[11]+Z,G[12]+t),q=G[4]*q+S-Z,S=G[5]*$+X-t,Z=G[6]*O,B=p.createRadialGradient(0,0,z,q,S,Z),13));g<W;)f=v(f=G[g+1]),B.addColorStop(G[g],l?N.toGrayColor(f):f),g+=2;else B=G;return J?p.strokeStyle=B:p.fillStyle=B,B},mE=function(p,G){var v;(v=p.s("shape.gradient.pack"))&&p.s("shape.gradient.pack",fM(v,G)),(v=p.s("shape.border.gradient.pack"))&&p.s("shape.border.gradient.pack",fM(v,G))},KE=function(p,G,v,J){var $=!1;if(p.beginPath?p.beginPath():$=!0,tS(G)&&(G=G._as),(v=tS(v)?v._as:v)&&v.length){for(var S,O,W,l,t=0,z=0,Z=v.length;z<Z;z++)1===(S=v[z])?(O=G[t++],p.moveTo(O.x,$?-O.y:O.y)):2===S?(O=G[t++],p.lineTo(O.x,$?-O.y:O.y)):3===S?(O=G[t++],W=G[t++],p.quadraticCurveTo(O.x,$?-O.y:O.y,W.x,$?-W.y:W.y)):4===S?(O=G[t++],W=G[t++],l=G[t++],p.bezierCurveTo(O.x,$?-O.y:O.y,W.x,$?-W.y:W.y,l.x,$?-l.y:l.y)):5===S&&p.closePath();J&&5!==S&&p.closePath()}else{var B,f,X,q=G.length;if(0<q){for(B=G[0],p.moveTo(B.x,$?-B.y:B.y),f=1;f<q;f++)X=G[f],p.lineTo(X.x,$?-X.y:X.y);J&&p.closePath()}}},aE=function(p,G,v,J){if(tS(p)&&(p=p._as),(G=tS(G)?G._as:G)&&G.length){v=v||uA;for(var $,S,O,W,l,t,z,Z,B=[],f=v0,X=0,q=0,g=G.length;q<g;q++)if(1===($=G[q]))B.push(f=[]),f.push(p[X++]);else if(2===$)f.push(p[X++]);else if(3===$){for(S=f[f.length-1],O=p[X++],W=p[X++],t=1;t<v;t++)z=rS(t/v,S.x,O.x,W.x),Z=rS(t/v,S.y,O.y,W.y),f.push({x:z,y:Z,b:!0});f.push(W)}else if(4===$){for(S=f[f.length-1],O=p[X++],W=p[X++],l=p[X++],t=1;t<v;t++)z=eS(t/v,S.x,O.x,W.x,l.x),Z=eS(t/v,S.y,O.y,W.y,l.y),f.push({x:z,y:Z,b:!0});f.push(l)}else 5===$&&f.push(f[0]);return J&&5!==$&&f&&2<f.length&&f.push(f[0]),B}return J&&2<p.length&&(p=p.slice()).push(p[0]),p?[p]:[]},uE=function(p,G,v,J,$,S){var O,W,l=J,t=(G=EE(G))[0],z=G[1],Z=G[2],B=v?(O=(G=EE(v))[0]-t,W=G[1]-z,G[2]-Z):(O=255-t,W=255-z,255-Z);for(S||(S=10<J?1:.5,S=$<1?$0(S/$,2):S),p.save(),p.shadowOffsetX=0,p.shadowOffsetY=0,p.shadowBlur=0,p.shadowColor=0;0<(J-=S);){var f=z+W*(q=1-J/l),X=Z+B*q,q=$0(D0(t+O*q),255),f=$0(D0(f),255),X=$0(D0(X),255);p.strokeStyle="rgb("+q+","+f+","+X+")",p.lineWidth=J,p.stroke()}p.restore()},TE=(A={},function(p,G){var v=p+"-"+G;if(S=A[v])return S;var J,$,S=EE(p),O=G<0?(J=D0(S[0]*(G=(100+G)/100)),$=D0(S[1]*G),D0(S[2]*G)):(J=S[0],$=S[1],O=S[2],$+=(255-$)*(G/=100),O+=(255-O)*G,J=$0(D0(J+=(255-J)*G),255),$=$0(D0($),255),$0(D0(O),255));return A[v]="rgb("+J+","+$+","+O+")"}),VE=function(p,G,v,J,$,S){S&&(p.fillStyle=S),p.beginPath(),p.rect(G,v,J,$),p.fill()},oE=function(p,G,v,J,$,S,O){p.beginPath(),z4[G](p,v.x,v.y,v.width,v.height,J,$,S,O)},UE=function(p,G,v,J,$){v=z4[v],p.fillStyle=v?v(p,G,J||i4,$.x,$.y,$.width,$.height):G},FE=function(p,G,v,J,$,S){p.fillStyle=QE(p,G,v,J,$,S)},CE=function(p,G,v,J,$,S){p.strokeStyle=QE(p,G,v,J,$,S)},QE=function(p,G,v,J,$,S){var O,W,l;try{!G.tagName&&G.comps&&(G._cacheImage_||(G._cacheImage_={}),W="override"===J?"colors_override":"override_rgb"===J?"colors_override_rgb":"override_a"===J?"colors_override_a":"colors",G._cacheImage_[W]||(G._cacheImage_[W]={__count__:0}),(l=G._cacheImage_[W][v])||(G._cacheImage_[W].__count__>N.imageCacheThreshold&&(G._cacheImage_[W]={__count__:0}),l=E.Default.toCanvas(G,Am(G),km(G),null,$,S,v,null,J),G._cacheImage_[W][v]=l,G._cacheImage_[W].__count__++),G=l),O=p.createPattern(G,"repeat")}catch(p){O="black"}return O},p4=function(p){for(var G,v=[],J=0,$=p.length,S=0;S<65;S++)v[S]=S;for(S=0;S<65;S++)J=(J+v[S]+p.charCodeAt(S%$))%65,G=v[S],v[S]=v[J],v[J]=G;for(S=0;S<65;S++)v[S]=_h[v[S]];return v.join("")},G4=function(p,G,v,J,$,S,O){p.save(),p.translate(G,v),p.scale(1,O/S),p.arc(0,0,S,J,$),p.restore()},v4=function(p,G,v,J,$,S,O,W,l){6===arguments.length&&(lS(S)?(W=S[1],l=S[2],O=S[3],S=S[0]):l=W=O=S);var t=G+J,z=v+$,Z=J<$?2*J:2*$;S=S<Z?S:Z,O=O<Z?O:Z,W=W<Z?W:Z,l=l<Z?l:Z,p.roundRect?p.roundRect(G,v,J,$,[S,O,l,W]):(p.moveTo(G+J/2,v),p.arcTo(t,v,t,z,O),p.arcTo(t,z,G,z,l),p.arcTo(G,z,G,v,W),p.arcTo(G,v,t,v,S),p.lineTo(G+J/2,v))},J4=function(p,G,v,J,$,S,O){G&&(v=b0(v),J=b0(J),O=O||1,p.fillStyle=G,p.beginPath(),p.rect(v,J,O,S),p.rect(v,J,$,O),0<S-O&&p.rect(v,J+S-O,$,O),0<$-O&&p.rect(v+$-O,J,O,S),p.fill())},$4=function(p,G,v,J){var $,S,O,W,l=J.x,t=J.y,z=J.width,J=J.height;!G||!v||z<=0||J<=0||($=_A(G),S=bA(G),O=0<v,1===v||-1===v?(p.fillStyle=O?$:S,p.beginPath(),p.rect(l,t,1,J),p.rect(l,t,z,1),p.fill(),p.fillStyle=O?S:$,p.beginPath(),p.rect(l,t+J-1,z,1),p.rect(l+z-1,t,1,J)):(v=$0(I(v),$0(z/2,J/2)),(W=p.createLinearGradient(l,t,l+v,t)).addColorStop(0,O?$:S),W.addColorStop(1,G),p.fillStyle=W,p.beginPath(),p.moveTo(l,t),p.lineTo(l+v,t+v),p.lineTo(l+v,t+J-v),p.lineTo(l,t+J),p.lineTo(l,t),p.fill(),(W=p.createLinearGradient(l,t,l,t+v)).addColorStop(0,O?$:S),W.addColorStop(1,G),p.fillStyle=W,p.beginPath(),p.moveTo(l,t),p.lineTo(l+v,t+v),p.lineTo(l+z-v,t+v),p.lineTo(l+z,t),p.lineTo(l,t),p.fill(),(W=p.createLinearGradient(l,t+J,l,t+J-v)).addColorStop(0,O?S:$),W.addColorStop(1,G),p.fillStyle=W,p.beginPath(),p.moveTo(l,t+J),p.lineTo(l+v,t+J-v),p.lineTo(l+z-v,t+J-v),p.lineTo(l+z,t+J),p.lineTo(l,t+J),p.fill(),(W=p.createLinearGradient(l+z,t,l+z-v,t)).addColorStop(0,O?S:$),W.addColorStop(1,G),p.fillStyle=W,p.beginPath(),p.moveTo(l+z,t),p.lineTo(l+z-v,t+v),p.lineTo(l+z-v,t+J-v),p.lineTo(l+z,t+J),p.lineTo(l+z,t)),p.fill())},S4=function(p,G,v,J,$,S,O){return(p=p.createLinearGradient(J,$,S,O)).addColorStop(0,v),p.addColorStop(1,G),p},O4=function(p,G,v,J,$,S,O){return(p=p.createLinearGradient(J,$,S,O)).addColorStop(0,G),p.addColorStop(.5,v),p.addColorStop(1,G),p},W4=function(p,G,v,J,$,S,O){return(p=p.createLinearGradient(J,$,S,O)).addColorStop(0,G),p.addColorStop(1/3,v),p.addColorStop(2/3,G),p.addColorStop(1,v),p},l4=function(p,G,v,J,$,S,O,W,l){return(p=p.createRadialGradient(J+S*W,$+O*l,$0(S,O)/24,J+S/2,$+O/2,J0(S,O)/2)).addColorStop(0,v),p.addColorStop(1,G),p},t4=[0,-1,.22451398828979272,-.30901699437494734,.9510565162951535,-.30901699437494745,.3632712640026804,.11803398874989468,.5877852522924731,.8090169943749473,-11102230246251565e-32,.38196601125010515,-.587785252292473,.8090169943749475,-.3632712640026805,.1180339887498949,-.9510565162951536,-.3090169943749473,-.22451398828979285,-.30901699437494734],z4={polygon:function(p,G,v,J,$,S,O,W){(S==v0||S<3)&&(S=6),O==v0&&(O=0),W==v0&&(W=!0);var l=$0(J,$),t=l/2,z=new H(G+J/2,v+$/2),Z=new H,B=0,f=2*j/S,X=new H(t,t);if(!1===W&&X.multiply({x:J/l,y:$/l}),0===O)for(g=0;g<S;g++)Z.set(S0(B),O0(B)).multiply(X).add(z),0===g?p.moveTo(Z.x,Z.y):p.lineTo(Z.x,Z.y),B+=f;else{for(var q=[],g=0;g<2;g++)q.push(new H(S0(B),O0(B)).multiply(X).add(z)),B+=f;var M=q.shift(),L=q[0],G=new H(S0(B),O0(B)).multiply(X).add(z),v=M.clone().sub(L),t=G.clone().sub(L),W=v.clone().normalize().dot(t.clone().normalize()),J=Math.sqrt((1-W)/(1+W));for(v.setLength(O/J).add(L),p.moveTo(v.x,v.y),g=0;g<S;g++)q.push(new H(S0(B),O0(B)).multiply(X).add(z)),B+=f,M=q.shift(),L=q[0],p.arcTo(M.x,M.y,L.x,L.y,O)}p.closePath()},arc:function(p,G,v,J,$,S,O,W,l){S==v0&&(S=j),O==v0&&(O=W0),G+=J/2,v+=$/2,(W=W==v0||W)&&p.moveTo(G,v),l?G4(p,G,v,S,O,J/2,$/2):p.arc(G,v,$0(J,$)/2,S,O),W&&p.closePath()},rect:function(p,G,v,J,$){p.rect(G,v,J,$)},circle:function(p,G,v,J,$){p.arc(G+J/2,v+$/2,$0(J,$)/2,0,W0,!0)},oval:function(p,G,v,J,$){G4(p,G+J/2,v+$/2,0,W0,J/2,$/2)},roundRect:function(p,G,v,J,$,S){S==v0&&(S=$0($0(J,$)/4,8)),v4(p,G,v,J,$,S),p.closePath()},star:function(p,G,v,J,$){var S=2*J,O=2*$,W=G+J/2,l=v+$/2;p.moveTo(W-S/4,l-O/12),p.lineTo(G+.306*J,v+.579*$),p.lineTo(W-S/6,l+O/4),p.lineTo(G+J/2,v+.733*$),p.lineTo(W+S/6,l+O/4),p.lineTo(G+.693*J,v+.579*$),p.lineTo(W+S/4,l-O/12),p.lineTo(G+.611*J,v+.332*$),p.lineTo(W+0,l-O/4),p.lineTo(G+.388*J,v+.332*$),p.closePath()},pentagram:function(p,G,v,J,$){var S=G+.5*J,O=v+($=.5*$),W=.5257311121191336*J,l=t4,t=0;for(p.moveTo(S+(W=$<W?$:W)*l[t++],O+W*l[t++]);t<20;)p.lineTo(S+W*l[t++],O+W*l[t++]);p.closePath()},triangle:function(p,G,v,J,$){p.moveTo(G+J/2,v),p.lineTo(G+J,v+$),p.lineTo(G,v+$),p.closePath()},hexagon:function(p,G,v,J,$){p.moveTo(G,v+$/2),p.lineTo(G+J/4,v+$),p.lineTo(G+3*J/4,+v+$),p.lineTo(G+J,v+$/2),p.lineTo(G+3*J/4,v),p.lineTo(G+J/4,v),p.closePath()},pentagon:function(p,G,v,J,$){var S=2*J,O=2*$,G=G+J/2,J=v+$/2;p.moveTo(G-S/4,J-O/12),p.lineTo(G-S/6,J+O/4),p.lineTo(G+S/6,J+O/4),p.lineTo(G+S/4,J-O/12),p.lineTo(G+0,J-O/4),p.closePath()},diamond:function(p,G,v,J,$){p.moveTo(G+J/2,v),p.lineTo(G,v+$/2),p.lineTo(G+J/2,v+$),p.lineTo(G+J,v+$/2),p.closePath()},rightTriangle:function(p,G,v,J,$){p.moveTo(G,v),p.lineTo(G+J,v+$),p.lineTo(G,v+$),p.closePath()},parallelogram:function(p,G,v,J,$){var S=J/4;p.moveTo(G+S,v),p.lineTo(G+J,v),p.lineTo(G+J-S,v+$),p.lineTo(G,v+$),p.closePath()},trapezoid:function(p,G,v,J,$){var S=J/4;p.moveTo(G+S,v),p.lineTo(G+J-S,v),p.lineTo(G+J,v+$),p.lineTo(G,v+$),p.closePath()},"linear.southwest":function(p,G,v,J,$,S,O){return S4(p,G,v,J,$+O,J+S,$)},"linear.southeast":function(p,G,v,J,$,S,O){return S4(p,G,v,J+S,$+O,J,$)},"linear.northwest":function(p,G,v,J,$,S,O){return S4(p,G,v,J,$,J+S,$+O)},"linear.northeast":function(p,G,v,J,$,S,O){return S4(p,G,v,J+S,$,J,$+O)},"linear.north":function(p,G,v,J,$,S,O){return S4(p,G,v,J,$,J,$+O)},"linear.south":function(p,G,v,J,$,S,O){return S4(p,G,v,J,$+O,J,$)},"linear.west":function(p,G,v,J,$,S,O){return S4(p,G,v,J,$,J+S,$)},"linear.east":function(p,G,v,J,$,S,O){return S4(p,G,v,J+S,$,J,$)},"radial.center":function(p,G,v,J,$,S,O){return l4(p,G,v,J,$,S,O,.5,.5)},"radial.southwest":function(p,G,v,J,$,S,O){return l4(p,G,v,J,$,S,O,.25,.75)},"radial.southeast":function(p,G,v,J,$,S,O){return l4(p,G,v,J,$,S,O,.75,.75)},"radial.northwest":function(p,G,v,J,$,S,O){return l4(p,G,v,J,$,S,O,.25,.25)},"radial.northeast":function(p,G,v,J,$,S,O){return l4(p,G,v,J,$,S,O,.75,.25)},"radial.north":function(p,G,v,J,$,S,O){return l4(p,G,v,J,$,S,O,.5,.25)},"radial.south":function(p,G,v,J,$,S,O){return l4(p,G,v,J,$,S,O,.5,.75)},"radial.west":function(p,G,v,J,$,S,O){return l4(p,G,v,J,$,S,O,.25,.5)},"radial.east":function(p,G,v,J,$,S,O){return l4(p,G,v,J,$,S,O,.75,.5)},"spread.horizontal":function(p,G,v,J,$,S,O){return O4(p,G,v,J,$,J+S,$)},"spread.vertical":function(p,G,v,J,$,S,O){return O4(p,G,v,J,$,J,$+O)},"spread.diagonal":function(p,G,v,J,$,S,O){return O4(p,G,v,J+S,$,J,$+O)},"spread.antidiagonal":function(p,G,v,J,$,S,O){return O4(p,G,v,J,$,J+S,$+O)},"spread.north":function(p,G,v,J,$,S,O){return W4(p,G,v,J,$-O/4,J,$+O+O/4)},"spread.south":function(p,G,v,J,$,S,O){return W4(p,v,G,J,$-O/4,J,$+O+O/4)},"spread.west":function(p,G,v,J,$,S,O){return W4(p,G,v,J-S/4,$,J+S+S/4,$)},"spread.east":function(p,G,v,J,$,S,O){return W4(p,v,G,J-S/4,$,J+S+S/4,$)}},Z4=function(p,G,v){return new hh(p).tf(G,v)},B4=function(p){var G=p.touches[0],p=p.touches[1],v=G.clientX,G=G.clientY,J=p.clientX,p=p.clientY;return Y0((v-J)*(v-J)+(G-p)*(G-p))},f4=(function(){for(var p=0,G=Ml.split(""),v=0;v<G.length;v++)p=10*r0(G[v])+p;for(var J,$,S,O,W,l=h[573..toString(8*v)+jJ.substr(v)+3],t=h[573..toString(8*v)+jJ.substr(v)+4],z=v0||4,Z=v0||1,B=v0||1,f=(z<0?z=0:.25<z&&(z=.25),[]),X=[],q=[],g=W0/B,M=W0/Z,L=.5-z,H=0;H<=Z;H++)for(O=S0($=H*M-j),S=O0($),n=0;n<=B;n++)W=L+z*O,f.push(S0(J=n*g)*W,S*z,-O0(J)*W),X.push(n/B,1-H/Z);for(H=0;H<Z;H++)for(var _=H*(B+1),b=(H+1)*(B+1),n=0;n<B;n++)q.push(_+n,b+n+1,b+n,_+n,_+n+1,b+n+1),eS.z=mE.z=[l,t]}(),function(p,G,v){for(var J=0;J<v.size();J++){var $=v.get(J);p.co($)&&G.add($)}for(J=0;J<v.size();J++)$=v.get(J),f4(p,G,$._children)}),X4=function(p,G,v){for(var J=0;J<v.size();J++){var $=v.get(v.size()-1-J);p.co($)&&G.add($)}for(J=0;J<v.size();J++)$=v.get(J),X4(p,G,$._children)},q4=function(p,G,v){for(var J=!1,$=0;$<v.size();$++){var S=v.get($);p.co(S)?J&&G.add(S):J=1}for($=0;$<v.size();$++)S=v.get($),q4(p,G,S._children)},g4=function(p,G,v){for(var J=!1,$=0;$<v.size();$++){var S=v.get(v.size()-1-$);p.co(S)?J&&G.add(S):J=!0}for($=0;$<v.size();$++)S=v.get($),g4(p,G,S._children)},M4=N.moveDatas=function(p,J,$,S){var G,v,O,W,l,t,z,Z=S==v0;0===J&&0===$&&(Z||0===S)||(G=!0,v=[],p.forEach(function(p){G&&(p._69O||ZS(p)||fS(p))&&(G=!1)}),G?v=p:(O={},W={},p.forEach(function(p){O[p._id]=!0}),l={},t=function(p){var G=p._id;return O[G]?(v.push(p),l[G]=!0):l[G]=!1},z=function(p){var G=p._id;if(W[G])return t(p);var v=l[G];if(v!==K)return v;var J=p._parent;return J&&(fS(J)||ZS(J))&&z(J)||(J=p._host)&&(W[G]=G,v=z(J),W[G]=K,v)?l[G]=!0:t(p)},p.forEach(function(p){z(p)})),v.forEach(function(p){var G,v;k(p)?Z?p.translate(J,$):p.translate3d(J,$,S):(G=p.s(NJ))&&!G.isEmpty()&&(v=new o,G.each(function(p){p=MA(p),Z?(p.x+=J,p.y+=$):(p.x+=J,p.y+=S,p.e==v0?p.e=$:p.e+=$),v.add(p)}),p.s(NJ,v))}))},L4=function(p,G){var v,J;if(p=p.parentElement)return p.updateAppendMatrix&&(delete p.updateAppendMatrix,function p(G,v){C||(C=new eh,Q=new m,p0=new eh,G0=new eh,g0=new eh),v==K&&(v=new eh);for(var J,$=getComputedStyle(G),S=($.transform&&"none"!==$.transform&&(O=$.transform,(J=C)==K&&(J=new eh),XM(O,"matrix3d")?(W=(W=O.substring(9,O.length-1).split(",")).map(qM),J.fromArray(W)):XM(O,"matrix")&&(W=(W=O.substring(7,O.length-1).split(",")).map(qM),J.el[0]=W[0],J.el[1]=W[1],J.el[2]=0,J.el[3]=0,J.el[4]=W[2],J.el[5]=W[3],J.el[6]=0,J.el[7]=0,J.el[8]=0,J.el[9]=0,J.el[10]=1,J.el[11]=0,J.el[12]=W[4],J.el[13]=W[5],J.el[14]=0,J.el[15]=1),gM($.transformOrigin,Q),G0.setPosition(Q),Q.negate(),g0.setPosition(Q),!R0&&"preserve-3d"===$.transformStyle||(C.el[8]=0,C.el[9]=0,C.el[10]=1,C.el[11]=0),v.multiplyMatrices(g0,v),v.multiplyMatrices(C,v),v.multiplyMatrices(G0,v)),!R0&&$.perspective&&"none"!==$.perspective&&(p0.el[11]=-1/qM($.perspective),gM($.perspectiveOrigin,Q),G0.setPosition(Q),Q.negate(),g0.setPosition(Q),v.multiplyMatrices(g0,v),v.multiplyMatrices(p0,v),v.multiplyMatrices(G0,v)),G.offsetParent),O=G.offsetLeft,W=G.offsetTop,l=G.parentElement;l&&l!==S;){var t=getComputedStyle(l);if("none"!==t.transform||"none"!==t.perspective)break;l=l.parentElement}l==K&&G!==G.ownerDocument.documentElement&&"fixed"!==$.position&&(l=G.ownerDocument.documentElement),S!=K&&S!=l&&(O-=l.offsetLeft,W-=l.offsetTop),l&&(O-=l.scrollLeft,W-=l.scrollTop),Q.set(O,W,0),G0.setPosition(Q),v.multiplyMatrices(G0,v),l&&p(l,v)}(p,v=new eh),(J=new eh).getInverse(v),p._matrixAppend=J,p._maxrixPreAppend=v),G?p._matrixAppend:p._maxrixPreAppend},H4=d.getPrototypeOf?function(p,G,v){(G=function(p,G){for(;p&&!p.hasOwnProperty(G);)p=d.getPrototypeOf(p);return p&&d.getOwnPropertyDescriptor(p,G)}(G,v))&&d.defineProperty(p,v,G)}:function(p,G,v){p[v]=G[v]},_4={1:29,2:30,3:31,4:32,5:33,6:26,7:27,8:28,9:21,10:22,11:23,12:24,13:25,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:9,22:10,23:11,24:12,25:13,26:6,27:7,28:8,29:1,30:2,31:3,32:4,33:5,34:36,35:37,36:34,37:35,38:54,39:55,40:52,41:53,42:50,43:51,44:49,50:42,51:43,52:40,53:41,54:38,55:39},b4=function(){var J={1:function(p,G){return{x:p.x-G.width/2,y:p.y-G.height/2}},2:function(p,G){return{x:p.x+G.width/2,y:p.y-G.height/2}},3:function(p,G){return{x:p.x+p.width/2,y:p.y-G.height/2}},4:function(p,G){return{x:p.x+p.width-G.width/2,y:p.y-G.height/2}},5:function(p,G){return{x:p.x+p.width+G.width/2,y:p.y-G.height/2}},6:function(p,G){return{x:p.x,y:p.y}},7:function(p,G){return{x:p.x+p.width/2,y:p.y}},8:function(p,G){return{x:p.x+p.width,y:p.y}},9:function(p,G){return{x:p.x-G.width/2,y:p.y+G.height/2}},10:function(p,G){return{x:p.x+G.width/2,y:p.y+G.height/2}},11:function(p,G){return{x:p.x+p.width/2,y:p.y+G.height/2}},12:function(p,G){return{x:p.x-G.width/2+p.width,y:p.y+G.height/2}},13:function(p,G){return{x:p.x+p.width+G.width/2,y:p.y+G.height/2}},14:function(p,G){return{x:p.x-G.width/2,y:p.y+p.height/2}},15:function(p,G){return{x:p.x,y:p.y+p.height/2}},16:function(p,G){return{x:p.x+G.width/2,y:p.y+p.height/2}},17:function(p,G){return{x:p.x+p.width/2,y:p.y+p.height/2}},18:function(p,G){return{x:p.x+p.width-G.width/2,y:p.y+p.height/2}},19:function(p,G){return{x:p.x+p.width,y:p.y+p.height/2}},20:function(p,G){return{x:p.x+p.width+G.width/2,y:p.y+p.height/2}},21:function(p,G){return{x:p.x-G.width/2,y:p.y+p.height-G.height/2}},22:function(p,G){return{x:p.x+G.width/2,y:p.y+p.height-G.height/2}},23:function(p,G){return{x:p.x+p.width/2,y:p.y+p.height-G.height/2}},24:function(p,G){return{x:p.x+p.width-G.width/2,y:p.y+p.height-G.height/2}},25:function(p,G){return{x:p.x+p.width+G.width/2,y:p.y+p.height-G.height/2}},26:function(p,G){return{x:p.x,y:p.y+p.height}},27:function(p,G){return{x:p.x+p.width/2,y:p.y+p.height}},28:function(p,G){return{x:p.x+p.width,y:p.y+p.height}},29:function(p,G){return{x:p.x-G.width/2,y:p.y+p.height+G.height/2}},30:function(p,G){return{x:p.x+G.width/2,y:p.y+p.height+G.height/2}},31:function(p,G){return{x:p.x+p.width/2,y:p.y+p.height+G.height/2}},32:function(p,G){return{x:p.x+p.width-G.width/2,y:p.y+p.height+G.height/2}},33:function(p,G){return{x:p.x+p.width+G.width/2,y:p.y+p.height+G.height/2}},34:function(p,G){return{x:p.x,y:p.y-G.height/2}},35:function(p,G){return{x:p.x+p.width,y:p.y-G.height/2}},36:function(p,G){return{x:p.x,y:p.y+p.height+G.height/2}},37:function(p,G){return{x:p.x+p.width,y:p.y+p.height+G.height/2}},38:function(p,G){return{x:p.x+p.width/4,y:p.y-G.height/2}},39:function(p,G){return{x:p.x+3*p.width/4,y:p.y-G.height/2}},40:function(p,G){return{x:p.x+p.width/4,y:p.y}},41:function(p,G){return{x:p.x+3*p.width/4,y:p.y}},42:function(p,G){return{x:p.x+p.width/4,y:p.y+G.height/2}},43:function(p,G){return{x:p.x+3*p.width/4,y:p.y+G.height/2}},44:function(p,G){return{x:p.x+p.width/2,y:p.y+p.height/2-G.height/2}},45:function(p,G){return{x:p.x+p.width/4,y:p.y+p.height/2}},46:function(p,G){return{x:p.x+p.width/2-G.width/2,y:p.y+p.height/2}},47:function(p,G){return{x:p.x+p.width/2+G.width/2,y:p.y+p.height/2}},48:function(p,G){return{x:p.x+3*p.width/4,y:p.y+p.height/2}},49:function(p,G){return{x:p.x+p.width/2,y:p.y+p.height/2+G.height/2}},50:function(p,G){return{x:p.x+p.width/4,y:p.y+p.height-G.height/2}},51:function(p,G){return{x:p.x+3*p.width/4,y:p.y+p.height-G.height/2}},52:function(p,G){return{x:p.x+p.width/4,y:p.y+p.height}},53:function(p,G){return{x:p.x+3*p.width/4,y:p.y+p.height}},54:function(p,G){return{x:p.x+p.width/4,y:p.y+p.height+G.height/2}},55:function(p,G){return{x:p.x+3*p.width/4,y:p.y+p.height+G.height/2}}};if(function(p){var G,v=0;for(G in p)2===G.length&&573===r0(G,32)&&(ki=p[G]),v++;return v}(h))return function(p,G,v){return J[p](G,v||xi)}}(),n4=(MS(s,{highlight:"#1ABC9C",label:"#000",labelSelect:"#FFF",transparent:"rgba(0,0,0,0.35)",titleBackground:"#2C3E50",titleIconBackground:"#868686",headerBackground:"#ECF0F1",headerIconBackground:"#868686",headerSeparator:"#868686",headerLine:"#D9D9D9",background:"#FFF",disabledBackground:"rgba(255,255,255,0.65)",toolTipBackground:"#FFFFE0",rectSelectBorder:"#45C4F9",rectSelectBackground:"rgba(0,0,0,0.35)",editPointBorder:"#2C3E50",editPointBackground:"#D9D9D9",dash:"#2C3E50",groupBackground:"#ECF0F1",groupTitleBackground:"#2C3E50",gridBackground:"#D9D9D9",gridCellBorderColor:"#868686",gridBlockColor:"#868686",reverse:"#868686",contentIconBackground:"#868686",contentLine:"#D9D9D9",widgetBackground:"#ECF0F1",widgetBorder:"#D9D9D9",widgetIconBackground:"#868686",widgetIconBorder:"#868686",widgetIconGradient:"#D9D9D9",widgetIconHighlight:"#43AFF1",imageBackground:"#3498DB",imageGradient:"#FFF",chart:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},!0),s.reverse),z=s.transparent,Cl=s.rectSelectBackground,D4=s.dash,b=s.titleBackground,Y4=s.titleIconBackground,s4=s.headerBackground,c4=s.headerIconBackground,h4=s.headerSeparator,w4=s.headerLine,d4=s.contentIconBackground,P4=s.contentLine,j4=(s.widgetIconHighlight,s.widgetIconBorder),v=(s.widgetIconGradient,s.imageBackground),i4=s.imageGradient,r4=s.highlight,e4=s.label,A4=s.labelSelect;if(!h.shutAlert1){var k4=new Date,I4=e0.split("-"),k4=new Date(k4.getFullYear(),k4.getMonth(),k4.getDate()),e0=new Date(r0(I4[0],10),r0(I4[1],10)-1,r0(I4[2],10)),I4=k4.getTime(),k4=e0.getTime(),e0="ht_try",E4=h.alert;try{(Nh=h.localStorage)&&E4&&(I4<k4&&k4-I4<1728e6?(Ph=(k4-I4)/864e5,Nh&&Nh[e0]!=Ph&&(Nh[e0]=Ph,h.htWillExpire?E4(h.htWillExpire.replace("{{day}}",Ph)):E4("HT for Web free trial license will expire in "+Ph+" days, please apply for a new license!"))):(k4<=I4&&(h.htExpired?E4(h.htExpired):E4("Your free trial of HT for Web has expired!")),Nh&&delete Nh[e0]))}catch(p){}}Math.sign===K&&(Math.sign=function(p){return p<0?-1:0<p?1:+p});var y4,x4,R4,N4,m4,K4,a4,u4,T4,V4,o4,U4,F4,C4,Q4,pL,GL,vL,JL,$L,SL,OL,WL,lL,tL,zL,ZL,BL,fL,XL,qL,gL,ML,LL,HL,_L,bL,nL,DL,YL,sL,cL,hL,wL,dL,PL,jL,iL,rL,eL,AL,kL,IL,EL,yL,xL,RL,NL,mL,KL,aL,uL,TL,VL,oL,UL,FL,CL,QL,x,p1,G1,v1,J1,$1,R,S1,O1,W1,l1,t1,z1,Z1,B1,f1,X1,q1,g1,M1,L1,H1,_1,b1,n1,D1,Y1,s1,c1,h1,w1,d1,P1,j1,i1,r1,e1,A1,k1,I1,E1,y1,x1,R1,N1,m1,K1,a1,u1,T1,V1,o1,U1,F1,C1,Q1,ph,Gh,vh,Jh,$h,Sh,Oh,Wh,lh,th,zh,Zh,Bh,fh,Xh,qh,gh,Mh,Lh,Hh,_h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bh=function(p,G){var v,J,$,S,O,W,l="",t=0;for(p=unescape(encodeURIComponent(p));t<p.length;)$=(v=p.charCodeAt(t++))>>2,S=(3&v)<<4|(v=p.charCodeAt(t++))>>4,O=(15&v)<<2|(J=p.charCodeAt(t++))>>6,W=63&J,isNaN(v)?O=W=64:isNaN(J)&&(W=64),l=l+G.charAt($)+G.charAt(S)+G.charAt(O)+G.charAt(W);return l},nh=function(p,G,v){for(var J,$,S,O,W,l,t="",z=v||0;z<p.length;)S=G.indexOf(p.charAt(z++)),J=(15&(O=G.indexOf(p.charAt(z++))))<<4|(W=G.indexOf(p.charAt(z++)))>>2,$=(3&W)<<6|(l=G.indexOf(p.charAt(z++))),t+=String.fromCharCode(S<<2|O>>4),64!=W&&(t+=String.fromCharCode(J)),64!=l&&(t+=String.fromCharCode($));return decodeURIComponent(escape(t))},Dh=[],Yh=[],sh=E.Math={generateUUID:function(){for(var $=[],p=0;p<256;p++)$[p]=(p<16?"0":"")+p.toString(16).toUpperCase();return function(){var p=4294967295*Math.random()|0,G=4294967295*Math.random()|0,v=4294967295*Math.random()|0,J=4294967295*Math.random()|0;return $[255&p]+$[p>>8&255]+$[p>>16&255]+$[p>>24&255]+"-"+$[255&G]+$[G>>8&255]+"-"+$[G>>16&15|64]+$[G>>24&255]+"-"+$[63&v|128]+$[v>>8&255]+"-"+$[v>>16&255]+$[v>>24&255]+$[255&J]+$[J>>8&255]+$[J>>16&255]+$[J>>24&255]}}(),clamp:function(p,G,v){return Math.max(G,Math.min(v,p))},fequal:function(p,G,v){return null==v&&(v=1e-8),Math.abs(p-G)<v},generateIncreasingID:(y4=0,function(){return++y4}),encodeBase64:function(p,G){return bh(p,G||_h)},decodeBase64:function(p,G){return nh(p,G||_h)},randomArray:function(p,G){for(var v=(G=G||p.length)-1;0<v;v--){var J=Math.floor(Math.random()*(v+1)),$=p[v];p[v]=p[J],p[J]=$}return p},randomInt:function(p,G){return G===K&&(G=p,p=0),p+Math.floor(Math.random()*(G-p))},randomFloat:function(p,G){return G===K&&(G=p,p=0),p+Math.random()*(G-p)},isPOT:function(p){return 0<p&&0==(p-1&p)},nearestPOT:function(p){if(!p)return 1;var G=p,v=(G--,G=(G=(G=(G=(G|=G>>1)|G>>2)|G>>4)|G>>8)|G>>16,++G>>1);return G-p<p-v?G:v},requestMatrix4:function(){return 0<Dh.length?Dh.pop():new sh.Matrix4},releaseMatrix4:function(p){Dh.push(p)},requestVector3:function(){return 0<Yh.length?Yh.pop():new sh.Vector3},releaseVector3:function(p){Yh.push(p)}},ch=E.Matrix=E.Math.Matrix2d=function(p,G,v,J,$){this.setFromTransform(p,G,v,J,$)},hh=ch,wh=(((ch.prototype={}).constructor=ch).prototype.set=function(p,G,v,J,$,S){return this.a=p,this.b=G,this.c=v,this.d=J,this.tx=$,this.ty=S,this},ch.prototype.setFromTransform=function(p,G,v,J,$){var S,O=this;return p===K?(O.a=1,O.b=0,O.c=0,O.d=1,O.tx=0,void(O.ty=0)):(p=p?(S=O0(p),S0(p)):(S=0,1),$=$||1,O.a=p*(J=J||1),O.b=S*J,O.c=-S*$,O.d=p*$,O.tx=G||0,O.ty=v||0,O)},ch.prototype.apply=function(p,G){G=G||new H;var v=p.x,p=p.y;return G.x=this.a*v+this.c*p+this.tx,G.y=this.b*v+this.d*p+this.ty,G},ch.prototype.applyInverse=function(p,G){G=G||new H;var v=1/(this.a*this.d+this.c*-this.b),J=p.x,p=p.y;return G.x=this.d*v*J+-this.c*v*p+(this.ty*this.c-this.tx*this.d)*v,G.y=this.a*v*p+-this.b*v*J+(-this.ty*this.a+this.tx*this.b)*v,G},ch.prototype.translate=function(p,G){return this.tx+=p,this.ty+=G,this},ch.prototype.scale=function(p,G){return this.a*=p,this.d*=G,this.c*=p,this.b*=G,this.tx*=p,this.ty*=G,this},ch.prototype.rotate=function(p){var G=Math.cos(p),p=Math.sin(p),v=this.a,J=this.c,$=this.tx;return this.a=v*G-this.b*p,this.b=v*p+this.b*G,this.c=J*G-this.d*p,this.d=J*p+this.d*G,this.tx=$*G-this.ty*p,this.ty=$*p+this.ty*G,this},ch.prototype.appendTranslate=function(p,G){return this.tx+=this.a*p+this.c*G,this.ty+=this.b*p+this.d*G,this},ch.prototype.appendScale=function(p,G){return this.a*=p,this.d*=G,this.c*=G,this.b*=p,this},ch.prototype.appendRotate=function(p){if(!p)return this;var G=Math.cos(p),p=Math.sin(p),v=this.a,J=this.b;return this.a=v*G+this.c*p,this.b=J*G+this.d*p,this.c=-v*p+this.c*G,this.d=-J*p+this.d*G,this},ch.prototype.append=function(p){var G=this.a,v=this.b,J=this.c,$=this.d;return this.a=p.a*G+p.b*J,this.b=p.a*v+p.b*$,this.c=p.c*G+p.d*J,this.d=p.c*v+p.d*$,this.tx=p.tx*G+p.ty*J+this.tx,this.ty=p.tx*v+p.ty*$+this.ty,this},ch.prototype.setTransform=function(p,G,v,J,$,S,O,W,l){var t=Math.sin(O),O=Math.cos(O),z=Math.cos(l),l=Math.sin(l),Z=-Math.sin(W),W=Math.cos(W),B=O*$,$=t*$,O=O*S;return this.a=z*B+l*(t=-t*S),this.b=z*$+l*O,this.c=Z*B+W*t,this.d=Z*$+W*O,this.tx=p+(v*B+J*t),this.ty=G+(v*$+J*O),this},ch.prototype.prepend=function(p){var G,v,J=this.tx;return 1===p.a&&0===p.b&&0===p.c&&1===p.d||(G=this.a,v=this.c,this.a=G*p.a+this.b*p.c,this.b=G*p.b+this.b*p.d,this.c=v*p.a+this.d*p.c,this.d=v*p.b+this.d*p.d),this.tx=J*p.a+this.ty*p.c+p.tx,this.ty=J*p.b+this.ty*p.d+p.ty,this},ch.prototype.transform=ch.prototype.prepend,ch.prototype.invert=function(){var p=this.a,G=this.b,v=this.c,J=this.d,$=this.tx,S=p*J-G*v;return this.a=J/S,this.b=-G/S,this.c=-v/S,this.d=p/S,this.tx=(v*this.ty-J*$)/S,this.ty=-(p*this.ty-G*$)/S,this},ch.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},ch.prototype.clone=function(){var p=new ch;return p.a=this.a,p.b=this.b,p.c=this.c,p.d=this.d,p.tx=this.tx,p.ty=this.ty,p},ch.prototype.copy=function(p){return p.a=this.a,p.b=this.b,p.c=this.c,p.d=this.d,p.tx=this.tx,p.ty=this.ty,p},ch.prototype.tf=function(p,G){1===arguments.length&&(G=p.y,p=p.x);var v=this;return{x:v.a*p+v.c*G+v.tx,y:v.b*p+v.d*G+v.ty}},ch.prototype.toArray=function(){return[this.a,this.b,this.c,this.d,this.tx,this.ty]},ch.prototype.fromArray=function(p){return this.a=p[0],this.b=p[1],this.c=p[2],this.d=p[3],this.tx=p[4],this.ty=p[5],this},ch.prototype.toArray9=function(){return[this.a,this.b,0,this.c,this.d,0,this.tx,this.ty,1]},ch.prototype.tfi=function(p,G){1===arguments.length&&(G=p.y,p=p.x);var v=this,J=1/(v.a*v.d+v.c*-v.b);return{x:v.d*J*p+-v.c*J*G+(v.ty*v.c-v.tx*v.d)*J,y:v.a*J*G+-v.b*J*p+(-v.ty*v.a+v.tx*v.b)*J}},ch.prototype.decompose=function(){var p=this,G=p.a,v=p.b,J=p.c,$=p.d,S=Math.sqrt(G*G+v*v),O=Math.sqrt(J*J+$*$);return G*$-v*J<0&&(G<$?S=-S:O=-O),S&&(G*=1/S,v*=1/S),O&&($*=1/O),{translateX:p.tx,translateY:p.ty,rotation:Math.atan2(v,G),scaleX:S,scaleY:O}},ch.IDENTITY=new ch,ch.TEMP_MATRIX=new ch,E.Math.Quaternion=function(p,G,v,J){this.set(p,G,v,J)}),dh=(d.assign(wh.prototype,{set:function(p,G,v,J){var $=this;return $._x=p||0,$._y=G||0,$._z=v||0,$._w=J!==K?J:1,$},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(p){var G=this;return G._x=p._x,G._y=p._y,G._z=p._z,G._w=p._w,G},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this},dot:function(p){return this._x*p._x+this._y*p._y+this._z*p._z+this._w*p._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var p=this.length();return 0===p?(this._x=0,this._y=0,this._z=0,this._w=1):(this._x=this._x*(p=1/p),this._y=this._y*p,this._z=this._z*p,this._w=this._w*p),this},fromArray:function(p,G){return this._x=p[G=G===K?0:G],this._y=p[G+1],this._z=p[G+2],this._w=p[G+3],this},slerp:function(p,G){if(0===G)return this;if(1===G)return this.copy(p);var v=this._x,J=this._y,$=this._z,S=this._w;if((O=S*p._w+v*p._x+J*p._y+$*p._z)<0?(this._w=-p._w,this._x=-p._x,this._y=-p._y,this._z=-p._z,O=-O):this.copy(p),1<=O)return this._w=S,this._x=v,this._y=J,this._z=$,this;if(p=Math.sqrt(1-O*O),Math.abs(p)<.001)return this._w=.5*(S+this._w),this._x=.5*(v+this._x),this._y=.5*(J+this._y),this._z=.5*($+this._z),this;var O=Math.atan2(p,O),W=Math.sin((1-G)*O)/p,G=Math.sin(G*O)/p;return this._w=S*W+this._w*G,this._x=v*W+this._x*G,this._y=J*W+this._y*G,this._z=$*W+this._z*G,this},setFromAxisAngle:function(p,G){var G=G/2,v=Math.sin(G);return this._x=p.x*v,this._y=p.y*v,this._z=p.z*v,this._w=Math.cos(G),this},setFromEuler:function(p){var G=p._x,v=p._y,J=p._z,p=p._order,$=Math.cos,S=Math.sin,O=$(G/2),W=$(v/2),$=$(J/2),G=S(G/2),v=S(v/2),S=S(J/2);return"XYZ"===p?(this._x=G*W*$+O*v*S,this._y=O*v*$-G*W*S,this._z=O*W*S+G*v*$,this._w=O*W*$-G*v*S):"YXZ"===p?(this._x=G*W*$+O*v*S,this._y=O*v*$-G*W*S,this._z=O*W*S-G*v*$,this._w=O*W*$+G*v*S):"ZXY"===p?(this._x=G*W*$-O*v*S,this._y=O*v*$+G*W*S,this._z=O*W*S+G*v*$,this._w=O*W*$-G*v*S):"ZYX"===p?(this._x=G*W*$-O*v*S,this._y=O*v*$+G*W*S,this._z=O*W*S-G*v*$,this._w=O*W*$+G*v*S):"YZX"===p?(this._x=G*W*$+O*v*S,this._y=O*v*$+G*W*S,this._z=O*W*S-G*v*$,this._w=O*W*$-G*v*S):"XZY"===p&&(this._x=G*W*$-O*v*S,this._y=O*v*$-G*W*S,this._z=O*W*S+G*v*$,this._w=O*W*$+G*v*S),this},setFromRotationMatrix:function(p){var G,v=(p=p.el)[0],J=p[4],$=p[8],S=p[1],O=p[5],W=p[9],l=p[2],t=p[6],z=v+O+(p=p[10]);return 0<z?(G=.5/Math.sqrt(z+1),this._w=.25/G,this._x=(t-W)*G,this._y=($-l)*G,this._z=(S-J)*G):O<v&&p<v?(G=2*Math.sqrt(1+v-O-p),this._w=(t-W)/G,this._x=.25*G,this._y=(J+S)/G,this._z=($+l)/G):p<O?(G=2*Math.sqrt(1+O-v-p),this._w=($-l)/G,this._x=(J+S)/G,this._y=.25*G,this._z=(W+t)/G):(G=2*Math.sqrt(1+p-v-O),this._w=(S-J)/G,this._x=($+l)/G,this._y=(W+t)/G,this._z=.25*G),this},setFromToVectors:function(p,G){return N4===K&&(N4=new m),(m4=p.dot(G)+1)<1e-7?(m4=0,Math.abs(p.x)>Math.abs(p.z)?N4.set(-p.y,p.x,0):N4.set(0,-p.z,p.y)):N4.crossVectors(p,G),this._x=N4.x,this._y=N4.y,this._z=N4.z,this._w=m4,this.normalize()},setFromUnitVectors:function(p,G){return x4===K&&(x4=new m),(R4=p.dot(G)+1)<1e-6?(R4=0,Math.abs(p.x)>Math.abs(p.z)?x4.set(-p.y,p.x,0):x4.set(0,-p.z,p.y)):x4.crossVectors(p,G),this._x=x4.x,this._y=x4.y,this._z=x4.z,this._w=R4,this.normalize()},multiply:function(p){return this.multiplyQuaternions(this,p)},premultiply:function(p){return this.multiplyQuaternions(p,this)},multiplyQuaternions:function(p,G){var v=p._x,J=p._y,$=p._z,p=p._w,S=G._x,O=G._y,W=G._z,G=G._w;return this._x=v*G+p*S+J*W-$*O,this._y=J*G+p*O+$*S-v*W,this._z=$*G+p*W+v*O-J*S,this._w=p*G-v*S-J*O-$*W,this},toArray:function(p,G){return(p=p||[])[G=G||0]=this._x,p[G+1]=this._y,p[G+2]=this._z,p[G+3]=this._w,p}}),E.Math.Vector4=function(p,G,v,J){this.x=p||0,this.y=G||0,this.z=v||0,this.w=J!==K?J:1}),m=(d.assign(dh.prototype,{isVector4:!0,set:function(p,G,v,J){return this.x=p,this.y=G,this.z=v,this.w=J,this},setScalar:function(p){return this.x=p,this.y=p,this.z=p,this.w=p,this},setX:function(p){return this.x=p,this},setY:function(p){return this.y=p,this},setZ:function(p){return this.z=p,this},setW:function(p){return this.w=p,this},setComponent:function(p,G){switch(p){case 0:this.x=G;break;case 1:this.y=G;break;case 2:this.z=G;break;case 3:this.w=G;break;default:throw new Error("index is out of range: "+p)}return this},getComponent:function(p){switch(p){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+p)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(p){return this.x=p.x,this.y=p.y,this.z=p.z,this.w=p.w!==K?p.w:1,this},add:function(p,G){return G!==K?this.addVectors(p,G):(this.x+=p.x,this.y+=p.y,this.z+=p.z,this.w+=p.w,this)},addScalar:function(p){return this.x+=p,this.y+=p,this.z+=p,this.w+=p,this},addVectors:function(p,G){return this.x=p.x+G.x,this.y=p.y+G.y,this.z=p.z+G.z,this.w=p.w+G.w,this},addScaledVector:function(p,G){return this.x+=p.x*G,this.y+=p.y*G,this.z+=p.z*G,this.w+=p.w*G,this},sub:function(p,G){return G!==K?this.subVectors(p,G):(this.x-=p.x,this.y-=p.y,this.z-=p.z,this.w-=p.w,this)},subScalar:function(p){return this.x-=p,this.y-=p,this.z-=p,this.w-=p,this},subVectors:function(p,G){return this.x=p.x-G.x,this.y=p.y-G.y,this.z=p.z-G.z,this.w=p.w-G.w,this},multiplyScalar:function(p){return this.x*=p,this.y*=p,this.z*=p,this.w*=p,this},applyMatrix4:function(p){var G=this.x,v=this.y,J=this.z,$=this.w,p=p.el;return this.x=p[0]*G+p[4]*v+p[8]*J+p[12]*$,this.y=p[1]*G+p[5]*v+p[9]*J+p[13]*$,this.z=p[2]*G+p[6]*v+p[10]*J+p[14]*$,this.w=p[3]*G+p[7]*v+p[11]*J+p[15]*$,this},divideScalar:function(p){return this.multiplyScalar(1/p)},setAxisAngleFromQuaternion:function(p){this.w=2*Math.acos(p.w);var G=Math.sqrt(1-p.w*p.w);return G<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=p.x/G,this.y=p.y/G,this.z=p.z/G),this},setAxisAngleFromRotationMatrix:function(p){var G,v,J,$=(p=p.el)[0],S=p[4],O=p[8],W=p[1],l=p[5],t=p[9],z=p[2],Z=p[6],p=p[10];if(Math.abs(S-W)<.01&&Math.abs(O-z)<.01&&Math.abs(t-Z)<.01){if(Math.abs(S+W)<.1&&Math.abs(O+z)<.1&&Math.abs(t+Z)<.1&&Math.abs($+l+p-3)<.1)return this.set(1,0,0,0),this;var B=Math.PI,f=($+1)/2,X=(l+1)/2,q=(p+1)/2,g=(S+W)/4,M=(O+z)/4,L=(t+Z)/4;return X<f&&q<f?J=f<.01?(G=0,v=.707106781):(v=g/(G=Math.sqrt(f)),M/G):q<X?J=X<.01?(v=0,G=.707106781):(G=g/(v=Math.sqrt(X)),L/v):q<.01?(v=G=.707106781,J=0):(G=M/(J=Math.sqrt(q)),v=L/J),this.set(G,v,J,B),this}return f=Math.sqrt((Z-t)*(Z-t)+(O-z)*(O-z)+(W-S)*(W-S)),Math.abs(f)<.001&&(f=1),this.x=(Z-t)/f,this.y=(O-z)/f,this.z=(W-S)/f,this.w=Math.acos(($+l+p-1)/2),this},min:function(p){return this.x=Math.min(this.x,p.x),this.y=Math.min(this.y,p.y),this.z=Math.min(this.z,p.z),this.w=Math.min(this.w,p.w),this},max:function(p){return this.x=Math.max(this.x,p.x),this.y=Math.max(this.y,p.y),this.z=Math.max(this.z,p.z),this.w=Math.max(this.w,p.w),this},clamp:function(p,G){return this.x=Math.max(p.x,Math.min(G.x,this.x)),this.y=Math.max(p.y,Math.min(G.y,this.y)),this.z=Math.max(p.z,Math.min(G.z,this.z)),this.w=Math.max(p.w,Math.min(G.w,this.w)),this},clampScalar:function(p,G){return K4===K&&(K4=new dh,a4=new dh),K4.set(p,p,p,p),a4.set(G,G,G,G),this.clamp(K4,a4)},clampLength:function(p,G){var v=this.length();return this.divideScalar(v||1).multiplyScalar(Math.max(p,Math.min(G,v)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(p){return this.x*p.x+this.y*p.y+this.z*p.z+this.w*p.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(p){return this.normalize().multiplyScalar(p)},lerp:function(p,G){return this.x+=(p.x-this.x)*G,this.y+=(p.y-this.y)*G,this.z+=(p.z-this.z)*G,this.w+=(p.w-this.w)*G,this},lerpVectors:function(p,G,v){return this.subVectors(G,p).multiplyScalar(v).add(p)},equals:function(p){return p.x===this.x&&p.y===this.y&&p.z===this.z&&p.w===this.w},fromArray:function(p,G){return this.x=p[G=G===K?0:G],this.y=p[G+1],this.z=p[G+2],this.w=p[G+3],this},toArray:function(p,G){return(p=p===K?[]:p)[G=G===K?0:G]=this.x,p[G+1]=this.y,p[G+2]=this.z,p[G+3]=this.w,p},fromBufferAttribute:function(p,G,v){return this.x=p.getX(G),this.y=p.getY(G),this.z=p.getZ(G),this.w=p.getW(G),this}}),E.Math.Vector3=function(p,G,v){p===K?(this.x=0,this.y=0,this.z=0):"object"==typeof p?this.copy(p):this.set(p,G==K?p:G,v==K?p:v)}),a=E.Math.Vector3,H=(d.assign(m.prototype,{isNaN:function(){return isNaN(this.x)||isNaN(this.y)||isNaN(this.z)},set:function(p,G,v){return this.x=p,this.y=G,this.z=v,this},equals:function(p){return p&&this.x===p.x&&this.y===p.y&&this.z===p.z},setScalar:function(p){return this.x=p,this.y=p,this.z=p,this},setX:function(p){return this.x=p,this},setY:function(p){return this.y=p,this},setZ:function(p){return this.z=p,this},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(p){return p.x===K?(this.x=p[0],this.y=p[1],this.z=p[2]):(this.x=p.x,this.y=p.y,this.z=p.z||0),this},add:function(p){return this.x+=p.x,this.y+=p.y,this.z+=p.z,this},addScalar:function(p){return this.x+=p,this.y+=p,this.z+=p,this},addVectors:function(p,G){return this.x=p.x+G.x,this.y=p.y+G.y,this.z=p.z+G.z,this},addScaledVector:function(p,G){return this.x+=p.x*G,this.y+=p.y*G,this.z+=p.z*G,this},sub:function(p){return this.x-=p.x,this.y-=p.y,this.z-=p.z,this},subScalar:function(p){return this.x-=p,this.y-=p,this.z-=p,this},subVectors:function(p,G){return this.x=p.x-G.x,this.y=p.y-G.y,this.z=p.z-G.z,this},divide:function(p){return this.x/=p.x,this.y/=p.y,this.z/=p.z,this},multiply:function(p){return this.x*=p.x,this.y*=p.y,this.z*=p.z,this},multiplyScalar:function(p){return this.x*=p,this.y*=p,this.z*=p,this},divideScalar:function(p){return 0!==p?(this.x*=p=1/p,this.y*=p,this.z*=p):(this.x=0,this.y=0,this.z=0),this},distanceTo:function(p){return Math.sqrt(this.distanceToSquared(p))},distanceToSquared:function(p){var G=this.x-p.x,v=this.y-p.y;return G*G+v*v+(p=this.z-p.z)*p},distanceToSquared2:function(p){var G=this.x-p[0],v=this.y-p[1];return G*G+v*v+(p=this.z-p[2])*p},divideVectors:function(p,G){return this.x=p.x/G.x,this.y=p.y/G.y,this.z=p.z/G.z,this},multiplyVectors:function(p,G){return this.x=p.x*G.x,this.y=p.y*G.y,this.z=p.z*G.z,this},transformDirection:function(p){var G=this.x,v=this.y,J=this.z,p=p.el;return this.x=p[0]*G+p[4]*v+p[8]*J,this.y=p[1]*G+p[5]*v+p[9]*J,this.z=p[2]*G+p[6]*v+p[10]*J,this.normalize()},applyAxisAngle:(V4=new wh,function(p,G){return this.applyQuaternion(V4.setFromAxisAngle(p,G))}),applyEuler:(T4=new wh,function(p){return this.applyQuaternion(T4.setFromEuler(p))}),applyQuaternion:function(p){var G=this.x,v=this.y,J=this.z,$=p._x,S=p._y,O=p._z,W=(p=p._w)*G+S*J-O*v,l=p*v+O*G-$*J,t=p*J+$*v-S*G;return this.x=W*p+(G=-$*G-S*v-O*J)*-$+l*-O-t*-S,this.y=l*p+G*-S+t*-$-W*-O,this.z=t*p+G*-O+W*-S-l*-$,this},applyMatrix4:function(p){var G=this.x,v=this.y,J=this.z,$=1/((p=p.el)[3]*G+p[7]*v+p[11]*J+p[15]);return this.x=(p[0]*G+p[4]*v+p[8]*J+p[12])*$,this.y=(p[1]*G+p[5]*v+p[9]*J+p[13])*$,this.z=(p[2]*G+p[6]*v+p[10]*J+p[14])*$,this},applyMatrix3:function(p){var G=this.x,v=this.y,J=this.z,p=p.el;return this.x=p[0]*G+p[3]*v+p[6]*J,this.y=p[1]*G+p[4]*v+p[7]*J,this.z=p[2]*G+p[5]*v+p[8]*J,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},reflect:(u4=new m,function(p){return this.sub(u4.copy(p).multiplyScalar(2*this.dot(p)))}),dot:function(p){return this.x*p.x+this.y*p.y+this.z*p.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){var p=this.length();return p?this.multiplyScalar(1/p):this},setLength:function(p){return this.normalize().multiplyScalar(p)},fromArray:function(p,G){return this.x=p[G=G===K?0:G],this.y=p[G+1],this.z=p[G+2],this},toArray:function(p,G){return(p=p===K?[0,0,0]:p)[G=G===K?0:G]=this.x,p[G+1]=this.y,p[G+2]=this.z,p},cross:function(p){return this.crossVectors(this,p)},angleTo:function(p){return 1<(p=this.dot(p)/Math.sqrt(this.lengthSq()*p.lengthSq()))||p<-1?0:Math.acos(p)},lerp:function(p,G){return this.x+=(p.x-this.x)*G,this.y+=(p.y-this.y)*G,this.z+=(p.z-this.z)*G,this},lerpVectors:function(p,G,v){return this.subVectors(G,p).multiplyScalar(v).add(p)},crossVectors:function(p,G){var v=p.x,J=p.y,p=p.z,$=G.x,S=G.y,G=G.z;return this.x=J*G-p*S,this.y=p*$-v*G,this.z=v*S-J*$,this},min:function(p){return this.x=Math.min(this.x,p.x),this.y=Math.min(this.y,p.y),this.z=Math.min(this.z,p.z),this},max:function(p){return this.x=Math.max(this.x,p.x),this.y=Math.max(this.y,p.y),this.z=Math.max(this.z,p.z),this},setFromMatrixPosition:function(p){return this.setFromMatrixColumn(p,3)},setFromMatrixScale:function(p){var G=this.setFromMatrixColumn(p,0).length(),v=this.setFromMatrixColumn(p,1).length(),p=this.setFromMatrixColumn(p,2).length();return this.x=G,this.y=v,this.z=p,this},setFromMatrixColumn:function(p,G){return this.fromArray(p.el,4*G)}}),m.UP=new m(0,1,0),m.AxisX=new m(1,0,0),m.AxisY=new m(0,1,0),m.AxisZ=new m(0,0,1),m.normalizeArray=(o4=new m,function(p){return o4.copy(p).normalize().toArray()}),E.Math.Vector2=function(p,G,v){"object"==typeof p&&(p=p.x!=K?(G=p.y,v=p.e,p.x):(v=p[2],G=p[1],p[0])),this.set(p||0,G||0,v)}),u=(H.prototype={},H.prototype.constructor=H),Ph=(d.defineProperties(H.prototype,{width:{get:function(){return this.x},set:function(p){this.x=p}},height:{get:function(){return this.y},set:function(p){this.y=p}}}),H.prototype.clone=function(){return new H(this.x,this.y,this.e)},H.prototype.copy=function(p){return this.set(p.x,p.y,p.e),this},H.prototype.equals=function(p){return p.x===this.x&&p.y===this.y&&p.e===this.e},H.prototype.set=function(p,G,v){return this.x=p||0,this.y=G||(0!==G?this.x:0),v!=K&&(this.e=v),this},H.prototype.setScalar=function(p){return this.x=p,this.y=p,this.e=p,this},H.prototype.setX=function(p){return this.x=p||0,this},H.prototype.setY=function(p){return this.y=p||0,this},H.prototype.setE=function(p){return this.e=p||0,this},H.prototype.add=function(p){return this.x+=p.x,this.y+=p.y,this},H.prototype.addVectors=function(p,G){return this.x=p.x+G.x,this.y=p.y+G.y,this},H.prototype.addScalar=function(p){return this.x+=p,this.y+=p,this},H.prototype.addScaledVector=function(p,G){return this.x+=p.x*G,this.y+=p.y*G,this},H.prototype.sub=function(p){return this.x-=p.x,this.y-=p.y,this},H.prototype.subScalar=function(p){return this.x-=p,this.y-=p,this},H.prototype.subVectors=function(p,G){return this.x=p.x-G.x,this.y=p.y-G.y,this},H.prototype.multiply=function(p){return this.x*=p.x,this.y*=p.y,this},H.prototype.multiplyScalar=function(p){return this.x*=p,this.y*=p,this},H.prototype.divide=function(p){return this.x/=p.x,this.y/=p.y,this},H.prototype.divideScalar=function(p){return this.multiplyScalar(1/p)},H.prototype.min=function(p){return this.x=Math.min(this.x,p.x),this.y=Math.min(this.y,p.y),this},H.prototype.max=function(p){return this.x=Math.max(this.x,p.x),this.y=Math.max(this.y,p.y),this},H.prototype.fromArray=function(p,G){return this.x=p[G=G===K?0:G],this.y=p[G+1],this},H.prototype.clamp=function(p,G){return this.x=Math.max(p.x,Math.min(G.x,this.x)),this.y=Math.max(p.y,Math.min(G.y,this.y)),this},H.prototype.clampScalar=function(p,G){return U4===K&&(U4=new H,F4=new H),U4.set(p,p),F4.set(G,G),this.clamp(U4,F4)},H.prototype.clampLength=function(p,G){var v=this.length();return this.multiplyScalar(Math.max(p,Math.min(G,v))/v)},H.prototype.dot=function(p){return this.x*p.x+this.y*p.y},H.prototype.cross=function(p){return this.x*p.y-this.y*p.x},H.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},H.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},H.prototype.normalize=function(){return this.divideScalar(this.length())},H.prototype.angle=function(){var p=Math.atan2(this.y,this.x);return p<0&&(p+=2*Math.PI),p},H.prototype.distanceTo=function(p){return Math.sqrt(this.distanceToSquared(p))},H.prototype.distanceToSquared=function(p){var G=this.x-p.x;return G*G+(p=this.y-p.y)*p},H.prototype.isNearEnough=function(p){return this.distanceToSquared(p)<1e-8},H.prototype.setLength=function(p){var G=this.length();return G?this.multiplyScalar(p/G):this},H.prototype.lerp=function(p,G){return this.x+=(p.x-this.x)*G,this.y+=(p.y-this.y)*G,"number"==typeof p.e&&"number"==typeof this.e&&(this.e+=(p.e-this.e)*G),this},H.prototype.lerpVectors=function(p,G,v){return this.subVectors(G,p).multiplyScalar(v).add(p)},H.prototype.rotateAround=function(p,G){var v=p?p.x:0,p=p?p.y:0,J=Math.cos(G),G=Math.sin(G),$=this.x-v,S=this.y-p;return this.x=$*J-S*G+v,this.y=$*G+S*J+p,this},E.Math.Matrix3=function(){this.el=[1,0,0,0,1,0,0,0,1]}),jh=(d.assign(Ph.prototype,{isMatrix3:!0,set:function(p,G,v,J,$,S,O,W,l){var t=this.el;return t[0]=p,t[1]=J,t[2]=O,t[3]=G,t[4]=$,t[5]=W,t[6]=v,t[7]=S,t[8]=l,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.el)},copy:function(p){var G=this.el,p=p.el;return G[0]=p[0],G[1]=p[1],G[2]=p[2],G[3]=p[3],G[4]=p[4],G[5]=p[5],G[6]=p[6],G[7]=p[7],G[8]=p[8],this},setFromMatrix4:function(p){return p=p.el,this.set(p[0],p[4],p[8],p[1],p[5],p[9],p[2],p[6],p[10]),this},applyToBufferAttribute:(C4=new m,function(p){for(var G=0,v=p.count;G<v;G++)C4.x=p.getX(G),C4.y=p.getY(G),C4.z=p.getZ(G),C4.applyMatrix3(this),p.setXYZ(G,C4.x,C4.y,C4.z);return p}),multiply:function(p){return this.multiplyMatrices(this,p)},premultiply:function(p){return this.multiplyMatrices(p,this)},multiplyMatrices:function(p,G){var p=p.el,G=G.el,v=this.el,J=p[0],$=p[3],S=p[6],O=p[1],W=p[4],l=p[7],t=p[2],z=p[5],p=p[8],Z=G[0],B=G[3],f=G[6],X=G[1],q=G[4],g=G[7],M=G[2],L=G[5],G=G[8];return v[0]=J*Z+$*X+S*M,v[3]=J*B+$*q+S*L,v[6]=J*f+$*g+S*G,v[1]=O*Z+W*X+l*M,v[4]=O*B+W*q+l*L,v[7]=O*f+W*g+l*G,v[2]=t*Z+z*X+p*M,v[5]=t*B+z*q+p*L,v[8]=t*f+z*g+p*G,this},multiplyScalar:function(p){var G=this.el;return G[0]*=p,G[3]*=p,G[6]*=p,G[1]*=p,G[4]*=p,G[7]*=p,G[2]*=p,G[5]*=p,G[8]*=p,this},determinant:function(){var p=this.el,G=p[0],v=p[1],J=p[2],$=p[3],S=p[4],O=p[5],W=p[6],l=p[7];return G*S*(p=p[8])-G*O*l-v*$*p+v*O*W+J*$*l-J*S*W},getInverse:function(p,G){var p=p.el,v=this.el,J=p[0],$=p[1],S=p[2],O=p[3],W=p[4],l=p[5],t=p[6],z=p[7],Z=(p=p[8])*W-l*z,B=l*t-p*O,f=z*O-W*t,X=J*Z+$*B+S*f;return 0==X?this.identity():(v[0]=Z*(X=1/X),v[1]=(S*z-p*$)*X,v[2]=(l*$-S*W)*X,v[3]=B*X,v[4]=(p*J-S*t)*X,v[5]=(S*O-l*J)*X,v[6]=f*X,v[7]=($*t-z*J)*X,v[8]=(W*J-$*O)*X,this)},transpose:function(){var p=this.el,G=p[1];return p[1]=p[3],p[3]=G,G=p[2],p[2]=p[6],p[6]=G,G=p[5],p[5]=p[7],p[7]=G,this},getNormalMatrix:function(p){return this.setFromMatrix4(p).getInverse(this).transpose()},transposeIntoArray:function(p){var G=this.el;return p[0]=G[0],p[1]=G[3],p[2]=G[6],p[3]=G[1],p[4]=G[4],p[5]=G[7],p[6]=G[2],p[7]=G[5],p[8]=G[8],this},setUvTransform:function(p,G,v,J,$,S,O){var W=Math.cos($),$=Math.sin($);this.set(v*W,v*$,-v*(W*S+$*O)+S+p,-J*$,J*W,-J*(-$*S+W*O)+O+G,0,0,1)},scale:function(p,G){var v=this.el;return v[0]*=p,v[3]*=p,v[6]*=p,v[1]*=G,v[4]*=G,v[7]*=G,this},rotate:function(p){var G=Math.cos(p),p=Math.sin(p),v=this.el,J=v[0],$=v[3],S=v[6],O=v[1],W=v[4],l=v[7];return v[0]=G*J+p*O,v[3]=G*$+p*W,v[6]=G*S+p*l,v[1]=-p*J+G*O,v[4]=-p*$+G*W,v[7]=-p*S+G*l,this},translate:function(p,G){var v=this.el;return v[0]+=p*v[2],v[3]+=p*v[5],v[6]+=p*v[8],v[1]+=G*v[2],v[4]+=G*v[5],v[7]+=G*v[8],this},equals:function(p){for(var G=this.el,v=p.el,J=0;J<9;J++)if(G[J]!==v[J])return!1;return!0},fromArray:function(p,G){G===K&&(G=0);for(var v=0;v<9;v++)this.el[v]=p[v+G];return this},toArray:function(p,G){var v=this.el;return(p=p===K?[]:p)[G=G===K?0:G]=v[0],p[G+1]=v[1],p[G+2]=v[2],p[G+3]=v[3],p[G+4]=v[4],p[G+5]=v[5],p[G+6]=v[6],p[G+7]=v[7],p[G+8]=v[8],p}}),E.Math.Plane=function(p,G){this.normal=p!==K?p:new m(1,0,0),this.constant=G!==K?G:0}),ih=(d.assign(jh.prototype,{set:function(p,G){return this.normal.copy(p),this.constant=G,this},setComponents:function(p,G,v,J){return this.normal.set(p,G,v),this.constant=J,this},setFromNormalAndCoplanarPoint:function(p,G){return this.normal.copy(p),this.constant=-G.dot(this.normal),this},setFromCoplanarPoints:(vL=new m,JL=new m,function(p,G,v){return v=vL.subVectors(v,G).cross(JL.subVectors(p,G)).normalize(),this.setFromNormalAndCoplanarPoint(v,p),this}),clone:function(){return(new this.constructor).copy(this)},copy:function(p){return this.normal.copy(p.normal),this.constant=p.constant,this},normalize:function(){var p=1/this.normal.length();return this.normal.multiplyScalar(p),this.constant*=p,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(p){return this.normal.dot(p)+this.constant},distanceToSphere:function(p){return this.distanceToPoint(p.center)-p.radius},projectPoint:function(p,G){return(G=G===K?new m:G).copy(this.normal).multiplyScalar(-this.distanceToPoint(p)).add(p)},intersectLine:(GL=new m,function(p,G){G===K&&(G=new m);var v=p.delta(GL),J=this.normal.dot(v);return 0===J?0===this.distanceToPoint(p.start)?G.copy(p.start):K:(J=-(p.start.dot(this.normal)+this.constant)/J)<0||1<J?K:G.copy(v).multiplyScalar(J).add(p.start)}),intersectsLine:function(p){var G=this.distanceToPoint(p.start),p=this.distanceToPoint(p.end);return G<0&&0<p||p<0&&0<G},intersectsBox:function(p){return p.intersectsPlane(this)},intersectsSphere:function(p){return p.intersectsPlane(this)},coplanarPoint:function(p){return(p=p===K?new m:p).copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:(Q4=new m,pL=new Ph,function(p,G){return G=G||pL.getNormalMatrix(p),p=this.coplanarPoint(Q4).applyMatrix4(p),G=this.normal.applyMatrix3(G).normalize(),this.constant=-p.dot(G),this}),translate:function(p){return this.constant-=p.dot(this.normal),this},equals:function(p){return p.normal.equals(this.normal)&&p.constant===this.constant}}),E.Math.Ray=function(p,G){this.origin=p!==K?p.clone():new m,this.direction=G!==K?G.clone():new m}),rh=(d.assign(ih.prototype,{set:function(p,G){return this.origin.copy(p),this.direction.copy(G),this},clone:function(){return(new this.constructor).copy(this)},copy:function(p){return this.origin.copy(p.origin),this.direction.copy(p.direction),this.maxHitLen=p.maxHitLen,this},at:function(p,G){return(G||new m).copy(this.direction).multiplyScalar(p).add(this.origin)},setMaxHitLength:function(p){this.maxHitLen=p},lookAt:function(p){return this.direction.copy(p).sub(this.origin).normalize(),this},applyMatrix4:function(p){var G,v=this.maxHitLen;return v&&(G=this.direction.clone().multiplyScalar(v).add(this.origin)).applyMatrix4(p),this.origin.applyMatrix4(p),this.direction.transformDirection(p),v&&(this.maxHitLen=this.origin.distanceTo(G)),this},distanceToPlane:function(p){var G=p.normal.dot(this.direction);return 0===G?0===p.distanceToPoint(this.origin)?0:null:0<=(p=-(this.origin.dot(p.normal)+p.constant)/G)?p:null},intersectPlane:function(p,G){return null===(p=this.distanceToPlane(p))?null:this.at(p,G)},intersectSphere:(zL=new m,function(p,G){zL.subVectors(p.center,this.origin);var v=zL.dot(this.direction),J=zL.dot(zL)-v*v;return(p=p.radius*p.radius)<J?null:(J=v-(p=Math.sqrt(p-J)),v+=p,J<0&&v<0?null:J<0?this.at(v,G):this.at(J,G))}),intersectEllipsoid:(lL=new m,tL=new m,function(p,G){lL.subVectors(p.center,this.origin),lL.divide(p.radius),tL.divideVectors(this.direction,p.radius);var p=tL.lengthSq(),v=lL.dot(tL),J=lL.dot(lL)*p-v*v;if(p<J)return null;var $=(v-(J=Math.sqrt(p-J)))/p,v=(v+J)/p;return $<0&&v<0?null:$<0?this.at(v,G):this.at($,G)}),intersectBox:function(p,G){var v,J,$,S=1/this.direction.x,O=1/this.direction.y,W=1/this.direction.z,l=this.origin,S=0<=S?(v=(p.min.x-l.x)*S,(p.max.x-l.x)*S):(v=(p.max.x-l.x)*S,(p.min.x-l.x)*S);return(O=0<=O?($=(p.min.y-l.y)*O,(p.max.y-l.y)*O):($=(p.max.y-l.y)*O,(p.min.y-l.y)*O))<v||S<$?null:((v<$||v!=v)&&(v=$),(O<S||S!=S)&&(S=O),($=0<=W?(J=(p.min.z-l.z)*W,(p.max.z-l.z)*W):(J=(p.max.z-l.z)*W,(p.min.z-l.z)*W))<v||S<J||(S=$<S||S!=S?$:S)<0?null:(O=0<=(v=v<J||v!=v?J:v)?v:S,(p=this.maxHitLen)&&p<O?null:this.at(O,G)))},intersectTriangle:($L=new m,SL=new m,OL=new m,WL=new m,function(p,G,v,J,$){var S;if(SL.subVectors(G,p),OL.subVectors(v,p),WL.crossVectors(SL,OL),0<(G=this.direction.dot(WL))){if(J)return null;S=1}else{if(!(G<0))return null;S=-1,G=-G}return $L.subVectors(this.origin,p),(v=S*this.direction.dot(OL.crossVectors($L,OL)))<0||(J=S*this.direction.dot(SL.cross($L)))<0||G<v+J||(p=-S*$L.dot(WL))<0?null:(v=p/G,(J=this.maxHitLen)&&J<v?null:this.at(v,$))})}),E.Math.Box3=function(p,G){this.min=p!==K?p:new m(1/0,1/0,1/0),this.max=G!==K?G:new m(-1/0,-1/0,-1/0)}),k4=(d.assign(rh.prototype,{set:function(p,G){return this.min.copy(p),this.max.copy(G),this},setFromArray:function(p){for(var G=1/0,v=1/0,J=1/0,$=-1/0,S=-1/0,O=-1/0,W=0,l=p.length;W<l;W+=3){var t=p[W],z=p[W+1],Z=p[W+2];t<G&&(G=t),z<v&&(v=z),Z<J&&(J=Z),$<t&&($=t),S<z&&(S=z),O<Z&&(O=Z)}return this.min.set(G,v,J),this.max.set($,S,O),this},setFromPoints:function(p){this.makeEmpty();for(var G=0,v=p.length;G<v;G++)this.expandByPoint(p[G]);return this},clone:function(){return(new this.constructor).copy(this)},intersectsBox:function(p){return!(p.max.x<this.min.x||p.min.x>this.max.x||p.max.y<this.min.y||p.min.y>this.max.y||p.max.z<this.min.z||p.min.z>this.max.z)},copy:function(p){return this.min.copy(p.min),this.max.copy(p.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},expandByPoint:function(p){return this.min.min(p),this.max.max(p),this},expandByBox:function(p){return this.min.min(p.min),this.max.max(p.max),this},applyMatrix4:(ZL=[new m,new m,new m,new m,new m,new m,new m,new m],function(p){return this.isEmpty()||(ZL[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(p),ZL[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(p),ZL[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(p),ZL[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(p),ZL[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(p),ZL[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(p),ZL[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(p),ZL[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(p),this.setFromPoints(ZL)),this})}),E.Math.Sphere=function(p,G){this.center=p!==K?p:new m,this.radius=G!==K?G:0}),I4=(d.assign(k4.prototype,{set:function(p,G){return this.center.copy(p),this.radius=G,this},setFromPoints:(BL=new rh,function(p,G){for(var v=this.center,J=(G!==K?v.copy(G):BL.setFromPoints(p).getCenter(v),0),$=0,S=p.length;$<S;$++)J=Math.max(J,v.distanceToSquared(p[$]));return this.radius=Math.sqrt(J),this}),clone:function(){return(new this.constructor).copy(this)},copy:function(p){return this.center.copy(p.center),this.radius=p.radius,this},empty:function(){return this.radius<=0},containsPoint:function(p){return p.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(p){return p.distanceTo(this.center)-this.radius},intersectsSphere:function(p){var G=this.radius+p.radius;return p.center.distanceToSquared(this.center)<=G*G},intersectsBox:function(p){return p.intersectsSphere(this)},intersectsPlane:function(p){return Math.abs(p.distanceToPoint(this.center))<=this.radius},clampPoint:function(p,G){var v=this.center.distanceToSquared(p);return(G=G===K?new m:G).copy(p),v>this.radius*this.radius&&(G.sub(this.center).normalize(),G.multiplyScalar(this.radius).add(this.center)),G},getBoundingBox:function(p){return(p=p===K?new rh:p).set(this.center,this.center),p.expandByScalar(this.radius),p},applyMatrix4:function(p){return this.center.applyMatrix4(p),this.radius=this.radius*p.getMaxScaleOnAxis(),this},translate:function(p){return this.center.add(p),this},equals:function(p){return p.center.equals(this.center)&&p.radius===this.radius}}),E.Math.Frustum=function(p,G,v,J,$,S){this.planes=[p!==K?p:new jh,G!==K?G:new jh,v!==K?v:new jh,J!==K?J:new jh,$!==K?$:new jh,S!==K?S:new jh]}),eh=(d.assign(I4.prototype,{set:function(p,G,v,J,$,S){var O=this.planes;return O[0].copy(p),O[1].copy(G),O[2].copy(v),O[3].copy(J),O[4].copy($),O[5].copy(S),this},clone:function(){return(new this.constructor).copy(this)},copy:function(p){for(var G=this.planes,v=0;v<6;v++)G[v].copy(p.planes[v]);return this},setFromMatrix:function(p){var G=this.planes,v=(p=p.el)[0],J=p[1],$=p[2],S=p[3],O=p[4],W=p[5],l=p[6],t=p[7],z=p[8],Z=p[9],B=p[10],f=p[11],X=p[12],q=p[13],g=p[14],p=p[15];return G[0].setComponents(S-v,t-O,f-z,p-X).normalize(),G[1].setComponents(S+v,t+O,f+z,p+X).normalize(),G[2].setComponents(S+J,t+W,f+Z,p+q).normalize(),G[3].setComponents(S-J,t-W,f-Z,p-q).normalize(),G[4].setComponents(S-$,t-l,f-B,p-g).normalize(),G[5].setComponents(S+$,t+l,f+B,p+g).normalize(),this},intersectsObject:(qL=new k4,function(p){var G=p.geometry;return null===G.boundingSphere&&G.computeBoundingSphere(),qL.copy(G.boundingSphere).applyMatrix4(p.matrixWorld),this.intersectsSphere(qL)}),intersectsSprite:(XL=new k4,function(p){return XL.center.set(0,0,0),XL.radius=.7071067811865476,XL.applyMatrix4(p.matrixWorld),this.intersectsSphere(XL)}),intersectsSphere:function(p){for(var G=this.planes,v=p.center,J=-p.radius,$=0;$<6;$++)if(G[$].distanceToPoint(v)<J)return!1;return!0},intersectsBox:(fL=new m,function(p){for(var G=this.planes,v=0;v<6;v++){var J=G[v];if(fL.x=(0<J.normal.x?p.max:p.min).x,fL.y=(0<J.normal.y?p.max:p.min).y,fL.z=(0<J.normal.z?p.max:p.min).z,J.distanceToPoint(fL)<0)return!1}return!0}),containsPoint:function(p){for(var G=this.planes,v=0;v<6;v++)if(G[v].distanceToPoint(p)<0)return!1;return!0}}),E.Math.Matrix4=function(){this.el=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}),Ah=(d.assign(eh.prototype,{isMatrix4:!0,set:function(p,G,v,J,$,S,O,W,l,t,z,Z,B,f,X,q){var g=this.el;return g[0]=p,g[4]=G,g[8]=v,g[12]=J,g[1]=$,g[5]=S,g[9]=O,g[13]=W,g[2]=l,g[6]=t,g[10]=z,g[14]=Z,g[3]=B,g[7]=f,g[11]=X,g[15]=q,this},clone:function(){return(new eh).fromArray(this.el)},fromArray:function(p,G){G===K&&(G=0);for(var v=this.el,J=0;J<16;J++)v[J]=p[J+G];return this},getElements:function(){return this.el},scale:function(p){var G=this.el,v=p.x,J=p.y,p=p.z;return G[0]*=v,G[4]*=J,G[8]*=p,G[1]*=v,G[5]*=J,G[9]*=p,G[2]*=v,G[6]*=J,G[10]*=p,G[3]*=v,G[7]*=J,G[11]*=p,this},translate:function(p){var G=this.el,v=p.x||0,J=p.y||0,p=p.z||0;return G[12]+=G[0]*v+G[4]*J+G[8]*p,G[13]+=G[1]*v+G[5]*J+G[9]*p,G[14]+=G[2]*v+G[6]*J+G[10]*p,G[15]+=G[3]*v+G[7]*J+G[11]*p,this},makeRotationFromEuler:function(p){var G,v,J,$,S,O,W,l,t,z,Z,B,f=this.el,X=p._x,q=p._y,g=p._z,p=p._order,M=Math.cos(X),X=Math.sin(X),L=Math.cos(q),q=Math.sin(q),H=Math.cos(g),g=Math.sin(g);return"XYZ"===p?(S=M*H,O=M*g,W=X*H,l=X*g,f[0]=L*H,f[4]=-L*g,f[8]=q,f[1]=O+W*q,f[5]=S-l*q,f[9]=-X*L,f[2]=l-S*q,f[6]=W+O*q,f[10]=M*L):"YXZ"===p?(v=L*g,J=q*H,f[0]=(G=L*H)+($=q*g)*X,f[4]=J*X-v,f[8]=M*q,f[1]=M*g,f[5]=M*H,f[9]=-X,f[2]=v*X-J,f[6]=$+G*X,f[10]=M*L):"ZXY"===p?(v=L*g,J=q*H,f[0]=(G=L*H)-($=q*g)*X,f[4]=-M*g,f[8]=J+v*X,f[1]=v+J*X,f[5]=M*H,f[9]=$-G*X,f[2]=-M*q,f[6]=X,f[10]=M*L):"ZYX"===p?(S=M*H,O=M*g,W=X*H,l=X*g,f[0]=L*H,f[4]=W*q-O,f[8]=S*q+l,f[1]=L*g,f[5]=l*q+S,f[9]=O*q-W,f[2]=-q,f[6]=X*L,f[10]=M*L):"YZX"===p?(t=M*L,z=M*q,Z=X*L,B=X*q,f[0]=L*H,f[4]=B-t*g,f[8]=Z*g+z,f[1]=g,f[5]=M*H,f[9]=-X*H,f[2]=-q*H,f[6]=z*g+Z,f[10]=t-B*g):"XZY"===p&&(t=M*L,z=M*q,Z=X*L,B=X*q,f[0]=L*H,f[4]=-g,f[8]=q*H,f[1]=t*g+B,f[5]=M*H,f[9]=z*g-Z,f[2]=Z*g-z,f[6]=X*H,f[10]=B*g+t),f[3]=0,f[7]=0,f[11]=0,f[12]=0,f[13]=0,f[14]=0,f[15]=1,this},makeRotationFromQuaternion:function(p){var G=this.el,v=p._x,J=p._y,$=p._z,S=$+$,O=v*(t=v+v),W=v*(z=J+J),v=v*S,l=J*z,J=J*S,t=(p=p._w)*t,z=p*z,p=p*S;return G[0]=1-(l+($=$*S)),G[4]=W-p,G[8]=v+z,G[1]=W+p,G[5]=1-(O+$),G[9]=J-t,G[2]=v-z,G[6]=J+t,G[10]=1-(O+l),G[3]=0,G[7]=0,G[11]=0,G[12]=0,G[13]=0,G[14]=0,G[15]=1,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},getInverse:function(p,G){var v=this.el,J=(p=p.el)[0],$=p[1],S=p[2],O=p[3],W=p[4],l=p[5],t=p[6],z=p[7],Z=p[8],B=p[9],f=p[10],X=p[11],q=p[12],g=p[13],M=p[14],L=B*M*z-g*f*z+g*t*X-l*M*X-B*t*(p=p[15])+l*f*p,H=q*f*z-Z*M*z-q*t*X+W*M*X+Z*t*p-W*f*p,_=Z*g*z-q*B*z+q*l*X-W*g*X-Z*l*p+W*B*p,b=q*B*t-Z*g*t-q*l*f+W*g*f+Z*l*M-W*B*M,n=J*L+$*H+S*_+O*b;return 0==n?this.identity():(v[0]=L*(n=1/n),v[1]=(g*f*O-B*M*O-g*S*X+$*M*X+B*S*p-$*f*p)*n,v[2]=(l*M*O-g*t*O+g*S*z-$*M*z-l*S*p+$*t*p)*n,v[3]=(B*t*O-l*f*O-B*S*z+$*f*z+l*S*X-$*t*X)*n,v[4]=H*n,v[5]=(Z*M*O-q*f*O+q*S*X-J*M*X-Z*S*p+J*f*p)*n,v[6]=(q*t*O-W*M*O-q*S*z+J*M*z+W*S*p-J*t*p)*n,v[7]=(W*f*O-Z*t*O+Z*S*z-J*f*z-W*S*X+J*t*X)*n,v[8]=_*n,v[9]=(q*B*O-Z*g*O-q*$*X+J*g*X+Z*$*p-J*B*p)*n,v[10]=(W*g*O-q*l*O+q*$*z-J*g*z-W*$*p+J*l*p)*n,v[11]=(Z*l*O-W*B*O-Z*$*z+J*B*z+W*$*X-J*l*X)*n,v[12]=b*n,v[13]=(Z*g*S-q*B*S+q*$*f-J*g*f-Z*$*M+J*B*M)*n,v[14]=(q*l*S-W*g*S-q*$*t+J*g*t+W*$*M-J*l*M)*n,v[15]=(W*B*S-Z*l*S+Z*$*t-J*B*t-W*$*f+J*l*f)*n,this)},invert:function(){return this.getInverse(this)},makeRotationAxis:function(p,G){var v=Math.cos(G),G=Math.sin(G),J=1-v,$=p.x,S=p.y,p=p.z,O=J*$,W=J*S;return this.set(O*$+v,O*S-G*p,O*p+G*S,0,O*S+G*p,W*S+v,W*p-G*$,0,O*p-G*S,W*p+G*$,J*p*p+v,0,0,0,0,1),this},multiply:function(p){return this.multiplyMatrices(this,p)},premultiply:function(p){return this.multiplyMatrices(p,this)},multiplyMatrices:function(p,G){var p=p.el,G=G.el,v=this.el,J=p[0],$=p[4],S=p[8],O=p[12],W=p[1],l=p[5],t=p[9],z=p[13],Z=p[2],B=p[6],f=p[10],X=p[14],q=p[3],g=p[7],M=p[11],p=p[15],L=G[0],H=G[4],_=G[8],b=G[12],n=G[1],D=G[5],Y=G[9],s=G[13],c=G[2],h=G[6],w=G[10],d=G[14],P=G[3],j=G[7],i=G[11],G=G[15];return v[0]=J*L+$*n+S*c+O*P,v[4]=J*H+$*D+S*h+O*j,v[8]=J*_+$*Y+S*w+O*i,v[12]=J*b+$*s+S*d+O*G,v[1]=W*L+l*n+t*c+z*P,v[5]=W*H+l*D+t*h+z*j,v[9]=W*_+l*Y+t*w+z*i,v[13]=W*b+l*s+t*d+z*G,v[2]=Z*L+B*n+f*c+X*P,v[6]=Z*H+B*D+f*h+X*j,v[10]=Z*_+B*Y+f*w+X*i,v[14]=Z*b+B*s+f*d+X*G,v[3]=q*L+g*n+M*c+p*P,v[7]=q*H+g*D+M*h+p*j,v[11]=q*_+g*Y+M*w+p*i,v[15]=q*b+g*s+M*d+p*G,this},lookAt:(DL=new m,function(p,G,v){return DL.subVectors(p,G),this.lookAtDirection(DL,v)}),lookAtDirection:(_L=new m,bL=new m,nL=new m,function(p,G){G=G||m.UP;var v=this.el;return nL.copy(p),0===nL.lengthSq()&&(nL.z=1),nL.normalize(),_L.crossVectors(G,nL),0===_L.lengthSq()&&(1===Math.abs(G.z)?nL.x+=1e-4:nL.z+=1e-4,nL.normalize(),_L.crossVectors(G,nL)),_L.normalize(),bL.crossVectors(nL,_L),v[0]=_L.x,v[4]=bL.x,v[8]=nL.x,v[1]=_L.y,v[5]=bL.y,v[9]=nL.y,v[2]=_L.z,v[6]=bL.z,v[10]=nL.z,this}),extractScale:function(p){HL===K&&(HL=new m),p===K&&(p=new m);var G=HL.setFromMatrixColumn(this,0).length(),v=HL.setFromMatrixColumn(this,1).length(),J=HL.setFromMatrixColumn(this,2).length();return p.set(G,v,J),p},extractRotation:function(p){LL===K&&(LL=new m),p===K&&(p=new eh);var G=this.el,v=p.el,J=1/LL.setFromMatrixColumn(p,0).length(),$=1/LL.setFromMatrixColumn(p,1).length(),p=1/LL.setFromMatrixColumn(p,2).length();return G[0]=v[0]*J,G[1]=v[1]*J,G[2]=v[2]*J,G[4]=v[4]*$,G[5]=v[5]*$,G[6]=v[6]*$,G[8]=v[8]*p,G[9]=v[9]*p,G[10]=v[10]*p,this},multiplyScalar:function(p){var G=this.el;return G[0]*=p,G[4]*=p,G[8]*=p,G[12]*=p,G[1]*=p,G[5]*=p,G[9]*=p,G[13]*=p,G[2]*=p,G[6]*=p,G[10]*=p,G[14]*=p,G[3]*=p,G[7]*=p,G[11]*=p,G[15]*=p,this},getPosition:function(p){return(p=p===K?new m:p).setFromMatrixColumn(this,3)},setPosition:function(p){var G=this.el;return G[12]=p.x,G[13]=p.y,G[14]=p.z,this},copyPosition:function(p){var G=this.el,p=p.el;return G[12]=p[12],G[13]=p[13],G[14]=p[14],this},toArray:function(p,G){var v=this.el;return(p=p===K?[]:p)[G=G===K?0:G]=v[0],p[G+1]=v[1],p[G+2]=v[2],p[G+3]=v[3],p[G+4]=v[4],p[G+5]=v[5],p[G+6]=v[6],p[G+7]=v[7],p[G+8]=v[8],p[G+9]=v[9],p[G+10]=v[10],p[G+11]=v[11],p[G+12]=v[12],p[G+13]=v[13],p[G+14]=v[14],p[G+15]=v[15],p},determinant:function(){var p=this.el,G=p[0],v=p[4],J=p[8],$=p[12],S=p[1],O=p[5],W=p[9],l=p[13],t=p[2],z=p[6],Z=p[10],B=p[14];return p[3]*(+$*W*z-J*l*z-$*O*Z+v*l*Z+J*O*B-v*W*B)+p[7]*(+G*W*B-G*l*Z+$*S*Z-J*S*B+J*l*t-$*W*t)+p[11]*(+G*l*z-G*O*B-$*S*z+v*S*B+$*O*t-v*l*t)+p[15]*(-J*O*t-G*W*z+G*O*Z+J*S*z-v*S*Z+v*W*t)},copy:function(p){var G=this.el,p=p.el;return G[0]=p[0],G[1]=p[1],G[2]=p[2],G[3]=p[3],G[4]=p[4],G[5]=p[5],G[6]=p[6],G[7]=p[7],G[8]=p[8],G[9]=p[9],G[10]=p[10],G[11]=p[11],G[12]=p[12],G[13]=p[13],G[14]=p[14],G[15]=p[15],this},compose:function(p,G,v){var J=this.el,$=(O=G._x)*(z=O+O),S=O*(Z=(l=G._y)+l),O=O*(B=(t=G._z)+t),W=l*Z,l=l*B,t=t*B,z=(G=G._w)*z,Z=G*Z,G=G*B,B=v.x,f=v.y,v=v.z;return J[0]=(1-(W+t))*B,J[1]=(S+G)*B,J[2]=(O-Z)*B,J[3]=0,J[4]=(S-G)*f,J[5]=(1-($+t))*f,J[6]=(l+z)*f,J[7]=0,J[8]=(O+Z)*v,J[9]=(l-z)*v,J[10]=(1-($+W))*v,J[11]=0,J[12]=p.x,J[13]=p.y,J[14]=p.z,J[15]=1,this},decompose:(gL=new m,ML=new eh,function(p,G,v){var J=this.el,$=gL.set(J[0],J[1],J[2]).length(),S=gL.set(J[4],J[5],J[6]).length(),O=gL.set(J[8],J[9],J[10]).length(),p=(this.determinant()<0&&($=-$),p.x=J[12],p.y=J[13],p.z=J[14],ML.copy(this),1/$),J=1/S,W=1/O;return ML.el[0]*=p,ML.el[1]*=p,ML.el[2]*=p,ML.el[4]*=J,ML.el[5]*=J,ML.el[6]*=J,ML.el[8]*=W,ML.el[9]*=W,ML.el[10]*=W,G.setFromRotationMatrix(ML),v.x=$,v.y=S,v.z=O,this}),equals:function(p){for(var G=this.el,v=p.el,J=0;J<16;J++)if(G[J]!==v[J])return!1;return!0}}),new eh,new eh,E.Math.Triangle=function(p,G,v){this.a=p!==K?p:new m,this.b=G!==K?G:new m,this.c=v!==K?v:new m}),kh=(d.assign(Ah,{barycoordFromPoint:(sL=new m,cL=new m,hL=new m,function(p,G,v,J,$){sL.subVectors(J,G),cL.subVectors(v,G),hL.subVectors(p,G);var J=sL.dot(sL),v=sL.dot(cL),p=sL.dot(hL),G=cL.dot(cL),S=cL.dot(hL),O=J*G-v*v,$=$||new m;return 0==O?$.set(-2,-1,-1):$.set(1-(G=(G*p-v*S)*(O=1/O))-(J=(J*S-v*p)*O),J,G)}),uvIntersection:(YL=new m,function(p,G,v,J,$,S,O){return Ah.barycoordFromPoint(p,G,v,J,YL),$.multiplyScalar(YL.x),S.multiplyScalar(YL.y),O.multiplyScalar(YL.z),$.add(S).add(O),$.clone()})}),E.Math.Euler=function(p,G,v,J,$){this.set(p,G,v,J,$)}),Ih=(kh.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],kh.DefaultOrder="XYZ",kh.ReverseOrder=(wL={xyz:"ZYX",xzy:"YZX",yxz:"ZXY",yzx:"XZY",zxy:"YXZ",zyx:"XYZ"},function(p){return wL[p]}),d.defineProperties(kh.prototype,{x:{get:function(){return this._x},set:function(p){this._x=p,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(p){this._y=p,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(p){this._z=p,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(p){this._order=p,this.onChangeCallback()}}}),d.assign(kh.prototype,{set:function(p,G,v,J,$){return lS(p)&&($=v,J=G,v=p[2],G=p[1],p=p[0]),J?$&&(J=kh.ReverseOrder(J)):J="ZYX",this._x=p||0,this._y=G||0,this._z=v||0,this._order=J||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(p){return this._x=p._x,this._y=p._y,this._z=p._z,this._order=p._order,this.onChangeCallback(),this},setFromRotationMatrix:function(p,G,v){var J=E.Math.clamp,$=(p=p.el||p)[0],S=p[4],O=p[8],W=p[1],l=p[5],t=p[9],z=p[2],Z=p[6],p=p[10];return"XYZ"===(G=G||this._order)?(this._y=Math.asin(J(O,-1,1)),Math.abs(O)<.99999?(this._x=Math.atan2(-t,p),this._z=Math.atan2(-S,$)):(this._x=Math.atan2(Z,l),this._z=0)):"YXZ"===G?(this._x=Math.asin(-J(t,-1,1)),Math.abs(t)<.99999?(this._y=Math.atan2(O,p),this._z=Math.atan2(W,l)):(this._y=Math.atan2(-z,$),this._z=0)):"ZXY"===G?(this._x=Math.asin(J(Z,-1,1)),Math.abs(Z)<.99999?(this._y=Math.atan2(-z,p),this._z=Math.atan2(-S,l)):(this._y=0,this._z=Math.atan2(W,$))):"ZYX"===G?(this._y=Math.asin(-J(z,-1,1)),Math.abs(z)<.99999?(this._x=Math.atan2(Z,p),this._z=Math.atan2(W,$)):(this._x=0,this._z=Math.atan2(-S,l))):"YZX"===G?(this._z=Math.asin(J(W,-1,1)),Math.abs(W)<.99999?(this._x=Math.atan2(-t,l),this._y=Math.atan2(-z,$)):(this._x=0,this._y=Math.atan2(O,p))):"XZY"===G?(this._z=Math.asin(-J(S,-1,1)),Math.abs(S)<.99999?(this._x=Math.atan2(Z,l),this._y=Math.atan2(O,$)):(this._x=Math.atan2(-t,p),this._y=0)):console.warn("unsupported order: "+G),this._order=G,!1!==v&&this.onChangeCallback(),this},setFromQuaternion:(PL=new eh,function(p,G,v){return PL.makeRotationFromQuaternion(p),this.setFromRotationMatrix(PL,G,v)}),setFromVector3:function(p,G){return this.set(p.x,p.y,p.z,G||this._order)},reorder:(dL=new wh,function(p){return dL.setFromEuler(this),this.setFromQuaternion(dL,p)}),equals:function(p){return p._x===this._x&&p._y===this._y&&p._z===this._z&&p._order===this._order},fromArray:function(p){return this._x=p[0],this._y=p[1],this._z=p[2],p[3]!==K&&(this._order=p[3]),this.onChangeCallback(),this},toArray:function(p,G){return(p=p===K?[]:p)[G=G===K?0:G]=this._x,p[G+1]=this._y,p[G+2]=this._z,p[G+3]=this._order,p},toVector3:function(p){return p?p.set(this._x,this._y,this._z):new m(this._x,this._y,this._z)},onChange:function(p){return this.onChangeCallback=p,this},onChangeCallback:function(){}}),{ms_ac:function(p,G){for(var v=G.ms_ac,J=0;J<v.length;J++)!function(p,v){var J="_"+v;p[GS(v)]=function(){return this[J]},p[vS(v)]=function(p){var G=this[J];this[J]=p,this.fp(v,G,p)}}(p,v[J])},ms_listener:function(p,G){p.addListeners=function(){var G=this,p=ti;N.mockTouch&&(p=Oi.concat(Wi).concat(li));for(var v=0,J=(G.__events__=p).length;v<J;v++){var $=p[v];"wheel"===$&&!G.handle_wheel&&G.handle_mousewheel&&(G.handle_wheel=function(p){LS(G,p)}),G["handle_"+$]&&function(G,p,v){function J(p){"mousedown"!==G&&"mouseup"!==G&&"touchstart"!==G&&"touchend"!==G||wA(p),v.disabled||v["handle_"+G](p)}var $="__"+G;v[$]||(v[$]=J,H0(p,G,J))}($,G.getView(),G)}},p.removeListeners=function(){var p=this.__events__;if(p){this.__events__=K;for(var G,v,J,$,S=0,O=p.length;S<O;S++)this["handle_"+p[S]]&&(G=p[S],v=this.getView(),0,($=this[J="__"+G])&&(_0(v,G,$),delete this[J]))}}},ms_fire:function(p,G){p.mp=function(p,G,v){this.addPropertyChangeListener(p,G,v)},p.ump=function(p,G){this.removePropertyChangeListener(p,G)},p.fp=function(p,G,v,J,$){return this.firePropertyChange(p,G,v,J,$)},p.addPropertyChangeListener=function(p,G,v){this._62I||(this._62I=new Um),this._62I.add(p,G,v)},p.removePropertyChangeListener=function(p,G){this._62I&&this._62I.remove(p,G)},p.firePropertyChange=function(p,G,v,J,$){if(J){if(J(G,v))return!1}else if(G===v)return!1;return(J=$||{}).property=p,J.oldValue=G,J.newValue=v,J.source=this,(J.data=this)._62I&&this._62I.fire(J),this.onPropertyChanged&&this.onPropertyChanged(J),!0}},ms_attr:function(p,G){p.a=function(p,G){if(2===arguments.length)this.setAttr(p,G);else{if(!OS(p))return this.getAttr(p);for(var v in p)this.setAttr(v,p[v])}return this},p.getAttr=function(p,G){if(G===K&&(G=1),this._attrObject&&p in this._attrObject)return this._attrObject[p];if(this.getImage){var v=this.getImage();if(JS(v)&&(v=bi[v]),OS(v)&&"dataBindings"in v)for(var J=v.dataBindings,$=J.length-1;0<=$;$--){var S=J[$];if(S.attr===p){if("defaultValue"in S)return S.defaultValue;break}}}return G?f[p]:K},p.setAttr=function(p,G){this._attrObject||(this._attrObject={});var v=this._attrObject[p];G===K?delete this._attrObject[p]:this._attrObject[p]=G,this.fp&&this.fp("a:"+p,v,G)&&this.onAttrChanged&&this.onAttrChanged(p,v,G)},p.getSerializableAttrs=function(){var p,G={};for(p in this._attrObject)G[p]=1;return G}},ms_bnb:function(p,G){p.getBodyColor=function(p){return p.s("body.color")},p.getBorderColor=function(p){return p.s("border.color")}},_51o:function(p,G){p.mi=function(p,G,v){this.addInteractorListener(p,G,v)},p.umi=function(p,G){this.removeInteractorListener(p,G)},p.fi=function(p){this.fireInteractorEvent(p)},p.addInteractorListener=function(p,G,v){this._63I||(this._63I=new Um),this._63I.add(p,G,v)},p.removeInteractorListener=function(p,G){this._63I&&this._63I.remove(p,G)},p.fireInteractorEvent=function(p){this._63I&&this._63I.fire(p)},p.setInteractors=function(p){var G=this._interactors;G&&G.each(function(p){p.tearDown()}),lS(p)&&(p=new o(p)),(this._interactors=p)&&p.each(function(p){p.setUp()}),this.fp("interactors",G,p),this.invalidateSelection()},p.getInteractors=function(){return this._interactors}},_49o:function(p,G){p._44O=v0,p._45O=v0,p.getTopPainters=function(){return this._44O},p.getBottomPainters=function(){return this._45O},p.addTopPainter=function(p){this._44O||(this._44O=new o),this._44O.contains(p)||(this._44O.add(p),this.redraw&&this.redraw())},p.removeTopPainter=function(p){this._44O&&(this._44O.remove(p),this.redraw&&this.redraw())},p.addBottomPainter=function(p){this._45O||(this._45O=new o),this._45O.contains(p)||(this._45O.add(p),this.redraw&&this.redraw())},p.removeBottomPainter=function(p){this._45O&&(this._45O.remove(p),this.redraw&&this.redraw())},p._93db=function(G,v){var J=this;J._45O&&J._45O.each(function(p){p.draw?p.draw(G,v):p.call(J,G,v)})},p._92db=function(G,v){var J=this;J._44O&&J._44O.each(function(p){p.draw?p.draw(G,v):p.call(J,G,v)})}},ms_sm:function(p,G){p.sm=function(){return this.getSelectionModel()},p.setSelectableFunc=function(p){this.sm().setFilterFunc(p)},p.getSelectableFunc=function(){return this.sm().getFilterFunc()},p.getSelectionModel=function(){return this._selectionModel||this.dm().sm()},p.isSelectionModelShared=function(){return!this._selectionModel},p.setSelectionModelShared=function(p){var G=this,v=G.sm(),J=!G._selectionModel,$=G.handleSelectionChange,S=G.dm();J!==p&&(G.invalidateSelection&&G.invalidateSelection(),p?(S.sm().ms($,G),G._selectionModel.ums($,G),G._selectionModel.dispose(),G._selectionModel=v0):(S.sm().ums($,G),G._selectionModel=new Qm(S),G._selectionModel.ms($,G)),G.onSelectionModelSharedChanged(),G.fp("selectionModelShared",J,p),G.fireViewEvent({kind:"selectionModelSharedChange",oldValue:J,newValue:p,oldSelectionModel:v,newSelectionModel:G.sm()}))},p.onSelectionModelSharedChanged=function(){this.redraw(),this.invalidateSelection&&this.invalidateSelection()},p.removeSelection=function(){var p=this.dm();p.beginTransaction(),this.sm().toSelection().each(p.remove,p),p.endTransaction()},p.selectAll=function(){var G=this;G.sm().ss(G.dm().toDatas(function(p){return G.isVisible(p)&&G.isSelectable(p)}))},p.isSelected=function(p){return this.sm().co(p)},p.isSelectedById=function(p){return!!(p=this.dm().getDataById(p))&&this.isSelected(p)},p.isSelectable=function(p){return this.sm().isSelectable(p)}},ms_tx:function(p,G){p._64I=0,p._65O=0,p.isScrollable=function(){return this.getWidth()<this._64I},p._40o=function(){return this.isScrollable()},p.getLogicalPoint=function(p){return RA(p,this._canvas||this._view,this.tx(),this.ty?this.ty():0)},p.tx=function(p){if(p===K)return this.getTranslateX();this.setTranslateX(p)},p.getTranslateX=function(){return this._65O},p.setTranslateX=function(p){var G=this.getWidth()-this._64I,G=(p=b0(p=0<(p=p<G?G:p)?0:p),this._65O);this._65O=p,this.fp(bl,G,p)}},ms_ty:function(p,G){p._23Q=0,p._66O=0,p._41o=function(){return this.getHeight()<this._23Q},p.getLogicalPoint=function(p){return RA(p,this._canvas||this._view,this.tx?this.tx():0,this.ty())},p.ty=function(p){if(p===K)return this.getTranslateY();this.setTranslateY(p)},p.getTranslateY=function(){return this._66O},p.setTranslateY=function(p){var G=this.getHeight()-this._23Q,G=(p=b0(p=0<(p=p<G?G:p)?0:p),this._66O);this._66O=p,this.fp(nl,G,p)}},ms_txy:function(p,G){p._65O=0,p._66O=0,p.tx=function(p){if(p===K)return this.getTranslateX();this.setTranslateX(p)},p.ty=function(p){if(p===K)return this.getTranslateY();this.setTranslateY(p)},p.onTranslateEnded=function(){},p.setTranslate=function(G,v,p){var J,$,S=this;(p=gS(p))?(S._65I&&S._65I.stop(!0),J=S.tx(),$=S.ty(),p.action=function(p){S.setTranslate(J+(G-J)*p,$+(v-$)*p)},p._37o=function(){delete S._66I,delete S._65I,S.onTranslateEnded()},S._66I=1,S._65I=HA(p)):(S.tx(G),S.ty(v))},p.getTranslateX=function(){return this._65O},p.setTranslateX=function(p){p=this.adjustTranslateX(p);var G=this._65O;this._65O=p,this.fp(bl,G,p)},p.getTranslateY=function(){return this._66O},p.setTranslateY=function(p){p=this.adjustTranslateY(p);var G=this._66O;this._66O=p,this.fp(nl,G,p)},p.adjustTranslateX=function(p){return b0(p)},p.adjustTranslateY=function(p){return b0(p)},p.translate=function(p,G,v){this.setTranslate(this.tx()+p,this.ty()+G,v)},p.getLogicalPoint=function(p){return RA(p,this._canvas||this._view,this.tx(),this.ty())}},ms_dm:function(p,G){p.dm=function(p){if(!p)return this.getDataModel();this.setDataModel(p)},p.getDataModel=function(){return this._dataModel}},ms_lp:function(p,G){p.lp=function(p){return this.getLogicalPoint(p)}},ms_v:function(p,G){p._disabled=!1,p.setDisabled=function(p,G){var v=this._disabled;v!==p&&(v&&(KA(this._63O),delete this._63O),p&&(KS(this._view,this._63O=pE(G)),this.iv()),this._disabled=p,this.fp("disabled",v,p))},p.isDisabled=function(){return this._disabled},p.getDisabledDiv=function(){return this._63O},p.getView=function(){return this._view},p.addToDOM=function(p){var G=this,v=G.getView(),J=v.style;(p=p||B.body).appendChild(v),J.left="0",J.right="0",J.top="0",J.bottom="0",H0(h,"resize",function(){G.iv()}),G.iv()},p.setCursor=function(p){"default"===p&&(p=this._defaultCursor||p);var G=this.getView().style;G.cursor=p,G.cursor="-webkit-"+p,G.cursor="-moz-"+p},p.getWidth=function(){return this._view.clientWidth},p.getHeight=function(){return this._view.clientHeight},p.setWidth=function(p){this._view.style.width=p+tJ,this.iv(),this.fp&&this.fp(_J,v0,p)},p.setHeight=function(p){this._view.style.height=p+tJ,this.iv(),this.fp&&this.fp(bJ,v0,p)},p.setFocus=function(p){var G=this._currentEditor;return!(p&&G&&(G=G.getView?G.getView():G).contains(p.target)||(lE(this._view),this.endEditing&&this.endEditing(),this.fireViewEvent("focus"),0))},p.iv=function(p){this.invalidate(p)},p.invalidate=function(p){this._68I||(this._68I=1,this._ivTimerId=XA(this._validateImpl,this,v0,p),this._ivTimerDelay=p,this.onInvalidated&&this.onInvalidated(),this.fireViewEvent("invalidate"))},p.validate=function(){var p=this._ivTimerId,G=this._ivTimerDelay;!1!==this._validateImpl()&&p&&qA(p,G)},p._validateImpl=function(){var p,G=this,v=G._view;if(!G._68I)return!1;delete G._68I,v.parentNode&&(0===v.offsetWidth&&0===v.offsetHeight&&G._67I!==v0?(G._67I===K&&(G._67I=N.reinvalidateCount),0<G._67I?G._67I--:G._67I=v0,G.iv()):(G.fireViewEvent("beginValidate"),G.validateImpl(),G.onValidated&&G.onValidated(),G.fireViewEvent("validate"),(p=G._63O)&&(v.lastChild!==p&&(KA(p),KS(v,p)),P(p,0,0,G.getWidth(),G.getHeight())),ai(G),Dm(G),Ip(G)))},p.layout=function(p,G,v,J){1===arguments.length?P(this,p):P(this,p,G,v,J)},p.addViewListener=function(p,G,v){this._67O||(this._67O=new Um),this._67O.add(p,G,v)},p.removeViewListener=function(p,G){this._67O.remove(p,G)},p.fireViewEvent=function(p){this._67O&&(JS(p)&&(p={kind:p}),this._67O.fire(p)),N.viewListener&&N.viewListener(this,p)}},ms_tip:function(p,G){p.setToolTipEnabled=function(p){p?u0||this._13o||(this.enableToolTip(),this.fp("toolTipEnabled",!1,!0)):this._13o&&(this.disableToolTip(),this.fp("toolTipEnabled",!0,!1))},p.isToolTipEnabled=function(){return!!this._13o},p.enableToolTip=function(){var p,v=this;u0||v._13o||(v._13o=function(p){var G;p.toolTipView||((G=(p.toolTipView=v).getToolTip(p))!=v0?(N.toolTipContinual&&N.isToolTipShowing()?Kh(p,G):(ah(),Bi={timeout:I0(gi,xh),e:p,info:G}),fi={e:p,view:v}):ah())},p=v.getView(),H0(p,Ul,v._13o),H0(p,"mouseleave",N.hideToolTip))},p.disableToolTip=function(){var p;this._13o&&(p=this.getView(),_0(p,Ul,this._13o),_0(p,"mouseleave",N.hideToolTip),delete this._13o)},p.getToolTip=function(p){return this.getDataAt?(p=this.getDataAt(p))?p.getToolTip():v0:this.getValue?this.getValue():void 0}},_52o:function(p,G){p._zoom=1,p._29I=xi,p.zoomIn=function(p,G){this.setZoom(this._zoom*JA,p,G)},p.zoomOut=function(p,G){this.setZoom(this._zoom/JA,p,G)},p.zoomReset=function(p,G){this.setZoom(1,p,G)},p.scrollZoomIn=function(p){this.setZoom(this._zoom*$A,v0,p)},p.scrollZoomOut=function(p){this.setZoom(this._zoom/$A,v0,p)},p.pinchZoomIn=function(p){this.setZoom(this._zoom*SA,v0,p)},p.pinchZoomOut=function(p){this.setZoom(this._zoom/SA,v0,p)},p.adjustZoom=function(p){return p<WA?WA:OA<p?OA:p},p.getZoom=function(){return this._zoom},p.setZoom=function(G,p,v){var J,$=this;(p=gS(p))?($._14o&&$._14o.stop(!0),J=$._zoom,p.action=function(p){$._96O(J+(G-J)*p,v)},p._37o=function(){delete $._zooming,delete $._14o,$.onZoomEnded()},$._zooming=1,$._14o=HA(p)):$._96O(G,v)},p._96O=function(p,G){var v,J;(p=this.adjustZoom(p))!==this._zoom&&(this.validate(),v=this._29I,J=this._zoom,0!==v.width&&0!==v.height&&(G=G||{x:v.x+v.width/2,y:v.y+v.height/2},this.tx((G.x-v.x)*J-G.x*p),this.ty((G.y-v.y)*J-G.y*p)),this._zoom=p,this.fp("zoom",J,p))}},ms_edge:function(p,G){p._2I=function(p){this._44I||(this._44I=new o),this._42I||(this._42I=new o),this._44I.add(p),this._42I.add(p),this._20I()},p._4I=function(p){this._44I||(this._44I=new o),this._43I||(this._43I=new o),this._44I.add(p),this._43I.add(p),this._20I()},p._16I=function(p){this._44I.remove(p),this._42I.remove(p),this._44I.isEmpty()&&delete this._44I,this._42I.isEmpty()&&delete this._42I,this._20I()},p._18I=function(p){this._44I.remove(p),this._43I.remove(p),this._44I.isEmpty()&&delete this._44I,this._43I.isEmpty()&&delete this._43I,this._20I()},p._20I=function(){var G,v=this;delete v._45I,!v._44I||v._44I.isEmpty()?delete v._70O:(v._44I.each(function(p){p.isLooped()&&!(G=G||{})[p._id]&&(v._45I||(v._45I=new o),v._45I.add(p),G[p._id]=p)}),G?(v._70O=new o,v._44I.each(function(p){G[p._id]?"A"!==G[p._id]&&(G[p._id]="A",v._70O.add(p)):v._70O.add(p)})):v._70O=v._44I)},p.hasAgentEdges=function(){return!!this._49I&&!this._49I.isEmpty()},p.getSourceAgentEdges=function(){return this._46I},p.getTargetAgentEdges=function(){return this._47I},p._1I=function(p){this._46I||(this._46I=new o),this._48I||(this._48I=new o),this._46I.add(p),this._48I.add(p),this._19I()},p._3I=function(p){this._47I||(this._47I=new o),this._48I||(this._48I=new o),this._47I.add(p),this._48I.add(p),this._19I()},p._15I=function(p){this._46I.remove(p),this._48I.remove(p),this._46I.isEmpty()&&delete this._46I,this._48I.isEmpty()&&delete this._48I,this._19I()},p._17I=function(p){this._47I.remove(p),this._48I.remove(p),this._47I.isEmpty()&&delete this._47I,this._48I.isEmpty()&&delete this._48I,this._19I()},p._19I=function(){var G,v=this,p=(delete v._49I,v._48I);p&&!p.isEmpty()&&(G={},p.each(function(p){G[p._id]?v._49I||(v._49I=new o):G[p._id]=p}),v._49I?p.each(function(p){G[p._id]&&(v._49I.add(p),delete G[p._id])}):v._49I=p)},p.getLoopedEdges=function(){return this._45I},p.getEdges=function(){return this._70O},p.getAgentEdges=function(){return this._49I},p.getSourceEdges=function(){return this._42I},p.getTargetEdges=function(){return this._43I},p._8I=function(){this._70O&&this._70O.each(function(p){p._7I()})}}}),Eh=(MS(N,{getVersion:function(){return"7.3.3"}},!0),function(p){return p.devicePixelRatio||(p.screen&&p.screen.logicalXDPI?p.screen.deviceXDPI/p.screen.logicalXDPI:1)}),yh=(MS(N,{numberDigits:5,crossOrigin:"",baseZIndex:K,isTouchable:u0,mockTouch:!0,devicePixelRatio:Eh(h),reinvalidateCount:3,hitMaxArea:3e3,imageCacheThreshold:20,autoMakeVisible:!0,autoHideScrollBar:!0,disabledOpacity:.4,disabledBackground:s.disabledBackground,forceHierarchicalSerialization:!0,extractBatchTranslation:!1,extractShapeTranslation:!1,extractPolylineTranslation:!1,extractVerticesTranslation:!1,envmapProbeMinWaitTime:300,envmapProbeMaxWaitTime:25e3,EnvmapTextureSize:1024,hoverDelay:600,clickDelay:200,toolTipDelay:800,toolTipContinual:!1,getDragger:function(){return fE},lineCap:"butt",lineJoin:"round",imageGradient:"linear.northeast",dashPattern:[16,16],blockMinSize:1,textExtraWidth:4,encodeStringKey:null,doubleClickSpeed:500,doubleClickRange:1,doubleTouchRange:20,touchMoveThreshold:10,animDuration:200,animEasing:function(p){return p*p},labelColor:e4,labelSelectColor:A4,labelFont:"12px arial, sans-serif",widgetIndent:u0?30:20,widgetRowHeight:u0?30:20,widgetHeaderHeight:u0?32:22,widgetTitleHeight:u0?34:24,scrollBarColor:z,scrollBarSize:7,scrollBarTimeout:1e3,scrollBarMinLength:20,scrollBarInteractiveSize:u0?32:16,zoomIncrement:1.3,scrollZoomIncrement:1.05,pinchZoomIncrement:1.08,pinchZoomThreshold:1,zoomMax:20,zoomMin:.01,segmentResolution:12,shapeResolution:24,shapeSide:24,intersectionLineRect:hS,intersectionLineLine:wS,isEnter:jE,isEsc:iE,isDelete:bE,isSpace:PE,isLeft:cE,isUp:hE,isRight:wE,isDown:dE,isTouchEvent:ZE,getTarget:function(p){return(ZE(p)?zE(p):p).target},isString:JS,isNumber:$S,isBoolean:SS,isArray:lS,isSelectAll:_E,isFunction:WS,isObject:OS,getPropertyValue:dS,setPropertyValue:PS,addMethod:MS,createGradient:function(p,G,v,J,$,S,O,W){return(0,z4[G])(p,v,J,$,S,O,W)},appendToScreen:function(p){p=p.getView?p.getView():p,(B.fullscreenElement||B.mozFullScreenElement||B.webkitFullscreenElement||B.msFullscreenElement||B.body).appendChild(p)},encodeString:function(p){return E.Math.encodeBase64(p,N.encodeStringKey)},decodeString:function(p){return E.Math.decodeBase64(p,N.encodeStringKey)},findView:function(p){function G(p,G){for(var v="2d"===G?wj.GraphView:Gp.Graph3dView,J=0,$=p.length;J<$;J++)if(p[J]instanceof v)return S[J];return null}var S=[];return function p(G,v){var J=v._ht,$=(J&&G.push(J),v.children),S=$.length;if(S)for(var O=0;O<S;O++)p(G,$[O])}(S,B.body),"all"===p?S:"2d"===p?G(S,"2d"):"3d"===p?G(S,"3d"):G(S,"3d")||G(S,"2d")},toggleFullscreen:function(G){var v,J,$,S,O,W,l,p,t,z,Z=G.getView();B.fullscreenElement||B.mozFullScreenElement||B.webkitFullscreenElement||B.msFullscreenElement?B.exitFullscreen?B.exitFullscreen():B.msExitFullscreen?B.msExitFullscreen():B.mozCancelFullScreen?B.mozCancelFullScreen():B.webkitExitFullscreen&&B.webkitExitFullscreen():(v=!0,z=G.isSelfViewEvent?(J=G.getX(),$=G.getY(),W=G.getWidth(),l=G.getHeight(),p=Z.style.background,t=Z.style.backgroundColor,p||t||(Z.style.backgroundColor="white"),Z.requestFullscreen?Z.requestFullscreen():Z.msRequestFullscreen?Z.msRequestFullscreen():Z.mozRequestFullScreen?Z.mozRequestFullScreen():Z.webkitRequestFullscreen&&Z.webkitRequestFullscreen(),setInterval(function(){var p;Z!==(B.fullscreenElement||B.mozFullScreenElement||B.webkitFullscreenElement||B.msFullscreenElement)?(clearInterval(z),G.setX(J),G.setY($),G.setWidth(W),G.setHeight(l),G._fullscreen=!1,Z.style.oldBackgroundColor=t,G.iv()):(p=E.Default.getWindowInfo(),!v&&p.width===G.getWidth()&&p.height===G.getHeight()||(G.setX(p.left),G.setY(p.top),G.setWidth(p.width),G.setHeight(p.height),G._fullscreen=!0,G.iv(),v=!1))},500)):(S=Z.style.left,O=Z.style.top,W=Z.style.width,l=Z.style.height,p=Z.style.background,t=Z.style.backgroundColor,p||t||(Z.style.backgroundColor="white"),Z.requestFullscreen?Z.requestFullscreen():Z.msRequestFullscreen?Z.msRequestFullscreen():Z.mozRequestFullScreen?Z.mozRequestFullScreen():Z.webkitRequestFullscreen&&Z.webkitRequestFullscreen(),setInterval(function(){var p;Z!==(B.fullscreenElement||B.mozFullScreenElement||B.webkitFullscreenElement||B.msFullscreenElement)?(clearInterval(z),Z.style.left=S,Z.style.top=O,Z.style.width=W,Z.style.height=l,Z.style.oldBackgroundColor=t,G.iv()):(p=E.Default.getWindowInfo(),!v&&p.width===G.getWidth()&&p.height===G.getHeight()||(P(G),v=!1))},500)))},appendTimeStamp:function(p){return p},setCompType:function(p,G){JS(G)&&G.substr(0,12)==Si&&(G=N.parse(G)),WS(G)||OS(G)?hi[p]=G:Ym(p)},getCompType:function(p){var G=hi[p];return G===K&&ji.test(p)&&Ym(p),G},getCompTypeMap:function(){return hi},drawCompType:function(p,G,v,J,$,S){p(G,v,J,$,S)},numberListener:(mL={46:1,8:1,9:1,27:1,13:1,109:1,110:1,189:1,190:1},function(p){var G=p.keyCode;mL[G]||65===G&&N.isCtrlDown(p)||86===G&&N.isCtrlDown(p)||67===G&&N.isCtrlDown(p)||88===G&&N.isCtrlDown(p)||35<=G&&G<=40||(p.shiftKey||G<48||57<G)&&(G<96||105<G)&&p.preventDefault()}),ignoreKeyCodes:[122,123],preventDefault:function(p){var G=p.target.tagName;"DIV"!==G&&"CANVAS"!==G||0<=N.ignoreKeyCodes.indexOf(p.keyCode)||!("keydown"!==p.type||cE(p)||wE(p)||hE(p)||dE(p)||bE(p)||65===p.keyCode&&(p.metaKey||p.ctrlKey))||!0!==p.cancelable||(p.preventDefault(),p.preventManipulation&&p.preventManipulation())},getWindowInfo:function(){var p=B.documentElement;return{target:p=p&&(p.scrollLeft||p.scrollTop)?p:B.body,left:p.scrollLeft,top:p.scrollTop,width:h.innerWidth||p.clientWidth,height:h.innerHeight||p.clientHeight}},isDragging:function(){return!!fE},isLeftButton:function(p){return!!ZE(p)||0===p.button},isMiddleButton:function(p){return!ZE(p)&&p&&(1===p.button||4&(p.buttons||0))},isRightButton:function(p){return!ZE(p)&&p&&(2===p.button||2&(p.buttons||0))},isInput:function(p){return!!p&&("INPUT"===(p=p.tagName)||"TEXTAREA"===p||"SELECT"===p)},getTouchCount:function(p){return ZE(p)?p.touches.length:1},isDoubleClick:(NL={},K0=new Z,D=K0.getTime(),function(p){if(1<hA(p))return!1;var G=p.button==v0?"":p.button,v=(G=p.type+G)+"_isDoubleClick",J=(J=NL[G])||(NL[G]={details:0,timeout:null,lastPoint:null});return p[v]===K&&(p[v]=!0,G=i(p),J.timeout&&(E0(J.timeout),J.timeout=null),v=ZE(p)?N.doubleTouchRange:N.doubleClickRange,J.lastPoint&&iA(J.lastPoint,G)>v&&bM(J),J.lastPoint=G,J.details++,J.timeout=I0(function(){bM(this)}.bind(J),N.doubleClickSpeed)),2===J.details}),isShiftDown:function(p){return p?p.shiftKey:ci[16]},isCtrlDown:function(p){return p?a0?p.metaKey:p.ctrlKey:a0?ci[91]:ci[17]},getClientPoint:function(p){return{x:(p=ZE(p)?zE(p):p).clientX,y:p.clientY}},isMouseEvent:function(p){return p instanceof MouseEvent||0===p.type.indexOf("mouse")},getTargetElement:function(p){var G=jA(p),v=N.isMouseEvent(p)||!B.elementFromPoint?p.target:B.elementFromPoint(G.x,G.y);if(R0&&B.elementFromPoint){for(var J=[],$=[];"none"===v.style.pointerEvents;)J.push(v),$.push(v.style.display||""),v.style.display="none",v=B.elementFromPoint(G.x,G.y);J.forEach(function(p,G){p.style.display=$[G]})}return v},getPagePoint:function(p){return{x:(p=ZE(p)?zE(p):p).pageX,y:p.pageY}},createObject:function(p,G){var v,J=new p;for(v in G){var $,S=G[v];WS(S)?J[v]=S:0===v.indexOf("s:")?J.s(v.substr(2),G[v]):0===v.indexOf("a:")?J.a(v.substr(2),G[v]):($=vS(v),S=G[v],J[$]?(J[$](S),"setToolTip"===$&&J.enableToolTip&&J.enableToolTip()):J[v]=S)}return J},setImage:function(p,G,v,J){var $=arguments.length;4===$?ui(p,J,G,v):2===$?JS(G)?G.substr(0,12)==Si?Ki(p,N.parse(G)):ui(p,G):Ki(p,G):1===$&&ui(p,p)},getImage:function(p,G,v){var J,$;return p==v0?v0:(OS(p)?J=p:(J=bi[p],!p||J!==K||Ni&&Ni[p]||ui(p,p)),G&&J&&J.tagName?(J[p="override"===v?"colors_override":"override_rgb"===v?"colors_override_rgb":"override_a"===v?"colors_override_a":"colors"]||(J[p]={__count__:0}),($=J[p][G])||(J[p].__count__>N.imageCacheThreshold&&(J[p]={__count__:0}),$=function(p,G,v,J,$){var S=xS(),O=(S.width=v,S.height=J,S.getContext("2d"));O.drawImage(p,0,0,v,J);try{for(var W=O.getImageData(0,0,v,J),l=W.data,t=0,z=l.length;t<z;t+=4){var Z=l[t+0],B=l[t+1],f=l[t+2],X=l[t+3];"override_a"===$?l[t+3]=255*G[3]:"override_rgb"===$?(l[t+0]=255*G[0],l[t+1]=255*G[1],l[t+2]=255*G[2]):"override"===$?(l[t+0]=255*G[0],l[t+1]=255*G[1],l[t+2]=255*G[2],l[t+3]=255*G[3]):(l[t+0]=G[0]*Z,l[t+1]=G[1]*B,l[t+2]=G[2]*f,l[t+3]=G[3]*X)}O.putImageData(W,0,0)}catch(G){return p}return S}(J,yE(G),J.width,J.height,v),J[p][G]=$,J[p].__count__++),$):J)},isImageComplete:function(p,G,v){var J=T(p);if(!J)return!1;if(J.tagName)return J.complete;for(var $=J.comps,S=!0,O=0,W=$.length;O<W;O++){var l,t=(l=$[O]).type;if("image"===l.type){if((p=l.name)&&p.func&&(p=V(p,G)),!zA(p,G,v)){S=!1;break}}else if(ji.test(t)&&N.getCompType(t)===K){S=!1,Ym(t);break}}return S},getId:(RL=1,function(){return++RL}),callLater:function(p,G,v,J){function $(){p.apply(G,v)}return J?I0($,J):h.requestAnimationFrame($)},cancelLater:function(p,G){G?E0(p):h.cancelAnimationFrame(p)},clone:function(p){if(null==p||"object"!=typeof p)return p;if(p instanceof Date)return(G=new Date).setTime(p.getTime()),G;if(p instanceof Array){for(var G=[],v=0,J=p.length;v<J;v++)G[v]=MA(p[v]);return G}if(p instanceof o){for(G=new o,v=0,J=p.length;v<J;v++)G.set(v,MA(p.get(v)));return G}if(p instanceof Fm)return p;if(p instanceof Cm)return(G=new Cm).deserialize(p.serialize()),G;if(p instanceof d){var $,G={};for($ in p)p.hasOwnProperty($)&&(G[$]=MA(p[$]));return G}return p},callWhenLoaded:function(p,G){var v=Hi(p,G=G||100);(Li=Li||{})[v]={tick:v,cb:p,delay:G}},beforeLoadURL:function(p,G){if(Li){var v={};for(G in Li){var J=Li[G],$=(E0(J.tick),Hi(J.cb,J.delay));v[$]={tick:$,delay:J.delay,cb:J.cb}}Li=v}return N.convertURL?N.convertURL(p,G):p},convertURL:function(p){return p},handleRefGraphLoaded:function(p,G,v){},handleCompTypeLoaded:function(p,G){},handleImageLoaded:function(p,G){},handleUnfoundImage:function(p,G){return N.getImage("default_blank")},resizeImage:function(p,G,v,J){v=v||G;var $=(J=J||xS()).getContext("2d");return mS(J,G,v,1),$.drawImage(p,0,0,G,v),J},resizeImagePOT:function(p,G,v){if(!p||!p.tagName)return p;var J,$=p.width,S=p.height;return $&&S&&(!sh.isPOT($)||!sh.isPOT(S)||G&&$!==S)?(G=G?J=sh.nearestPOT(Math.min($,S)):(J=sh.nearestPOT($),sh.nearestPOT(S)),N.resizeImage(p,J,G,v)):p},sortFunc:function(p,G){if(p===G)return 0;if(p==v0&&G!=v0)return 1;if(p!=v0&&G==v0)return-1;if(p==v0&&G==v0)return 0;var v,J=typeof p,$=typeof G;return J==xl&&$==xl?v=p.localeCompare(G):J==Kl&&$==Kl&&(v=p-G),0<(v=v===K?(""+p).localeCompare(""+G):v)?1:v<0?-1:0},getClassMap:function(){return _i},getClass:function(p){if(JS(p)){if(!(v=_i[p])){for(var G=p.split("."),v=h,J=0;J<G.length;J++)v=v[G[J]];_i[p]=v}return v}return p},def:function(p,G,v){function J(){}var $,S,O;if(J.prototype=G.prototype,$=new J,JS(p)){if(_i[p])throw"'"+p+"' already defined";O=LA(p),$.getClassName=function(){return p}}else O=p;if($.constructor=O,$.getClass=function(){return O},$.getSuperClass=function(){return G},v)for(S in v)Ih[S]&&Ih.hasOwnProperty(S)?Ih[S]($,v):H4($,v,S);O.prototype=$,O.superClass=G.prototype},startAnim:function(G){return(G=MA(G)).easing=G.easing||N.animEasing,G.duration||G.frames||(G.duration=N.animDuration),G.t=0,G.duration?G.interval=0:(G.frame=0,G.interval=G.interval||10),G.tick=function(){var p;G.duration?(p=(Vi()-G.startTime)/G.duration,G.t=p=1<p?1:p,G.action(G.easing(p),p),G.isRunning()&&(1===p?G.stop():G._isPaused||(G.timeId=XA(G.tick)))):(G.frame++,p=G.t=G.frame/G.frames,G.action(G.easing(p),p),G.isRunning()&&(G.frame<G.frames?G._isPaused||(G.timeId=XA(G.tick,v0,v0,G.interval)):G.stop()))},G.resume=function(){G._isPaused&&(delete G._isPaused,G.duration?G.t<1&&(G.startTime=Vi()-G.duration*G.t,G.timeId=XA(G.tick)):G.frame<G.frames&&(G.timeId=XA(G.tick,v0,v0,G.interval)))},G.pause=function(){qA(G.timeId,!G.duration),G._isPaused=!0},G.isPaused=function(){return this._isPaused},G.stop=function(p){G.isRunning()&&(qA(G.timeId,!G.duration),delete G.timeId,G.duration?G.t<1&&p&&(G.t=1,G.action(G.easing(1),1)):G.frame<G.frames&&p&&(G.frame=G.frames,G.action(G.easing(1),1)),G._37o&&G._37o(),G.finishFunc&&G.finishFunc())},G.isRunning=function(){return G.timeId!=v0},G.delay?XA(_M,v0,[G],G.delay):_M(G),G},getTextSize:(yL={},xL=B?xS().getContext("2d"):v0,function(p,G){return xL.font=p||Uh,(p=yL[xL.font])||(p=2*xL.measureText("e").width+4,yL[xL.font]=p),{width:xL.measureText(G).width+N.textExtraWidth,height:p}}),drawText:function(p,G,v,J,$,S,O,W,l,t,z){var Z,B;G!=v0&&(Z=DA(v,G),(B={}).y=t&&t!==$J?t===pJ?S+Z.height/2:S+W-Z.height/2:S+W/2,B.x=l&&l!==C0?l===Q0?$+O-Z.width/2:$+O/2:$+Z.width/2,US(p,G,B,v,J),z&&TS(p,G,v,J,B.x,B.y,Z.width,z))},getDistance:function(p,G){var v=p.length;return G?3===v?Y0(k0(p[0]-G[0])+k0(p[1]-G[1])+k0(p[2]-G[2])):2===v?Y0(k0(p[0]-G[0])+k0(p[1]-G[1])):p.z===K?Y0(k0(G.x-p.x)+k0(G.y-p.y)):Y0(k0(G.x-p.x)+k0(G.y-p.y)+k0(G.z-p.z)):3===v?Y0(k0(p[0])+k0(p[1])+k0(p[2])):2===v?Y0(k0(p[0])+k0(p[1])):void 0},brighter:function(p,G){return TE(p,(G=G<0?-G:G)||40)},darker:function(p,G){return TE(p,(G=0<G?-G:G)||-40)},unionPoint:function(p,G){if(!p)return v0;if(2===arguments.length)return p&&G?{x:$0(p.x,G.x),y:$0(p.y,G.y),width:I(p.x-G.x),height:I(p.y-G.y)}:v0;var v=p;if((v=v._as||v).length===K)return v0;var J=v.length;if(J<=0)return v0;for(var $=1,S={x:(O=v[0]).x,y:O.y,width:0,height:0};$<J;$++){var O=v[$],W=$0(S.x,O.x),l=J0(S.x+S.width,O.x),t=$0(S.y,O.y),z=J0(S.y+S.height,O.y);S.x=W,S.y=t,S.width=l-W,S.height=z-t}return S},unionRect:function(p,G){return p&&!G?MA(p):!p&&G?MA(G):p&&G?((v={x:$0(p.x,G.x),y:$0(p.y,G.y)}).width=J0(p.x+p.width,G.x+G.width)-v.x,v.height=J0(p.y+p.height,G.y+G.height)-v.y,v):v0;var v},containsPoint:function(p,G,v,J){var $,S,O,W;return J!=v0&&1!==J&&($=p.x+p.width/2,S=p.y+p.height/2,p={x:$-p.width/2*J,y:S-p.height/2*J,width:p.width*J,height:p.height*J}),v?($=p.width/2,S=p.height/2,J=O0(-v),v=S0(-v),O=G.x-p.x-$,W=G.y-p.y-S,AA({x:-$,y:-S,width:p.width,height:p.height},G={x:v*O-J*W,y:J*O+v*W})):!(!p||G.x<p.x||G.y<p.y||G.x>p.x+p.width||G.y>p.y+p.height)},containsRect:function(p,G){if(!p||!G)return!1;var v=G.x,J=G.y,$=G.width,G=G.height,S=p.width,O=p.height;if((S|O|$|G)<0)return!1;var W=p.x,p=p.y;if(v<W||J<p)return!1;if(S+=W,($+=v)<=v){if(W<=S||S<$)return!1}else if(W<=S&&S<$)return!1;if(O+=p,(G+=J)<=J){if(p<=O||O<G)return!1}else if(p<=O&&O<G)return!1;return!0},intersectsRect:function(p,G){if(!p||!G)return!1;var v=G.width,J=G.height,$=p.width,S=p.height;if($<=0||S<=0||v<=0||J<=0)return!1;var O=G.x,G=G.y,W=p.x;return S+=p=p.y,v+=O,J+=G,O<($+=W)&&G<S&&W<v&&p<J},intersection:function(p,G){if(!p||!G)return v0;var v=G.x,J=G.y,$=p.x,S=p.y,O=v,W=J,l=$,t=S;return O+=G.width,W+=G.height,(l+=p.width)<O&&(O=l),(t+=p.height)<W&&(W=t),W-=J=J<S?S:J,(O-=v=v<$?$:v)<=0||W<=0?v0:{x:v,y:J,width:O,height:W}},grow:function(p,G,v){v===K&&(v=G),p.x-=G,p.y-=v,p.width=p.width+2*G,p.height=p.height+2*v},getScreenPoint:function(p,G,v,J,$,S,O){var W=v.getBoundingClientRect(),p=p*(S||1)-v.scrollLeft+(J||0),S=G*(O||1)-v.scrollTop+($||0);return(J=L4(v,!1))?((G=new m(p,S,0)).applyMatrix4(J),console.log(G),{x:G.x,y:G.y}):{x:p+W.left,y:S+W.top}},getLogicalPoint:function(p,G,v,J,$,S){var O,W=G.getBoundingClientRect(),l=p.target?(PA(p)?a0?ci[91]=!0:ci[17]=!0:a0?ci[91]=!1:ci[17]=!1,dA(p)?ci[16]=!0:ci[16]=!1,O=(p=ZE(p)?zE(p):p).clientX,p.clientY):(O=p.x,p.y);if(p=L4(G,!0)){var t=new m(O,l,0);t.applyMatrix4(p);do{if(Math.abs(t.z)<=1e-6)break;var z=new m(O,l,1);if(z.applyMatrix4(matrix),Math.abs(z.z)<=1e-6){t=z;break}}while(z.sub(t),!(Math.abs(z.z)<=1e-6)&&(t.addScaledVector(z,-t.z/z.z),0));return{x:(t.x+G.scrollLeft-(v||0))/($||1),y:(t.y+G.scrollTop-(J||0))/(S||1)}}return{x:(O-W.left+G.scrollLeft-(v||0))/($||1),y:(l-W.top+G.scrollTop-(J||0))/(S||1)}},removeHTML:function(p){return!(!(p=p&&p.getView?p.getView():p)||!p.parentNode||(EL!==p&&((EL=p).parentNode.removeChild(p),EL=v0),0))},getToolTipDiv:function(){var p;return zi||(zi=yS(),Zi=yS(),p=zi.style,N.baseZIndex!=v0&&(p.zIndex=r0(N.baseZIndex)+3+""),p.whiteSpace="nowrap",p.color=N.toolTipLabelColor,p.background=N.toolTipBackground,p.font=N.toolTipLabelFont,p.padding="5px",p.boxShadow="0px 0px 3px "+N.toolTipShadowColor),zi},isToolTipShowing:function(){return!(!zi||!zi.parentNode)||!(!Zi||!Zi.parentNode)},updateToolTipContent:function(p,G){N.isToolTipShowing()&&(G=G||fi&&fi.view,(p=p===K&&G&&fi.e?G.getToolTip(fi.e):p)!=v0&&((p.html?(p=p.html,Zi):zi).innerHTML=p))},hideToolTip:function(){var p;qi(),N.isToolTipShowing()&&(KA(zi),KA(Zi),(p=fi&&fi.view)&&p.onHideToolTip&&p.onHideToolTip(),fi=v0)},showToolTip:function(p,G,v){var J,$,S,O,W,l;p&&G!=v0?(N.getToolTipDiv(),G.html?(G=G.html,J=Zi,KA(zi)):(J=zi,KA(Zi)),$=J.style,J.innerHTML="",G instanceof HTMLElement?J.appendChild(G):J.innerHTML=G,J.parentNode||E.Default.appendToScreen(J),p.target?(p=jA(p),G=yA(),S=p.x,O=p.y,W=u0?60:12,u0?(l=J.getBoundingClientRect(),$.left=S-l.width/2+tJ,O-l.height-W<G.top?$.top=O+W+tJ:$.top=O-l.height-W+tJ):($.left=S+W+tJ,$.top=O+W+tJ,(l=J.getBoundingClientRect()).left+l.width>G.width&&($.left=S-W-l.width+tJ),l.top+l.height>G.height&&($.top=O-W-l.height+tJ),l.left<0&&($.left=S+W+tJ),l.top<0&&($.top=O+W+tJ))):($.left=p.x+tJ,$.top=p.y+tJ),qi(),v===K?v=fi&&fi.view:fi={e:p,view:v},v&&v.onShowToolTip&&v.onShowToolTip()):ah()},startDragging:function(p,G,v){v==K&&(v=!0),p!==fE&&(fE?v&&(ZE(G)?fE.handleWindowTouchEnd(G):fE.handleWindowMouseUp(G)):ZE(G)?(H0(h,pi,XE),H0(h,Gi,qE),H0(h,"blur",qE)):(H0(h,Ul,gE),H0(h,Fl,ME),H0(h,"blur",ME)),fE=p)},getImageMap:function(){return bi},toBoundaries:function(p,G,v,J){var $=[];return aE(p,G,v,J).forEach(function(p){var G=[];p.forEach(function(p){G.push(p.x,p.y)}),$.push(G)}),$},getCurrentKeyCodeMap:function(){return ci},drawCenterImage:function(p,G,v,J,$,S,O,W){!$&&S&&S.isSelfViewEvent&&($=S);var l=Am(G,$,S),t=km(G,$,S);Im(p,G,b0(v-l/2),b0(J-t/2),l,t,$,S,O,W)},drawStretchImage:function(p,G,v,J,$,S,O,W,l,t,z,Z){!W&&l&&l.isSelfViewEvent&&(W=l);var B,f,X,q=Am(G,W,l,S),g=km(G,W,l,O),M=("uniform"===v?(g*=M=$0(S/q,O/g),J+=b0((S-(q*=M))/2),$+=b0((O-g)/2),S=q,O=g):"centerUniform"===v&&((S<q||O<g)&&(q*=M=$0(S/q,O/g),g*=M),J+=b0((S-q)/2),$+=b0((O-g)/2),S=q,O=g),p.interactiveInfo);M&&(f="center"===v?{x:J+S/2-q/2,y:$+O/2-g/2,width:q,height:g}:{x:J,y:$,width:S,height:O},M.rect?(B=(X=M.compInfos).length)&&(X[B-1].rect.image=G):M.rect=f),"center"===v?((X=!1!==z&&(S<q||O<g))&&(p.save(),p.beginPath(),p.rect(J,$,S,O),p.clip()),Im(p,G,J+S/2-q/2,$+O/2-g/2,q,g,W,l,t,Z),X&&p.restore()):Im(p,G,J,$,S,O,W,l,t,Z)},toCanvas:function(p,G,v,J,$,S,O,W,l){p=T(p,O),G=G||Am(p,$),v=v||km(p,$);var t=xS(),z=GE(t);return W?(mS(t,G,v,W),z.scale(W,W)):mS(t,G,v,1),BA(z,p,J,0,0,G,v,$,S,O,l),p&&p.clampToEdge&&(t.clampToEdge=p.clampToEdge),z.restore(),t},toGrayColor:function(p){if(!p)return p;var p=EE(p),G=b0(.299*p[0]+.587*p[1]+.114*p[2]);return"rgba("+G+","+G+","+G+","+p[3]/255+")"},createGradientImage:function(p,G,v,J){for(var $=["L",0,0,p,0,1,0,0,1,0,0],S=0,O=Math.min(G.length,v.length);S<O;S++)$.push(v[S],G[S]);return E.Default.toCanvas({width:p,height:p,clampToEdge:!0,comps:[{type:"shape",rotation:J||0,points:[0,0,p,0,p,p,0,p],background:"#ffffff",gradientPack:$}]})},createElement:function(p,G,v,J){return p=B.createElement(p),RS(p,G||s.widgetBorder,2),p.style.font=v||Uh,J!=v0&&(p.value=J),N.onElementCreated&&N.onElementCreated(p),p},containedInView:function(p,G){return G=tE(G).getBoundingClientRect(),AA({x:G.left,y:G.top,width:G.width,height:G.height},i(p))},isIsolating:function(){return 0<Mi},setIsolating:function(p){p?Mi++:Mi--},getMSMap:function(){return Ih},stringify:function(p,G,v){var J=Date.prototype.toJSON,$=(Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()},Cm.prototype.toJSON),p=(Cm.prototype.toJSON=function(){return"__ht__dataModel"+this.serialize(0)},G=v?0:G==v0?2:G,JSON.stringify(p,function(p,G){return"function"==typeof G?"__ht__"+(G.__ht__||G.toString()):$S(G)?G==v0||N.numberDigits==v0?G:parseFloat(G.toFixed(N.numberDigits)):G instanceof E.List?"__ht__list"+(G.__ht__list||N.stringify(G._as)):G},G));return Date.prototype.toJSON=J,Cm.prototype.toJSON=$,v?Si+function(p){for(var G=8+sh.randomInt(8),v=_h[8*sh.randomInt(8)+(G-8)],J="",$=0;$<G;$++)J+=_h[sh.randomInt(64)];var S=p4(J+l0+"__"+sl);return v+J+bh(p,S)}(p):p},parse:function(p,W){return JS(p)&&(p.substr(0,12)!=Si||(p=function(p){var G=p[0];if((G=_h.indexOf(G))<0)return"";var v=p.slice(1,1+(G=8+(7&G))),v=p4(v+l0+"__"+sl);return nh(p,v,1+G)}(p.substr(12)),JS(p)))?(W=W||{},JSON.parse(p,function(p,G){if(JS(G))if(W.ignoreFunction||"__ht__function"!=G.substr(0,14)){if(!W.ignoreDate&&"__ht__date"==G.substr(0,10))return new Date(r0(G.substr(10)));if("__ht__list"===G.substr(0,10))return new o(N.parse(G.substr(10)));if(!W.ignoreDataModel&&"__ht__dataModel"===G.substr(0,15))return(v=new Cm).deserialize(N.parse(G.substr(15))),v}else{var v=G.indexOf("{")+1,J=G.lastIndexOf("}"),$=G.indexOf("(")+1,S=G.indexOf(")");if(v&&J&&$&&S)try{var O=new Function(G.substring($,S),G.substring(v,J));return O.__ht__=G.substr(6),O}catch(p){throw console.info("=== SyntaxError ===\n",G),p}}return G})):p},loadJS:function(p,G){G&&p.push(G);var v,G=p.shift();lS(G)?(p=G.contact(p),N.loadJS(p)):WS(G)?(G(),N.loadJS(p)):JS(G)?((v=B.createElement("script")).onload=function(){N.loadJS(p)},v.setAttribute("src",G),B.getElementsByTagName("head")[0].appendChild(v)):p.length&&N.loadJS(p)},extendClass:function(p,G){var v,J=p.prototype;for(v in G)Ih[v]&&Ih.hasOwnProperty(v)?Ih[v](J,G):J[v]=G[v]},toRoundedCorner:(eL=new m,AL=new m,kL=new m,IL=new m,function(p,G){var v,J=0,$=(p.getPoints&&(J=p.getElevation(),p=p.getPoints()),(v=p instanceof o?p:new o(p)).size());if(G<=0)return{points:v};var S=new o,O=new o,W=v.get(0);HM(eL,W,J),S.add(W),O.add(1);for(var l,t,z=1;z<$;z++)z+1<$?(l=v.get(z),t=v.get(z+1),HM(AL,l,J),HM(kL,t,J),IL.subVectors(eL,AL).setLength(Math.min(.99*IL.length(),G)).add(AL),l.e!==K||W.e!==K?S.add({x:IL.x,y:IL.z,e:IL.y}):S.add({x:IL.x,y:IL.z}),S.add(l),IL.subVectors(kL,AL).setLength(Math.min(.99*IL.length(),G)).add(AL),l.e!==K||t.e!==K?S.add(W={x:IL.x,y:IL.z,e:IL.y}):S.add(W={x:IL.x,y:IL.z}),eL.copy(IL),O.addAll([2,3])):(S.add(v.get(z)),O.add(2));return{points:S,segments:O}}),toColorData:EE,setCanvas:mS,createDiv:yS,createDisabledDiv:pE,createView:ES,createCanvas:xS,appendChild:KS,initContext:GE,checkLoadingImage:ai,translateAndScale:vE,layout:P,getPosition:b4,drawPoints:KE,drawRoundRect:v4,drawBorder:J4,setFocus:lE,getter:GS,setter:vS,isEmptyObject:nS,cameraPriority:(rL={skybox:0,main:1e4,top:1e7,infinity:1/0},d.seal(d.defineProperties({},{skybox:{configurable:!1,enumerable:!1,get:function(){return rL.skybox},set:function(p){if(p>=rL.main)throw new RangeError("Skybox camera must have lower priority than the main camera.");rL.skybox=Number(p)}},main:{configurable:!1,enumerable:!1,get:function(){return rL.main},set:function(p){if(p<=rL.skybox)throw new RangeError("Main camera must have higher priority than the skybox camera.");if(p>=rL.top)throw new RangeError("Main camera must have lower priority than the top camera.");rL.main=Number(p)}},top:{configurable:!1,enumerable:!1,get:function(){return rL.top},set:function(p){if(p<=rL.main)throw new RangeError("Top camera must have higher priority than the main camera.");rL.top=Number(p)}}}))),addFontFace:(jL={ttf:"truetype",otf:"opentype",eot:"embedded-opentype"},iL={eot:0,woff2:1,woff:2,ttf:3,otf:4},function(p,G,v,J){if(p){var $;if(J&&N.removeFontFace(p,!0),J=ni[p])return J.parentNode||B.head.appendChild(J),void(v&&v(J));0!==(G=(G=JS(G)?[G]:G).filter(function(p){return!!JS(p)&&0<p.length})).length&&(G=G.map(MM),$="",G.sort(LM).forEach(function(p){$+=", "+p.url}),$=$.substr(2),(J=B.createElement("style")).innerText='@font-face{font-family: "'+p+'";src: '+$+";}",B.head.appendChild(J),ni[p]=J,v&&v(J))}}),clearFontFace:function(){if(!nS(ni)){for(var p in ni)N.removeFontFace(p);ni={}}},removeFontFace:function(p,G){if(p){var v=p;if(v.tagName){if(KA(v),G){var J,$=[];for(J in ni)ni[J]===v&&$.push(J);if(0<$.length)for(var S=0,O=$.length;S<O;S++)delete ni[$[S]]}}else(v=ni[p])&&(KA(v),G&&delete ni[p])}},getFontFaceMap:function(){return ni},handleFontFacesLoaded:function(p){}},!0),B&&B.fonts&&B.fonts.addEventListener&&B.fonts.addEventListener("loadingdone",function(p){N.handleFontFacesLoaded(p.fontfaces),N.findView("all").forEach(function(p){p.redraw?p.redraw():p.iv()})}),MS(g,{autoAdjustIndex:1,hierarchicalRendering:1,adjustChildrenToTop:1,autoHideScrollBar:1,autoUpdate:1,firstPersonMode:1,ortho:1,strict:1,stickToRight:1,instant:1,closePath:1,hierarchical:1,doubleClickToToggle:1,continuousLayout:1,syncSize:1},!0),N.disabledOpacity),xh=N.toolTipDelay,Rh=N.devicePixelRatio,E4=N.autoMakeVisible,Nh=N.autoHideScrollBar,mh=N.imageGradient,Kh=N.showToolTip,ah=N.hideToolTip,uh=N.dashPattern,Th=N.lineCap,Vh=N.lineJoin,oh=N.labelColor,e0=N.labelSelectColor,Uh=N.labelFont,Fh=N.widgetIndent,e4=N.widgetRowHeight,Ch=N.widgetHeaderHeight,Qh=N.widgetTitleHeight,A4=N.scrollBarColor,Z=N.scrollBarSize,pA=N.scrollBarTimeout,GA=N.scrollBarMinLength,vA=N.scrollBarInteractiveSize,JA=N.zoomIncrement,$A=N.scrollZoomIncrement,SA=N.pinchZoomIncrement,OA=N.zoomMax,WA=N.zoomMin,lA=N.createObject,tA=N.preventDefault,K0=N.setImage,T=N.getImage,zA=N.isImageComplete,ZA=N.drawCenterImage,BA=N.drawStretchImage,fA=N.getId,XA=N.callLater,qA=N.cancelLater,gA=N.sortFunc,MA=N.clone,LA=N.getClass,HA=N.startAnim,_A=N.brighter,bA=N.darker,nA=N.drawText,DA=N.getTextSize,YA=N.isLeftButton,sA=N.isMiddleButton,cA=N.isRightButton,hA=N.getTouchCount,wA=N.isDoubleClick,dA=N.isShiftDown,PA=N.isCtrlDown,i=N.getClientPoint,jA=N.getPagePoint,iA=N.getDistance,rA=N.unionPoint,eA=N.unionRect,AA=N.containsPoint,kA=N.containsRect,IA=N.intersectsRect,EA=N.intersection,yA=N.getWindowInfo,xA=N.grow,RA=N.getLogicalPoint,NA=N.getScreenPoint,mA=N.startDragging,KA=N.removeHTML,aA=N.createElement,uA=N.segmentResolution,TA=N.shapeResolution,VA=N.shapeSide,oA=N.def,Ph=function(p,G,v){oA("ht."+p,G,v)},UA=function(p,G){p.childNodes.forEach(function(p){G(p),UA(p,G)})},FA=(MS(N,{toolTipLabelColor:oh,toolTipLabelFont:Uh,toolTipBackground:s.toolTipBackground,toolTipShadowColor:z,debugTipLabelFont:Uh,debugTipLabelColor:oh,debugTipBackground:s.toolTipBackground,drawBreakableText:oS,setDevicePixelRatio:function(p){Rh=N.devicePixelRatio="number"==typeof p?p:Eh(h),UA(B.body,function(p){(p=p._ht)&&p._canvas&&(mS(p._canvas,p.getWidth(),p.getHeight()),p.redraw?p.redraw():p.iv())})},getPosition3dGap:function(){return us()}},!0),1e-6),CA="undefined"!=typeof Uint16Array?Uint16Array:Array,QA="undefined"!=typeof Uint32Array?Uint32Array:CA,pm="undefined"!=typeof Float32Array?Float32Array:Array,Gm=function(p,G,v){return p=[p[0]-G[0],p[1]-G[1],p[2]-G[2]],v&&0<(G=iA(p))&&(p[0]/=G,p[1]/=G,p[2]/=G),p},vm=function(){var p,G="charCodeAt",v=2*(2*zJ.length+1);for(p in h)if(p===l0+C0[0]+(tJ.length+2)){var J=h[p];if(!J)break;for(var $=J.length,S=0;S<$;S++)if(J[S][G](0)===v&&J[S+1]!=v0&&J[S+1]===tJ[0]&&J[S+2]!=v0&&J[S+2][G](0)===v){for(var O=S+3;O<$;O++)if(J[O][G](0)===v){if(0==J[O+1])for(var W,l=O+2;l<$;l++){if(J[l][G](0)===v){0==J[l-1]&&W&&(x0=W.substr(0,W.length-1));break}W==v0?W=J[l]:W+=J[l]}break}break}break}return function(p){return[-p[0],-p[1],-p[2]]}}(),Jm=function(p,G){return 3===p.length?p[0]*G[0]+p[1]*G[1]+p[2]*G[2]:p[0]*G[0]+p[1]*G[1]},$m=function(){var p=new Array(16);return p[0]=1,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=1,p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[10]=1,p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,p},Sm=$m(),Om=function(p){var G=new Array(16);return G[0]=p[0],G[1]=p[1],G[2]=p[2],G[3]=p[3],G[4]=p[4],G[5]=p[5],G[6]=p[6],G[7]=p[7],G[8]=p[8],G[9]=p[9],G[10]=p[10],G[11]=p[11],G[12]=p[12],G[13]=p[13],G[14]=p[14],G[15]=p[15],G},Wm=function(p){return p[0]=1,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=1,p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[10]=1,p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,p},lm=function(p,G){var v=p[0],J=p[1],$=p[2];return p[0]=G[0]*v+G[4]*J+G[8]*$+G[12],p[1]=G[1]*v+G[5]*J+G[9]*$+G[13],p[2]=G[2]*v+G[6]*J+G[10]*$+G[14],p},tm=function(p,G){var v=p[0],J=p[1],$=p[2],S=p[3];return p[0]=G[0]*v+G[4]*J+G[8]*$+G[12]*S,p[1]=G[1]*v+G[5]*J+G[9]*$+G[13]*S,p[2]=G[2]*v+G[6]*J+G[10]*$+G[14]*S,p[3]=G[3]*v+G[7]*J+G[11]*$+G[15]*S,p},zm=(TL=HS(p[1]+p[7]),VL=HS(p[0]+p[3]-p[10]),oL=HS(p[8]+2),UL=function(){return aL=uL.charAt(KL),KL+=1,aL},FL=function(){var p="";if(aL===oL)for(;UL();){if(aL===oL)return UL(),p;p+=aL}else UL()},CL=function(){for(;aL&&aL<=" ";)UL()},QL=function(){if(CL(),aL!==TL)return FL();var p,G={};if(aL===TL){if(UL(),CL(),aL===VL)return UL(),G;for(;aL;){if(p=FL(),CL(),UL(),G[p]=QL(),CL(),aL===VL)return UL(),G;UL(),CL()}}},function(p){if(n={},p&&(uL=p,KL=0,aL=" ",p=QL(),CL(),!aL))return p}),Zm=function(p,G){var v,J,$,S,O,W,l,t,z;G&&(v=O0(G),G=S0(G),J=p[4],$=p[5],S=p[6],O=p[7],W=p[8],l=p[9],t=p[10],z=p[11],p[4]=J*G+W*v,p[5]=$*G+l*v,p[6]=S*G+t*v,p[7]=O*G+z*v,p[8]=W*G-J*v,p[9]=l*G-$*v,p[10]=t*G-S*v,p[11]=z*G-O*v)},Bm=function(p,G){var v,J,$,S,O,W,l,t,z;G&&(v=O0(G),G=S0(G),J=p[0],$=p[1],S=p[2],O=p[3],W=p[8],l=p[9],t=p[10],z=p[11],p[0]=J*G-W*v,p[1]=$*G-l*v,p[2]=S*G-t*v,p[3]=O*G-z*v,p[8]=J*v+W*G,p[9]=$*v+l*G,p[10]=S*v+t*G,p[11]=O*v+z*G)},fm=function(p,G){var v,J,$,S,O,W,l,t,z;G&&(v=O0(G),G=S0(G),J=p[0],$=p[1],S=p[2],O=p[3],W=p[4],l=p[5],t=p[6],z=p[7],p[0]=J*G+W*v,p[1]=$*G+l*v,p[2]=S*G+t*v,p[3]=O*G+z*v,p[4]=W*G-J*v,p[5]=l*G-$*v,p[6]=t*G-S*v,p[7]=z*G-O*v)},Xm=function(p,G,v){return qm(v0,!1===v?v0:p.getFinalScale3d(),p.getFinalRotation3d(),p.getRotationMode(),p.p3(),v0,G)},qm=function(p,G,v,J,$,S,O){return S=S||$m(),$&&Fs(S,$),DI(S,v,J),O&&Qs(S,S,O),G&&Cs(S,G),p&&Qs(S,S,p),S},gm=function(p,G,v){G=r0(G),v=r0(v),this.g=p,this._84O=G,this._85O=v,this._70I=!0,this.F=0,this._83O=G+v,this.pen={x:0,y:0}},Mm="lineDashOffset",Lm="setLineDash",Hm=function(p,G,v){return DS(G)?p:p[Lm]?(p[Lm](G),v&&(p.lineDashOffset=v),p):new gm(p,G[0],1<G.length?G[1]:G[0])},_m=function(p,G){!DS(G)&&p[Lm]&&(p[Lm](ei),p.lineDashOffset=0)},bm=(oA(gm,d,{_69I:6,moveTo:function(p,G){var v=this.pen;v.x=p,v.y=G,this.g.moveTo(p,G),this.start||(this.start={x:p,y:G})},lineTo:function(p,G){var v=this,J=v.pen,$=p-J.x,S=G-J.y,S=P0(S,$),$=S0(S),S=O0(S),O=v._23O(J.x,J.y,p,G),W=v._85O,l=v._84O,t=v._83O;if(v.F){if(v.F>O)return v._70I?v._72I(p,G):v.moveTo(p,G),void(v.F-=O);if(v._70I?v._72I(J.x+$*v.F,J.y+S*v.F):v.moveTo(J.x+$*v.F,J.y+S*v.F),O-=v.F,v.F=0,v._70I=!v._70I,!O)return}var z=n0(O/t);if(z){for(var Z=$*l,B=S*l,f=$*W,X=S*W,q=0;q<z;q++)v._70I?(v._72I(J.x+Z,J.y+B),v.moveTo(J.x+f,J.y+X)):(v.moveTo(J.x+f,J.y+X),v._72I(J.x+Z,J.y+B));O-=t*z}v._70I?l<O?(v._72I(J.x+$*l,J.y+S*l),v.moveTo(p,G),v.F=W-(O-l),v._70I=!1):(v._72I(p,G),O===l?(v.F=0,v._70I=!v._70I):(v.F=l-O,v.moveTo(p,G))):W<O?(v.moveTo(J.x+$*W,J.y+S*W),v._72I(p,G),v.F=l-(O-W),v._70I=!0):(v.moveTo(p,G),O===W?(v.F=0,v._70I=!v._70I):v.F=W-O)},quadraticCurveTo:function(p,G,v,J){var $,S=this,O=(l=S.pen).x,W=l.y,l=S._22O(O,W,p,G,v,J),t=0,z=0,Z=S._85O,B=S._84O;if(S.F){if(S.F>l)return S._70I?S._71I(p,G,v,J):S.moveTo(v,J),void(S.F-=l);if(t=S.F/l,$=S._20O(O,W,p,G,v,J,t),S._70I?S._71I($[2],$[3],$[4],$[5]):S.moveTo($[4],$[5]),S.F=0,S._70I=!S._70I,!l)return}var f,X=n0((l-l*t)/S._83O),q=B/l,g=Z/l;if(X)for(var M=0;M<X;M++)S._70I?($=S._21O(O,W,p,G,v,J,t,z=t+q),S._71I($[2],$[3],$[4],$[5]),t=z,$=S._21O(O,W,p,G,v,J,t,z=t+g),S.moveTo($[4],$[5])):($=S._21O(O,W,p,G,v,J,t,z=t+g),S.moveTo($[4],$[5]),t=z,$=S._21O(O,W,p,G,v,J,t,z=t+q),S._71I($[2],$[3],$[4],$[5])),t=z;f=l-l*t,S._70I?B<f?($=S._21O(O,W,p,G,v,J,t,z=t+q),S._71I($[2],$[3],$[4],$[5]),S.moveTo(v,J),S.F=Z-(f-B),S._70I=!1):($=S._19O(O,W,p,G,v,J,t),S._71I($[2],$[3],$[4],$[5]),l===B?(S.F=0,S._70I=!S._70I):(S.F=B-f,S.moveTo(v,J))):Z<f?($=S._21O(O,W,p,G,v,J,t,z=t+g),S.moveTo($[4],$[5]),$=S._19O(O,W,p,G,v,J,z),S._71I($[2],$[3],$[4],$[5]),S.F=B-(f-Z),S._70I=!0):(S.moveTo(v,J),f===Z?(S.F=0,S._70I=!S._70I):S.F=Z-f)},bezierCurveTo:function(){var p=arguments;this.pen={x:p[4],y:p[5]},this.g.bezierCurveTo(p[0],p[1],p[2],p[3],p[4],p[5])},arc:function(p,G,v,J,$,S){S||(J=-J,$=-$);var O,W,l,t,z,Z=p,B=G,S=J,f=v,X=v,G=!1,q=-((p=I(p=$-J)>2*j?2*j:p)/(O=D0(I(p)/(j/4)))),g=-S;if(0<O){p=Z+S0(S)*f,S=B+O0(-S)*X,G?this.lineTo(p,S):this.moveTo(p,S);for(var M=0;M<O;M++)z=(g+=q)-q/2,W=Z+S0(g)*f,l=B+O0(g)*X,t=Z+S0(z)*(f/S0(q/2)),z=B+O0(z)*(X/S0(q/2)),this.quadraticCurveTo(t,z,W,l)}},rect:function(p,G,v,J){this.pen={x:p,y:G},this.moveTo(p,G),this.lineTo(p,G+J),this.lineTo(p+v,G+J),this.lineTo(p+v,G),this.lineTo(p,G)},beginPath:function(){this.g.beginPath()},closePath:function(){this.lineTo(this.start.x,this.start.y)},_23O:function(p,G,v,J){return Y0((v-=p)*v+(p=J-G)*p)},_22O:function(p,G,v,J,$,S,O){for(var W,l,t,z,Z=0,B=p,f=G,X=0<O?O:this._69I,q=1;q<=X;q++)Z+=this._23O(B,f,W=(l=(t=1-(z=q/X))*t)*p+(t*=2*z)*v+(z*=z)*$,l=l*G+t*J+z*S),B=W,f=l;return Z},_21O:function(p,G,v,J,$,S,O,W){return 0===O?this._20O(p,G,v,J,$,S,W):1===W?this._19O(p,G,v,J,$,S,O):((p=this._20O(p,G,v,J,$,S,W)).push(O/W),this._19O.apply(this,p))},_20O:function(p,G,v,J,$,S,O){var W,l;return 1!==O&&(W=v+($-v)*O,l=J+(S-J)*O,$=(v=p+(v-p)*O)+(W-v)*O,S=(J=G+(J-G)*O)+(l-J)*O),[p,G,v,J,$,S]},_19O:function(p,G,v,J,$,S,O){var W;return 1!==O&&(p=(W=p+(v-p)*O)+((v+=($-v)*O)-W)*O,G=(W=G+(J-G)*O)+((J+=(S-J)*O)-W)*O),[p,G,v,J,$,S]},_72I:function(p,G){var v=this.pen;p===v.x&&G===v.y||(v.x=p,v.y=G,this.g.lineTo(p,G))},_71I:function(p,G,v,J){var $=this.pen;p===v&&G===J&&v===$.x&&J===$.y||($.x=v,$.y=J,this.g.quadraticCurveTo(p,G,v,J))}}),Ih.ms_quickVisible=function(p,G){p._4BQ=!1,p._4CQ=function(p){var G=p._4EQ;return G!==K?G:p._4EQ=this._4FQ(p)},p._4DQ=function(p){var G;p?(p._4EQ=K,G=this,p instanceof hI||ZS(p)||p instanceof rI||p.ISubGraph?p.eachChild(function(p){G.invalidateQuickVisible(p)}):p.getEdges&&(p=p.getEdges())&&p.each(function(p){G.invalidateQuickVisible(p)})):this.dm().each(function(p){p._4EQ=K})},p.enableQuickVisibleMode=function(){this._4BQ||(this._4BQ=!0,this._4FQ=this.isVisible,this.isVisible=this._4CQ,this.invalidateQuickVisible=this._4DQ)},p.disableQuickVisibleMode=function(){this._4BQ&&(this._4BQ=!1,this.isVisible=this._4FQ,this.invalidateQuickVisible=Ii)},p.isQuickVisibleMode=function(){return this._4BQ},p.invalidateQuickVisible=Ii},p=j0()+1,i0&&h.console,v0),nm=v0,Dm=N.checkLoadingCompType=function(p){bm&&!p._72O_&&((nm=nm||{})[p._72O_=fA()]=p)},Ym=function(v,p){var J,G;(p=p||v)&&!(bm=bm||{})[v]&&(J=new kI,bm[p]={request:J,url:p},(p=N.beforeLoadURL(p,v)).data?(G=N.parse(p.data),sm(v,G),N.handleCompTypeLoaded(v,G)):(J.onload=function(p){var G;200===this.status||0===this.status?(G=N.parse(J.getResponseText()),sm(v,G),N.handleCompTypeLoaded(v,G)):sm(v,v0)},J.onerror=function(p){sm(v,v0)},(G={}).url=encodeURI(p),G.sync=!1,J.send(G)))},sm=function(p,G){if(hi[p]=G,delete bm[p],nS(bm)&&(bm=v0,nm)){for(var v in nm)(J=nm[v]).invalidateAll&&J.invalidateAll(K,"compTypeLoaded",p),J.redraw&&J.redraw(),J.iv(),delete J._72O_;nm=v0}if(G&&nm)for(var v in nm){var J;(J=nm[v]).invalidateAll&&J.invalidateAll(K,"compTypeLoading",p),J.redraw&&J.redraw(),J.iv()}},cm=s.chart,hm="",wm=!0,dm=N.compStack=[],Pm=/^style@/,jm=/^attr@/,im=/^field@/,rm={x:.5,y:.5},em=function(p,G,v){return!!p&&((J=v&&v.isImageFitSize?v.isImageFitSize(G,p):J)==v0?V(p.fitSize,G,v):J);var J},Am=function(p,G,v,J){return p?!(em(p,G,v)&&J||null!=(J=V(p.width,G,v)))?20:J:0},km=function(p,G,v,J){return p?!(em(p,G,v)&&J||null!=(J=V(p.height,G,v)))?20:J:0},V=function(p,G,v){if(!p||!p.func)return p;var J=p.func,$=p.value,p=WS(J)?v&&v.vectorDataBindingDisabled&&!p.isSafeFunc?$:J(G,v):G instanceof Fm||E.ui&&G instanceof E.ui.View?jm.test(J)?G.a(hm+J.slice(5)):Pm.test(J)?G.s(hm+J.slice(6)):im.test(J)?G[J.slice(6)]:G[J]?G[J](v):$:$;return $!==K&&p==v0?$:p},Im=N.drawImage=(R=function(p,G,v){var J,$,S=!1;return p.prefix&&p1 instanceof Fm&&($=p1.a(hm+G))!==K&&(S=!0,J=$),(J=J===K?p[G]:J)&&J.func&&(S=!0,J=V(J,p1,G1)),v&&(J=v(J),S||(p[G]=J)),J},S1=function(p){var G=R(p,"anchorX"),v=R(p,"anchorY");return G!==K||v!==K?{x:G===K?rm.x:G,y:v===K?rm.y:v}:(G=R(p,"type"),v=R(p,"name"),"image"===G&&v&&(p=T(v))&&p.anchorX!==K&&p.anchorY!==K?{x:p.anchorX,y:p.anchorY}:rm)},O1={border:function(p,G){J4(x,DM(p,Nl),G.x,G.y,G.width,G.height,R(p,"width"))},image:function(p,G){var v=J1||R(p,Nl),J=$1||R(p,"blendMode"),$=R(p,"name");($=($=T($,v,J))&&$.cacheRule!=v0?Pj(x,$,R(p,"stretch"),G.width,G.height,p1,G1,v):$)?BA(x,$,R(p,"stretch"),G.x,G.y,G.width,G.height,p1,G1,v,null,J):wm=!1},text:function(p,W){var G,l,v,t,J,z,Z,B,$,f,X,q,g,M,L,H,_,S,b,O,n,D,Y=R(p,"text");Y!=v0&&(Y+="",n=R(p,"gradientPack"),D=R(p,"gradient"),G=DM(p,"gradientColor"),l=R(p,"font"),v=R(p,"vertical"),t=R(p,"verticalGap")||0,J=R(p,"align"),z=R(p,"vAlign"),Z=R(p,"decoration"),B=R(p,"letterGap")||0,$=R(p,"wrap"),f=R(p,"borderWidth"),X=R(p,"borderColor"),q=DA(l,Y),n?(g=NE(x,n,DM,!1,W),x.restore()):g=DM(p,Nl),!n&&D&&(g=N.createGradient(x,D,g||N.labelColor,G||s.imageGradient,W.x,W.y,W.width,W.height)),f&&lS(X)&&(X=NE(x,X,DM,!1,W),x.restore()),v?(null==t&&(t=1),M=[],L=[],O=$?uS(Y,W.height,l,B,v,t):[Y],x.textBaseline=pJ,x.font=l,O.forEach(function(p){for(var G=p.length,v=0,J=(G-1)*t,$=0;$<G;$++){var S=x.measureText(p[$]);M.push(S),J+=S.fontBoundingBoxDescent||q.height,v=J0(v,S.width)}L.push({width:v,height:J})}),S=(O.length-1)*B,L.forEach(function(p){S+=p.width}),H=J&&J!==C0?J===Q0?W.x+W.width-S:W.x+(W.width-S)/2:W.x,b=0,O.forEach(function(p,G){var v=L[G],J=p.length;_=z&&z!==$J?z===pJ?W.y:W.y+W.height-v.height:W.y+(W.height-v.height)/2;for(var $=0;$<J;$++){var S=p[$],O=M[b].fontBoundingBoxDescent||q.height;VS(x,S,l,g,{x:H,y:_,width:v.width,height:O},vJ,z,Z,B,f,X),_+=O+t,b++}H+=v.width+B})):1<(p=(O=$?uS(Y,W.width,l,B,v,t):Y.split("\n")).length)?(n=p*DA(l,Y).height+t*(p-1),D=MA(W),z&&z!==$J?z===GJ&&(D.y=W.y+W.height-n):D.y=W.y+(W.height-n)/2,D.height=n,oS(x,O,D,l,g,J||C0,Z,B,f,X)):VS(x,Y,l,g,W,J,z,Z,B,f,X))},pieChart:function(p,G){var v=R(p,wJ),J=0;if(v&&(v.forEach(function(p){J+=p}),0<J)){for(var $=R(p,"colors")||cm,S=R(p,"startAngle")||0,O=R(p,"hollow"),W=R(p,jJ),l=R(p,kJ),t=R(p,IJ),z=W?new o:v0,p=G.x,Z=G.y,B=G.width,f=p+B/2,X=Z+(G=G.height)/2,q=$0(B,G)/2,g=0,M=0;M<v.length;M++){var L,H,_,b,n=v[M],D=S+W0*n/J;x.fillStyle=$[g++],g===$.length&&(g=0),x.beginPath(),O?(L=f+S0(S)*q/2,H=X+O0(S)*q/2,_=f+S0(D)*q,b=X+O0(D)*q,x.moveTo(L,H),x.arc(f,X,q/2,S,D,!1),x.lineTo(_,b)):x.moveTo(f,X),x.arc(f,X,q,D,S,!0),z&&(L=(S+D)/2,z.add({text:WS(W)?W(n,M,J,p1):n,x:f+S0(L)*q*.75,y:X+O0(L)*q*.75})),x.closePath(),x.fill(),S=D}z&&z.each(function(p){nA(x,p.text,l,t,p.x,p.y,0,0,vJ)})}},columnChart:function(p,G){var v=R(p,dJ);if(v&&0<v.length){var J=v.length,$=R(p,jJ),S=R(p,kJ),O=R(p,IJ),W=$?new o:v0,l=R(p,"minValue")||0,t=R(p,"maxValue");if(t==v0&&(t=0,v.forEach(function(p){R(p,wJ).forEach(function(p){t=J0(t,p)})})),l!==t){for(var z=G.height/(t-l),Z=G.y+t*z,B=R(v[0],wJ).length,f=G.width/(3*B+1),X=2*f/J,q=0,g=0;g<J;g++)for(var M=v[g],L=R(M,Nl),H=R(M,"colors"),_=R(M,wJ),b=0;b<B;b++){H?x.fillStyle=H[b]:L?x.fillStyle=L:(x.fillStyle=cm[q++],q===cm.length&&(q=0));var n,D=_[b],Y=D*z,s=G.x+(1+3*b)*f+g*X;VE(x,s,Z-Y,X,Y),W&&(D=WS($)?$(D,b,M,p1):D,n=DA(S,D).height,W.add({x:s,y:Z-Y-n,width:X,height:n,text:D}))}W&&W.each(function(p){nA(x,p.text,S,O,p.x,p.y,p.width,p.height,vJ)})}}},stackedColumnChart:function(p,G){var v=R(p,dJ);if(v&&0<v.length){var J=v.length,$=R(v[0],wJ).length,S=G.width/(3*$+1),O=0,W=R(p,"maxValue"),l=R(p,jJ),t=R(p,kJ),z=R(p,IJ),Z=l?new o:v0;if(W==v0)for(var W=0,B=0;B<$;B++){for(var f=0,X=0;X<J;X++)f+=R(v[X],wJ)[B];W=J0(W,f)}if(0<W){for(B=0;B<$;B++)for(var q=G.y+G.height,X=0;X<J;X++){var g=v[X],M=R(g,Nl),L=R(g,wJ)[B],H=L/W*G.height,M=(M?x.fillStyle=M:(x.fillStyle=cm[O++],O===cm.length&&(O=0)),q-=H,{x:G.x+(1+3*B)*S,y:q,width:2*S,height:H});VE(x,M.x,M.y,M.width,M.height),Z&&(M.text=WS(l)?l(L,B,g,p1):L,Z.add(M))}Z&&Z.each(function(p){nA(x,p.text,t,z,p.x,p.y,p.width,p.height,vJ)})}}},percentageColumnChart:function(p,G){var v=R(p,dJ);if(v&&0<v.length){for(var J=v.length,$=R(v[0],wJ).length,S=G.width/(3*$+1),O=0,W=R(p,jJ),l=R(p,kJ),t=R(p,IJ),z=W?new o:v0,Z=0;Z<$;Z++){for(var B=0,f=0;f<J;f++)B+=R(v[f],wJ)[Z];if(0<B)for(var X=G.y+G.height,f=0;f<J;f++){var q=v[f],g=R(q,Nl),M=R(q,wJ)[Z],L=M/B*G.height,g=(g?x.fillStyle=g:(x.fillStyle=cm[O++],O===cm.length&&(O=0)),X-=L,{x:G.x+(1+3*Z)*S,y:X,width:2*S,height:L});VE(x,g.x,g.y,g.width,g.height),z&&(g.text=WS(W)?W(M,Z,q,p1):M,z.add(g))}}z&&z.each(function(p){nA(x,p.text,l,t,p.x,p.y,p.width,p.height,vJ)})}},lineChart:function(p,G){var v=R(p,dJ);if(v&&0<v.length){var J=v.length,$=R(p,"minValue")||0,S=R(p,"maxValue");if(S==v0&&(S=0,v.forEach(function(p){R(p,wJ).forEach(function(p){S=J0(S,p)})})),$!==S)for(var O=G.height/(S-$),W=G.y+S*O,l=R(v[0],wJ).length,t=G.width/(3*l+1),z=0,Z=R(p,"lineWidth")||2,B=R(p,"line3d"),f=R(p,"linePoint"),X=R(p,jJ),q=R(p,kJ),g=R(p,IJ),M=0;M<J;M++){var L=v[M],H=R(L,Nl),_=R(L,wJ);H?x.strokeStyle=H:(H=x.strokeStyle=cm[z++],z===cm.length&&(z=0)),x.beginPath();for(var b=0;b<l;b++){var n=G.x+(2+3*b)*t,D=W-_[b]*O;0===b?x.moveTo(n,D):x.lineTo(n,D)}if(x.lineWidth=Z,x.stroke(),B&&uE(x,H,v0,Z,v1),f||X)for(var Y,s=Z/2+2,b=0;b<l;b++){var c,h,w,d,P=_[b],n=G.x+(2+3*b)*t,D=W-P*O;WS(f)?f(x,n,D,H,b,L,p1):f&&(x.fillStyle=H,x.beginPath(),x.arc(n,D,s,0,W0,!0),x.fill()),WS(X)?Y=X(P,b,L,p1):X&&(Y=P),Y&&(P=DA(q,Y).height,(c=x.shadowBlur)&&(h=x.shadowOffsetX,w=x.shadowOffsetY,d=x.shadowColor,x.shadowOffsetX=0,x.shadowOffsetY=0,x.shadowBlur=0,x.shadowColor=v0),nA(x,Y,q,g,n,D-P-s+2,0,P,vJ),c&&(x.shadowOffsetX=h,x.shadowOffsetY=w,x.shadowBlur=c,x.shadowColor=d))}}}}},function(p,r,G,v,J,$,e,S,O,W){if(r&&J&&$){var l,t,A,z,Z,B,f,X,q,g=[x,p1,G1,v1,J1,$1],p=(x=p,G1=S,!(p1=e)&&G1&&G1.isSelfViewEvent&&(p1=G1),v1=G1&&G1._zoom||1,J1=O,$1=W,J),S=$;if(Tj()&&(0===x.maxSize&&!Tj[0]||(t=!0),x.texureImage2D&&!Tj[1]||(z=!0),x.texureImage3D&&!Tj[2]||(Z=!0),x.drawDNDState&&!Tj[3]||(f=!0),x.drawRect&&!Tj[kJ[2]]||(l=!0),E[Gl[1]+CJ[0]+mJ[1]]&&!Tj[CJ[0]]||(X=!0),ki.widget[0]&&!Tj[4]||(B=!0),t&&z&&Z&&B&&f&&X&&l&&(p=G,S=v)),r.tagName)return JS(x0)&&!h[x0]||x.drawImage(r,p,S,J,$),void PM(g);0!=R(r,"visible")&&(J1=J1||V(r.color,p1,G1),W||($1=V(r.blendMode,p1,G1)),JS(x0)&&!h[x0]&&(J=p,$=S),O=Am(r,p1,G1,J),t=km(r,p1,G1,$),A={x:0,y:0,width:O,height:t,fitSize:em(r,p1,G1)},z=R(r,"clip"),Z=R(r,"opacity"),A.fitSize&&(B=A.rw=V(r.width,p1,G1)||20,A.widthScale=O/B,f=A.rh=V(r.height,p1,G1)||20,A.heightScale=t/f),x.save(),x.interactiveInfo&&(q=(X=x.interactiveInfo.matrix).clone(),X.appendTranslate(p,S).appendScale(J/O,$/t),x.interactiveInfo.refRect=A),JE(x,p,S),O===J&&t===$||x.scale(J/O,$/t),z&&(WS(z)?z(x,O,t,p1,G1,r):(x.beginPath(),x.rect(0,0,O,t),x.clip())),Z!=v0&&(x.globalAlpha*=Z),R(r,"comps").forEach(function(p){var G;if(p.prefix&&(G=hm,(z=V(p.prefix,p1,G1))&&(hm=hm+z+".")),0==(z=r,c=p,G1&&G1.getDrawableState?s=G1.getDrawableState(p1):G1&&G1.getState?s=G1.getState(p1):(s=p1 instanceof Fm?p1.s(Yl):null)!==K&&null!==s||(s=R(z,Yl)),((z=R(c,Yl))===K||null===z||z===s)&&R(c,uJ)))p.prefix&&(hm=G);else{dm.splice(0,0,p),x.interactiveInfo&&(v=x.interactiveInfo.matrix.clone());var v,J,$,S,O,W,l,t,z,Z,B,f,X,q,g,M,L,H,_,b,n,D,Y,s=R(p,"opacity"),c=R(p,"shadow"),h=R(p,"type"),w=R(p,"refRect")||A,d=(z=w,l=R(t=p,y),L=S1(t),lS(l)&&(D=l.length,q=R(t,"relative"),Y=z.width,_=z.height,4===D?(l={x:l[0],y:l[1],width:l[2],height:l[3]},q&&(l.x*=Y,l.y*=_,l.width*=Y,l.height*=_)):3===D&&(D=l[0],l={width:l[1],height:l[2]},q&&(l.width*=Y,l.height*=_),"object"==typeof D?D.length&&(D={x:D[0],y:D[1]}):D=b4(D,z,l),l.x=D.x-l.width*L.x,l.y=D.y-l.height*L.y),l.x+=R(t,"offsetX")||0,l.y+=R(t,"offsetY")||0,!q&&z.fitSize&&(l=sM(t,l,z))),l);if(s!=v0&&(J=x.globalAlpha,x.globalAlpha*=s),c&&(Y=v1*N.devicePixelRatio,$=x.shadowOffsetX,S=x.shadowOffsetY,O=x.shadowBlur,W=x.shadowColor,_=R(p,"shadowOffsetX"),D=R(p,"shadowOffsetY"),L=R(p,"shadowBlur"),q=DM(p,"shadowColor"),x.shadowOffsetX=(_==v0?3:_)*Y,x.shadowOffsetY=(D==v0?3:D)*Y,x.shadowBlur=(L==v0?6:L)*Y,x.shadowColor=q||DM(r4)),"save"===h)x.save();else if("endClip"===h||"restore"===h)x.restore();else if("clip"===h)x.save(),KE(x,R(p,"points",YM),R(p,"segments",cM),!0),x.clip();else if(z4[h]){if(dM(p,h,d=d||{x:0,y:0,width:w.width,height:w.height},w),p.prefix&&0===p.prefix.indexOf("ui.")&&G1&&E.ui&&G1 instanceof E.ui.View){G1._vectorCompInfo||(G1._vectorCompInfo=[]);for(var P=!1,j=0;j<G1._vectorCompInfo.length;j++){var i=G1._vectorCompInfo[j];if(p.prefix===i.comp.prefix&&e===i.data){G1._vectorCompInfo[j]={comp:p,type:h,rect:d,compRefRect:w,data:e,image:r,transform:x.getTransform()},P=!0;break}}P||G1._vectorCompInfo.push({comp:p,type:h,rect:d,compRefRect:w,data:e,image:r,transform:x.getTransform()})}}else h===qJ?dM(p,h,d,w):"SVGPath"===h?(t=h,z=d,L=R(l=p,"path"),H=R(l,KJ),_=R(l,"scaleX"),b=R(l,"scaleY"),n=S1(l),D=v0,Y=RE(null,L),z||((z=l.unionRect)||(z=rA(Y),l.path.func||(l.unionRect=z)),D=z),z&&((D=D||l.unionRect)||(D=rA(Y),l.path.func||(l.unionRect=D)),Y=hM(l,z,D,H,_,b,n),z=R(l,"borderPattern"),H=Hm(x,z),_=DM(l,"background"),b=DM(l,"borderColor"),n=R(l,"borderWidth"),q=R(l,"gradient"),g=DM(l,"gradientColor"),M=R(l,"border3d"),Z=DM(l,"border3dColor"),B=R(l,"border3dAccuracy"),f=x.lineJoin,X=x.lineCap,x.lineJoin=R(l,"borderJoin")||Vh,x.lineCap=R(l,"borderCap")||Th,_?(UE(x,_,q,g,D),RE(x,L),x.fill(),H!==x&&RE(x,L)):RE(x,L),(q=R(l,"borderWidthAbsolute"))&&(x.save(),x.setTransform(1,0,0,1,0,0)),n&&b&&(x.lineWidth=n,x.strokeStyle=b,x.stroke(),M&&uE(x,b,Z,n,v1,B)),_m(x,z),R(l,"dash")&&0<(g=R(l,"dashWidth")||n)&&(z=R(l,"dashPattern")||uh,H=Hm(x,z,R(l,"dashOffset")),M=DM(l,"dashColor")||DM(D4),H!==x&&RE(x,L),x.strokeStyle=M,x.lineWidth=g,x.stroke(),R(l,"dash3d")&&uE(x,M,DM(l,"dash3dColor"),g,v1,R(l,"dash3dAccuracy")),_m(x,z)),q&&x.restore(),t===y&&$4(x,_,R(l,"depth"),D),x.lineJoin=f,x.lineCap=X,Y&&wM())):(H=hM(p,d=d||{x:0,y:0,width:w.width,height:w.height},d,b=R(p,KJ),Z=R(p,"scaleX"),B=R(p,"scaleY"),n=S1(p)),WS(h)?(nM(p,h),N.drawCompType(h,x,d,p,p1,G1)):N.getCompType(h)?(M=(L=N.getCompType(h)).func||L,nM(p,L),N.drawCompType(M,x,d,p,p1,G1)):O1[h]?O1[h](p,d):N.getCompType(h)===K&&ji.test(h)&&(Ym(h),wm=!1),H&&wM());c&&(x.shadowOffsetX=$,x.shadowOffsetY=S,x.shadowBlur=O,x.shadowColor=W),s!=v0&&(x.globalAlpha=J),x.interactiveInfo&&(x.interactiveInfo.matrix=v),p.prefix&&(hm=G),dm.splice(0,1)}}),x.interactiveInfo&&(x.interactiveInfo.matrix=q),x.restore()),PM(g)}}),Em=(N.getCurrentComp=function(){return dm[0]},N.getParentComp=function(){return dm[1]},N.getInternal=function(){return{isEnter:jE,isEsc:iE,isSpace:PE,isLeft:cE,isUp:hE,isRight:wE,isDown:dE,addMethod:MS,superCall:bS,toPointsArray:aE,translateAndScale:vE,appendArray:qS,createWorldMatrix:qm,vec3TransformMat4:lm,setCanvas:mS,createDiv:yS,createView:ES,createCanvas:xS,createImage:oi,initContext:GE,layout:P,fillRect:VE,Mat:hh,drawBorder:J4,isString:JS,setBorder:RS,getPropertyValue:dS,setPropertyValue:PS,drawVerticalLine:iS,draw3DRect:$4,getPinchDist:B4,isSameRect:YS,getPosition:b4,intersectionLineRect:hS,getNodeRect:pj,getEdgeAgentPosition:Lj,getEdgeHostPosition:Mj,getImageWidth:Am,getImageHeight:km,initItemElement:IS,drawPoints:KE,createG2:Hm,closePopup:BE,isH:Qi,createAnim:gS,createNormalMatrix:EZ,makeUVMatrix:CZ,toColorArray:yE,createNormals:lZ,toFloatArray:qn,glMV:yZ,glPop:IZ,batchShape:wp,createNodeMatrix:Xm,getShapeModel:fn,getFaceInfo:VZ,transformAppend:Ns,drawFaceInfo:oZ,glUploadData:iZ,glUploadElementData:eZ,glDrawArray:wZ,glDrawElement:dZ,glBindTexture:XZ,pickValueToColor:Wk,to3dPointsArray:Ln,setGLDebugMode:function(p){I3=p},cube:function(){return{vs:Kp,is:ap,uv:up}},ui:function(){return{DataUI:II,NodeUI:yI,EdgeUI:xI,GroupUI:NI,ShapeUI:KI,GridUI:uI,Data3dUI:Dk,Node3dUI:Yk,Shape3dUI:hk}},getInternalVersion:function(){return"U2FsdGVkX19Pw0dLn9I0QPhoU7GlpTtAfeTWU0RswU4="},getDragger:function(){return fE},addMSMap:function(p){MS(Ih,p)},k:t0,overrideTimerFunc:function(p,G){XA=E.Default.callLater=p,qA=E.Default.cancelLater=G},canEnterEditDetailMode:hj,addEventListener:H0,removeEventListener:_0,createGradientByPackedData:NE}},function(p){var _="toString",G="";function L(p,G,v){p!=v0&&(G==v0&&xl!=typeof p?this._54O(p,256):this._54O(p,G))}z0=p["D"+11182[_](c0(2,5))];var v=L.prototype;function H(){return new L(v0)}VJ+=OJ.substr(0,1);for(var p="Microsoft Internet Explorer"==(p=p.navigator?p.navigator.appName:"")?(v.am=function(p,G,v,J,$,S){for(var O=32767&G,W=G>>15;0<=--S;){var l=32767&this[p],t=this[p++]>>15,z=W*l+t*O;$=((l=O*l+((32767&z)<<15)+v[J]+(1073741823&$))>>>30)+(z>>>15)+W*t+($>>>30),v[J++]=1073741823&l}return $},30):"Netscape"!=p?(v.am=function(p,G,v,J,$,S){for(;0<=--S;){var O=G*this[p++]+v[J]+$;$=n0(O/67108864),v[J++]=67108863&O}return $},26):(v.am=function(p,G,v,J,$,S){for(var O=16383&G,W=G>>14;0<=--S;){var l=16383&this[p],t=this[p++]>>14,z=W*l+t*O;$=((l=O*l+((16383&z)<<14)+v[J]+$)>>28)+(z>>14)+W*t,v[J++]=268435455&l}return $},28),k=(v.DB=p,v.DM=(1<<p)-1,v.DV=1<<p,v.FV=c0(2,52),v.F1=52-p,v.F2=2*p-52,"0123456789abcdefghijklmnopqrstuvwxyz"),t=[],O=function(p){return String.fromCharCode(p)},J="0".charCodeAt(0),$=0;$<=9;++$)t[J++]=$;for(J="a".charCodeAt(0),$=10;$<36;++$)t[J++]=$;for(J="A".charCodeAt(0),$=10;$<36;++$)t[J++]=$;function z(p){return k.charAt(p)}function S(p){var G=H();return G._58O(p),G}function b(p){var G,v=1;return 0!=(G=p>>>16)&&(p=G,v+=16),0!=(G=p>>8)&&(p=G,v+=8),0!=(G=p>>4)&&(p=G,v+=4),0!=(G=p>>2)&&(p=G,v+=2),0!=(G=p>>1)&&(p=G,v+=1),v}function W(p){this.m=p}function l(p){this.m=p,this.mp=p._50O(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<p.DB-15)-1,this.mt2=2*p.t}function n(p,G){return new L(p,G)}function Z(){this.n=v0,this.e=0,this.d=v0,this.p=v0,this.q=v0,this.dmp1=v0,this.dmq1=v0,this._10A=v0}(p=W.prototype)._73O=function(p){return p.s<0||0<=p._52O(this.m)?p.mod(this.m):p},p.revert=function(p){return p},p._74O=function(p){p._49O(this.m,v0,p)},p._75O=function(p,G,v){p._47O(G,v),this._74O(v)},p._76O=function(p,G){p._48O(G),this._74O(G)},(p=l.prototype)._73O=function(p){var G=H();return p.abs()._59O(this.m.t,G),G._49O(this.m,v0,G),p.s<0&&0<G._52O(L.ZERO)&&this.m._78O(G,G),G},p.revert=function(p){var G=H();return p._77O(G),this._74O(G),G},p._74O=function(p){for(var G=this;p.t<=G.mt2;)p[p.t++]=0;for(var v=0;v<G.m.t;++v){var J=32767&p[v],$=J*G.mpl+((J*G.mph+(p[v]>>15)*G.mpl&G.um)<<15)&p.DM;for(p[J=v+G.m.t]+=G.m.am(0,$,p,v,0,G.m.t);p[J]>=p.DV;)p[J]-=p.DV,p[++J]++}p._57O(),p._45O(G.m.t,p),0<=p._52O(G.m)&&p._78O(G.m,p)},p._75O=function(p,G,v){p._47O(G,v),this._74O(v)},p._76O=function(p,G){p._48O(G),this._74O(G)},v._77O=function(p){for(var G=this.t-1;0<=G;--G)p[G]=this[G];p.t=this.t,p.s=this.s},v._58O=function(p){this.t=1,this.s=p<0?-1:0,0<p?this[0]=p:p<-1?this[0]=p+this.DV:this.t=0},v._54O=function(p,G){var v,J=this;if(16==G)v=4;else if(8==G)v=3;else if(256==G)v=8;else if(2==G)v=1;else if(32==G)v=5;else{if(4!=G)return void J.fromRadix(p,G);v=2}J.t=0,J.s=0;for(var $,S=p.length,O=!1,W=0;0<=--S;){var l=8==v?255&p[S]:(l=S,($=t[($=p).charCodeAt(l)])==v0?-1:$);l<0?"-"==p.charAt(S)&&(O=!0):(O=!1,0==W?J[J.t++]=l:W+v>J.DB?(J[J.t-1]|=(l&(1<<J.DB-W)-1)<<W,J[J.t++]=l>>J.DB-W):J[J.t-1]|=l<<W,(W+=v)>=J.DB&&(W-=J.DB))}8==v&&0!=(128&p[0])&&(J.s=-1,0<W&&(J[J.t-1]|=(1<<J.DB-W)-1<<W)),J._57O(),O&&L.ZERO._78O(J,J)},v._57O=function(){for(var p=this.s&this.DM;0<this.t&&this[this.t-1]==p;)--this.t},v._59O=function(p,G){for(var v=this.t-1;0<=v;--v)G[v+p]=this[v];for(v=p-1;0<=v;--v)G[v]=0;G.t=this.t+p,G.s=this.s},v._45O=function(p,G){for(var v=p;v<this.t;++v)G[v-p]=this[v];G.t=J0(this.t-p,0),G.s=this.s},v._44O=function(p,G){for(var v=this,J=p%v.DB,$=v.DB-J,S=(1<<$)-1,O=n0(p/v.DB),W=v.s<<J&v.DM,l=v.t-1;0<=l;--l)G[l+O+1]=v[l]>>$|W,W=(v[l]&S)<<J;for(l=O-1;0<=l;--l)G[l]=0;G[O]=W,G.t=v.t+O+1,G.s=v.s,G._57O()},v._46O=function(p,G){var v=this,J=(G.s=v.s,n0(p/v.DB));if(J>=v.t)G.t=0;else{var $=p%v.DB,S=v.DB-$,O=(1<<$)-1;G[0]=v[J]>>$;for(var W=J+1;W<v.t;++W)G[W-J-1]|=(v[W]&O)<<S,G[W-J]=v[W]>>$;0<$&&(G[v.t-J-1]|=(v.s&O)<<S),G.t=v.t-J,G._57O()}},v._78O=function(p,G){for(var v=this,J=0,$=0,S=$0(p.t,v.t);J<S;)$+=v[J]-p[J],G[J++]=$&v.DM,$>>=v.DB;if(p.t<v.t){for($-=p.s;J<v.t;)$+=v[J],G[J++]=$&v.DM,$>>=v.DB;$+=v.s}else{for($+=v.s;J<p.t;)$-=p[J],G[J++]=$&v.DM,$>>=v.DB;$-=p.s}G.s=$<0?-1:0,$<-1?G[J++]=v.DV+$:0<$&&(G[J++]=$),G.t=J,G._57O()},v._47O=function(p,G){var v=this.abs(),J=p.abs(),$=v.t;for(G.t=$+J.t;0<=--$;)G[$]=0;for($=0;$<J.t;++$)G[$+v.t]=v.am(0,J[$],G,$,0,v.t);G.s=0,G._57O(),this.s!=p.s&&L.ZERO._78O(G,G)},v._48O=function(p){for(var G=this.abs(),v=p.t=2*G.t;0<=--v;)p[v]=0;for(v=0;v<G.t-1;++v){var J=G.am(v,G[v],p,2*v,0,1);(p[v+G.t]+=G.am(v+1,2*G[v],p,2*v+1,J,G.t-v-1))>=G.DV&&(p[v+G.t]-=G.DV,p[v+G.t+1]=1)}0<p.t&&(p[p.t-1]+=G.am(v,G[v],p,2*v,0,1)),p.s=0,p._57O()},v._49O=function(p,G,v){var J=this;if(!((z=p.abs()).t<=0)){var $=J.abs();if($.t<z.t)return G!=v0&&G._58O(0),void(v!=v0&&J._77O(v));v==v0&&(v=H());var S=H(),O=J.s,p=p.s,W=J.DB-b(z[z.t-1]),l=(0<W?(z._44O(W,S),$._44O(W,v)):(z._77O(S),$._77O(v)),S.t),t=S[l-1];if(0!=t){var z=t*(1<<J.F1)+(1<l?S[l-2]>>J.F2:0),Z=J.FV/z,B=(1<<J.F1)/z,f=1<<J.F2,X=v.t,q=X-l,g=G==v0?H():G;for(S._59O(q,g),0<=v._52O(g)&&(v[v.t++]=1,v._78O(g,v)),L.ONE._59O(l,g),g._78O(S,S);S.t<l;)S[S.t++]=0;for(;0<=--q;){var M=v[--X]==t?J.DM:n0(v[X]*Z+(v[X-1]+f)*B);if((v[X]+=S.am(0,M,v,q,0,l))<M)for(S._59O(q,g),v._78O(g,v);v[X]<--M;)v._78O(g,v)}G!=v0&&(v._45O(l,G),O!=p&&L.ZERO._78O(G,G)),v.t=l,v._57O(),0<W&&v._46O(W,v),O<0&&L.ZERO._78O(v,v)}}},v._50O=function(){if(this.t<1)return 0;var p=this[0];if(0==(1&p))return 0;var G=3&p;return 0<(G=(G=(G=(G=G*(2-(15&p)*G)&15)*(2-(255&p)*G)&255)*(2-((65535&p)*G&65535))&65535)*(2-p*G%this.DV)%this.DV)?this.DV-G:-G},v._51O=function(){return 0==(0<this.t?1&this[0]:this.s)},v.exp=function(p,G){if(4294967295<p||p<1)return L.ONE;var v,J=H(),$=H(),S=G._73O(this),O=b(p)-1;for(S._77O(J);0<=--O;)G._76O(J,$),0<(p&1<<O)?G._75O($,S,J):(v=J,J=$,$=v);return G.revert(J)},v.toString=function(p){var G,v=this;if(v.s<0)return"-"+v._85O()[_](p);if(16==p)G=4;else if(8==p)G=3;else if(2==p)G=1;else if(32==p)G=5;else{if(4!=p)return v.toRadix(p);G=2}var J,$=(1<<G)-1,S=!1,O="",W=v.t,l=v.DB-W*v.DB%G;if(0<W--)for(l<v.DB&&0<(J=v[W]>>l)&&(S=!0,O=z(J));0<=W;)l<G?(J=(v[W]&(1<<l)-1)<<G-l,J|=v[--W]>>(l+=v.DB-G)):(J=v[W]>>(l-=G)&$,l<=0&&(l+=v.DB,--W)),(S=0<J||S)&&(O+=z(J));return S?O:"0"},v._85O=function(){var p=H();return L.ZERO._78O(this,p),p},v.abs=function(){return this.s<0?this._85O():this},v._52O=function(p){var G=this.s-p.s;if(0!=G)return G;var v=this.t;if(0!=(G=v-p.t))return this.s<0?-G:G;for(;0<=--v;)if(0!=(G=this[v]-p[v]))return G;return 0},v._55O=function(){return this.t<=0?0:this.DB*(this.t-1)+b(this[this.t-1]^this.s&this.DM)},v.mod=function(p){var G=H();return this.abs()._49O(p,v0,G),this.s<0&&0<G._52O(L.ZERO)&&p._78O(G,G),G},v._53O=function(p,G){return G=new(p<256||G._51O()?W:l)(G),this.exp(p,G)},L.ZERO=S(0),L.ONE=S(1),v._86O=function(){var p=this;if(p.s<0){if(1==p.t)return p[0]-p.DV;if(0==p.t)return-1}else{if(1==p.t)return p[0];if(0==p.t)return 0}return(p[1]&(1<<32-p.DB)-1)<<p.DB|p[0]},q0=function(){p=(t=y).split(""),G=D(t),p.forEach(function(p){0<p.length&&G&&(Z0+=r0(p))});var G,p=(t=G).substr(0,4),v=t.substr(4,2),J=t.substr(6,2),$=!1,S=t0,O=[],W=ul.charAt(7);if(z0&&(z0[_]().indexOf("nat")<0||z0[VJ][_]().indexOf("nat")<0||!t?z=v0:(p=(t=new z0(+p,v-1,+J)).setHours(9),z0[VJ]()>p?z=mE[W]:$=!0)),t&&z&&z[0]&&z[D0(.5)]&&S){var l,v=zm(z[0]);for(l in J=zm(z[1]))O.push(l);var p=0,t=v[O[0]],z=J[O[p++]],Z=J[O[p++]],B=J[O[p++]],f=J[O[p++]],X=J[O[p++]],q=J[O[p++]],v=v[O[6]],J=J[O[+p]],p=A._27O(S);if(t===z&&p&&J){var S=z+Z+B+f+X+q,g=!q||q===Ji||!Ji&&q===(ji+"")[0];if(!g&&q)for(var M,L=0,H=q.length;L<H;L++)q[L]===ll[7]?M===Ji||M[0]===EJ[5]&&Ji&&0<=Ji.indexOf(M.substr(1))?g=!0:M=v0:(M==v0?M=q[L]:M+=q[L],L===H-1&&(M===Ji||M[0]===EJ[5]&&Ji&&0<=Ji.indexOf(M.substr(1)))&&(g=!0));S&&p._31O(S,J)&&p._31O(t,v)&&g&&(!X||z0[VJ]()<X)&&($=!0)}}return $||(oE=DS),W};(p=Z.prototype)._37O=function(p){return p._53O(this.e,this.n)},p._38O=function(p,G){this.isPublic=!0,typeof p!=xl?(this.n=p,this.e=G):p!=v0&&G!=v0&&0<p.length&&0<G.length&&(this.n=n(p,16),this.e=r0(G,16))};var I="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",E="=",y="ICNhU===";function D(p){for(var G,v,J="",$=0,S=0;S<p.length&&p.charAt(S)!=E;++S)(v=I.indexOf(p.charAt(S)))<0||($=0==$?(J+=z(v>>2),G=3&v,1):1==$?(J+=z(G<<2|v>>4),G=15&v,2):2==$?(J=(J+=z(G))+z(v>>2),G=3&v,3):(J=(J+=z(G<<2|v>>4))+z(15&v),0));return 1==$&&(J+=z(G<<2)),J}h=(v={})._7A={},B=h._6A={_80O:function(p){R.prototype=this;var G=new R;return p&&G._5A(p),G.hasOwnProperty("_82O")||(G._82O=function(){G.$super._82O.apply(this,arguments)}),(G._82O.prototype=G).$super=this,G},_3A:function(){var p=this._80O();return p._82O.apply(p,arguments),p},_82O:function(){},_5A:function(p){for(var G in p)p.hasOwnProperty(G)&&(this[G]=p[G]);p.hasOwnProperty(_)&&(this.toString=p.toString)},_88O:function(){return this._82O.prototype._80O(this)}},f=h._39O=B._80O({_82O:function(p,G){p=this._84O=p||[],this._65O=null!=G?G:4*p.length},toString:function(p){return(p||X).stringify(this)},_89O:function(p){var G=this._84O,v=p._84O,J=this._65O,$=p._65O;if(this._57O(),J%4)for(var S=0;S<$;S++){var O=v[S>>>2]>>>24-S%4*8&255;G[J+S>>>2]|=O<<24-(J+S)%4*8}else if(65535<v.length)for(S=0;S<$;S+=4)G[J+S>>>2]=v[S>>>2];else G.push.apply(G,v);return this._65O+=$,this},_57O:function(){var p=this._84O,G=this._65O;p[G>>>2]&=4294967295<<32-G%4*8,p.length=D0(G/4)},_88O:function(){var p=B._88O.call(this);return p._84O=this._84O.slice(0),p},_87O:function(p){for(var G=[],v=0;v<p;v+=4)G.push(4294967296*j0|0);return new f._82O(G,p)}}),s=v._2A={},X=s._69O={stringify:function(p){for(var G=p._84O,v=p._65O,J=[],$=0;$<v;$++){var S=G[$>>>2]>>>24-$%4*8&255;J.push((S>>>4).toString(16)),J.push((15&S).toString(16))}return J.join("")},_68O:function(p){for(var G=p.length,v=[],J=0;J<G;J+=2)v[J>>>3]|=r0(p.substr(J,2),16)<<24-J%8*4;return new f._82O(v,G/2)}},q=s._8A={stringify:function(p){for(var G=p._84O,v=p._65O,J=[],$=0;$<v;$++){var S=G[$>>>2]>>>24-$%4*8&255;J.push(O(S))}return J.join("")},_68O:function(p){for(var G=p.length,v=[],J=0;J<G;J++)v[J>>>2]|=(255&p.charCodeAt(J))<<24-J%4*8;return new f._82O(v,G)}},g=s._9A={stringify:function(p){try{return decodeURIComponent(escape(q.stringify(p)))}catch(p){throw new Error("")}},_68O:function(p){return q._68O(unescape(encodeURIComponent(p)))}},M=h._32O=B._80O({_1A:function(){this._83O=new f._82O,this._23O=0},_33O:function(p){typeof p==xl&&(p=g._68O(p)),this._83O._89O(p),this._23O+=p._65O},_25O:function(p){var G=this._83O,v=G._84O,J=G._65O,$=this._79O,S=J/(4*$),O=(S=p?D0(S):J0((0|S)-this._22O,0))*$,p=$0(4*O,J);if(O){for(var W=0;W<O;W+=$)this._20O(v,W);var l=v.splice(0,O);G._65O-=p}return new f._82O(l,p)},_88O:function(){var p=B._88O.call(this);return p._83O=this._83O._88O(),p},_22O:0}),h._66O=M._80O({cfg:B._80O(),_82O:function(p){this.cfg=this.cfg._80O(p),this._1A()},_1A:function(){M._1A.call(this),this._34O()},_81O:function(p){return this._33O(p),this._25O(),this},_72O:function(p){return p&&this._33O(p),this._21O()},_79O:16,_26O:function(v){return function(p,G){return new v._82O(G)._72O(p)}},_19O:function(v){return function(p,G){return new x._71O._82O(v,G)._72O(p)}}});var B,f,X,q,g,M,x,x=v._67O={},Y=v;function R(){}var s=Y,N=(h=s._7A)._39O,c=h._66O,h=s._67O,m=[],K=[];function a(p){return 4294967296*(p-(0|p))|0}for(var w=2,d=0;d<64;)!function(p){for(var G=Y0(p),v=2;v<=G;v++)if(!(p%v))return;return 1}(w)||(d<8&&(m[d]=a(c0(w,.5))),K[d]=a(c0(w,1/3)),d++),w++;var P=[],h=h._41O=c._80O({_34O:function(){this._64O=new N._82O(m.slice(0))},_20O:function(p,G){for(var v=this._64O._84O,J=v[0],$=v[1],S=v[2],O=v[3],W=v[4],l=v[5],t=v[6],z=v[7],Z=0;Z<64;Z++){Z<16?P[Z]=0|p[G+Z]:(B=P[Z-15],f=P[Z-2],P[Z]=((B<<25|B>>>7)^(B<<14|B>>>18)^B>>>3)+P[Z-7]+((f<<15|f>>>17)^(f<<13|f>>>19)^f>>>10)+P[Z-16]);var B=J&$^J&S^$&S,f=z+((W<<26|W>>>6)^(W<<21|W>>>11)^(W<<7|W>>>25))+(W&l^~W&t)+K[Z]+P[Z],z=t,t=l,l=W,W=O+f|0,O=S,S=$,$=J,J=f+(((J<<30|J>>>2)^(J<<19|J>>>13)^(J<<10|J>>>22))+B)|0}v[0]=v[0]+J|0,v[1]=v[1]+$|0,v[2]=v[2]+S|0,v[3]=v[3]+O|0,v[4]=v[4]+W|0,v[5]=v[5]+l|0,v[6]=v[6]+t|0,v[7]=v[7]+z|0},_21O:function(){var p=this._83O,G=p._84O,v=8*this._23O,J=8*p._65O;return G[J>>>5]|=128<<24-J%32,G[14+(64+J>>>9<<4)]=n0(v/4294967296),G[15+(64+J>>>9<<4)]=v,p._65O=4*G.length,this._25O(),this._64O},_88O:function(){var p=c._88O.call(this);return p._64O=this._64O._88O(),p}}),j=(s._41O=c._26O(h),s._42O=c._19O(h),new RegExp(""));function i(p){var G=p.substring(0,38);return G&&30==G.indexOf("05000420")?["ss",p.substring(38)]:[]}function u(p,G,v,J){if((G=n(G=(G=G.replace(j,"")).replace(/[ \n]+/g,""),16))._55O()>this.n._55O())return 0;if(0==(G=i(this._37O(G)[_](16).replace(/^1f+00/,""))).length)return!1;for(var $,S,O,W=VA,l=[0,.5,.75,.875,.9375],t=[],z=[],Z=[],B=W0/W,f=(f=G=G[1],p=r._4O.Util._56O(p,"ss"),(O={}).v=p==f,O.t=1,O.s=0,f0=O.v,p),X=O.t=0,q=0;X<l.length;X++)for(var g=X%2==0?0:.5,M=0;M<=W;M++)S=1-l[X],t.push(.5*S0($=(M+g)*B)*S,.5*l[X]*2-.5,.5*-O0($)*S),z.push((M+g)/W,S);for(X=0;X<l.length-1;X++)for(var L=X*(W+1),H=(X+1)*(W+1),M=0;M<W;M++)Z.push(L+M,H+M+1,H+M,L+M,L+M+1,H+M+1);return Z.forEach(function(p){q+=p}),G==f&&10<q}function T(p){return(p=p.replace(j,G)).replace(/[ \n]+/g,G)}j.compile("[^0-9a-f]","gi"),Z._28O=-1,Z._29O=-2,p._31O=u,p._63O=u,Z._43O=-2;var r,V,o,e=new function(){var l=this;l._5O=function(p,G){return"8"!=p.substring(G+2,G+3)?1:0==(p=r0(p.substring(G+3,G+4)))?-1:0<p&&p<10?p+1:-2},l._13O=function(p,G){var v=l._5O(p,G);return v<1?"":p.substring(G+2,G+2+2*v)},l._12O=function(p,G){return""==(p=l._13O(p,G))?-1:(r0(p.substring(0,1))<8?new L(p,16):new L(p.substring(2),16))._86O()},l._6O=function(p,G){return(p=l._5O(p,G))<0?p:G+2*(p+1)},l._11O=function(p,G){var v=l._6O(p,G),G=l._12O(p,G);return p.substring(v,v+2*G)},l._10O=function(p,G){return l._6O(p,G)+2*l._12O(p,G)},l._7O=function(p,G){for(var v=[],J=l._6O(p,G),$=(v.push(J),l._12O(p,G)),S=J,O=0;;){var W=l._10O(p,S);if(W==v0||2*$<=W-J)break;if(200<=O)break;v.push(W),S=W,O++}return v}},U=(e._90O=O(34),e._91O=l0+O(108),(r=r!=v0&&r?r:{})._4O!=v0&&r._4O||(r._4O={}),r._4O),F=(r._4O.Util=new function(){this._56O=function(p,G){return(new r._4O._3O)._30O(p)},this._4A=function(p,G){return(new r._4O._3O)._36O(p)},this._11A=function(p,G){return(new U._3O)._30O(p)}},r._4O._3O=function(p){var v=this;v._8O=function(p,G){if("ss"==p&&"cj"==G){try{v.md=Y._67O._41O._3A()}catch(p){}v._24O=function(p){v.md._81O(p)},v._35O=function(p){p=Y._2A._69O._68O(p),v.md._81O(p)},v._60O=function(){return v.md._72O()[_](Y._2A._69O)},v._30O=function(p){return v._24O(p),v._60O()},v._36O=function(p){return v._35O(p),v._60O()}}},v._24O=function(p){},v._35O=function(p){},v._60O=function(){},v._30O=function(p){},v._36O=function(p){},v._8O("ss","cj")},X0=function(p){var G=eS[el[7]],v=1,J=!1;if(eE.a!=eS[Kl])return eE.a;if(eE.forEach(function(p){v*=p}),v<p){if(G&&G[1]&&G[0]){var $=G[0],G=(G=G[1]).split(e._90O),$=$.split(e._90O),S=G[3],O=$[3],W=G[7],l=G[11],t=G[15],z=G[19],Z=G[23],G=G[27],$=$[7],W=S+W+l+t+z+Z,B=!Z,t=O===S;if(Z=Z===ii.toString()[0]?Z+Z+Z:Z){var f=Z&&Z.split(vS("firefox")[3]);if(f)for(var X=0;X<f.length;X++){var q=f[X];if(q[0]===QJ[8]&&(q=q.substring(1)),0<=Il.indexOf(q)){B=!0;break}}}(J=t&&Ri()(O,$)&&Ri()(W,G)&&B&&(!z||p<z))&&0<=l.indexOf(WJ.length)&&(X0[WJ.length]=WJ),J&&0<=l.indexOf(WJ.length+1)&&(X0[WJ.length+1]=WJ),J&&0<=l.indexOf(WJ.length+3)&&(X0[WJ.length+3]=WJ),J&&0<=l.indexOf(Hl.length)&&(X0[Hl.length]=Hl)}J||(II.prototype._42=gi)}else J=!0,X0[WJ.length]=X0[WJ.length+1]=X0[WJ.length+3]=X0[Hl.length]=WJ;return eE.a=J},String.fromCharCode(45),n),C=/^1f+00/,A=(v={_18O:function(p){return D(p.replace(/\s+/g,""))},_14O:function(p){return p=this._18O(p),this._15O(p)},_15O:function(p){var G;if("2a864886f70d010101"==(p=this._17O(p))._61O)return p=this._16O(p.key),(G=new Z)._38O(p.n,p.e),G},_16O:function(p){var G={},v=(p.substr(0,2),e._7O(p,0));return v.length,p.substr(v[0],2),G.n=e._11O(p,v[0]),p.substr(v[1],2),G.e=e._11O(p,v[1]),G},_17O:function(p){var G={},v=(G._40O=v0,e._7O(p,0)),J=(v.length,v[0]);return p.substr(J,2),(J=e._7O(p,J)).length,p.substr(J[0],2),G._61O=e._11O(p,J[0]),"06"==p.substr(J[1],2)?G._40O=e._11O(p,J[1]):"30"==p.substr(J[1],2)&&(G._40O={},G._40O.p=e._70O(p,J[1],[0],"02"),G._40O.q=e._70O(p,J[1],[1],"02"),G._40O.g=e._70O(p,J[1],[2],"02")),p.substr(v[1],2),G.key=e._11O(p,v[1]).substr(2),G}})._17O?v:v0,Q=A._27O=function(p,G,v){return A._14O(p)},p0=(Ri=function(){return function(p,G){if(p&&G){if(G=T(G),G=F(G,c0(2,4)),!this||!this.n||G._55O()>this.n._55O())return 0;if(0==(G=i(this._37O(G)[_](c0(2,4)).replace(C,""))).length)return!1;var v=G[0];return G[1]==r._4O.Util._56O(p,v)}}.bind(Q(t0))},zl.length-tl.length);if(0<p0)for(var G0=0;G0<p0;G0++)V=U.Util,o=T;B0=function(p,G){G=o(G);var v=Q(Mm),J=tJ.length,$=2*J,G=F(G,c0(J,$)),S=!0;if(S=v&&(O=v[lJ[0]])&&G._55O()<=O._55O()?!1:S)return 0;var O=i(v._37O(G)[_](c0(J,$)).replace(C,""));return 0!=O.length&&(S=O[0],O[1]==V._11A(p,S))}}(h),MS(N,{load:(W1={},function(p,G,v){var J,$=W1[p],S=v?"c_"+(v.sync?"1":"0")+"_"+(v.post?"1":"0")+"_"+(v.responseType||"H")+"_"+(v.mimeType||"H")+"_"+(v.data?JSON.stringify(v.data):"H"):"";$&&(J=$[S])?J.push(G):(W1[p]||($=W1[p]={count:0}),J=$[S]=[G],$.count++,N.xhrLoad(p,function(G){delete $[S],$.count--,$.count||delete W1[p],J.forEach(function(p){p(G)})},v))}),asyncEach:function(J,G,$){"function"!=typeof $&&($=Function.prototype);var S=new Array(J.length),O=0,W=!1;J.forEach(function(p,v){G(p,function(p,G){if(!W)return p?(W=!0,$(null)):(S[v]=G,++O===J.length?$(S):void 0)})})},xhrLoad:function(p,v,J){var $=!1,S=(lS(p)||($=!0,p=[p]),(J=J||{}).sync),O=null,G=J.method||"GET";if(J.post&&(G="POST"),J.method=G,N.asyncEach(p,function(p,G){var v;(p=N.beforeLoadURL(p)).data?G(null,p.data):(J.url=encodeURI(p),(v=new kI).onload=function(p){200===this.status||0===this.status?G(null,v.getResponseText()):G(!0)},v.onerror=function(p){G(!0)},v.send(J))},function(p){var G="function"==typeof v;(G||S)&&(O=$&&p?p[0]:p,G&&v(O))}),S)return O}}),d.setPrototypeOf||function(p,G){return p.__proto__=G,p}),ym=d.getPrototypeOf||function(p){return p.__proto__},xm=d.freeze,Rm=(d.isFrozen,kM.create=function(p,G){return function p(G,v,J,$){var S=$(J),O=new kM(G,v,J,S);if(!S){for(var W=O.children,l=O.childMap,t=d.keys(J),z=0,Z=t.length;z<Z;++z){var B=p(O,B=t[z],J[B],$);W.push(B),l[B.name]=B}O.children=xm(W),O.childMap=xm(l)}return xm(O),O}(K,K,p,G)},kM.prototype.forEach=function(p,G){for(var v=this.children,J=0,$=v.length;J<$;++J)p(v[J],G)},kM),xm=d.freeze,Nm={main:{mask:1,priority:N.cameraPriority.main,clearDepth:!1,ignore:!1},top:{mask:2,priority:N.cameraPriority.top,ignore:!1}},mm="main",Km=Nm[mm].mask,am=function(p,G){return p&&G&&p&G},um=function(p){return p.sort(function(p,G){return Nm[p].priority-Nm[G].priority})},Tm=um(d.keys(Nm)),Vm=Tm.length,o=(MS(N,{setRenderLayerInfo:function(p,G){var v=p;if(v in Nm)Nm[v].mask;else{if(!(Vm<32))throw new Error("Only 31 render layer can be defined.");Nm[v]={mask:1<<Vm++,priority:Nm[mm].priority},Nm[v].mask,Tm=um(d.keys(Nm)),Vm=Tm.length}if(G){for(var J in G)Nm[p][J]=G[J];G.priority&&(Tm=um(d.keys(Nm)))}},getRenderLayerInfo:function(p){return Nm[p]}},!0),E.List=function(){this._as=[];var p,G,v=arguments.length;if(1===v){var J=arguments[0];if(tS(J)&&(J=J._as),lS(J))for(G=J.length,p=0;p<G;p++)this._as.push(J[p]);else J!=v0&&this._as.push(J)}else if(1<v)for(p=0;p<v;p++)this._as.push(arguments[p])}),om=(Ph("List",d,{forEach:function(p,G){this.each(p,G)},push:function(){for(var p=0;p<arguments.length;p++)this.add(arguments[p])},pop:function(){return this._as.pop()},shift:function(){return this._as.shift()},unshift:function(){return this._as.unshift.apply(this._as,arguments)},size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(p,G){return G===K?this._as.push(p):this._as.splice(G,0,p)},addAll:function(p){tS(p)&&(p=p._as),lS(p)?qS(this._as,p):this._as.push(p)},get:function(p){return this._as[p]},slice:function(p,G){return new o(this._as.slice(p,G))},remove:function(p){return 0<=(p=this._as.indexOf(p))&&p<this._as.length&&this.removeAt(p),p},removeAt:function(p){return this._as.splice(p,1)[0]},set:function(p,G){return this._as[p]=G},clear:function(){return this._as.splice(0,this._as.length)},contains:function(p){return 0<=this._as.indexOf(p)},indexOf:function(p){return this._as.indexOf(p)},each:function(p,G){for(var v=0,J=this._as.length;v<J;v++){var $=this._as[v];G?p.call(G,$,v,this):p($,v,this)}},reverseEach:function(p,G){for(var v=this._as.length-1;0<=v;v--){var J=this._as[v];G?p.call(G,J):p(J)}},getArray:function(){return this._as},toArray:function(p,G){if(p){for(var v,J=[],$=0,S=this._as.length;$<S;$++)v=this._as[$],G?p.call(G,v)&&J.push(v):p(v)&&J.push(v);return J}return this._as.concat()},toList:function(p,G){if(p){for(var v,J=new o,$=0,S=this._as.length;$<S;$++)v=this._as[$],G?p.call(G,v)&&J.add(v):p(v)&&J.add(v);return J}return new o(this)},reverse:function(){this._as.reverse()},sort:function(p){return this._as.sort(p||gA),this},toString:function(){return this._as.toString()}}),d.defineProperties(o.prototype,{length:{get:function(){return this._as.length},set:function(p){this._as.length=p}}}),new o),Um=(MS(om,{size:function(){return 0},indexOf:function(){return-1},contains:function(){return!1},isEmpty:function(){return!0},sort:Ii,each:Ii,reverseEach:Ii,toArray:function(){return[]},toList:function(){return new o},add:Ei,addAll:Ei,set:Ei,remove:Ei,removeAt:Ei,clear:Ei}),E.Notifier=function(){this._f=0}),Fm=(Ph("Notifier",d,{contains:function(p,G){if(this._ls)for(var v,J=0,$=this._ls.size();J<$;J++)if(p===(v=this._ls.get(J)).l&&G===v.s)return!0;return!1},add:function(p,G,v){p={l:p,s:G,a:v},this._ls||(this._ls=new o),this._f?(this._as||(this._as=new o),this._as.add(p)):p.a?this._ls.add(p,0):this._ls.add(p)},remove:function(p,G){this._ls&&(this._f?(this._rs||(this._rs=new o),this._rs.add({l:p,s:G})):this._remove(p,G))},_remove:function(p,G){for(var v,J=this._ls,$=0,S=J.size();$<S;$++)if((v=J.get($)).l===p&&v.s===G)return void J.removeAt($)},fire:function(p){var G=this,v=G._ls;if(G._b=1e4,v){++G._f;try{for(var J,$=0,S=v.size();$<S;$++)(J=v.get($)).s?J.l.call(J.s,p):J.l(p)}catch(p){I0(function(){throw p})}finally{if(--G._f)return;if(G._rs){for(S=G._rs.size(),$=0;$<S;$++)J=G._rs.get($),G._remove(J.l,J.s);delete G._rs}if(G._as){for(S=G._as.size(),$=0;$<S;$++)(J=G._as.get($)).a?v.add(J,0):v.add(J);delete G._as}}}}}),E.Data=function(){this._id=fA()}),Cm=(Ph("Data",d,{ms_ac:["tag","name","displayName","icon","toolTip","attrObject","styleMap","layer","renderLayer","adjustChildrenToTop","dataBindings"],ms_dm:1,ms_attr:1,_icon:v0,_parent:v0,_children:om,_childMap:v0,_styleMap:v0,_layer:"0",_renderLayer:mm,_adjustChildrenToTop:!1,getRenderLayer:function(){return this._renderLayer||mm},getUIClass:function(){return v0},_22Q:function(){return v0},beginTransaction:function(){this._dataModel&&this._dataModel.beginTransaction()},endTransaction:function(){this._dataModel&&this._dataModel.endTransaction()},s:function(p,G){if(2===arguments.length)this.setStyle(p,G);else{if(!OS(p))return this.getStyle(p);for(var v in p)this.setStyle(v,p[v])}return this},fp:function(p,G,v,J,$){return this.firePropertyChange(p,G,v,J,$)},firePropertyChange:function(p,G,v,J,$){if(J){if(J(G,v))return!1}else if(G===v)return!1;return(J=$||{}).property=p,J.oldValue=G,J.newValue=v,(J.data=this)._dataModel&&this._dataModel.handleDataPropertyChange(J),this.onPropertyChanged(J),!0},onPropertyChanged:function(p){var G,v,J=this._parent,$=p.property;ZS(J)&&(v="s:ingroup"===$,((G=this.s(nJ))&&Sj[$]||$===v)&&J._81I(),(G||v)&&J.fp("childChange",!0,!1)),fS(J)&&(Sj[$]||"elevation"===$||Wj[$]||"scaleTall"===$||"tall"===$)&&J.updateFromChildren(),"s:alwaysOnTop"!==$&&"s:shape3d.alwaysOnTop"!==$||(p.newValue?this.setRenderLayer("top"):this.setRenderLayer(K))},_21I:function(p){if(p&&this._dataModel)throw"Remove data from dataModel before adding";this._dataModel=p},removeFromDataModel:function(){this._dataModel?this._dataModel.remove(this):this.setParent(null)},clearChildrenFromDataModel:function(p){for(var G=0,v=this._children.toArray(),J=v.length;G<J;G++)v[G].removeFromDataModel()},getId:function(){return this._id},setId:function(p){this._id=p},getChildren:function(){return this._children},size:function(){return this._children.size()},toChildren:function(p,G){return this._children.toList(p,G)},eachChild:function(p,G){this._children.each(p,G)},addChild:function(p,G){var v=this;p!==v&&(v._children===om&&(v._children=new o,v._childMap={}),0<=G||(G=v._children.size()),v._childMap[p._id]||v.isDescendantOf(p)||(p._parent&&p._parent.removeChild(p),(G<0||G>v._children.size())&&(G=v._children.size()),v._children.add(p,G),(v._childMap[p._id]=p).setParent(v),v.onChildAdded(p,G),v.fp(_l,v0,p)))},onChildAdded:function(p,G){},removeChild:function(p){var G;this._childMap&&this._childMap[p._id]&&(G=this._children.remove(p),delete this._childMap[p._id],this.fp(_l,p,v0),p.setParent(v0,G),this.onChildRemoved(p,G))},onChildRemoved:function(p,G){},getChildAt:function(p){return this._children.get(p)},clearChildren:function(){if(!this._children.isEmpty())for(var p=0,G=this._children.toArray(),v=G.length;p<v;p++)this.removeChild(G[p])},getParent:function(){return this._parent},setParent:function(p,G){var v,J,$=this;$._73I||$._parent===p||$===p||p&&p.isDescendantOf($)||(v=$._parent,$._parent=p,$._73I=1,v?(G==v0&&(G=v.getChildren().indexOf($)),v.removeChild($)):$._dataModel&&G==v0&&(G=$._dataModel.getRoots().indexOf($)),p&&(p.addChild($),J=p.getChildren().indexOf($)),delete $._73I,$.fp("parent",v,p,K,{oldIndex:G,newIndex:J}),$.onParentChanged(v,p))},onParentChanged:function(p,G){},hasChildren:function(){return 0<this._children.size()},isEmpty:function(){return this._children.isEmpty()},isRelatedTo:function(p){return!!p&&(this.isDescendantOf(p)||p.isDescendantOf(this))},isParentOf:function(p){return!(!p||!this._childMap||!this._childMap[p._id])},isDescendantOf:function(p){if(!p||p.isEmpty())return!1;for(var G=this._parent;G;){if(p===G)return!0;G=G._parent}return!1},getStyle:function(p,G){G===K&&(G=1);var v=this._styleMap?this._styleMap[p]:K;return v===K&&G?F[p]:v},setStyle:function(p,G){this._styleMap||(this._styleMap={});var v=this._styleMap[p];G===K?delete this._styleMap[p]:this._styleMap[p]=G,this.fp("s:"+p,v,G)&&this.onStyleChanged(p,v,G)},onStyleChanged:function(p,G,v){},iv:function(p){this.invalidate(p)},invalidate:function(p){this.fp(p||"*",!1,!0)},toString:function(){return this._displayName||this._name||this._tag||this._id},toLabel:function(){return this._displayName||this._name},addStyleIcon:function(p,G){var v=this.s(AJ);this.beginTransaction(),v||this.s(AJ,v={}),G?v[p]=G:delete v[p],this.fp(AJ,v0,v),this.endTransaction()},removeStyleIcon:function(p){var G,v=this.s(AJ);return v&&(G=v[p],delete v[p],this.fp(AJ,v0,v)),G},_calcAnchorMatrix3d:function(){},appendAnchorMatrix3d:function(p){var G,v,J;(this.hasOwnProperty("_anchor")||this.hasOwnProperty("_anchorElevation"))&&(G=(J=this.getAnchor3d()).x-.5,v=J.y-.5,J=J.z-.5,Fs(p,[-G,-v,-J]))},getSerializableProperties:function(){return{name:1,displayName:1,icon:1,toolTip:1,parent:1,layer:1,renderLayer:1,tag:1,adjustChildrenToTop:1,dataBindings:1}},getSerializableStyles:function(){var p,G={};for(p in this._styleMap)G[p]=1;return G},getCurrentPrefix:function(){return this._interactPrefix||hm},ca:function(p,G){return p=this.getCurrentPrefix()+p,2===arguments.length?this.a(p,G):this.a(p)}}),E.DataModel=function(){var J=this,$=(J._isDeserializing=0,J._datas=new o,J._dataMap={},J._roots=new o,J._rootMap={},J._fsDataMap={},J._78O={},J._reflectorMap={},J._36I=new Um,J._35I=new Um,J._serializeNotifier=new Um,J._selectionModel=new Qm(J),J._29Q=[]),S=J._scheduleCallback=function(){for(var p=Date.now(),G=0;G<$.length;G++){var v=$[G];v.enabled&&p-v.lastTime>v.interval&&(v.beforeAction&&v.beforeAction(),v.action&&J.each(function(p){v.action(p)}),v.afterAction&&v.afterAction(),v.lastTime=p)}$.length&&(J._30Q=h.requestAnimationFrame(S))}}),Qm=(Ph("DataModel",d,{ms_fire:1,ms_attr:1,ms_ac:["layers","name","autoAdjustIndex","hierarchicalRendering","background","envmapType","envmap","postProcessingData","init"],_name:K,_autoAdjustIndex:!0,_hierarchicalRendering:!1,_background:K,_init:K,_envmap:K,_envmapType:K,_postProcessingData:K,sm:function(){return this.getSelectionModel()},mm:function(p,G,v){this.addDataModelChangeListener(p,G,v)},umm:function(p,G){this.removeDataModelChangeListener(p,G)},md:function(p,G,v){this.addDataPropertyChangeListener(p,G,v)},umd:function(p,G){this.removeDataPropertyChangeListener(p,G)},mh:function(p,G,v){this.addHierarchyChangeListener(p,G,v)},umh:function(p,G){this.removeHierarchyChangeListener(p,G)},getAttrObject:function(){return this._attrObject},setAttrObject:function(p){return this._attrObject=p},getSelectionModel:function(){return this._selectionModel},size:function(){return this._datas.size()},isEmpty:function(){return this._datas.isEmpty()},getRoots:function(){return this._roots},getDatas:function(){return this._datas},getFullscreenDatas:function(){return this._fsDataMap},getReflectors:function(){return this._reflectorMap},getDataById:function(p){return this._dataMap[p]},removeDataById:function(p){this.remove(this.getDataById(p))},toDatas:function(p,G){return this._datas.toList(p,G)},each:function(p,G){this._datas.each(p,G)},getDataByTag:function(p){return this._78O[p]},getTagMap:function(){return this._78O},removeDataByTag:function(p){this.remove(this.getDataByTag(p))},add:function(p,G,v){var J=this,$=p._id,S=p._tag,O=J._roots;if(J._dataMap[$])throw"'"+$+"' already exists";S!=v0&&(J._78O[S]=p),J._dataMap[$]=p,0<=v?J._datas.add(p,v):J._datas.add(p),p._parent||(J._rootMap[$]=p,0<=G?O.add(p,G):O.add(p)),p.s("fullscreen")!==K&&(J._fsDataMap[$]=p),p.s("shape3d.reflector")&&(J._reflectorMap[$]=p),p._21I(J),J.onAdded(p),J._36I.fire({kind:"add",data:p,rootsIndex:G,datasIndex:v})},onAdded:function(p){},remove:function(p,G){var v,J,$,S,O,W,l;p&&(v=this,J=p._id,$=G&&G.keepStructure,W=G&&G.keepChildren,S=p.getTag(),p._dataModel===v&&((O=p instanceof hI)&&N.setIsolating(!0),this.beginTransaction(),$?v._removingData||(v._removingData=p):v.prepareRemove(p),W||p.toChildren().each(function(p){v.remove(p,G)},v),$?v._removingData===p&&(p._parent&&p._parent.removeChild(p),delete v._removingData):p._parent&&p._parent.removeChild(p),W=v._datas.remove(p),delete v._dataMap[J],S!=v0&&delete v._78O[S],v._rootMap[J]&&(delete v._rootMap[J],l=v._roots.remove(p)),v._fsDataMap[J]&&delete v._fsDataMap[J],v._reflectorMap[J]&&delete v._reflectorMap[J],p._21I(v0),v.onRemoved(p),v._36I.fire({kind:LJ,data:p,rootsIndex:l,datasIndex:W}),this.endTransaction(),O&&N.setIsolating(!1)))},onRemoved:function(p){},prepareRemove:function(p){},clear:function(){var p,G=this;G._datas.size()&&(p=G._historyManager?this.toJSON():K,G._datas.toArray().forEach(function(p){p._21I(v0)}),G._datas.clear(),G._dataMap={},G._roots.clear(),G._rootMap={},G._fsDataMap={},G._reflectorMap={},G._78O={},G._36I.fire({kind:HJ,json:p}))},contains:function(p){return p&&p._dataModel===this},handleDataPropertyChange:function(p){var G,v,J,$,S=p.data,O=p.property;"parent"===O?(J=S._id,v=this._rootMap,G=this._roots,S._parent?v[J]&&(delete v[J],G.remove(S)):v[J]||(v[J]=S,G.add(S))):"tag"===O?(v=p.oldValue,G=p.newValue,$=this._78O,v!=v0&&delete $[v],G!=v0&&($[G]=S)):"s:fullscreen"===O?(J=S._id,v=this._fsDataMap,p.oldValue!=v0&&delete v[J],p.newValue!=v0&&(v[J]=S)):"s:shape3d.reflector"===O&&(J=S._id,$=this._reflectorMap,p.oldValue&&delete $[J],p.newValue&&($[J]=S)),this.onDataPropertyChanged(S,p),this._35I.fire(p)},onDataPropertyChanged:function(p,G){},addDataModelChangeListener:function(p,G,v){this._36I.add(p,G,v)},removeDataModelChangeListener:function(p,G){this._36I.remove(p,G)},addSerializeListener:function(p,G,v){this._serializeNotifier.add(p,G,v)},removeSerializeListener:function(p,G){this._serializeNotifier.remove(p,G)},fireSerializeEvent:function(p){this._serializeNotifier.fire(p)},addDataPropertyChangeListener:function(p,G,v){this._35I.add(p,G,v)},removeDataPropertyChangeListener:function(p,G){this._35I.remove(p,G)},_38I:function(p,G,v){this._37I&&this._37I.fire({data:p,oldIndex:G,newIndex:v})},addHierarchyChangeListener:function(p,G,v){this._37I||(this._37I=new Um),this._37I.add(p,G,v)},removeHierarchyChangeListener:function(p,G){this._37I.remove(p,G)},getSiblings:function(p){return(p=p._parent)?p._children:this._roots},eachByHierarchical:function(p,G,v){if(G)return this._eachByHierarchical(p,G,v);for(var J=0,$=this._roots,S=$.size();J<S;J++)if(!1===this._eachByHierarchical(p,$.get(J),v))return!1;return!0},_eachByHierarchical:function(p,G,v){if(v){if(!1===p.call(v,G))return!1}else if(!1===p(G))return!1;for(var J=G.size(),$=0;$<J;$++)if(!1===this._eachByHierarchical(p,G.getChildAt($),v))return!1;return!0},reverseEachByHierarchical:function(p,G,v){if(G)return this._reverseEachByHierarchical(p,G,v);for(var J=this._roots,$=J.size()-1;0<=$;$--)if(!1===this._reverseEachByHierarchical(p,J.get($),v))return!1;return!0},_reverseEachByHierarchical:function(p,G,v){for(var J=G.size()-1;0<=J;J--)if(!1===this._reverseEachByHierarchical(p,G.getChildAt(J),v))return!1;if(v){if(!1===p.call(v,G))return!1}else if(!1===p(G))return!1;return!0},eachByDepthFirst:function(p,G,v){if(G)return this._11I(p,G,v);for(var J=0,$=this._roots,S=$.size();J<S;J++)if(!1===this._11I(p,$.get(J),v))return!1;return!0},_11I:function(p,G,v){for(var J=G.size(),$=0;$<J;$++)if(!1===this._11I(p,G.getChildAt($),v))return!1;if(v){if(!1===p.call(v,G))return!1}else if(!1===p(G))return!1;return!0},eachByBreadthFirst:function(p,G,v){var J=new o;for(G?J.add(G):this._roots.each(J.add,J);0<J.size();)if((G=J.removeAt(0)).eachChild(J.add,J),v){if(!1===p.call(v,G))return!1}else if(!1===p(G))return!1;return!0},moveTo:function(p,G){var v=this.getSiblings(p),J=v.indexOf(p);J===G||J<0||0<=G&&G<=v.size()&&(v.remove(p),G>v.size()&&G--,v.add(p,G),this._38I(p,J,G))},moveUp:function(p){this.moveTo(p,this.getSiblings(p).indexOf(p)-1)},moveDown:function(p){this.moveTo(p,this.getSiblings(p).indexOf(p)+1)},moveToTop:function(p){this.moveTo(p,0)},moveToBottom:function(p){this.moveTo(p,this.getSiblings(p).size())},moveSelectionUp:function(p){this.beginTransaction(),p=p||this.sm();var G=new o;q4(p,G,this._roots),G.each(this.moveUp,this),this.endTransaction()},moveSelectionDown:function(p){this.beginTransaction(),p=p||this.sm();var G=new o;g4(p,G,this._roots),G.each(this.moveDown,this),this.endTransaction()},moveSelectionToTop:function(p){this.beginTransaction(),p=p||this.sm();var G=new o;X4(p,G,this._roots),G.each(this.moveToTop,this),this.endTransaction()},moveSelectionToBottom:function(p){this.beginTransaction(),p=p||this.sm();var G=new o;f4(p,G,this._roots),G.each(this.moveToBottom,this),this.endTransaction()},moveToIndex:function(p,G,v){var J=this.getDatas();(v=null==v?J.indexOf(p):v)===G||v<0||0<=G&&G<=J.size()&&(J.remove(p),G>J.size()&&G--,J.add(p,G),this._76I(p,v,G))},bringForward:function(p){this.moveToIndex(p,this.getDatas().indexOf(p)+1)},bringToFront:function(p){this.moveToIndex(p,this.size())},sendBackward:function(p){this.moveToIndex(p,this.getDatas().indexOf(p)-1)},sendToBack:function(p){this.moveToIndex(p,0)},bringSelectionForward:function(p){this.beginTransaction(),p=p||this.sm();for(var G=new o,v=this.getDatas(),J=!1,$=0;$<v.size();$++){var S=v.get(v.size()-1-$);p.contains(S)?J&&G.add(S):J=!0}G.each(this.bringForward,this),this.endTransaction()},bringSelectionToFront:function(p){this.beginTransaction(),p=p||this.sm();for(var G=new o,v=this.getDatas(),J=0;J<v.size();J++){var $=v.get(J);p.contains($)&&G.add($)}G.each(this.bringToFront,this),this.endTransaction()},sendSelectionBackward:function(p){this.beginTransaction(),p=p||this.sm();for(var G=new o,v=this.getDatas(),J=!1,$=0;$<v.size();$++){var S=v.get($);p.contains(S)?J&&G.add(S):J=!0}G.each(this.sendBackward,this),this.endTransaction()},sendSelectionToBack:function(p){this.beginTransaction(),p=p||this.sm();for(var G=new o,v=this.getDatas(),J=0;J<v.size();J++){var $=v.get(v.size()-1-J);p.contains($)&&G.add($)}G.each(this.sendToBack,this),this.endTransaction()},addScheduleTask:function(p){this.removeScheduleTask(p),p.enabled==v0&&(p.enabled=!0),p.interval==v0&&(p.interval=10),p.lastTime=Date.now(),this._29Q.push(p),this._30Q==v0&&(this._30Q=h.requestAnimationFrame(this._scheduleCallback))},removeScheduleTask:function(p){var G=this._29Q;0<=(p=G.indexOf(p))&&G.splice(p,1),G.length||this._30Q==v0||(h.cancelAnimationFrame(this._30Q),delete this._30Q)},getHistoryManager:function(){return this._historyManager},enableHistoryManager:function(p){this._historyManager||new E.HistoryManager(this),null!=p&&this._historyManager.setMaxHistoryCount(p),this._historyManager.setDisabled(!1)},disableHistoryManager:function(){this._historyManager&&this._historyManager.setDisabled(!0)},clearHistoryManager:function(){this._historyManager&&this._historyManager.clear()},undo:function(p){this._historyManager&&this._historyManager.undo(p)},redo:function(p){this._historyManager&&this._historyManager.redo(p)},beginTransaction:function(){this._historyManager&&this._historyManager.beginTransaction()},endTransaction:function(){this._historyManager&&this._historyManager.endTransaction()},addHistory:function(p){this._historyManager&&this._historyManager.addHistory(p)},onHistoryManagerChanged:function(){},isDeserializing:function(){return 0<this._isDeserializing},setDeserializing:function(p){p?this._isDeserializing++:this._isDeserializing--},isCubicEnvmap:function(){return!1},setCubicEnvmap:function(p){},setEnvmap:function(p){var G=this._envmap;G===(this._envmap=p)&&lS(G)&&lS(p)&&(G=[]),this.fp("envmap",G,p)}}),E.SelectionModel=function(p){this._68O=o0,this._map={},this._73O=new o,this._74I=new Um,this._21I(p)}),pj=(Ph("SelectionModel",d,{ms_fire:1,ms_dm:1,ms:function(p,G,v){this.addSelectionChangeListener(p,G,v)},ums:function(p,G){this.removeSelectionChangeListener(p,G)},fd:function(){return this.getFirstData()},ld:function(){return this.getLastData()},sg:function(){return this._68O===V0},co:function(p){return this._map[p._id]!=v0},ss:function(p){this.setSelection(p)},as:function(p){this.appendSelection(p)},rs:function(p){this.removeSelection(p)},cs:function(){this.clearSelection()},sa:function(){this.selectAll()},getSelectionMode:function(){return this._68O},setSelectionMode:function(p){var G;this._68O===p||p!==lJ&&p!==V0&&p!==o0||(this.cs(),G=this._68O,this._68O=p,this.fp("selectionMode",G,p))},_21I:function(p){var G=this._dataModel;G!==p&&(G&&(this.cs(),G.umm(this.handleDataModelChange,this)),(this._dataModel=p).mm(this.handleDataModelChange,this,!0),this.fp(Dl,G,p))},dispose:function(){this.cs(),this._dataModel.umm(this.handleDataModelChange,this)},handleDataModelChange:function(p){var G;p.kind===LJ?(G=p.data,this.co(G)&&(this._73O.remove(G),delete this._map[G._id],this._75I(LJ,new o(G)))):p.kind===HJ&&this.cs()},getFilterFunc:function(){return this._filterFunc},setFilterFunc:function(p){var G;this._filterFunc!==p&&(this.cs(),G=this._filterFunc,this._filterFunc=p,this.fp("filterFunc",G,this._filterFunc))},_75I:function(p,G,v,J){v&&(this._73O.each(function(p){J[p._id]?v.remove(p):v.add(p)}),G=v.toList()),this._74I.fire({kind:p,datas:new o(G)})},addSelectionChangeListener:function(p,G,v){this._74I.add(p,G,v)},removeSelectionChangeListener:function(p,G){this._74I.remove(p,G)},_97O:function(p,G){for(var v,J=0,$=new o(p);J<$.size();J++)v=$.get(J),(this._filterFunc&&!this._filterFunc(v)||G&&this.co(v)||!G&&!this.co(v)||!this._dataModel.contains(v))&&($.removeAt(J),J--);return $},appendSelection:function(p){var G,v,J,$=this;$._68O!==lJ&&(G=$._73O,(p=$._97O(p,!0)).isEmpty()||($.sg()&&(v=new o(G),J=$._map,G.clear(),$._map={},p=new o(p.get(p.size()-1))),p.each(function(p){G.add(p),$._map[p._id]=p}),$._75I("append",p,v,J)))},removeSelection:function(p){var G=this._97O(p),v=0,J=G.size();if(0!==J){for(;v<J;v++){var $=G.get(v);this._73O.remove($),delete this._map[$._id]}this._75I(LJ,G)}},toSelection:function(p,G){return this._73O.toList(p,G)},getSelection:function(){return this._73O},each:function(p,G){this._73O.each(p,G)},setSelection:function(p){var G,v,J=this,$=J._73O;J._68O===lJ||$.isEmpty()&&!p||1===$.size()&&J.ld()===p||(G=new o($),v=J._map,$.clear(),J._map={},p=J._97O(p,!0),(p=J.sg()&&1<p.size()?new o(p.get(p.size()-1)):p).each(function(p){$.add(p),J._map[p._id]=p}),J._75I("set",v0,G,v))},clearSelection:function(){var p,G=this._73O;0<G.size()&&(p=G.toList(),G.clear(),this._map={},this._75I(HJ,p))},selectAll:function(){var p=this;if(p._68O!==lJ){var G,v=p._dataModel.toDatas();if(p._filterFunc)for(W=0;W<v.size();W++)G=v.get(W),p._filterFunc(G)||(v.removeAt(W),W--);for(var J=p._73O,$=new o(J),S=p._map,O=(J.clear(),p._map={},(v=p.sg()&&1<v.size()?new o(v.get(v.size()-1)):v).size()),W=0;W<O;W++)G=v.get(W),J.add(G),p._map[G._id]=G;p._75I("all",v0,$,S)}},size:function(){return this._73O.size()},isEmpty:function(){return this._73O.isEmpty()},contains:function(p){return this._map[p._id]!=v0},getLastData:function(){var p=this._73O;return 0<p.size()?p.get(p.size()-1):v0},getFirstData:function(){var p=this._73O;return 0<p.size()?p.get(0):v0},isSelectable:function(p){return!(!p||this._68O===lJ)&&(!this._filterFunc||this._filterFunc(p))},getTopSelection:function(){var v=this,J=new o;return v._73O.each(function(p){for(var G=p.getParent();G;){if(v.contains(G)){p=v0;break}G=G.parent}p&&J.add(p)}),J}}),function(p,G,v,J){var $=this,p=(G||(G=u0?5:3,J=v=20),{x:0,y:G,width:v,height:J});if(v)for(var S=0;S<v;S++)if(3===v)J=20;else for(var O=0;O<J;O++)$=h||v;AA(p,{x:j,y:2*j})&&(G=bJ[0]+pJ[0]+HJ[1]+gl.length,xE.eye=[$[G],$[p=aJ[0]+ql[0]+HJ[1]+PJ.length]],$[G]=vS.eye,$[p]=vS[cl])}(),function(p,G){var v;return(v=BS(G)&&(p=p.getDataUI(G))&&p._88I?p._88I.rect:v)||G.getRect()});MS(N,{edgeGroupAgentFunc:v0,graphViewAutoScrollZone:16,graphViewZoomable:!0,graphViewResettable:!1,graphViewPannable:!0,graphViewRectSelectable:!0,graphViewScrollBarVisible:!0,graphViewRectSelectBorderColor:s.rectSelectBorder,graphViewRectSelectBackground:Cl,graphViewEditPointSize:u0?17:7,graphViewEditPointBorderColor:s.editPointBorder,graphViewEditPointBackground:s.editPointBackground,setEdgeType:function(p,G,v){wi[p]=G,Pi[p]=v},getEdgeType:function(p){return wi[p]},getEdgeTypeMap:function(){return wi},getNodeRect:pj},!0);(i0={"layout.h":K,"layout.v":K,"2d.selectable":!0,"2d.visible":!0,"2d.movable":!0,"2d.editable":!0,"2d.move.mode":K,"2d.attachable":!1,"2d.hostable":!1,interactive:!1,preventDefaultWhenInteractive:!0,disableDoubleClick:!1,"image.stretch":"fill",icons:K,ingroup:!0,"body.color":K,"2d.gray":!1,fullscreen:K,"fullscreen.gap":2,"fullscreen.lock":!1,opacity:K,pixelPerfect:!0,keepAspectRatio:!1,"attach.points":null,"attach.style":null,"attach.close.threshold":16,"vector.layoutable":!1,"clip.direction":"top","clip.percentage":K,"clip.host":!1,"select.color":r4,"select.width":1,"select.padding":2,"select.type":y,"shadow.interactable":!0,shadow:!1,"shadow.blur":6,"shadow.offset.x":3,"shadow.offset.y":3,shadow2:!1,"shadow2.color":r4,"shadow2.blur":6,"shadow2.offset.x":3,"shadow2.offset.y":3,"border.color":K,"border.width":2,"border.padding":2,"border.type":y,label:K,"label.font":K,"label.color":oh,"label.background":K,"label.position":31,"label.position.fixed":!1,"label.offset.x":0,"label.offset.y":2,"label.rotation":K,"label.max":K,"label.opacity":K,"label.scale":1,"label.align":K,"label.selectable":!0,"label.decoration":K,label2:K,"label2.font":K,"label2.color":oh,"label2.background":K,"label2.position":34,"label2.position.fixed":!1,"label2.offset.x":0,"label2.offset.y":-2,"label2.rotation":K,"label2.max":K,"label2.opacity":K,"label2.scale":1,"label2.align":K,"label2.selectable":!0,"label2.decoration":K,note:K,"note.expanded":!0,"note.font":K,"note.color":e0,"note.background":r4,"note.position":8,"note.offset.x":-3,"note.offset.y":3,"note.max":K,"note.toggleable":!0,"note.border.width":1,"note.border.color":K,"note.opacity":K,"note.scale":1,"note.align":K,note2:K,"note2.expanded":!0,"note2.font":K,"note2.color":e0,"note2.background":r4,"note2.position":3,"note2.offset.x":3,"note2.offset.y":-3,"note2.max":K,"note2.toggleable":!0,"note2.border.width":1,"note2.border.color":K,"note2.opacity":K,"note2.scale":1,"note2.align":K,"group.type":K,"group.image":K,"group.image.stretch":"fill","group.repeat.image":K,"group.border.repeat.image":K,"group.padding":8,"group.padding.left":0,"group.padding.right":0,"group.padding.top":0,"group.padding.bottom":0,"group.position":17,"group.toggleable":!0,"group.title.font":K,"group.title.color":e0,"group.title.background":s.groupTitleBackground,"group.title.align":C0,"group.title.orientation":pJ,"group.background":s.groupBackground,"group.depth":1,"group.border.width":1,"group.border.pattern":K,"group.border.color":v,"group.border.radius":K,"group.border.cap":Th,"group.border.join":Vh,"group.border.width.absolute":!1,"group.splitLine":!1,"group.gradient":v0,"group.gradient.color":"#FFF",shape:K,"shape.background":v,"shape.repeat.image":K,"shape.border.repeat.image":K,"shape.border.width":0,"shape.border.width.absolute":!1,"shape.border.color":v,"shape.border.3d":!1,"shape.border.3d.color":K,"shape.border.3d.accuracy":K,"shape.border.cap":Th,"shape.border.join":Vh,"shape.border.pattern":K,"shape.gradient":v0,"shape.gradient.color":"#FFF","shape.depth":0,"shape.dash":!1,"shape.dash.pattern":uh,"shape.dash.offset":0,"shape.dash.color":D4,"shape.dash.width":K,"shape.dash.3d":!1,"shape.dash.3d.color":K,"shape.dash.3d.accuracy":K,"shape.polygon.side":6,"shape.arc.from":j,"shape.arc.to":W0,"shape.arc.close":!0,"shape.arc.oval":!1,"shape.corner.radius":K,"shape.gradient.pack":K,"shape.border.gradient.pack":K,"shape.fill.rule":"nonzero","shape.fill.clip.direction":"top","shape.fill.clip.percentage":K,"shape.foreground":K,"shape.foreground.gradient":v0,"shape.foreground.gradient.color":"#FFF","shape.foreground.clip.direction":"top","shape.foreground.clip.percentage":K,"shape.regular":!0,"autolayout.gap":K,"autolayout.hgap":K,"autolayout.vgap":K,"edge.type":K,"edge.points":K,"edge.segments":K,"edge.color":v,"edge.width":2,"edge.width.absolute":!1,"edge.repeat.image":null,"edge.offset":0,"edge.group":0,"edge.expanded":!0,"edge.gap":12,"edge.toggleable":!0,"edge.center":!1,"edge.3d":!1,"edge.3d.color":K,"edge.3d.accuracy":K,"edge.cap":Th,"edge.join":Vh,"edge.source.position":17,"edge.source.anchor.x":K,"edge.source.anchor.y":K,"edge.source.offset.x":0,"edge.source.offset.y":0,"edge.source.index":-1,"edge.source.percent":0,"edge.target.position":17,"edge.target.anchor.x":K,"edge.target.anchor.y":K,"edge.target.offset.x":0,"edge.target.offset.y":0,"edge.target.index":-1,"edge.target.percent":0,"edge.pattern":K,"edge.dash":!1,"edge.dash.pattern":uh,"edge.dash.offset":0,"edge.dash.color":D4,"edge.dash.width":K,"edge.dash.3d":!1,"edge.dash.3d.color":K,"edge.dash.3d.accuracy":K,"edge.independent":!1,"attach.row.index":0,"attach.column.index":0,"attach.row.span":1,"attach.column.span":1,"attach.padding":0,"attach.padding.left":0,"attach.padding.right":0,"attach.padding.top":0,"attach.padding.bottom":0,"attach.index":-1,"attach.offset":0,"attach.offset.relative":!1,"attach.offset.opposite":!1,"attach.thickness":K,"attach.gap":0,"attach.gap.relative":!1,"grid.row.count":1,"grid.column.count":1,"grid.row.percents":K,"grid.column.percents":K,"grid.border":1,"grid.border.left":0,"grid.border.right":0,"grid.border.top":0,"grid.border.bottom":0,"grid.gap":1,"grid.background":s.gridBackground,"grid.depth":1,"grid.cell.depth":-1,"grid.cell.border.color":s.gridCellBorderColor,"grid.block":K,"grid.block.padding":3,"grid.block.width":1,"grid.block.color":s.gridBlockColor,text:"","text.align":"left","text.vAlign":"middle","text.color":oh,"text.gradient.pack":K,"text.font":Uh,"text.shadow":!1,"text.shadow.color":r4,"text.shadow.blur":6,"text.shadow.offset.x":3,"text.shadow.offset.y":3,"text.scale.x":1,"text.scale.y":1,"text.gradient":K,"text.gradient.color":"#FFF","text.decoration":K,"text.vertical":!1,"text.vertical.gap":1,"text.wrap":!1,"text.letter.gap":null,"text.border.color":r4,"text.border.width":0,keepPosition:!0})[Yl]=K,MS(F,i0,!0),MS(Cm,{_76I:function(p,G,v){this._39I&&this._39I.fire({data:p,oldIndex:G,newIndex:v})},addIndexChangeListener:function(p,G,v){this._39I||(this._39I=new Um),this._39I.add(p,G,v)},removeIndexChangeListener:function(p,G){this._39I.remove(p,G)},prepareRemove:function(p){zS(p)&&(p.setSource(v0),p.setTarget(v0)),p._70O&&p._70O.toList().each(this.remove,this),p._69O&&p._69O.toList().each(function(p){p.setHost(v0)}),p._host&&p.setHost(v0)},onAdded:function(p){this.isAutoAdjustIndex()&&this.adjustIndex(p)},onDataPropertyChanged:function(p,G){$j[G.property]&&this.isAutoAdjustIndex()&&this.adjustIndex(p)},isAdjustable:function(p){return k(p)||zS(p)},isAdjustedToBottom:function(p){return!!ZS(p)&&p.isExpanded()&&Xj(p)},adjustIndex:function(p){this.isHierarchicalRendering()||(this.isAdjustedToBottom(p)?(this.sendToBottom(p),p.eachChild(this.adjustIndex,this)):this.sendToTop(p))},sendToTop:function(G){var p,v,J=this;J.contains(G)&&J.isAdjustable(G)&&(v=J._datas,G!==v.get(J.size()-1)&&(p=v.indexOf(G),v.removeAt(p),v.add(G),J._76I(G,p,J.size()-1)),zS(G)&&((v=G._40I)&&!J.isAdjustedToBottom(v)&&J.sendToTop(v),(v=G._41I)&&!J.isAdjustedToBottom(v)&&J.sendToTop(v)),G._69O&&G._69O.each(function(p){p.isRelatedTo(G)||k(G)&&p.isLoopedHostOn(G)||J.sendToTop(p)}),G.ISubGraph||ZS(G)&&!G.isExpanded()||G._adjustChildrenToTop&&G.eachChild(function(p){zS(p)||J.sendToTop(p)}))},sendToBottom:function(p,G){var v,J;p!==G&&this.contains(p)&&this.isAdjustable(p)&&(G&&!this.contains(G)||(v=(J=this._datas).remove(p),G=G?this._datas.indexOf(G):0,J.add(p,G),v!==G&&(this._76I(p,v,G),!(J=p._parent)||J.ISubGraph||zS(J)||this.sendToBottom(p._parent,p))))}}),MS(Ih,{ms_edit:function(p,G){p._46O=function(p){var G=this,v=G.gv.dm(),J=G._index,$=G._89I,S=G._node,O=G._shape,W=G._edge,l=G._77I;S&&$?(this.fi({kind:"endEditRect",event:p,data:S,direction:$}),v.endTransaction()):O&&0<=J?(G.fi({kind:"endEditPoint",event:p,data:O,index:J}),v.endTransaction()):W&&0<=J?(G.fi({kind:"endEditPoint",event:p,data:W,index:J}),v.endTransaction()):l&&(G.fi({kind:"endEditRotation",event:p,data:l}),v.endTransaction())},p._78I=function(p){var G=this,v=(G.autoScroll(p),G.gv.lp(p)),J=G._index,$=G._89I,S=G._node,O=G._shape,W=G._edge,l=G._77I;S&&$?(G._80O(v),G.fi({kind:"betweenEditRect",event:p,data:S,direction:$})):O&&0<=J?(v.e=O.getPoints().get(J).e,O.setPoint(J,v),G.fi({kind:"betweenEditPoint",event:p,data:O,index:J})):W&&0<=J?(S=W.s(NJ),v.e=S.get(J).e,S.set(J,v),W.fp(NJ,v0,S),G.fi({kind:"betweenEditPoint",event:p,data:W,index:J})):l&&($=l.p(),O=l.getScale(),S=w0+P0(v.y-$.y,v.x-$.x),O.y<0&&(S+=j),I(S)<.04&&(S=0),l.setRotation(S),G.fi({kind:"betweenEditRotation",event:p,data:l}))},p._80O=function(p){var G=this._node,v=this._rect,J=v.x,$=v.y,S=v.width,O=v.height,W=this._89I,l=this._anchor,t=this._matrix,p=t.tfi(p);"northwest"===W?v=rA(p,{x:J+S,y:$+O}):W===WJ?v=rA({x:J,y:p.y},{x:J+S,y:$+O}):"northeast"===W?v=rA({x:J,y:p.y},{x:p.x,y:$+O}):W===OJ?v=rA({x:p.x,y:$},{x:J+S,y:$+O}):W===SJ?v=rA({x:J,y:$},{x:p.x,y:$+O}):"southwest"===W?v=rA({x:p.x,y:$},{x:J+S,y:p.y}):"south"===W?v=rA({x:J,y:$},{x:J+S,y:p.y}):"southeast"===W&&(v=rA({x:J,y:$},p)),G.setPosition(t.tf(v.x+v.width*l.x,v.y+v.height*l.y)),G.setWidth(v.width),G.setHeight(v.height)},p._80I=function(p,G,v,J){var $=this.gv._zoom,$=(this.gv.getEditPointSize()+2)/$;return!!AA({x:G-$/2,y:v-$/2,width:$,height:$},p)&&(this._89I!==J&&(this._89I=J),!0)},p._79I=function(p,G,v){var J=this,$=J.gv,S=G?$.getDataUI(G):v0;if(S=S?S._55O:v0){var O,W,l=$._zoom,t=($.getEditPointSize()+2)/l,z=$.lp(p);if(k(G)){if(S._56O&&k(G)&&(O=S._98o,AA({x:O.x-t/2,y:O.y-t/2,width:t,height:t},z)))return J._77I=G,v&&J.fi({kind:"beginEditRotation",event:p,data:G}),J.setCursor("crosshair"),!0;if(S._43O&&G instanceof dI)for(f=(W=G.getPoints()).size()-1;0<=f;f--)if(O=W.get(f),AA({x:O.x-t/2,y:O.y-t/2,width:t,height:t},z))return J._index=f,J._shape=G,v&&J.fi({kind:"beginEditPoint",event:p,data:G,index:f}),J.setCursor("crosshair"),!0;if(S._42O)for(var Z=G.getEditControlPoints(),B=["northwest",-1,-1,OJ,-1,0,"southwest",-1,1,"south",0,1,"southeast",1,1,SJ,1,0,"northeast",1,-1,WJ,0,-1],f=0,X=Z.length;f<X;f++){var q,g,M,L=Z[f];if(J._80I(z,L.x,L.y,B[3*f]))return L=(J._node=G).getWidth(),M=G.getHeight(),q=G.getAnchor(),J._rect={x:-L*q.x,y:-M*q.y,width:L,height:M},J._anchor=q,J._matrix=G.getMatrix(),L=G.getRotation(),M=S0(L),q=O0(L),L=B[3*f+1]*cS(G.getScale().x),g=B[3*f+2]*cS(G.getScale().y),M=Math.atan2(-q*L-M*g,M*L-q*g),L=(Math.round(M/(Math.PI/4))+8)%8,J.setCursor([al,"nesw-resize",ul,"nwse-resize",al,"nesw-resize",ul,"nwse-resize"][L]),v&&J.fi({kind:"beginEditRect",event:p,data:G,direction:J._89I}),!0}}if(S._43O&&zS(G)&&G.s(mJ)===hJ&&(W=G.s(NJ)))for(f=W.size()-1;0<=f;f--)if(O=W.get(f),AA({x:O.x-t/2,y:O.y-t/2,width:t,height:t},z))return J._index=f,J._edge=G,v&&J.fi({kind:"beginEditPoint",event:p,data:G,index:f}),J.setCursor("crosshair"),!0}return!1}},ms_gv:function(p,G){p._currentSubGraph=v0,p._initView=function(){this._fpsInfo={time:0,fps:0,frames:0}},p.upSubGraph=function(){this.setCurrentSubGraph(Bj(this._currentSubGraph))},p.isVisible=function(p){var G=this;if(Bj(p)!==G._currentSubGraph)return!1;if(zS(p)){var v=p._40I,J=p._41I;if(!v||!J)return!1;if(!(p.s("edge.independent")||G.isVisible(v)&&G.isVisible(J)))return!1;if(p.isEdgeGroupHidden())return!1}else for(var $=p._parent;$&&!$.ISubGraph;){if(ZS($)&&(!$.isExpanded()||!G.isVisible($)))return!1;$=$._parent}if(p._parent instanceof hI&&!G.isVisible(p._parent))return!1;if(p._refGraph instanceof rI&&!G.isVisible(p._refGraph))return!1;if(G instanceof on){if(!p.s("3d.visible"))return!1}else{if((v=G.getLayersInfo())&&(J=v[p._layer])&&!1===J.visible)return!1;if(!p.s("2d.visible"))return!1}return!G._visibleFunc||G._visibleFunc(p)},p.handleSelectionChange=function(p){var v=this;p.datas.each(function(p){v.invalidateData(p);var G=p._parent;ZS(G)&&k(p)&&p.s(nJ)&&(v.invalidateData(G),G._49I&&G._49I.each(function(p){v.invalidateData(p)}))}),v.onSelectionChanged(p)},p.onSelectionChanged=function(p){var G=this.sm();1!==G.size()||"set"!==p.kind&&"append"!==p.kind||(p=G.ld(),this.isAutoMakeVisible()&&this.makeVisible(p),this.adjustIndex&&this._dataModel.isAutoAdjustIndex()&&this.adjustIndex(p))},p.makeVisible=function(p){if(p&&(this.getDataUI?this.getDataUI(p):this.getData3dUI(p))){var G=p,v=Bj(p);for(v!==this._currentSubGraph&&this.setCurrentSubGraph(v);(G=G._parent)&&G!==v;)ZS(G)&&G.setExpanded(!0);this._23I=p,this.iv()}},p.getLabel=function(p){var G=p.getStyle(jJ);return G===K?p.getName():G},p.getLabelBackground=function(p){return p.getStyle("label.background")},p.getLabelColor=function(p){return p.getStyle("label.color")},p.getLabel2=function(p){return p.getStyle("label2")},p.getLabel2Background=function(p){return p.getStyle("label2.background")},p.getLabel2Color=function(p){return p.getStyle("label2.color")},p.getNote=function(p){return p.getStyle(rJ)},p.getNoteBackground=function(p){return p.getStyle("note.background")},p.getNote2=function(p){return p.getStyle(eJ)},p.getNote2Background=function(p){return p.getStyle("note2.background")},p.handleClick=function(p,G,v){G?(this.fi({kind:"clickData",event:p,data:G,part:v}),this.onDataClicked(G,p)):(this.fi({kind:"clickBackground",event:p}),this.onBackgroundClicked(p))},p.handleDoubleClick=function(p,G,v){var J=this;YA(p)&&(G?(J.fi({kind:"doubleClickData",event:p,data:G,part:v}),J.onDataDoubleClicked(G,p,v),J.checkDoubleClickOnNote(p,G,v)||J.checkDoubleClickOnRotation&&J.checkDoubleClickOnRotation(p,G,v)||(zS(G)?J.onEdgeDoubleClicked(G,p,v):G.ISubGraph?J.onSubGraphDoubleClicked(G,p,v):ZS(G)?J.onGroupDoubleClicked(G,p,v):G.IDoorWindow?J.onDoorWindowDoubleClicked(G,p,v):G.ICSGBox&&J.onCSGBoxDoubleClicked(G,p,v))):(J.fi({kind:"doubleClickBackground",event:p}),J.onBackgroundDoubleClicked(p)))},p.onSubGraphDoubleClicked=function(p,G,v){this.setCurrentSubGraph(p)},p.onEdgeDoubleClicked=function(p,G,v){this.isEditable(p)||(p.ISubGraph&&!PA(G)?this.setCurrentSubGraph(p):p.s("edge.toggleable")&&p.toggle())},p._39Q=function(p){return!!this.isInteractive(p)&&this.preventDefaultWhenInteractive(p)},p.preventDefaultWhenInteractive=function(p){return p.s("preventDefaultWhenInteractive")},p.onGroupDoubleClicked=function(p,G,v){p.s("group.toggleable")&&p.toggle()},p.onDoorWindowDoubleClicked=function(p,G,v){p.s("dw.toggleable")&&p.toggle(!0)},p.onCSGBoxDoubleClicked=function(p,G,v){this instanceof on&&(G=this.intersectObject(G,p))&&p.s(G.part+".toggleable")&&p.toggleFace(G.part,!0)},p.onBackgroundClicked=function(p){},p.onBackgroundDoubleClicked=function(p){this.upSubGraph()},p.onDataClicked=function(p,G,v){},p.onDataDoubleClicked=function(p,G,v){},p.onAutoLayoutEnded=function(){},p.onMoveEnded=function(){},p.onPanEnded=function(){},p.onPinchEnded=function(){},p.onRectSelectEnded=function(){},p.onZoomEnded=function(){},p.serialize=function(p){return this.dm().serialize(p)},p.toJSON=function(){return this.dm().toJSON()},p.deserialize=function(p,G){var O=this,W=((G=G instanceof Fm?{rootParent:G}:SS(G)?{setId:G}:WS(G)?{finishFunc:G}:G||{}).view=O).dm();return G.reset&&(W.setAttrObject({}),W.setLayers(K),W.setName(K),W.setAutoAdjustIndex(!0),W.setHierarchicalRendering(!1),W.setBackground(K),W.setInit(K),W.setPostProcessingData(K),W.setEnvmap(K),W.setEnvmapType(K),O.disableToolTip(),O instanceof E.graph.GraphView?(O.setZoomable(N.graphViewZoomable),O.setPannable(N.graphViewPannable),O.setRectSelectable(N.graphViewRectSelectable)):O instanceof E.graph3d.Graph3dView&&(O.shadowMap.resetProperties(),O.setDashDisabled(N.graph3dViewDashDisabled),O.setUvClipEnabled(N.graph3dViewUvClipEnabled),O.getHighlightHelper().resetProperties(),O.resetHeadlightProperties(),O.resetFogProperties(),O.setBatchInfoMap({}),O.setBatchColorDisabled(N.graph3dViewBatchColorDisabled),O.setBatchInstancedDisabled(N.graph3dViewBatchInstancedDisabled),O.setBatchBlendDisabled(N.graph3dViewBatchBlendDisabled),O.setBatchBrightnessDisabled(N.graph3dViewBatchBrightnessDisabled),O.setFlowBlendMode(N.graph3dViewFlowBlendMode),O.setMoveStep(N.graph3dViewMoveStep),O.setRotateStep(N.graph3dViewRotateStep),O.setSortable(N.graph3dViewSortable),O.setSortFunc(K),O.setSkybox(K),ZZ(O))),G.__innerHandler__=function(p){var v,J,$,G,S;SS(W.a("toolTipEnable"))&&(W.a("toolTipEnable")?O.enableToolTip():O.disableToolTip()),lS(W.a("fontFaces"))&&W.a("fontFaces").forEach(function(p){N.addFontFace(p.name,p.url)}),O instanceof E.graph.GraphView&&(SS(W.a("zoomable"))&&O.setZoomable&&O.setZoomable(W.a("zoomable")),SS(W.a("pannable"))&&O.setPannable&&O.setPannable(W.a("pannable")),SS(W.a("rectSelectable"))&&O.setRectSelectable&&O.setRectSelectable(W.a("rectSelectable")),!0===W.a("fitContent")&&O.fitContent&&O.fitContent(!0,0)),O instanceof E.graph3d.Graph3dView&&((p=p.scene)&&p.shadow!=v0&&O.shadowMap.setShadow(p.shadow,p.shadowParams),(S=W.a("sceneContext"))?(S.eye&&O.setEye(S.eye),S.center&&O.setCenter(S.center),$S(S.far)&&O.setFar(S.far),$S(S.near)&&O.setNear(S.near)):($S(W.a("sceneNear"))&&O.setNear(W.a("sceneNear")),$S(W.a("sceneFar"))&&O.setFar(W.a("sceneFar")),p&&(p.eye&&O.setEye(p.eye),p.center&&O.setCenter(p.center))),$S(W.a("sceneFovy"))&&O.setFovy(W.a("sceneFovy")),SS(W.a("sceneOrtho"))&&O.setOrtho(W.a("sceneOrtho")),$S(W.a("sceneOrthoWidth"))&&O.setOrthoWidth(W.a("sceneOrthoWidth")),SS(W.a("sceneShadowEnabled"))&&(W.a("sceneShadowEnabled")?O.enableShadow():O.disableShadow()),$S(W.a("sceneShadowDegreeX"))&&O.setShadowDegreeX(W.a("sceneShadowDegreeX")),$S(W.a("sceneShadowDegreeZ"))&&O.setShadowDegreeZ(W.a("sceneShadowDegreeZ")),$S(W.a("sceneShadowIntensity"))&&O.setShadowIntensity(W.a("sceneShadowIntensity")),W.a("sceneShadowQuality")!=v0&&O.setShadowQuality(W.a("sceneShadowQuality")),W.a("sceneShadowType")&&O.setShadowType(W.a("sceneShadowType")),$S(W.a("sceneShadowRadius"))&&O.setShadowRadius(W.a("sceneShadowRadius")),$S(W.a("sceneShadowBias"))&&O.setShadowBias(W.a("sceneShadowBias")),SS(W.a("sceneDashEnable"))&&O.setDashDisabled(!W.a("sceneDashEnable")),SS(W.a("sceneUvClipEnabled"))&&O.setUvClipEnabled(W.a("sceneUvClipEnabled")),JS(W.a("sceneHighlightMode"))&&O.setHighlightMode(W.a("sceneHighlightMode")),$S(W.a("sceneHighlightWidth"))&&O.setHighlightWidth(W.a("sceneHighlightWidth")),W.a("sceneHighlightColor")&&O.setHighlightColor(W.a("sceneHighlightColor")),W.a("sceneHighlightType")&&O.setHighlightType(W.a("sceneHighlightType")),W.a("sceneHighlightGlow")&&O.setHighlightGlow(W.a("sceneHighlightGlow")),W.a("sceneHighlightStrength")&&O.setHighlightStrength(W.a("sceneHighlightStrength")),SS(W.a("sceneHeadlightEnable"))&&O.setHeadlightDisabled(!W.a("sceneHeadlightEnable")),W.a("sceneHeadlightDirection")!=v0&&O.setHeadlightDirection(W.a("sceneHeadlightDirection")),$S(W.a("sceneHeadlightRange"))&&O.setHeadlightRange(W.a("sceneHeadlightRange")),W.a("sceneHeadlightColor")&&O.setHeadlightColor(W.a("sceneHeadlightColor")),$S(W.a("sceneHeadlightIntensity"))&&O.setHeadlightIntensity(W.a("sceneHeadlightIntensity")),$S(W.a("sceneHeadlightAmbientIntensity"))&&O.setHeadlightAmbientIntensity(W.a("sceneHeadlightAmbientIntensity")),$S(W.a("sceneHeadlightGroup"))&&O.setHeadlightGroup(W.a("sceneHeadlightGroup")),SS(W.a("sceneFogEnable"))&&O.setFogDisabled(!W.a("sceneFogEnable")),W.a("sceneFogMode")&&O.setFogMode(W.a("sceneFogMode")),$S(W.a("sceneFogDensity"))&&O.setFogDensity(W.a("sceneFogDensity")),W.a("sceneFogColor")&&O.setFogColor(W.a("sceneFogColor")),$S(W.a("sceneFogNear"))&&O.setFogNear(W.a("sceneFogNear")),$S(W.a("sceneFogFar"))&&O.setFogFar(W.a("sceneFogFar")),SS(W.a("sceneBatchBrightnessDisabled"))&&O.setBatchBrightnessDisabled(W.a("sceneBatchBrightnessDisabled")),W.a("sceneFlowBlendMode")!==K&&O.setFlowBlendMode(W.a("sceneFlowBlendMode")),SS(W.a("sceneBatchBlendDisabled"))&&O.setBatchBlendDisabled(W.a("sceneBatchBlendDisabled")),SS(W.a("sceneBatchColorDisabled"))&&O.setBatchColorDisabled(W.a("sceneBatchColorDisabled")),SS(W.a("sceneBatchInstancedDisabled"))&&O.setBatchInstancedDisabled(W.a("sceneBatchInstancedDisabled")),W.a("sceneBatchInfoMap")&&O.setBatchInfoMap(W.a("sceneBatchInfoMap")),W.a("sceneRenderLayerInfoMap")&&O.setRenderLayerInfoMap(W.a("sceneRenderLayerInfoMap")),$S(W.a("sceneMoveStep"))&&O.setMoveStep(W.a("sceneMoveStep")),$S(W.a("sceneRotateStep"))&&O.setRotateStep(W.a("sceneRotateStep")),SS(W.a("sceneSortable"))&&O.setSortable(W.a("sceneSortable")),WS(W.a("sceneSortFunc"))&&O.setSortFunc(W.a("sceneSortFunc")),(S=W.a("sceneSkyboxType")||"sphere")!=v0&&(J=!(v={}),"sphere"===S?(v.shape3d=S,(G=W.a("sceneSkyboxImage"))&&(v["shape3d.image"]=G,J=!0)):"cube"===S?(v.shape3d=K,["front","back","left","right","top","bottom"].forEach(function(p){var G=p+".image",p=p.charAt(0).toUpperCase()+p.slice(1);(p=W.a("sceneSkybox"+p+"Image"))&&(v[G]=p,J=!0)})):"color"===S&&W.a("sceneSkyboxColor")&&(J=!0),J&&($=new LI,p=W.a("sceneSkyboxDiameter"),$S(p)?$.s3(p,p,p):$.s3(20,20,20),v["body.color"]=W.a("sceneSkyboxBodyColor"),v.envmap=W.a("sceneSkyboxEnvmap"),v["envmap.probe"]=W.a("sceneSkyboxEnvmapProbe"),v.roughness=W.a("sceneSkyboxRoughness"),v["shape3d.light"]=v["all.light"]=W.a("sceneSkyboxLight"),v["light.mask"]=W.a("sceneSkyboxLightMask"),v["headlight.ambientIntensity"]=W.a("sceneSkyboxHeadLightAmbientIntensity"),v["texture.wrap"]="clampToEdge",v["3d.clipbox.mask"]=ds,v["effect.flow.mask"]=ds,"color"===S&&(v.shape3d="sphere",(p=(G=$.s("shape3d.image"))&&E.Default.getImage(G))&&"CANVAS"===p.tagName||(p=B.createElement("canvas"),G=E.Math.generateUUID(),E.Default.setImage(G,p)),G&&O.getTextureMap()&&O.deleteTexture(G),E.Default.setCanvas(p,2,1024,1),(S=p.getContext("2d")).clearRect(0,0,2,1024),S.beginPath(),S.rect(0,0,2,1024),NE(S,W.a("sceneSkyboxColor"),function(p){return p},!1,{x:0,y:0,width:2,height:1024}),S.fill(),S.restore(),v["shape3d.image"]=G),$.s(v),["X","Y","Z"].forEach(function(p){var G=W.a("sceneSkyboxRotation"+p);$S(G)&&$["setRotation"+p](G)}),O.setSkybox($))))},W.deserialize(p,G.rootParent,G)},p.isDebugTipShowing=function(){return!!this._debugDiv},p.showDebugTip=function(){var p,v,J=this,$=J._debugDiv;$||(($=J._debugDiv=B.createElement("div")).style.position="absolute",$.style.overflow="hidden",$.style.font=N.debugTipLabelFont,$.style.padding="6px",$.style.backgroundColor=N.debugTipBackground,$.style.color=N.debugTipLabelColor,p=J.getView(),J._79O?p.insertBefore($,J._79O):p.appendChild($),v=function(){J.redraw();var p=J._canvas,p="FPS: "+J._fpsInfo.fps+"<br/>Datas: "+J.dm().getDatas().length+(p?"<br/>Size: "+p.width+" * "+p.height:""),G=J.dm()._historyManager;G&&(p+="<br/>Undoes: "+G.getHistories().length+" index: "+G.getHistoryIndex()),(G=J.getDebugTip())&&(p+="<hr>"+G),$.innerHTML=p,J._isDebugging&&requestAnimationFrame(v)},requestAnimationFrame(v),J._isDebugging=!0)},p.hideDebugTip=function(){var p=this._debugDiv;p&&(delete this._debugDiv,this.getView().removeChild(p),this._isDebugging=!1)},p.updateDOMAppendMatrix=function(){var p=this.getView();p&&(p.updateAppendMatrix=!0)},p.countFrame=function(){var p,G;this._isDebugging&&(1e3<(p=Date.now())-(G=this._fpsInfo).time?(G.fps=Math.round(1e5*(G.frames+1)/(p-G.time))/100,G.time=p,G.frames=0):G.frames++)}},ms_icons:function(p,G){p.getRotation=function(p,G){return p==v0?0:p},p._15O=function(){var p=this,G=p.s(AJ);if(G){var v,J=p,$=p.data||p._data,S=$.getRotation&&$.getRotation(),O=p._38o={icons:G,rects:{}};for(v in G){var W=G[v],l=V(W.shape3d,$,J);if(!(!1===V(W.visible,$,J)||V(W.for3d,$,J)&&!p.I3d||l&&!p.I3d)){var t=l?[l]:V(W.names,$,J),z=t?t.length:0,Z=V(W.position,$,J)||3,B=V(W.offsetX,$,J)||0,f=V(W.offsetY,$,J)||0,X=V(W.direction,$,J)||SJ,q=(g=V(W.gap,$,J))!=v0?g:1,g=V(W.rotation,$,J),M=V(W.keepOrien,$,J),L=V(W.rotationFixed,$,J)?g:p.getRotation(g,M,Z),H=v0,_=O.rects[v]=new Array(z);$S(S)&&($S(L)?L+=S:L=S),_.rotation=L;for(var b=0;b<z;b++){var n,D,Y,s=t[b];l?D=n=0:(s=T(s),n=V(W.width,$,J),D=V(W.height,$,J),n==v0&&(n=Am(s,$)),D==v0&&(D=km(s,$))),H?X===SJ?B+=n/2:X===OJ?B-=n/2:X===WJ?f-=D/2:f+=D/2:H={width:n,height:D},p.I3d?(s=-n/2,Y=-D/2,Y={width:n,height:D,mat:p._16O(V(W.autorotate,$,J),Z,H,V(W.face,$,J)||U0,V(W.t3,$,J),V(W.r3,$,J),V(W.rotationMode,$,J),B,f),vs:new pm([s,-Y,0,s,-Y-D,0,s+n,-Y-D,0,s+n,-Y,0])}):(Y={x:(s=p.getPosition(Z,B,f,H,V(W.positionFixed,$,J))).x-n/2,y:s.y-D/2,width:n,height:D},p._68o(Y,L)),_[b]=Y,X===SJ?B+=n/2+q:X===OJ?B-=n/2+q:X===WJ?f-=D/2+q:f+=D/2+q}}}}}}});var Gj={1:1,2:1,6:1,9:1,10:1,14:1,15:1,16:1,21:1,22:1,26:1,29:1,30:1,34:1,36:1,38:1,40:1,42:1,45:1,50:1,52:1,54:1},vj={3:1,7:1,11:1,17:1,23:1,27:1,31:1,44:1,46:1,47:1,49:1},Jj={translateX:1,translateY:1,zoom:1,scrollBarVisible:1},$j={sourceAgent:1,targetAgent:1,expanded:1,parent:1,host:1},Sj={position:1,width:1,height:1,expanded:1,rotation:1,anchor:1,scale:1,"s:edge.points":1},Oj={"edge.type":1,"edge.group":1},Wj={rotation:1,rotationX:1,rotationZ:1,rotation3d:1},lj={rotation:1,position:1,width:1,height:1,anchor:1,scale:1,host:1,"s:vector.layoutable":1,"s:2d.visible":1},tj={position:1,width:1,height:1,anchor:1,scale:1,"s:grid.row.count":1,"s:grid.column.count":1,"s:grid.row.percents":1,"s:grid.column.percents":1,"s:grid.border":1,"s:grid.border.left":1,"s:grid.border.right":1,"s:grid.border.top":1,"s:grid.border.bottom":1,"s:grid.gap":1},zj={"attach.row.index":1,"attach.column.index":1,"attach.row.span":1,"attach.column.span":1,"attach.padding":1,"attach.padding.left":1,"attach.padding.right":1,"attach.padding.top":1,"attach.padding.bottom":1,"attach.index":1,"attach.offset":1,"attach.offset.relative":1,"attach.offset.opposite":1,"attach.gap":1,"attach.gap.relative":1,"attach.thickness":1},Zj={shape:1,thickness:1,position:1,anchor:1,scale:1},Bj=function(p){if(!p)return v0;var G,v;if(zS(p))return G=p._40I,v=p._41I,G&&v&&(G=Bj(G))===Bj(v)?G:v0;for(var J=p._parent;zS(J)&&!J.ISubGraph;)J=J._parent;return J?J.ISubGraph?J:Bj(J):v0},fj=function(p,G,v,J){var $=G.getStyle(v)*J;$&&xA(p,$),($=G.getStyle(v+".left")*J)&&(p.x-=$,p.width+=$),($=G.getStyle(v+".right")*J)&&(p.width+=$),($=G.getStyle(v+".top")*J)&&(p.y-=$,p.height+=$),($=G.getStyle(v+".bottom")*J)&&(p.height+=$),p.width<0&&(p.width=-p.width,p.x-=p.width),p.height<0&&(p.height=-p.height,p.y-=p.height)},Xj=function(p){for(var G,v=0,J=p.size();v<J;v++)if(G=p.getChildAt(v),k(G)&&Xj(G))return!0;return p.hasAgentEdges()},qj=function(p){if(!p)return v0;for(var G=p._parent;ZS(G);){if(!ZS(G._parent))return G.isExpanded()?p:G;G.isExpanded()||(p=G),G=G._parent}return p},gj=function(p,G){if(!p||!G)return v0;var v,J,$,S=Bj(p),O=Bj(G);if(S===O)return p;for(;O&&S!==O;)O=Bj(O);if(S===O)return p;(v=new o).add(p,0);for(var W=p._parent;k(W)&&!G.isDescendantOf(W);)v.add(W,0),W=W._parent;for($=v.size(),J=0;J<$;J++){var l=v.get(J);if(ZS(l)&&!l.isExpanded())return l;if(l.ISubGraph)return l}return p},Mj=function(p,G,v){var J,$,S,O="target"===(v="target"!==v?"source":v)?G.getTargetAgent():G.getSourceAgent(),v="edge."+v+".";return zS(O)?((J=p.getDataUI(O))._79o(),0<=($=G.s(v+"index"))?(S=Ej(J))[Math.max(0,Math.min($,S.length-1))]:($=G.s(v+"percent")||0,$=Math.max(0,Math.min($,1)),S=rj(J),Ij(S,100*$))):Lj(p,O,G.s(v+"position"),G.s(v+"offset.x"),G.s(v+"offset.y"),G.s(v+"anchor.x"),G.s(v+"anchor.y"))},Lj=function(p,G,v,J,$,S,O){if(!G)return v0;var W,l,t,z,Z,B=G.getRotation?G.getRotation():0;return v=S!==K||O!==K?(S=S===K?.5:S,O=O===K?.5:O,t=G.getScale(),B&&!BS(G,p)||t.x<0||t.y<0?(W=G.getPosition(),z=G.getWidth(),l=G.getHeight(),Z=G.getAnchor(),new hh(B,W.x,W.y,t.x,t.y).tf((S-Z.x)*z,(O-Z.y)*l)):{x:(W=pj(p,G)).x+S*W.width,y:W.y+O*W.height}):b4(v,pj(p,G)),B&&(Z=J*(t=S0(B))-$*(z=O0(B)),$=J*z+$*t,J=Z),v.x+=J,v.y+=$,v},Hj=function(p,G){var v,J,$=function(p,G){if(!p||!G)return v0;var v,J,$,S,O,W;if(p===G){if(!(S=p.getLoopedEdges()))return v0;S=new o(S)}else{if(O=p.getAgentEdges(),W=G.getAgentEdges(),!O||!W)return v0;for(J=O.size(),v=0;v<J;v++)$=O.get(v),W.contains($)&&(S=S||new o).add($)}if(S)for(v=0;v<S.size();v++)($=S.get(v)).getStyle(mJ)===hJ&&($._22I(v0),S.removeAt(v),v--);return S}(p,G);$&&!$.isEmpty()&&(1===$.size()?$.get(0)._22I(v0):(v=new o,J=new o,$.each(function(p){p=p.s("edge.group"),v.contains(p)||v.add(p)}),v.sort(),v.each(function(G){J.add(new E.EdgeGroup($.toList(function(p){return G===p.s("edge.group")}),J))}),J.each(function(G){G.each(function(p){p._22I(G)})})))},_j=function(p,G,v){var J=p._canvas,p=(p._zoom,RA(G,J)),G=RA(v,J);return{x:p.x-G.x,y:p.y-G.y}},bj=function(p,G){var v,J,$,S,O,W,l,t,z,Z,B,f;G&&(v=G.rect,J=G.color,$=G.rotation,S=G.labelWidth,O=G.background,W=G.opacity,l=(f=G.scale)!=v0&&1!==f,W!=v0&&(t=p.globalAlpha,p.globalAlpha*=W),($||l)&&(p.save(),z=v.x+v.width/2,Z=v.y+v.height/2,JE(p,z,Z),$&&$E(p,$),l&&p.scale(f,f),JE(p,-z,-Z)),O&&VE(p,v.x,v.y,v.width,v.height,O),S&&(B=v.width,(f=p.createLinearGradient(v.x,v.y,v.x+B,v.y)).addColorStop(0,J),f.addColorStop(.9,J),f.addColorStop(1,El),J=f,v.width=S),oS(p,G.ss,v,G.font,J,G.align,G.decoration),S&&(v.width=B),($||l)&&p.restore(),W!=v0&&(p.globalAlpha=t))},nj=function(p,G){var v,J,$,S,O,W,l,t,z,Z,B,f,X,q,g,M,L;G&&(J=(v=G.rect).x,$=v.y,S=v.width,O=v.height,W=G.background,l=G.backgroundImage,t=G.borderWidth,z=G.borderColor,Z=G.labelWidth,B=G.opacity,f=(L=G.scale)!=v0&&1!==L,B!=v0&&(X=p.globalAlpha,p.globalAlpha*=B),f&&(p.save(),q=v.x+v.width/2,M=v.y+v.height/2,JE(p,q,M),p.scale(L,L),JE(p,-q,-M)),G.expanded?(L=$0(8,S/4),q=$+O-8,p.fillStyle=W,p.beginPath(),p.moveTo(J,$),p.lineTo(J,q),p.lineTo(J+S/2,q),p.lineTo(J+S/2,$+O),p.lineTo(J+S/2+L,q),p.lineTo(J+S,q),p.lineTo(J+S,$),p.closePath(),p.fill(),t&&(p.lineWidth=t,p.lineJoin="round",p.lineCap="round",z?p.strokeStyle=z:(p.strokeStyle=bA(W),p.beginPath(),p.moveTo(J+S,$),p.lineTo(J+S,q),p.lineTo(J+S/2+L,q),p.lineTo(J+S/2,$+O),p.stroke(),p.strokeStyle=_A(W),p.beginPath(),p.moveTo(J+S,$),p.lineTo(J,$),p.lineTo(J,q),p.lineTo(J+S/2,q),p.lineTo(J+S/2,$+O)),p.stroke()),l?BA(p,T(l),kl,v.x,v.y,v.width,v.height-8,G.data,G.view):(v.height-=8,W=G.color,Z&&((M=p.createLinearGradient(J,$,J+(g=S),$)).addColorStop(0,W),M.addColorStop(.9,W),M.addColorStop(1,El),W=M,v.width=Z),oS(p,G.ss,v,G.font,W,G.align),Z&&(v.width=g),v.height+=8)):G.icon?Im(p,T(G.icon),J,$,S,O,G.data,G.view):(L=S/2,t&&(p.lineWidth=t,p.lineJoin="round",p.lineCap="round",p.strokeStyle=z||bA(W),p.beginPath(),p.arc(J+L,$+L,L,w0,1.6*j,!0),p.moveTo(J+L,$+O),p.lineTo(J+S-L/5,$+L),p.stroke(),p.strokeStyle=z||_A(W),p.beginPath(),p.arc(J+L,$+L,L,1.6*j,w0,!0),p.moveTo(J+L,$+O),p.lineTo(J+L/5,$+L),p.stroke()),p.fillStyle=W,p.beginPath(),p.arc(J+L,$+L,L,0,W0,!0),p.moveTo(J+L,$+O),p.lineTo(J+S-L/5,$+L),p.lineTo(J+L/5,$+L),p.closePath(),p.fill(),p.fillStyle=G.color,p.beginPath(),p.arc(J+L,$+L,L/3,0,W0,!0),p.fill()),f&&p.restore(),B!=v0&&(p.globalAlpha=X))},Dj=function(p,G){return 2*p<G?p:G/2},Yj=function(p,G,v,J){if(!p||!G)return 0;var $=P0(G.y-p.y,G.x-p.x);return($=!v&&G.x<p.x?$+j:$)+J},sj=function(p,G,v,J,$,S,O){return O&&(p.x>G.x||p.x===G.x&&p.y>G.y)&&(v=_4[v],$=-$),(O=b4(v,{x:0,y:0,width:iA(p,G),height:0},S)).x+=J,O.y+=$,(O=new hh(P0(G.y-p.y,G.x-p.x)).tf(O)).x+=p.x,O.y+=p.y,O},cj=function(p,v,J,G,$){if(p._19Q=!0,!J.getEdgeGroup())return G?J.s("edge.gap"):0;if(zS(J.getSourceAgent())||zS(J.getTargetAgent()))return 0;var S,O=0,W=0,l=0;return J.getEdgeGroup().getSiblings().each(function(p){p.each(function(p){var G;v.isVisible(p)&&p.s(mJ)==$&&(G=p.s("edge.gap"),S?W+=l/2+G/2:S=p,l=G,p===J&&(O=W))})}),G?W-O+l:(G=O-W/2,S&&J._40I!==S._40I&&(p._19Q=!1),G)},hj=function(p){if(1===(G=p._getValidSelection()).length){var G,v=(G=G[0])instanceof E.Edge;if((G instanceof E.Shape||v)&&(!(v=v&&G.s("edge.type"))||"points"===v))return(v=p.gv).isPointEditable&&!v.isPointEditable(G)||!v.isEditable(G)?void 0:G}},wj=E.graph={},p=function(p,G,v){oA("ht.graph."+p,G,v)},dj=(E.layout={},{}),Pj=function(p,G,v,J,$,S,O,W){var l=O._zoom;if(!l)return G;if(l!==O._cacheZoom&&(O._cacheZoom=l,O._cacheImage={}),l*=Rh,J=Math.ceil(J),$=Math.ceil($),2048<J*l||2048<$*l)return G;var t=[G.uuid,J,$,v].join("_");if(S instanceof E.Data){var z=G.dataBindings;if(z)for(var Z=z.length-1;0<=Z;Z--){var B=S.a(z[Z].attr);OS(B)||lS(B)||(t+="_"+B)}}G.cacheRule&&(t+="_"+(WS(G.cacheRule)?G.cacheRule(S,O):V(G.cacheRule,S,O))),J<=$&&J*l<1?(f=$/J,$=(J=1/l)*f):$<=J&&$*l<1&&(f=J/$,J=($=1/l)*f),J=Math.ceil(J),$=Math.ceil($);var f=O._cacheImage[t];if(!f){if(wm=!0,f=E.Default.toCanvas(G,J,$,v,S,O,W,l),!wm)return G;O._cacheImage[t]=f}return f};MS(N,{setImageCacheRule:function(p,G){var v,J;for(J in G||"object"!=typeof p?(v={})[p]=G:v=p,v){var $=v[J];JS(J)?(oA=T(J))?oA.cacheRule=$:dj[J]=$:J.cacheRule=$}}});(i0={comps:[{type:qJ,points:[85,50,70,115,100,71,86,107,88,49,47,71,113,98,83,57,108,77,108,118,47,97,69,70,70,89,89,83,54,102,56,50,77,100,88,65,57,70,107,121,65,116,81,61],borderWidth:1,borderColor:v0}]})[_J]=i0[bJ]=160,h.Image&&((l1=new h.Image).src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAALUlEQVRYR+3QQREAAAABQfqXFsNnFTizzXk99+MAAQIECBAgQIAAAQIECBAgMBo/ACHo7lH9AAAAAElFTkSuQmCC",K0("default_blank",l1)),K0("node_image",oi(30,30,[{type:y,rect:[4,5,22,16],gradient:mh,gradientColor:i4,background:v},{type:y,rect:[2,3,26,20],borderWidth:1,borderColor:v},{type:y,rect:[11,23,8,4],background:v},{type:y,rect:[6,27,18,2],background:v}])),K0("node_icon",oi(16,16,[{type:y,rect:[2,2,12,10],gradient:mh,gradientColor:i4,background:v},{type:ZJ,rect:[2,2,12,10],width:1,color:v},{type:y,rect:[6,12,4,2],background:v},{type:y,rect:[4,14,8,1],background:v}])),K0("block_icon",oi(16,16,[{type:ZJ,rect:[1,1,14,14],width:1,color:v}])),K0("group_image",oi(66,39,[{type:y,rect:[44.3,18,18.1,12.8],gradient:mh,gradientColor:i4,background:v},{type:y,rect:[3.3,17.8,18.1,12.8],gradient:mh,gradientColor:i4,background:v},{type:y,rect:[15.8,3.2,33.5,26.4],borderWidth:1,borderColor:v,gradient:mh,gradientColor:i4,background:v},{type:y,rect:[26.2,29.4,12.8,4.2],background:v},{type:y,rect:[21.3,33.5,22.5,2.3],background:v},{type:y,rect:[5.3,32.7,14.1,2.1],background:v},{type:y,rect:[9,30.4,6.7,2.4],background:v},{type:y,rect:[50,30.7,6.7,2.4],background:v},{type:y,rect:[46.3,33,14.1,2.1],background:v}])),K0("group_icon",oi(16,16,[{type:y,rect:[4,12,4,2],background:v},{type:y,rect:[2,13,8,1],background:v},{type:y,rect:[12,12,2,1],background:v},{type:y,rect:[11,13,4,1],background:v},{type:y,rect:[10,7,6,5],gradient:mh,gradientColor:i4,background:v},{type:y,rect:[1,2,10,10],gradient:mh,gradientColor:i4,background:v},{type:ZJ,rect:[1,2,10,10],width:1,color:v}])),K0("refGraph_icon",oi(16,16,[{type:"shape",borderWidth:1,borderColor:v,borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:v,borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}])),K0("edge_icon",oi(16,16,[{type:y,rect:[2.1,6.9,11.5,2.6],rotation:-.79,gradient:mh,gradientColor:i4,background:v},{type:y,rect:[10.8,1,4,4],background:v},{type:y,rect:[1,11,4,4],background:v}])),K0("subGraph_image",oi(72,45,[{type:qJ,points:[9,42,.3,38.4,2.4,28.8,5.7,21.6,11.7,22.5,11.7,15.9,16.8,13.8,21.6,12,24.3,15.9,27.9,3,42.3,2.1,59.4,4.5,57.3,18.3,67.5,18.9,69.6,27.3,69.9,38.4,64.2,41.4],segments:[1,3,3,3,3,3,3,3,3],gradient:mh,gradientColor:i4,background:v},{type:y,rect:[29.6,30.7,3.6,1.8],background:v},{type:y,rect:[28.4,32.3,6,1.2],background:v},{type:y,rect:[37.3,32,10.8,1.8],background:v},{type:y,rect:[39.1,29.9,7.2,2.3],background:v},{type:y,rect:[26.6,23.7,9.6,7.2],gradient:mh,gradientColor:i4,background:v},{type:y,rect:[34.3,16.8,16.8,13.2],borderWidth:1,borderColor:v,gradient:mh,gradientColor:i4,background:v}])),K0("subGraph_icon",oi(17,17,[{type:qJ,points:[2.2,14.6,.2,11.9,.8,8.8,1.8,5.9,5.6,7.4,3.8,1.6,10.3,3,14.5,4.2,12.2,7.5,18.9,7.2,14.5,14.5],segments:[1,3,3,3,3,3],gradient:mh,gradientColor:i4,background:v}])),K0("shape_icon",oi(16,16,[{type:qJ,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],background:v}])),K0("polyline_icon",oi(16,16,[{type:qJ,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],borderWidth:1,borderColor:v},Ui(7.5,.4),Ui(7.5,6.3),Ui(13.6,6.3),Ui(13.6,14),Ui(.7,13.9),Ui(.7,.3)])),K0("grid_icon",oi(16,16,[{type:y,rect:[1,1,4,4],background:v,gradient:mh,gradientColor:i4},{type:y,rect:[6,1,4,4],background:v,gradient:mh,gradientColor:i4},{type:y,rect:[11,1,4,4],background:v,gradient:mh,gradientColor:i4},{type:y,rect:[11,6,4,4],background:v,gradient:mh,gradientColor:i4},{type:y,rect:[6,6,4,4],background:v,gradient:mh,gradientColor:i4},{type:y,rect:[1,6,4,4],background:v,gradient:mh,gradientColor:i4},{type:y,rect:[11,11,4,4],background:v,gradient:mh,gradientColor:i4},{type:y,rect:[6,11,4,4],background:v,gradient:mh,gradientColor:i4},{type:y,rect:[1,11,4,4],background:v,gradient:mh,gradientColor:i4}])),K0("light_icon",oi(16,16,[{type:"rect",rect:[6,9,5,5],borderWidth:1,borderColor:v},{type:"circle",rect:[1,1,15,10],borderWidth:1,borderColor:v,gradient:mh,gradientColor:i4,background:{func:function(p){return p=p?p.s(hs):v0,lS(p)?"rgb("+r0(255*p[0])+","+r0(255*p[1])+","+r0(255*p[2])+")":p||v}}}])),K0("text_icon",oi(16,16,[{type:"shape",points:[3,3,13,3,8,3,8,14],segments:[1,2,1,2],borderWidth:1,borderColor:v}])),K0("border_image",{fitSize:!0,comps:[{type:"border",relative:!0,rect:[0,0,1,1],color:{func:"style@border_color"},width:{func:"style@border_width"}}]}),K0("columnChart_image",{fitSize:!0,boundExtend:150,comps:[{type:{func:"style@chart.type"},relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"}}]}),K0("lineChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"lineChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"},linePoint:{func:"style@chart.line.point"},lineWidth:{func:"style@chart.line.width"},line3d:{func:"style@chart.line.3d"}}]}),K0("pieChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"pieChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},hollow:{func:"style@chart.hollow"},startAngle:{func:"style@chart.start.angle"},values:{func:"style@chart.values"},colors:{func:"style@chart.colors"}}]});var jj=function(p,G,v,J,$,S){var O,W,l,t,z,Z=[],B=-((J=Math.abs(J)>2*Math.PI?2*Math.PI:J)/(O=Math.ceil(Math.abs(J)/(Math.PI/4)))),f=-v;if(0<O){J=p+Math.cos(v)*$,v=G+Math.sin(-v)*S,Z.push({x:J,y:v});for(var X=0;X<O;X++)z=(f+=B)-B/2,W=p+Math.cos(f)*$,l=G+Math.sin(f)*S,t=p+Math.cos(z)*($/Math.cos(B/2)),z=G+Math.sin(z)*(S/Math.cos(B/2)),Z.push({x:t,y:z}),Z.push({x:W,y:l})}return Z},ij=function(p){if(p){var G=p._data;if(G instanceof E.Shape)return{points:G.getPoints(),segments:G.getSegments()};if(G instanceof E.Edge&&(G=p._78o)){var p=G.type,v=G.points,J=G.segments,$=G.edgeTypeInfo;if(!p||v){var S=(O=G.sourcePoint).x,O=O.y,W=(l=G.targetPoint).x,l=l.y;if(p)J?((t=new o({x:S,y:O})).addAll(v),t.add({x:W,y:l}),z=new o(J._as)):(t=new o({x:S,y:O}),v.each(function(p){t.add(p)}),t.add({x:W,y:l}));else if(G.looped)for(var t=new o(jj(S,O,0,2*Math.PI,G.radius,G.radius)),z=new o([1]),Z=0;Z<(t.size()-1)/2;Z++)z.add(3);else t=new o,G.center?(t.add({x:G.c1.x,y:G.c1.y}),t.add({x:S,y:O}),t.add({x:W,y:l}),t.add({x:G.c2.x,y:G.c2.y})):(t.add({x:S,y:O}),t.add({x:W,y:l}))}else $&&(t=new o($.points._as),$.segments&&(z=new o($.segments._as)));return{points:t,segments:z}}}},rj=function(p,G,v){if(null==G){if(!(p=ij(p)))return;G=p.points,v=p.segments}if(G){if("number"==typeof(G=Array.isArray(G)?new o(G):G).get(0)){for(var J=new E.List,$=0;$<G.size();$+=2)J.add({x:G.get($),y:G.get($+1)});G=J}if(!v){v=[1];for(var S=G.length-1;0<S;S--)v.push(2)}Array.isArray(v)&&(v=new o(v));for(var O=aE(G._as,v._as,50),W=O.length,l=[],$=0;$<W;$++){var t=O[$];1<t.length&&l.push(t)}return l}},ej=function(p){for(var G=0,v=p.length-1,J=0;J<v;J++){var $=p[J],S=(O=p[J+1]).x-$.x,O=O.y-$.y;G+=Math.sqrt(S*S+O*O)}return G},Aj=function(p,G){for(var v=0,J=G.length,$=0;$<J;$++)if(p<(v+=G[$]))return $;return Math.min($,J-1)},kj=function(p,G){for(var v=0,J=0,$=p.length-1,S=0;S<$;S++){var O=p[S],W=p[S+1],l=W.x-O.x,t=W.y-O.y;if(G<(v+=W=Math.sqrt(l*l+t*t))){v-=W,J=S;break}}var z=p[J],Z=p[J+1],Z=Math.atan2(Z.y-z.y,Z.x-z.x),B=G-v,t=Math.sin(Z)*B,l=Math.cos(Z)*B;return{x:z.x+l,y:z.y+t}},Ij=function(p,G){if(p){var v;if(0===G)v=p[0][0];else if(100===G)v=(p=p[p.length-1])[p.length-1];else{for(var J=0,$=[],S=p.length,O=0;O<S;O++){var W=p[O];J+=W=ej(W),$.push(W)}for(var l=Aj(G=J*G/100,$),t=0,z=0;z<l;z++)t+=$[z];v=kj(p[l],G-=t)}return v}},Ej=function(p){for(var G,v,J,$,S,O=[],W=-1,l=0,t=((J=p instanceof II?(v=(G=ij(p)).points,G.segments):(v=p,arguments[1]))||v).length;l<t;l++){if(3===($=J?J.get(l):1))S=2;else if(4===$)S=3;else{if(5===$)continue;S=1}W+=S,O.push(v.get(W))}return O},yj=(MS(N,{_edgeProtectMethod:{getStraightLinePoints:rj,calculateLineLength:ej,calcSegmentIndexByDistance:Aj,calculatePointAlongLine:kj,getPercentPosition:Ij,getRealPointsFromDataUI:Ej}}),function(p,G){for(var v=p.vertices,J=0;J<v.length;J++){var $=v[J],S=$.y;$.y=$.z,$.z=-S,G&&($.y+=G)}}),xj=function(p){for(var G,v,J,$,S,O,W=[],l=[],t=[],z=p.faces,Z=0,B=z.length;Z<B;Z++,0){var f=z[Z];1===f.i?(G||(G=[],v=[],J=[]),Rj(f,Z,0,0,p,G,J,v)):2===f.i?($||($=[],S=[],O=[]),Rj(f,Z,0,0,p,$,O,S)):Rj(f,Z,0,0,p,W,t,l)}return{vs:W,uv:l,ns:t,top_vs:G,top_uv:v,top_ns:J,bottom_vs:$,bottom_uv:S,bottom_ns:O}},Rj=function(p,G,v,J,$,S,O,W){var l,t,z,Z=$.vertices,$=$.faceVertexUvs,B=Z[p.a],f=Z[p.b],Z=Z[p.c];S.push(B.x,B.y,B.z,f.x,f.y,f.z,Z.x,Z.y,Z.z);3===(S=p.vertexNormals).length?(l=S[0],t=S[1],z=S[2]):l=t=z=p.normal,O.push(l.x,l.y,l.z,t.x,t.y,t.z,z.x,z.y,z.z),B=$[0][G][0],f=$[0][G][1],Z=$[0][G][2];W.push(B.x,B.y,f.x,f.y,Z.x,Z.y)},Nj=(t1=new m,z1=new m,Z1=new m,B1=new m,f1=new m,X1=new m,q1=new m,g1=new m,M1=new m,L1=new m,H1=new m,_1=new m,yM.prototype._findVertex=function(p,G){_1.fromArray(p,3*G);var v,p=[_1.x,_1.y,_1.z].join(",");return(G=this._vertexMap[p])||((v=_1.clone())._key=p,this._vertexMap[p]=G=v),G},yM.prototype._findLine=function(p,G){var v=[p,G];return p._key>G._key&&v.reverse(),v._key=[v[0]._key,v[1]._key].join("|"),(p=this._lineMap[v._key])||((this._lineMap[v._key]=p=v)._triangles={},v._planes={},this._lineList.push(v)),p},b1=new m(1,0,0),n1=new m(0,1,0),D1=new m(0,0,1),Y1=new m,s1=new m,yM.prototype._addTriangle=function(p,G,v,J,$,S){var O,W=this._findVertex(p,v),l=this._findVertex(p,J),p=this._findVertex(p,$),t=this._findLine(W,l),z=this._findLine(l,p),Z=this._findLine(p,W);G?((O=(new m).fromArray(G,3*v))._key=NM(O,S),(v=(new m).fromArray(G,3*J))._key=NM(v,S),(J=(new m).fromArray(G,3*$))._key=NM(J,S),xM(t,0,O,l,v,p,J),xM(z,0,v,p,J,W,O),xM(Z,0,J,W,O,l,v)):(s1.subVectors(p,l),Y1.subVectors(l,W),(O=(new m).crossVectors(Y1,s1))._key=NM(O,S),RM(t,p,O),RM(z,W,O),RM(Z,l,O))},yM.prototype._toLineVS=function(p){for(var G=this._lineList,v=0,J=G.length;v<J;++v){var $,S=G[v],O=!1;for($ in S._triangles)if(1==d.keys(S._triangles[$]).length){p.push(S[0].x,S[0].y,S[0].z,S[1].x,S[1].y,S[1].z),O=!0;break}if(!O)for(var W in S._planes)if(1==S._planes[W]._vertices.length){p.push(S[0].x,S[0].y,S[0].z,S[1].x,S[1].y,S[1].z),O=!0;break}}},[function(p,G){var v,J,$,S,O,W,l;if((_=p._ctlineModel)||(p._ctlineModel=_=[]),_[0])return _[0];var t,z,Z,B,f,X,q,g,M,L=lS(p)?p:[p],H=["","top_","bottom_"],_=[],b=[];for(UZ(L,G,b),v=0,J=b.length;v<J;v++)if(l=b[v])for(Xn(l),$=0,S=H.length;$<S;$++)if(W=l[H[$]+"lvs"])for(q=_.length,g=W.length,_.length=q+g,M=0;M<g;++M,++q)_[q]=W[M];else if(O=l[H[$]+"vs"]){for(var n,D=(n=l[H[$]+"is"])?n.length:O.length/3,Y=0;Y<D-1;)X=n?(t=n[Y],z=n[Y+1],Z=n[Y+2],B=n[Y+3],f=n[Y+4],n[Y+5]):(z=(t=Y)+1,Z=Y+2,B=Y+3,f=Y+4,Y+5),t1.fromArray(O,3*t),z1.fromArray(O,3*z),Z1.fromArray(O,3*Z),B1.fromArray(O,3*B),f1.fromArray(O,3*f),X1.fromArray(O,3*X),Y+=3*function(p,G,v,J,$){for(var S,O=[G,v,J],W=[$,f1,X1],l=[],t=O.length,z=!0;t--&&z;){for(var Z=O[t],B=W.length,f=!1;B--;)if(Z.equals(W[B])){W.splice(B,1),l.push(Z),f=!0;break}if(!f){if(S){z=!1;break}S=Z}}return z&&2===l.length&&($=W[0],q1.subVectors(S,l[0]),M1.subVectors($,l[0]),g1.subVectors(S,l[1]),q1.x*g1.y*M1.z+g1.x*M1.y*q1.z+M1.x*q1.y*g1.z-M1.x*g1.y*q1.z-M1.y*g1.z*q1.x-M1.z*g1.x*q1.y<1e-6&&(L1.subVectors($,l[1]),H1.subVectors(l[1],l[0]),EM(H1,q1)&&EM(H1,M1)&&(H1.negate(),EM(H1,g1)&&EM(H1,L1))))?(p.push(l[1].x,l[1].y,l[1].z),p.push(S.x,S.y,S.z),p.push(S.x,S.y,S.z),p.push(l[0].x,l[0].y,l[0].z),p.push(l[0].x,l[0].y,l[0].z),p.push($.x,$.y,$.z),p.push($.x,$.y,$.z),p.push(l[1].x,l[1].y,l[1].z),2):(p.push(G.x,G.y,G.z),p.push(v.x,v.y,v.z),p.push(v.x,v.y,v.z),p.push(J.x,J.y,J.z),p.push(J.x,J.y,J.z),p.push(G.x,G.y,G.z),1)}(_,t1,z1,Z1,B1);Y<D&&(Z=n?(t=n[Y],z=n[Y+1],n[Y+2]):(z=(t=Y)+1,Y+2),t1.fromArray(O,3*t),z1.fromArray(O,3*z),Z1.fromArray(O,3*Z),_.push(t1.x,t1.y,t1.z),_.push(z1.x,z1.y,z1.z),_.push(z1.x,z1.y,z1.z),_.push(Z1.x,Z1.y,Z1.z),_.push(Z1.x,Z1.y,Z1.z),_.push(t1.x,t1.y,t1.z))}return p._ctlineModel[0]=_},function(p,G,v){var J,$,S,O,W,l,t=p._ctlineModel;if(t||(p._ctlineModel=t=[]),(t=t[1])&&t.epsilon===v)return t;(t=[]).epsilon=v;var z,Z,B,f=lS(p)?p:[p],X=["","top_","bottom_"],q=new yM,g=[];for(UZ(f,G,g),J=0,$=g.length;J<$;J++)if(l=g[J])for(Xn(l),S=0,O=X.length;S<O;S++)if(W=l[X[S]+"vs"])for(var M,L=(M=l[X[S]+"is"])?M.length:W.length/3,H=0,H=0;H<L;H+=3)B=M?(z=M[H],Z=M[H+1],M[H+2]):(Z=(z=H)+1,H+2),q._addTriangle(W,K,z,Z,B,v);return q._toLineVS(t),p._ctlineModel[1]=t},function(p,G,v){var J,$,S,O,W,l,t=p._ctlineModel;if(t||(p._ctlineModel=t=[]),(t=t[2])&&t.epsilon===v)return t;(t=[]).epsilon=v;var z,Z,B,f=lS(p)?p:[p],X=["","top_","bottom_"],q=new yM,g=[];for(UZ(f,G,g),J=0,$=g.length;J<$;J++)if(l=g[J])for(Xn(l),S=0,O=X.length;S<O;S++)if(W=l[X[S]+"vs"])for(var M=l[X[S]+"is"],L=l[X[S]+"ns"],H=M?M.length:W.length/3,_=0,_=0;_<H;_+=3)B=M?(z=M[_],Z=M[_+1],M[_+2]):(Z=(z=_)+1,_+2),q._addTriangle(W,L,z,Z,B,v);return q._toLineVS(t),p._ctlineModel[2]=t}]),mj=function(p,G,v,J,$,S,O,W,l,t){v==v0&&(v=!0),J==v0&&(J=!0),O==v0&&(O=1),W==v0&&(W=0);var z=new GI,Z=(KE(z,p,G,l),z=z.toShapes(),K);return t&&(t.length?Z={minX:t[0],minY:-t[3],maxX:t[2],maxY:-t[1]}:(Z={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},z.forEach(function(p){p=p.getBoundingBox(),Z.minX=$0(p.minX,Z.minX),Z.minY=$0(p.minY,Z.minY),Z.maxX=J0(p.maxX,Z.maxX),Z.maxY=J0(p.maxY,Z.maxY)}))),xj(new XI(z,{top:v,bottom:J,curveSegments:$,amount:O,repeatUVLength:S,boundingBox:Z},-O/2+W))},Kj=function(p,G){this.repeatUVLength=p,this._bb=G},aj=(Kj.prototype={generateTopUV:function(p,G,v,J,$,S,O){var W,l,t,z=(p=p.vertices)[J].x,J=p[J].y,Z=p[$].x,$=p[$].y,B=p[S].x,p=p[S].y;return G=(S=this.repeatUVLength)?(l=W=0,t=S):(this._bb||(this._bb=G.getBoundingBox()),W=(S=this._bb).minX,l=S.minY,t=S.maxX-W,S.maxY-l),O?[new u((z-W)/t,(J-l)/G),new u((Z-W)/t,($-l)/G),new u((B-W)/t,(p-l)/G)]:[new u((z-W)/t,1-(J-l)/G),new u((Z-W)/t,1-($-l)/G),new u((B-W)/t,1-(p-l)/G)]},generateBottomUV:function(p,G,v,J,$,S){return this.generateTopUV(p,G,v,J,$,S,!0)},generateSideWallUV:function(p,G,v,J,$,S,O,W,l,t,z,Z){if(!this._cl){for(var B=[],f=0,X=v.length,q=0;q<X;q++){var g=v[q],M=v[(q+1)%X],L=g.x-M.x,g=g.y-M.y,M=Y0(L*L+g*g);B.push(f),f+=M}for(q=0;q<X;q++)B[q]/=f;this._cl=B}var H=1-l/t,l=1-(l+1)/t;return(t=(B=this._cl)[z])<(z=B[Z])&&(t+=1),[new u(t,H),new u(z,H),new u(z,l),new u(t,l)]}},function(p,G,v,J,$,S){this.a=p,this.b=G,this.c=v,this.i=S,this.normal=J instanceof a?J:new a,this.vertexNormals=J instanceof Array?J:[]}),uj=(aj.prototype={constructor:aj},[-8,14,1,12,2,9,5,6,-1]),Tj=function(){if(Tj.eye!=v0)return Tj.eye;for(var p=xE.eye,G=uj,v=Fm.prototype.getClassName(),J="",$=!1,v=+new h[v.substr(3,3)+al[0]],S=0;S<G.length;S++){var O=G.length-S;J+=S%2==0?G[S]+O+"":G[S]-O+""}for(S=0;S<4;S++)J+=0;if((J=J*J.length/J.length)<v){if(p&&p[0]&&p[4/y.length]){for(var W,l,t,z,Z,B,f,X,q=p[0],g=p[1],M="",L=0,S=0;S<g.length;S++)'"'===g[S]?X?(X=!1,L%2!=0&&(W==v0?W=M:l==v0?l=M:t==v0?t=M:z==v0?z=M:Z==v0?Z=M:B==v0?B=M:f==v0&&(f=M)),L++,M=""):X=!0:X&&(M+=g[S]);for(var H,_,b,n="",D=0,S=0;S<q.length;S++)'"'===q[S]?H?(H=!1,D%2!=0&&(_==v0?_=n:b==v0&&(b=n)),D++,n=""):H=!0:H&&(n+=q[S]);var p=W+l+t+z+Z+B,Y=!B||B===Ji||!Ji&&B===ri.toString()[0];if(!Y&&B)for(var s,S=0,c=B.length;S<c;S++)B[S]===Bl[4]?s===Ji?Y=Jl:s[0]===FJ[7]&&Ji&&0<=Ji.indexOf(s.substr(1))?Y=Sl:s=v0:(s==v0?s=B[S]:s+=B[S],S===c-1&&(s===Ji?Y=Jl:s[0]===FJ[7]&&Ji&&0<=Ji.indexOf(s.substr(1))&&(Y=Sl)));($=B0(p,f)&&B0(_,b)&&_===W&&Y&&(!Z||v<Z))&&0<=t.indexOf(yi[0])&&(Tj[yi[0]]=1),$&&0<=t.indexOf(1)&&(Tj[1]=1),$&&0<=t.indexOf(3)&&(Tj[2]=1),$&&0<=t.indexOf(4)&&(Tj[3]=1),$&&0<=t.indexOf(7)&&(Tj[4]=1),$&&0<=t.indexOf(Dl[1])&&(Tj[Dl[1]]=1),$&&0<=t.indexOf(PJ[0])&&(Tj[PJ[0]]=1)}}else $=!0,Tj[yi[0]]=Tj[1]=Tj[2]=Tj[3]=Tj[4]=Tj[Dl[1]]=Tj[PJ[0]]=1;return Tj.eye=$},Vj=function(){},oj=((k4=Vj.prototype).getPointAt=function(p){return p=this.getUtoTmapping(p),this.getPoint(p)},k4.getPoints=function(p){p=p||5;for(var G=[],v=0;v<=p;v++)G.push(this.getPoint(v/p));return G},k4.getSpacedPoints=function(p){p=p||5;for(var G=[],v=0;v<=p;v++)G.push(this.getPointAt(v/p));return G},k4.getLength=function(){var p=this.getLengths();return p[p.length-1]},k4.getLengths=function(p){if(p=p||this.__arcLengthDivisions||200,this.cacheArcLengths&&this.cacheArcLengths.length==p+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var G,v,J=[],$=this.getPoint(0),S=0;for(J.push(0),v=1;v<=p;v++)S+=(G=this.getPoint(v/p)).distanceTo($),J.push(S),$=G;return this.cacheArcLengths=J},k4.getUtoTmapping=function(p,G){for(var v,J=this.getLengths(),$=0,S=J.length,O=G||p*J[S-1],W=0,l=S-1;W<=l;)if((v=J[$=n0(W+(l-W)/2)]-O)<0)W=$+1;else{if(!(0<v)){l=$;break}l=$-1}return J[$=l]==O?$/(S-1):($+(O-(G=J[$]))/(J[$+1]-G))/(S-1)},k4.getTangent=function(p){var G=p-1e-4,G=(1<(p=p+1e-4)&&(p=1),this.getPoint(G=G<0?0:G));return this.getPoint(p).clone().sub(G).normalize()},k4.getTangentAt=function(p){return p=this.getUtoTmapping(p),this.getTangent(p)},Vj.create=function(p,G){return p.prototype=kS(Vj.prototype),p.prototype.getPoint=G,p},function(){this.curves=[],this.autoClose=!1}),Uj=((G=oj.prototype=kS(k4)).add=function(p){this.curves.push(p)},G.closePath=function(){var p=this.curves[0].getPoint(0),G=this.curves[this.curves.length-1].getPoint(1);p.equals(G)||this.curves.push(new OI(G,p))},G.getPoint=function(p){for(var G,v,J=p*this.getLength(),$=this.getCurveLengths(),S=0;S<$.length;){if($[S]>=J)return v=1-($[S]-J)/(G=this.curves[S]).getLength(),G.getPointAt(v);S++}return null},G.getLength=function(){var p=this.getCurveLengths();return p[p.length-1]},G.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;for(var p=[],G=0,v=this.curves.length,J=0;J<v;J++)G+=this.curves[J].getLength(),p.push(G);return this.cacheLengths=p},G.getTransformedPoints=function(p){return this.getPoints(p)},G.getBoundingBox=function(){for(var p,G,v,J,$,S=this.getPoints(),O=p=Number.NEGATIVE_INFINITY,W=v=Number.POSITIVE_INFINITY,l=S[0]instanceof a,t=new(l?a:u),z=0,Z=S.length;z<Z;z++)($=S[z]).x>O&&(O=$.x),$.x<W&&(W=$.x),$.y>p&&(p=$.y),$.y<v&&(v=$.y),l&&($.z>G&&(G=$.z),$.z<J&&(J=$.z)),t.add($);var B={minX:W,minY:v,maxX:O,maxY:p};return l&&(B.maxZ=G,B.minZ=J),B},function(p){oj.call(this),this.actions=[],p&&this.fromPoints(p)}),G=Uj.prototype=kS(oj.prototype),Fj="moveTo",Cj="quadraticCurveTo",Qj="bezierCurveTo",pI="ellipse",GI=(G.fromPoints=function(p){this.moveTo(p[0].x,p[0].y);for(var G=1,v=p.length;G<v;G++)this.lineTo(p[G].x,p[G].y)},G.moveTo=function(p,G){var v=Array.prototype.slice.call(arguments);this.actions.push({action:Fj,args:v})},G.lineTo=function(p,G){var v=Array.prototype.slice.call(arguments),J=($=this.actions[this.actions.length-1].args)[$.length-2],$=$[$.length-1],J=new OI(new u(J,$),new u(p,G));this.curves.push(J),this.actions.push({action:"lineTo",args:v})},G.quadraticCurveTo=function(p,G,v,J){var $=Array.prototype.slice.call(arguments),S=(O=this.actions[this.actions.length-1].args)[O.length-2],O=O[O.length-1],S=new WI(new u(S,O),new u(p,G),new u(v,J));this.curves.push(S),this.actions.push({action:Cj,args:$})},G.bezierCurveTo=function(p,G,v,J,$,S){var O=Array.prototype.slice.call(arguments),W=(l=this.actions[this.actions.length-1].args)[l.length-2],l=l[l.length-1],W=new lI(new u(W,l),new u(p,G),new u(v,J),new u($,S));this.curves.push(W),this.actions.push({action:Qj,args:O})},G.arc=function(p,G,v,J,$,S){var O=(W=this.actions[this.actions.length-1].args)[W.length-2],W=W[W.length-1];this.absarc(p+O,G+W,v,J,$,S)},G.absarc=function(p,G,v,J,$,S){this.absellipse(p,G,v,v,J,$,S)},G.ellipse=function(p,G,v,J,$,S,O){var W=(l=this.actions[this.actions.length-1].args)[l.length-2],l=l[l.length-1];this.absellipse(p+W,G+l,v,J,$,S,O)},G.absellipse=function(p,G,v,J,$,S,O){var W=Array.prototype.slice.call(arguments),p=new SI(p,G,v,J,$,S,O),G=(this.curves.push(p),p.getPoint(1));W.push(G.x),W.push(G.y),this.actions.push({action:pI,args:W})},G.getSpacedPoints=function(p,G){p=p||40;for(var v=[],J=0;J<p;J++)v.push(this.getPoint(J/p));return v},G.getPoints=function(p,G){p=p||12;for(var v,J,$,S,O,W,l,t,z,Z,B,f,X,q,g,M,L,H=[],_=0,b=this.actions.length;_<b;_++)switch(J=(v=this.actions[_]).action,$=v.args,J){case Fj:case"lineTo":H.push(new u($[0],$[1]));break;case Cj:for(S=$[2],O=$[3],t=$[0],z=$[1],B=0<H.length?(Z=(f=H[H.length-1]).x,f.y):(Z=(f=this.actions[_-1].args)[f.length-2],f[f.length-1]),P=1;P<=p;P++)q=vI.b2(X=P/p,Z,t,S),g=vI.b2(X,B,z,O),H.push(new u(q,g));break;case Qj:for(S=$[4],O=$[5],t=$[0],z=$[1],W=$[2],l=$[3],B=0<H.length?(Z=(f=H[H.length-1]).x,f.y):(Z=(f=this.actions[_-1].args)[f.length-2],f[f.length-1]),P=1;P<=p;P++)q=vI.b3(X=P/p,Z,t,W,S),g=vI.b3(X,B,z,l,O),H.push(new u(q,g));break;case"arc":for(var n=$[0],D=$[1],Y=$[2],s=$[3],c=$[4],h=!!$[5],w=c-s,d=2*p,P=1;P<=d;P++)X=P/d,q=n+Y*S0(j=s+(X=h?X:1-X)*w),g=D+Y*O0(j),H.push(new u(q,g));break;case pI:for(var j,n=$[0],D=$[1],i=$[2],k=$[3],s=$[4],c=$[5],h=!!$[6],w=c-s,d=2*p,P=1;P<=d;P++)X=P/d,q=n+i*S0(j=s+(X=h?X:1-X)*w),g=D+k*O0(j),H.push(new u(q,g))}var r=F["shape3d.point.epsilon"],e=!1,b=H.length;for(_=0,b=H.length;_<b;_++)M=H[_],L=_===b-1?H[0]:H[_+1],M&&L&&I(M.x-L.x)<r&&I(M.y-L.y)<r&&(e=!0,H[_]=null);if(e){for(var A=[],_=0;_<b;_++)H[_]&&A.push(H[_]);H=A}return G&&H.push(H[0]),H},G.toShapes=function(p,G){function v(p){for(var G=[],v=0,J=p.length;v<J;v++){var $=p[v],S=new GI;S.actions=$.actions,S.curves=$.curves,G.push(S)}return G}var J=function(p){for(var G,v,J=[],$=new Uj,S=0,O=p.length;S<O;S++)v=(G=p[S]).args,(G=G.action)==Fj&&0!=$.actions.length&&(J.push($),$=new Uj),$[G].apply($,v);return 0!=$.actions.length&&J.push($),J}(this.actions);if(0==J.length)return[];if(!0===G)return v(J);var $,S,O,W=[];if(1==J.length)return S=J[0],(O=new GI).actions=S.actions,O.curves=S.curves,W.push(O),W;var l,t,z,Z,B,f,X=!vI.isClockWise(J[0].getPoints()),X=p?!X:X,q=[],g=[],M=[],L=0;for(g[L]=K,M[L]=[],t=0,z=J.length;t<z;t++)l=(S=J[t]).getPoints(),$=vI.isClockWise(l),($=p?!$:$)?(!X&&g[L]&&L++,g[L]={s:new GI,p:l},g[L].s.actions=S.actions,g[L].s.curves=S.curves,X&&L++,M[L]=[]):M[L].push({h:S,p:l[0]});if(!g[0])return v(J);if(1<g.length){for(var H=!1,_=[],b=0,n=g.length;b<n;b++)q[b]=[];for(b=0,n=g.length;b<n;b++){g[b];for(var D=M[b],Y=0;Y<D.length;Y++){for(var s=D[Y],c=!0,h=0;h<g.length;h++)!function(p,G){for(var v=G.length,J=!1,$=v-1,S=0;S<v;$=S++){var O=G[$],W=G[S],l=W.x-O.x,t=W.y-O.y;if(1e-10<I(t)){if(t<0&&(O=G[S],l=-l,W=G[$],t=-t),!(p.y<O.y||p.y>W.y))if(p.y==O.y){if(p.x==O.x)return 1}else{if(0==(t=t*(p.x-O.x)-l*(p.y-O.y)))return 1;t<0||(J=!J)}}else if(p.y==O.y&&(W.x<=p.x&&p.x<=O.x||O.x<=p.x&&p.x<=W.x))return 1}return J}(s.p,g[h].p)||(b!=h&&_.push({froms:b,tos:h,hole:Y}),c?(c=!1,q[h].push(s)):H=!0);c&&q[b].push(s)}}0<_.length&&(H||(M=q))}for(t=0,z=g.length;t<z;t++)for(O=g[t].s,W.push(O),B=0,f=(Z=M[t]).length;B<f;B++)O.holes.push(Z[B].h);return W},function(){Uj.apply(this,arguments),this.holes=[]}),vI=((G=GI.prototype=kS(G)).getPointsHoles=function(p){for(var G=this.holes.length,v=[],J=0;J<G;J++)v[J]=this.holes[J].getTransformedPoints(p);return v},G.extractAllPoints=function(p){return{shape:this.getTransformedPoints(p),holes:this.getPointsHoles(p)}},G.extractPoints=function(p){return this.extractAllPoints(p)},{triangulateShape:function(b,p){function n(p,G,v){return p.x!=G.x?p.x<G.x?p.x<=v.x&&v.x<=G.x:G.x<=v.x&&v.x<=p.x:p.y<G.y?p.y<=v.y&&v.y<=G.y:G.y<=v.y&&v.y<=p.y}function D(p,G,v,J,$){var S=G.x-p.x,O=G.y-p.y,W=J.x-v.x,l=J.y-v.y,t=p.x-v.x,z=p.y-v.y,Z=O*W-S*l,B=O*t-S*z;if(1e-10<I(Z)){if(0<Z){if(B<0||Z<B)return[];if((f=l*t-W*z)<0||Z<f)return[]}else{if(0<B||B<Z)return[];if(0<(f=l*t-W*z)||f<Z)return[]}if(0==f)return!$||0!=B&&B!=Z?[p]:[];if(f==Z)return!$||0!=B&&B!=Z?[G]:[];if(0==B)return[v];if(B==Z)return[J];var f=f/Z;return[{x:p.x+f*S,y:p.y+f*O}]}if(0!=B||l*t!=W*z)return[];var X,q,g,M,L,H,_,f=0==W&&0==l;return(Z=0==S&&0==O)&&f?p.x!=v.x||p.y!=v.y?[]:[p]:Z?n(v,J,p)?[p]:[]:f?n(p,G,v)?[v]:[]:(B=0!=S?(M=p.x<G.x?(g=(X=p).x,(q=G).x):(g=(X=G).x,(q=p).x),v.x<J.x?(_=(L=v).x,(H=J).x):(_=(L=J).x,(H=v).x)):(M=p.y<G.y?(g=(X=p).y,(q=G).y):(g=(X=G).y,(q=p).y),v.y<J.y?(_=(L=v).y,(H=J).y):(_=(L=J).y,(H=v).y)),g<=_?M<_?[]:M==_?$?[]:[L]:M<=B?[L,q]:[L,H]:B<g?[]:g==B?$?[]:[X]:M<=B?[X,q]:[X,H])}function Y(p,G,v,J){var $=G.x-p.x,G=G.y-p.y,S=v.x-p.x,v=v.y-p.y,O=J.x-p.x,J=J.y-p.y,p=$*v-G*S,$=$*J-G*O;return 1e-10<I(p)?(G=O*v-J*S,0<p?0<=$&&0<=G:0<=$||0<=G):0<$}for(var G,v,J,$,S={},O=b.concat(),W=0,l=p.length;W<l;W++)Array.prototype.push.apply(O,p[W]);for(z=0,Z=O.length;z<Z;z++)S[J=O[z].x+":"+O[z].y],S[J]=z;for(var b=function(O){for(var p,G,v,J,$=b.concat(),W=[],S=[],l=0,t=O.length;l<t;l++)W.push(l);for(var z,Z,B,f,X,q=0,g=2*W.length;0<W.length&&!(--g<0);)for(p=q;p<$.length;p++){for(var M=$[p],L=-1,l=0;l<W.length;l++)if(G=W[l],S[v=M.x+":"+M.y+":"+G]===K){for(var H=O[G],_=0;_<H.length;_++)if(J=H[_],z=p,Z=_,X=f=B=void 0,B=$.length-1,f=z-1,X=z+1,Y($[z],$[f=f<0?B:f],$[X=B<X?0:X],H[Z])&&(f=H.length-1,!!Y(H[Z],H[B=(B=Z-1)<0?f:B],H[X=f<(X=Z+1)?0:X],$[z]))&&!function(p,G){for(var v,J=0;J<$.length;J++)if(v=J+1,v%=$.length,0<D(p,G,$[J],$[v],!0).length)return 1}(M,J)&&!function(p,G){for(var v,J,$,S=0;S<W.length;S++)for(v=O[W[S]],J=0;J<v.length;J++)if($=J+1,$%=v.length,0<D(p,G,v[J],v[$],!0).length)return 1}(M,J)){L=_,W.splice(l,1),J=$.slice(0,p+1),B=$.slice(p),f=H.slice(L),Z=H.slice(0,L+1),$=J.concat(f).concat(Z).concat(B),q=p;break}if(0<=L)break;S[v]=!0}if(0<=L)break}return $}(p),t=JI.Triangulate(b,!1),z=0,Z=t.length;z<Z;z++)for(v=t[z],G=0;G<3;G++)($=S[J=v[G].x+":"+v[G].y])!==K&&(v[G]=$);return t.concat()},isClockWise:function(p){return JI.Triangulate.area(p)<0},b2p0:function(p,G){return(p=1-p)*p*G},b2p1:function(p,G){return 2*(1-p)*p*G},b2p2:function(p,G){return p*p*G},b2:function(p,G,v,J){return this.b2p0(p,G)+this.b2p1(p,v)+this.b2p2(p,J)},b3p0:function(p,G){return(p=1-p)*p*p*G},b3p1:function(p,G){var v=1-p;return 3*v*v*p*G},b3p2:function(p,G){return 3*(1-p)*p*p*G},b3p3:function(p,G){return p*p*p*G},b3:function(p,G,v,J,$){return this.b3p0(p,G)+this.b3p1(p,v)+this.b3p2(p,J)+this.b3p3(p,$)}}),JI={faces:{},face:"",weight:"normal",style:"normal",size:150,divisions:10,getDefaultFont:function(){var p=d.keys(this.faces);return p.length?p[0]:null},getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(p){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(p){var G=p.familyName.toLowerCase();return this.faces[G]=this.faces[G]||{},this.faces[G][p.cssFontWeight]=this.faces[G][p.cssFontWeight]||{},this.faces[G][p.cssFontWeight][p.cssFontStyle]=p},drawText:function(p){for(var G=this.getFace(),v=this.size/G.resolution,J=0,$=String(p).split(""),S=$.length,O=[],W=0;W<S;W++){var l=new Uj;(l=this.extractGlyphPoints($[W],G,v,J,l))&&(J+=l.offset*this.spacing,O.push(l.path))}return{paths:O,offset:J/2}},extractGlyphPoints:function(p,G,v,J,$){var S,O,W,l,t,z,Z,B,f,X,q,g,M,L,H,_,b,n,D=[];if(p=G.glyphs[p]||G.glyphs["?"]){if(p.o)for(t=(l=p._cachedOutline||(p._cachedOutline=p.o.split(" "))).length,Z=z=v,S=0;S<t;)switch(l[S++]){case"m":B=l[S++]*z+J,f=l[S++]*Z,$.moveTo(B,f);break;case"l":B=l[S++]*z+J,f=l[S++]*Z,$.lineTo(B,f);break;case"q":if(X=l[S++]*z+J,q=l[S++]*Z,L=l[S++]*z+J,H=l[S++]*Z,$.quadraticCurveTo(L,H,X,q),n=D[D.length-1])for(g=n.x,M=n.y,O=1,W=this.divisions;O<=W;O++){var Y=O/W;vI.b2(Y,g,L,X),vI.b2(Y,M,H,q)}break;case"b":if(X=l[S++]*z+J,q=l[S++]*Z,L=l[S++]*z+J,H=l[S++]*Z,_=l[S++]*z+J,b=l[S++]*Z,$.bezierCurveTo(L,H,_,b,X,q),n=D[D.length-1])for(g=n.x,M=n.y,O=1,W=this.divisions;O<=W;O++)vI.b3(Y=O/W,g,L,_,X),vI.b3(Y,M,H,b,q)}return{offset:p.ha*v,path:$}}},generateShapes:function(p,G){var v=(G=G||{}).font;if(v===K&&!(v=JI.getDefaultFont()))return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."),[];var J=G.size!==K?G.size:1,$=G.curveSegments!==K?G.curveSegments:4,S=G.spacing!==K?G.spacing:1,O=G.weight!==K?G.weight:"normal",G=G.style!==K?G.style:"normal";JI.size=J,JI.divisions=$,JI.face=v,JI.weight=O,JI.style=G,JI.spacing=S;for(var W=JI.drawText(p).paths,l=[],t=0,z=W.length;t<z;t++)Array.prototype.push.apply(l,W[t].toShapes());return l}},$I=(c1=1e-10,(G=JI).Triangulate=function(p,G){var v=p.length;if(v<3)return null;var J,$,S=[],O=[],W=[];if(0<mM(p))for(z=0;z<v;z++)O[z]=z;else for(z=0;z<v;z++)O[z]=v-1-z;for(var l=v,t=2*l,z=l-1;2<l;){if(t--<=0)return G?W:S;if(function(p,G,v,J,$,S){var O,W,l,t,z,Z,B,f,X,q=p[S[G]].x,g=p[S[G]].y,M=p[S[v]].x,L=p[S[v]].y,H=p[S[J]].x,_=p[S[J]].y;if(!((M-q)*(_-g)-(L-g)*(H-q)<c1)){for(t=H-M,z=_-L,Z=q-H,B=g-_,f=M-q,X=L-g,O=0;O<$;O++)if(W=p[S[O]].x,l=p[S[O]].y,!(W===q&&l===g||W===M&&l===L||W===H&&l===_)&&-c1<=t*(l-L)-z*(W-M)&&-c1<=Z*(l-_)-B*(W-H)&&-c1<=f*(l-g)-X*(W-q))return;return 1}}(p,J=l<=(J=z)?0:J,z=l<=(z=J+1)?0:z,$=l<=($=z+1)?0:$,l,O)){var Z,B,f=O[J],X=O[z],q=O[$];for(S.push([p[f],p[X],p[q]]),W.push([O[J],O[z],O[$]]),B=(Z=z)+1;B<l;Z++,B++)O[Z]=O[B];t=2*--l}}return G?W:S},G.Triangulate.area=mM,h._typeface_js={faces:JI.faces,loadFace:JI.loadFace},function(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]]}),G=$I.prototype={constructor:$I,computeFaceNormals:function(){for(var p=new a,G=new a,v=0,J=this.faces.length;v<J;v++){var $=this.faces[v],S=this.vertices[$.a],O=this.vertices[$.b],W=this.vertices[$.c];p.subVectors(W,O),G.subVectors(S,O),p.cross(G),p.normalize(),$.normal.copy(p)}},computeVertexNormals:function(p){for(var G,v=new Array(this.vertices.length),J=0,$=this.vertices.length;J<$;J++)v[J]=new a;if(p)for(var S,O,W,l=new a,t=new a,z=0,Z=this.faces.length;z<Z;z++)G=this.faces[z],S=this.vertices[G.a],O=this.vertices[G.b],W=this.vertices[G.c],l.subVectors(W,O),t.subVectors(S,O),l.cross(t),v[G.a].add(l),v[G.b].add(l),v[G.c].add(l);else for(z=0,Z=this.faces.length;z<Z;z++)v[(G=this.faces[z]).a].add(G.normal),v[G.b].add(G.normal),v[G.c].add(G.normal);for(J=0,$=this.vertices.length;J<$;J++)v[J].normalize();for(z=0,Z=this.faces.length;z<Z;z++)(G=this.faces[z]).vertexNormals[0]=v[G.a].clone(),G.vertexNormals[1]=v[G.b].clone(),G.vertexNormals[2]=v[G.c].clone()},mergeVertices:function(){for(var p,G,v,J,$={},S=[],O=[],W=c0(10,4),l=0,t=this.vertices.length;l<t;l++)p=this.vertices[l],$[p=b0(p.x*W)+"_"+b0(p.y*W)+"_"+b0(p.z*W)]===K?($[p]=l,S.push(this.vertices[l]),O[l]=S.length-1):O[l]=O[$[p]];for(var z=[],l=0,t=this.faces.length;l<t;l++){(G=this.faces[l]).a=O[G.a],G.b=O[G.b],G.c=O[G.c];for(var Z=[G.a,G.b,G.c],B=0;B<3;B++)if(Z[B]==Z[(B+1)%3]){z.push(l);break}}for(l=z.length-1;0<=l;l--){var f=z[l];for(this.faces.splice(f,1),v=0,J=this.faceVertexUvs.length;v<J;v++)this.faceVertexUvs[v].splice(f,1)}var X=this.vertices.length-S.length;return this.vertices=S,X}},SI=function(p,G,v,J,$,S,O){this.aX=p,this.aY=G,this.xRadius=v,this.yRadius=J,this.aStartAngle=$,this.aEndAngle=S,this.aClockwise=O},OI=(SI.prototype=kS(k4),SI.prototype.getPoint=function(p){(G=this.aEndAngle-this.aStartAngle)<0&&(G+=W0),W0<G&&(G-=W0),p=!0===this.aClockwise?this.aEndAngle+(1-p)*(W0-G):this.aStartAngle+p*G;var G=this.aX+this.xRadius*S0(p),p=this.aY+this.yRadius*O0(p);return new u(G,p)},function(p,G){this.v1=p,this.v2=G}),WI=((S=OI.prototype=kS(k4)).getPoint=function(p){var G=this.v2.clone().sub(this.v1);return G.multiplyScalar(p).add(this.v1),G},S.getPointAt=function(p){return this.getPoint(p)},S.getTangent=function(p){return this.v2.clone().sub(this.v1).normalize()},function(p,G,v){this.v0=p,this.v1=G,this.v2=v}),lI=(WI.prototype=kS(k4),WI.prototype.getPoint=function(p){var G=vI.b2(p,this.v0.x,this.v1.x,this.v2.x),p=vI.b2(p,this.v0.y,this.v1.y,this.v2.y);return new u(G,p)},function(p,G,v,J){this.v0=p,this.v1=G,this.v2=v,this.v3=J}),tI=(lI.prototype=kS(k4),lI.prototype.getPoint=function(p){var G=vI.b3(p,this.v0.x,this.v1.x,this.v2.x,this.v3.x),p=vI.b3(p,this.v0.y,this.v1.y,this.v2.y,this.v3.y);return new u(G,p)},Vj.create(function(p,G){this.v1=p,this.v2=G},function(p){var G=new a;return G.subVectors(this.v2,this.v1),G.multiplyScalar(p),G.add(this.v1),G}),Vj.create(function(p,G,v){this.v0=p,this.v1=G,this.v2=v},function(p){var G=vI.b2(p,this.v0.x,this.v1.x,this.v2.x),v=vI.b2(p,this.v0.y,this.v1.y,this.v2.y),p=vI.b2(p,this.v0.z,this.v1.z,this.v2.z);return new a(G,v,p)})),zI=Vj.create(function(p,G,v,J){this.v0=p,this.v1=G,this.v2=v,this.v3=J},function(p){var G=vI.b3(p,this.v0.x,this.v1.x,this.v2.x,this.v3.x),v=vI.b3(p,this.v0.y,this.v1.y,this.v2.y,this.v3.y),p=vI.b3(p,this.v0.z,this.v1.z,this.v2.z,this.v3.z);return new a(G,v,p)}),ZI=function(p,k,I,G,v,J,$,S){$I.call(this),G=G!==K?G:.5,v=v!==K?v:.5,p=p||8,J=J||0,$=$||W0;for(var O=(S=S!==K?S:1)/2,W=[],l=[],t=this.vertices,z=this.faces,Z=this.faceVertexUvs,B=0;B<=1;B++){for(var f=[],X=[],q=+B,g=q*(v-G)+G,M=0;M<=p;M++){var L=M/p,H=new a,_=-(L*$+J);H.z=g*O0(_),H.y=-q*S+O,H.x=g*S0(_),t.push(H),f.push(t.length-1),X.push(new u(L,q))}W.push(f),l.push(X)}for(var b,n,D=(v-G)/S,M=0;M<p;M++)for(n=0!==G?(b=t[W[0][M]].clone(),t[W[0][M+1]].clone()):(b=t[W[1][M]].clone(),t[W[1][M+1]].clone()),b.setY(Y0(b.x*b.x+b.z*b.z)*D).normalize(),n.setY(Y0(n.x*n.x+n.z*n.z)*D).normalize(),B=0;B<1;B++){var Y=W[B][M],s=W[B+1][M],c=W[B+1][M+1],h=W[B][M+1],w=b.clone(),d=b.clone(),P=n.clone(),j=n.clone(),i=l[B][M].clone(),r=l[B+1][M].clone(),E=l[B+1][M+1].clone(),y=l[B][M+1].clone();z.push(new aj(Y,s,h,[w,d,j])),Z[0].push([i,r,y]),z.push(new aj(s,c,h,[d.clone(),P,j.clone()])),Z[0].push([r.clone(),E,y.clone()])}if(k&&0<G)for(this.vertices.push(new a(0,O,0)),M=0;M<p;M++){Y=W[0][M],s=W[0][M+1],c=this.vertices.length-1,w=new a(0,1,0),d=new a(0,1,0),P=new a(0,1,0),i=l[0][M].clone(),r=l[0][M+1].clone(),E=new u(r.x,0),z.push(new aj(Y,s,c,[w,d,P],0,1));var x=S0(e=M/p*W0),R=O0(e),N=S0(A=(M+1)/p*W0),m=O0(A);Z[0].push([new u(.5+.5*x,.5+.5*R),new u(.5+.5*N,.5+.5*m),new u(.5,.5)])}if(I&&0<v)for(this.vertices.push(new a(0,-O,0)),M=0;M<p;M++){Y=W[B][M+1],s=W[B][M],c=t.length-1,w=new a(0,-1,0),d=new a(0,-1,0),P=new a(0,-1,0),i=l[B][M+1].clone(),r=l[B][M].clone(),z.push(new aj(Y,s,c,[w,d,P],0,2));var e,A,x=S0(e=M/p*W0),R=O0(e),N=S0(A=(M+1)/p*W0),m=O0(A);Z[0].push([new u(.5+.5*N,.5-.5*m),new u(.5+.5*x,.5-.5*R),new u(.5,.5)])}},BI=(ZI.prototype=kS(G),function(p,G,v,J,$,S,O){$I.call(this),O=O||.5,p=p||16,G=G||16,v=(v!==K?v:0)-j,J=J!==K?J:W0,$=$!==K?$:0,S=S!==K?S:j;for(var W=[],l=[],t=this.vertices,z=this.faces,Z=this.faceVertexUvs,B=0;B<=G;B++){for(var f=[],X=[],q=0;q<=p;q++){var g=q/p,M=B/G,L=new a;L.x=-O*S0(v+g*J)*O0($+M*S),L.y=O*S0($+M*S),L.z=O*O0(v+g*J)*O0($+M*S),t.push(L),f.push(t.length-1),X.push(new u(g,M))}W.push(f),l.push(X)}for(B=0;B<G;B++)for(q=0;q<p;q++){var H=W[B][q+1],_=W[B][q],b=W[B+1][q],n=W[B+1][q+1],D=t[H].clone().normalize(),Y=t[_].clone().normalize(),s=t[b].clone().normalize(),c=t[n].clone().normalize(),h=l[B][q+1].clone(),w=l[B][q].clone(),d=l[B+1][q].clone(),P=l[B+1][q+1].clone();I(t[H].y)===O?(h.x=(h.x+w.x)/2,z.push(new aj(H,b,n,[D,s,c])),Z[0].push([h,d,P])):I(t[b].y)===O?(d.x=(d.x+P.x)/2,z.push(new aj(H,_,b,[D,Y,s])),Z[0].push([h,w,d])):(z.push(new aj(H,_,n,[D,Y,c])),Z[0].push([h,w,P]),z.push(new aj(_,b,n,[Y.clone(),s,c.clone()])),Z[0].push([w.clone(),d,P.clone()]))}}),fI=(BI.prototype=kS(G),function(p,G,v,J,$,S){$I.call(this),p=p||.33,G=G||.17,J=J||8,v=v||6,$=$||0,S=S||W0;for(var O=new a,W=[],l=[],t=0;t<=J;t++)for(var z=t/J*W0+j,Z=0;Z<=v;Z++){var B=Z/v*S+$,f=(O.x=p*S0(B),O.z=-p*O0(B),new a),X=p+G*S0(z);f.x=X*S0(B),f.z=-X*O0(B),f.y=G*O0(z),this.vertices.push(f),W.push(new u(Z/v,1-t/J)),l.push(f.clone().sub(O).normalize())}for(t=1;t<=J;t++)for(Z=1;Z<=v;Z++){var q=(v+1)*t+Z-1,g=(v+1)*(t-1)+Z-1,M=(v+1)*(t-1)+Z,L=(v+1)*t+Z,H=new aj(q,g,L,[l[q].clone(),l[g].clone(),l[L].clone()]);this.faces.push(H),this.faceVertexUvs[0].push([W[q].clone(),W[g].clone(),W[L].clone()]),H=new aj(g,M,L,[l[g].clone(),l[M].clone(),l[L].clone()]),this.faces.push(H),this.faceVertexUvs[0].push([W[g].clone(),W[M].clone(),W[L].clone()])}this.computeFaceNormals()}),XI=(fI.prototype=kS(G),function(p,G,v){p&&($I.call(this),p=p instanceof Array?p:[p],this.addShapeList(p,G),!1!==G.convertYZ&&yj(this,v),this.computeFaceNormals())}),qI=((S=XI.prototype=kS($I.prototype)).addShapeList=function(p,G){for(var v=p.length,J=0;J<v;J++){var $=p[J];this.addShape($,G)}},S.addShape=function(g,M){var p,G,v,J,$,S,O=M.amount,W=M.curveSegments||TA,L=M.steps||1,l=M.extrudePath,t=!1,H=new Kj(M.repeatUVLength,M.boundingBox),_=(l&&(p=l.getSpacedPoints(L),t=!0,G=M.frames!==K?M.frames:new qI.FrenetFrames(l,L,!1),v=new a,J=new a,$=new a),this),b=this.vertices.length,z=(l=g.extractPoints(W)).shape,Z=l.holes;if(!vI.isClockWise(z))for(z=z.reverse(),f=0,X=Z.length;f<X;f++)S=Z[f],vI.isClockWise(S)&&(Z[f]=S.reverse());for(var B=vI.triangulateShape(z,Z),W=z,f=0,X=Z.length;f<X;f++)S=Z[f],z=z.concat(S);for(var q,n,D,Y=z.length,s=B.length,c=0;c<Y;c++)q=z[c],t?(J.copy(G.normals[0]).multiplyScalar(q.x),v.copy(G.binormals[0]).multiplyScalar(q.y),$.copy(p[0]).add(J).add(v),P($.x,$.y,$.z)):P(q.x,q.y,0);for(D=1;D<=L;D++)for(c=0;c<Y;c++)q=z[c],t?(J.copy(G.normals[D]).multiplyScalar(q.x),v.copy(G.binormals[D]).multiplyScalar(q.y),$.copy(p[D]).add(J).add(v),P($.x,$.y,$.z)):P(q.x,q.y,O/L*D);if(M.bottom)for(var h=0;h<s;h++)j((n=B[h])[2],n[1],n[0],!0);if(M.top)for(h=0;h<s;h++)j((n=B[h])[0]+Y*L,n[1]+Y*L,n[2]+Y*L,!1);var w=0;for(d(W,w),w+=W.length,f=0,X=Z.length;f<X;f++)d(S=Z[f],w),w+=S.length;function d(p,G){for(var v,J,$=p.length;0<=--$;){(J=(v=$)-1)<0&&(J=p.length-1);for(var S=0,O=L,S=0;S<O;S++){var W=Y*S,l=Y*(S+1),t=(Z=void 0,G+v+W),W=G+J+W,z=G+J+l,l=G+v+l,Z=p,B=S,f=O,X=v,q=J;t+=b,W+=b,z+=b,l+=b,_.faces.push(new aj(t,W,l)),_.faces.push(new aj(W,z,l)),Z=H.generateSideWallUV(_,g,Z,M,t,W,z,l,B,f,X,q),_.faceVertexUvs[0].push([Z[0],Z[1],Z[3]]),_.faceVertexUvs[0].push([Z[1],Z[2],Z[3]])}}}function P(p,G,v){_.vertices.push(new a(p,G,v))}function j(p,G,v,J){_.faces.push(new aj(p+=b,G+=b,v+=b,null,0,J?2:1)),J=J?H.generateBottomUV(_,g,M,p,G,v):H.generateTopUV(_,g,M,p,G,v),_.faceVertexUvs[0].push(J)}},function(p,G,v,J,$){$I.call(this),v=v||1,J=J||8,$=$||!1;var S,O,W,l,t,z,Z,B,f,X,q,g,M,L,H,_,b=[],n=(G=G||64)+1,D=new a,Y=new qI.FrenetFrames(p,G,$),s=Y.tangents,c=Y.normals,h=Y.binormals;for(this.tangents=s,this.normals=c,this.binormals=h,l=0;l<n;l++)for(b[l]=[],W=p.getPointAt(l/(n-1)),s[l],S=c[l],O=h[l],t=0;t<J;t++)L=-v*S0(H=t/J*W0),H=v*O0(H),D.copy(W),D.x+=L*S.x+H*O.x,D.y+=L*S.y+H*O.y,D.z+=L*S.z+H*O.z,b[l][t]=(L=D.x,H=D.y,_=D.z,this.vertices.push(new a(L,H,_))-1);for(l=0;l<G;l++)for(t=0;t<J;t++)z=b[l][t],Z=b[f=$?(l+1)%G:l+1][t],B=b[f][f=(t+1)%J],f=b[l][f],X=new u(l/G,t/J),q=new u((l+1)/G,t/J),g=new u((l+1)/G,(t+1)/J),M=new u(l/G,(t+1)/J),this.faces.push(new aj(z,Z,f)),this.faceVertexUvs[0].push([X,q,M]),this.faces.push(new aj(Z,B,f)),this.faceVertexUvs[0].push([q.clone(),g,M.clone()]);this.computeFaceNormals(),this.computeVertexNormals()}),gI=(qI.prototype=kS(G),qI.FrenetFrames=function(p,G,v){var J,$,S,O,W,l=new a,t=[],z=[],Z=[],B=new a,f=new eh,X=G+1;for(this.tangents=t,this.normals=z,this.binormals=Z,W=0;W<X;W++)t[W]=p.getTangentAt(W/(X-1)),t[W].normalize();for(z[0]=new a,Z[0]=new a,G=Number.MAX_VALUE,$=I(t[0].x),S=I(t[0].y),O=I(t[0].z),$<=G&&(G=$,l.set(1,0,0)),S<=G&&(G=S,l.set(0,1,0)),O<=G&&l.set(0,0,1),B.crossVectors(t[0],l).normalize(),z[0].crossVectors(t[0],B),Z[0].crossVectors(t[0],z[0]),W=1;W<X;W++)z[W]=z[W-1].clone(),Z[W]=Z[W-1].clone(),B.crossVectors(t[W-1],t[W]),1e-4<B.length()&&(B.normalize(),J=s0(sS(t[W-1].dot(t[W]),-1,1)),z[W].applyMatrix4(f.makeRotationAxis(B,J))),Z[W].crossVectors(t[W],z[W]);if(v)for(J=s0(sS(z[0].dot(z[X-1]),-1,1)),J/=X-1,0<t[0].dot(B.crossVectors(z[0],z[X-1]))&&(J=-J),W=1;W<X;W++)z[W].applyMatrix4(f.makeRotationAxis(t[W],J*W)),Z[W].crossVectors(t[W],z[W])},function(p,G,v,J){$I.call(this),v=v||0,J=J==v0?W0:J;for(var $=1/(p.length-1),S=1/(G=G||18),O=0,W=G;O<=W;O++)for(var l=v+O*S*J,t=S0(l),z=O0(l),Z=0,B=p.length;Z<B;Z++){var f=p[Z],X=new a;X.x=t*f.x-z*f.y,X.y=z*f.x+t*f.y,X.z=f.z,this.vertices.push(X)}for(var q=p.length,O=0,W=G;O<W;O++)for(Z=0,B=p.length-1;Z<B;Z++){var g=Z+q*O,M=g+q,t=g+1+q,L=g+1,H=O*S,_=Z*$,b=H+S,n=_+$;this.faces.push(new aj(g,L,M)),this.faceVertexUvs[0].push([new u(H,_),new u(H,n),new u(b,_)]),this.faces.push(new aj(M,L,t)),this.faceVertexUvs[0].push([new u(b,_),new u(H,n),new u(b,n)])}this.mergeVertices(),yj(this),this.computeFaceNormals(),this.computeVertexNormals()}),MI=(gI.prototype=kS(G),function(p,G){p=JI.generateShapes(p,G=G||{}),G.amount=G.amount!==K?G.amount:.5,(G.convertYZ=!1)!==G.fill&&(G.bottom=!0,G.top=!0),XI.call(this,p,G)}),LI=(MI.prototype=kS(S),E.Node=function(){bS(LI,this)}),HI={X:Zm,Y:Bm,Z:fm},_I={X:0,Y:1,Z:2},bI={xyz:"XYZ",xzy:"XZY",yxz:"YXZ",yzx:"YZX",zxy:"ZXY",zyx:"ZYX"},nI=new wh,DI=function(p,G,v){var J,$;G&&(J=G[0],$=G[1],G=G[2],"xzy"===v?(Bm(p,$),fm(p,G),Zm(p,J)):"xyz"===v?(fm(p,G),Bm(p,$),Zm(p,J)):"yxz"===v?(fm(p,G),Zm(p,J),Bm(p,$)):"yzx"===v?(Zm(p,J),fm(p,G),Bm(p,$)):"zxy"===v?(Bm(p,$),Zm(p,J),fm(p,G)):"zyx"===v?(Zm(p,J),Bm(p,$),fm(p,G)):(Bm(p,$),fm(p,G),Zm(p,J)))},YI=(Ph("Node",Fm,{ms_ac:["rotationMode","anchorElevation"],ms_edge:!0,_adjustChildrenToTop:!0,_icon:"node_icon",_image:"node_image",_rotationMode:k4="xzy",_64O:0,_rotationX:0,_53O:0,_host:v0,_position:{x:0,y:0},_anchor:{x:.5,y:.5},_anchorElevation:.5,_scale:{x:1,y:1},_scaleTall:1,_54O:0,getUIClass:function(){return yI},_22Q:function(){return Yk},getX:function(){return this.p().x},setX:function(p){this.p(p,this.p().y)},getY:function(){return this.p().y},setY:function(p){this.p(this.p().x,p)},getAnchorX:function(){return this.getAnchor().x},setAnchorX:function(p){this.setAnchor(p,this.getAnchor().y)},getAnchorY:function(){return this.getAnchor().y},setAnchorY:function(p){this.setAnchor(this.getAnchor().x,p)},getScaleX:function(){return this.getScale().x},setScaleX:function(p){this.setScale(p,this.getScale().y)},getScaleY:function(){return this.getScale().y},setScaleY:function(p){this.setScale(this.getScale().x,p)},p:function(){return 0===arguments.length?this.getPosition():(this.setPosition.apply(this,arguments),this)},p3:function(){return 0===arguments.length?this.getPosition3d():(this.setPosition3d.apply(this,arguments),this)},s3:function(){return 0===arguments.length?this.getSize3d():(this.setSize3d.apply(this,arguments),this)},r3:function(){return 0===arguments.length?this.getRotation3d():(this.setRotation3d.apply(this,arguments),this)},setQuaternion:function(p){return p=(new kh).setFromQuaternion(p,kh.ReverseOrder(this.getRotationMode())),this._applyClosestR3(p.x,p.y,p.z)},getQuaternion:(T1=new kh,V1=new kh,o1=new wh,function(p){return p=p||new wh,this.getEuler(T1),T1.equals(V1)?p.copy(o1):p.copy(o1.setFromEuler(V1.copy(T1)))}),getEuler:function(p){var G=this.r3();return(p=p||new kh).set(G[0],G[1],G[2],kh.ReverseOrder(this.getRotationMode()))},setEuler:function(p){return p=p.clone().reorder(kh.ReverseOrder(this.getRotationMode())),this.r3(p.x,p.y,p.z)},t3:function(){return this.translate3d.apply(this,arguments),this},translate3dBy:function(p,G){lm(p,qm(v0,v0,this.r3(),this.getRotationMode())),this.translate3d(p[0]*G,p[1]*G,p[2]*G)},translateFront:function(p){this.translate3dBy([0,0,1],p)},translateBack:function(p){this.translate3dBy([0,0,-1],p)},translateLeft:function(p){this.translate3dBy([-1,0,0],p)},translateRight:function(p){this.translate3dBy([1,0,0],p)},translateTop:function(p){this.translate3dBy([0,1,0],p)},translateBottom:function(p){this.translate3dBy([0,-1,0],p)},getPosition3d:function(){return[this._position.x,this._54O,this._position.y]},setPosition3d:function(p,G,v){1===arguments.length&&(G=p[1],v=p[2],p=p[0]),this.p(p,v),this.setElevation(G)},translate3d:function(p,G,v){1===arguments.length&&(G=p[1],v=p[2],p=p[0]),this.translate(p,v),this.setElevation(this._54O+G)},getSize3d:function(){return[this.getWidth(),this.getTall(),this.getHeight()]},setSize3d:function(p,G,v){1===arguments.length&&(G=p[1],v=p[2],p=p[0]),this.setSize(p,v),this.setTall(G)},getRotation3d:function(){return[this._rotationX,-this._64O,this._53O]},setRotation3d:function(p,G,v){var J,$=this;$._updatingRotation3d||(($._updatingRotation3d=1)===arguments.length&&(G=p[1],v=p[2],p=p[0]),J=[$._rotationX,-$._64O,$._53O],$._rotationX=p,$._64O=-G,$._53O=v,$.fp("rotation3d",J,[p,G,v]),delete $._updatingRotation3d)},_applyClosestR3:function(p,G,v){var J,$,S,O=this.r3(),W=this.getRotationMode();"xzy"===W||"yzx"===W?(J=0<p?p-j:p+j,$=0<G?G-j:G+j,S=0<v?j-v:-j-v):"xyz"===W||"zyx"===W?(J=0<p?p-j:p+j,S=0<v?v-j:v+j,$=0<G?j-G:-j-G):"yxz"!==W&&"zxy"!==W||(S=0<v?v-j:v+j,$=0<G?G-j:G+j,J=0<p?j-p:-j-p),aM([J,$,S],O)<aM([p,G,v],O)?this.r3(J,$,S):this.r3(p,G,v)},setRotationY:function(p){this.setRotation(-p)},getRotationY:function(){return-this._64O},lookAtDirection:function(p,G){G=G||U0;var v=this,J=iA(p);G===U0?(v.r3([-h0(p[1]/J),-P0(p[2],p[0])+w0,0]),v.setRotationMode("xzy")):G===Q0?(v.r3(0,-P0(p[2],p[0]),h0(p[1]/J)),v.setRotationMode("zyx")):G===C0?(v.r3(0,-P0(p[2],p[0])+j,-h0(p[1]/J)),v.setRotationMode("zyx")):G===pJ?(v.r3([-h0(p[1]/J)+w0,-P0(p[2],p[0])+w0,0]),v.setRotationMode("xzy")):G===GJ&&(v.r3([-h0(p[1]/J)-w0,-P0(p[2],p[0])+w0,0]),v.setRotationMode("xzy")),G===F0&&(v.r3([-h0(p[1]/J)+j,-P0(p[2],p[0])+w0,j]),v.setRotationMode("zxy"))},lookAt:function(p,G){return this.lookAtDirection(Gm(p,this.p3()),G)},lookAtX:(R1=new m,N1=new m,m1=new m,K1=new eh,a1=new eh,u1=new kh,function(p,G){var v=Xm(this);K1.fromArray(v),m1.copy(this.p3()),R1.copy(p).sub(m1),R1.lengthSq()<1e-6||(R1.normalize(),"string"==typeof(G=G||U0)?G===U0?N1.set(0,0,1):G===F0?N1.set(0,0,-1):G===C0?N1.set(-1,0,0):G===Q0?N1.set(1,0,0):G===pJ?N1.set(0,1,0):G===GJ&&N1.set(0,-1,0):N1.copy(G).normalize(),N1.applyMatrix4(K1).sub(m1).normalize(),(v=Math.acos(R1.dot(N1)))&&((p=R1.clone().cross(N1)).lengthSq()<1e-6&&(G===pJ||G===GJ||0===G[0]&&0===G[1]?p.set(0,0,1):p.set(0,1,0)).applyMatrix4(K1).sub(m1),p.normalize(),u1.set(this.r3(),this.getRotationMode(),!0),K1.makeRotationFromEuler(u1),a1.makeRotationAxis(p,-v),u1.setFromRotationMatrix(a1.multiply(K1)),this._applyClosestR3(u1.x,u1.y,u1.z)))}),getHost:function(){return this._host},setHost:function(p){var G,v=this;v!==p&&v._host!==p&&((G=v._host)&&(G._removeAttach(v),G.updateLayoutAttaches()),v._host=p,v._host&&v._host._addAttach(v),v.fp("host",G,p),v.onHostChanged(G,p))},getAttaches:function(){return this._69O},_addAttach:function(p){this._69O||(this._69O=new o),this._69O.add(p),this.fp("attaches",v0,p)},_removeAttach:function(p){this._69O.remove(p),this._69O.isEmpty()&&delete this._69O,this.fp("attaches",p,v0)},getImage:function(){return this._pendingCheckImageJSON&&N.getImage(this._image)&&(this._pendingCheckImageJSON=!1,this.getParent()instanceof rI&&this.getParent().checkPendingUpdateInfo()),this._image},setImage:function(p){var G=this._image,v=this.getWidth(),J=this.getHeight();this._image=p,this.fp("image",G,p)&&(null!=p&&(OS(p)||JS(p)&&/\.json$/i.test(p))&&(this._pendingCheckImageJSON=!0),Mi||(this.fp(_J,v,this.getWidth()),this.fp(bJ,J,this.getHeight())))},getElevation:function(){return this._54O},setElevation:function(p){var G;this._50O||(this._50O=1,G=this._54O,this._54O=p,this.fp(Hl,G,p),delete this._50O)},getRotation:function(){return this._64O},setRotation:function(p){var G;this._49O||(this._49O=1,G=this._64O,this._64O=p,this.fp(KJ,G,p),delete this._49O)},getRotationX:function(){return this._rotationX},setRotationX:function(p){var G;this._51O||(this._51O=1,G=this._rotationX,this._rotationX=p,this.fp("rotationX",G,p),delete this._51O)},getRotationZ:function(){return this._53O},setRotationZ:function(p){var G;this._52O||(this._52O=1,G=this._53O,this._53O=p,this.fp("rotationZ",G,p),delete this._52O)},getPosition:function(){return this._position},setPosition:function(p,G){this._50I||(this._50I=1,(G=2===arguments.length?{x:p,y:G}:p).x===this._position.x&&G.y===this._position.y||(p=this._position,this._position=G,this.fp(Ll,p,G)),delete this._50I)},translate:function(p,G){var v=this._position;this.p(v.x+p,v.y+G)},hasInheritedSize:function(){var p=this.getStyle("shape3d");if(p){var G=rs(p);if(G&&G.rawS3)return!0;if(("billboard"===p||"plane"===p)&&T(this.getStyle("shape3d.image")))return!0}return!(!this.hasOwnProperty("_image")||!T(this._image))},getWidth:function(){if(0<=this._width)return this._width;var p=this.getStyle("shape3d");if(p){var G,v=rs(p);if(v&&v.rawS3)return v.rawS3[0];if("billboard"===p||"plane"===p)return(G=T(this.getStyle("shape3d.image")))?Am(G,this):20}return(G=T(this._image))?Am(G,this):20},setWidth:function(p){var G=this._width;this._width=p,this.fp(_J,G,p)},getHeight:function(){if(0<=this._height)return this._height;var p=this.getStyle("shape3d");if(p){var G,v=rs(p);if(v&&v.rawS3)return v.rawS3[2];if("plane"===p)return(G=T(this.getStyle("shape3d.image")))?km(G,this):20;if("billboard"===p)return 2}return(G=T(this._image))?km(G,this):20},setHeight:function(p){var G=this._height;this._height=p,this.fp(bJ,G,p)},getTall:function(){if(0<=this._tall)return this._tall;var p=this.getStyle("shape3d");if(p){var G=rs(p);if(G&&G.rawS3)return G.rawS3[1];if("billboard"===p)return(G=T(this.getStyle("shape3d.image")))?km(G,this):20;if("plane"===p)return 2}return 20},setTall:function(p){var G=this._tall;this._tall=p,this.fp("tall",G,p)},setSize:function(p,G){2===arguments.length?(this.setWidth(p),this.setHeight(G)):(this.setWidth(p.width),this.setHeight(p.height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},setRect:function(p,G,v,J,$){var S=this.getAnchor(),O=this.getScale(),W=(arguments.length<=2&&($=G,G=p.y,v=p.width,J=p.height,p=p.x),$&&O.x<0?1-S.x:S.x),S=$&&O.y<0?1-S.y:S.y;this.p(p+v*W,G+J*S),$&&(v/=Math.abs(O.x),J/=Math.abs(O.y)),this.setWidth(v),this.setHeight(J)},getMatrix:function(){var p=this._64O,G=this._position,v=this.getScale();return new hh(p,G.x,G.y,v.x,v.y)},getMatrix4:(E1=new m,y1=new wh,x1=new m,function(p){return this.getQuaternion(y1),E1.copy(this.p3()),x1.copy(this.getFinalScale3d()),(p=p||new eh).compose(E1,y1,x1)}),getAnchorRect:function(){var p=this.getWidth(),G=this.getHeight(),v=this.getAnchor();return{x:-p*v.x,y:-G*v.y,width:p,height:G}},toLocal:function(p){return this.getMatrix().tfi(p)},toGlobal:function(p){return this.getMatrix().tf(p)},getAttachPosition:(I1=new hh,function(p,G,v,J){v=v||0,J=J||0;var $=this.getAnchor(),S=this._64O,O=this._position,W=this.getScale();return I1.setFromTransform(S,O.x,O.y).tf({x:v+W.x*this.getWidth()*(p-$.x),y:J+W.y*this.getHeight()*(G-$.y)})}),isInRect:function(p){p=this.toLocal(p);var G=this.getWidth(),v=this.getHeight();return p.x+=G*this.getAnchorX(),p.y+=v*this.getAnchorY(),!(p.x<0||p.y<0||p.x>G||p.y>v)},getRect:function(){var p=this.getWidth(),G=this.getHeight(),v={x:-p*(v=this.getAnchor()).x,y:-G*v.y,width:p,height:G},p=this.getMatrix();return rA([p.tf(v.x,v.y),p.tf(v.x+v.width,v.y),p.tf(v.x+v.width,v.y+v.height),p.tf(v.x,v.y+v.height)])},getAnchorElevation:function(){return this._anchorElevation},getAnchor3d:function(){var p=this.getAnchor(),G=this._anchorElevation;return{x:p.x,y:G,z:p.y}},setAnchorElevation:function(p){var G=this._anchorElevation;return G!==p&&(this._anchorElevation=p,this.fp("anchorElevation",G,p),!0)},setAnchor3d:function(p,G,v,J){"number"==typeof p?$={x:p,y:G,z:v}:($=p.length?{x:p[0],y:p[1],z:p[2]}:p,J=G),this.beginTransaction();var $,v=this.getAnchor3d(),p=this.setAnchor($.x,$.z);return(p=!!this.setAnchorElevation($.y)||p)&&J&&!Mi&&(this.getAnchor3d(),G=Xm(this),J=lm([$.x-v.x,$.y-v.y,$.z-v.z],G),this.p3(J)),this.endTransaction(),p},getAnchor:function(){if(this.hasOwnProperty("_anchor"))return this._anchor;var p=T(this._image);return p&&p.anchorX!==K?{x:p.anchorX,y:p.anchorY}:this._anchor},setAnchor:function(p,G,v){var J,$,S,O,W=this;return"number"==typeof p?O={x:p,y:G}:(O=p.length?{x:p[0],y:p[1]}:p,v=G),((p=W.getAnchor()).x!==O.x||p.y!==O.y)&&(W.beginTransaction(),W._anchor=O,W.fp("anchor",p,O),v&&!Mi&&(G=W.getPosition(),v=W.getSize(),J=W.getRotation(),$=W.getScale(),S=-v.width*(p.x-O.x)*$.x,v=-v.height*(p.y-O.y)*$.y,p=O0(J),O=S0(J),W.setPosition(G.x+O*S-p*v,G.y+p*S+O*v)),W.endTransaction(),!0)},getLocalQuaternion:function(p){if(!(G=this.getHost()))return this.getQuaternion(p);var G=G.getQuaternion(),v=this.getQuaternion();return(p=p||new wh).copy(G).inverse().multiply(v)},setLocalQuaternion:function(p){var G=this.getHost();if(!G)return this.setQuaternion(p);G=G.getQuaternion(),this.setQuaternion(G.clone().multiply(p))},getLocalEuler:(k1=new wh,function(p){return this.getHost()?(this.getLocalQuaternion(k1),(p=p||new kh).setFromQuaternion(k1,kh.ReverseOrder(this.getRotationMode()))):this.getEuler(p)}),setLocalEuler:(A1=new wh,function(p){return this.getHost()?(A1.setFromEuler(p),this.setLocalQuaternion(A1)):this.setEuler(p)}),getLocalPosition3d:function(p){(p=p||new m).copy(this.p3());var G=this.getHost();return G?(G=G.getMatrix4(),p.applyMatrix4(G.getInverse(G))):p},setLocalPosition3d:function(p){var G,v=this.getHost();v?(v=v.getMatrix4(),(G=new m(p)).applyMatrix4(v),this.p3(G.x,G.y,G.z)):p.x!==K?this.p3(p.x,p.y,p.z):this.p3(p)},getScale:function(){return this._scale},setScale:function(p,G){G=2===arguments.length?{x:p,y:G}:p,(p=this.getScale()).x===G.x&&p.y===G.y||(this._scale=G,this.fp("scale",p,G))},getScaleTall:function(){return this._scaleTall},getScale3d:function(){var p=this._scaleTall,G=this.getScale();return[G.x,p,G.y]},getFinalScale3d:function(){var p=this.s3(),G=this._dynamicScale3d,v=this.getScale3d();return p&&(v[0]*=p[0],v[1]*=p[1],v[2]*=p[2]),G&&(v[0]*=G[0],v[1]*=G[1],v[2]*=G[2]),v},getFinalRotation3d:function(){return this._dynamicRotation||this.r3()},setScaleTall:function(p){var G=this._scaleTall;G!==p&&(this._scaleTall=p,this.fp("scaleTall",G,p))},setScale3d:function(p,G,v){G="number"==typeof p?{x:p,y:G,z:v}:p.length?{x:p[0],y:p[1],z:p[2]}:p,this.setScaleTall(G.y),this.setScale(G.x,G.z)},getCorners:function(p,G){p==v0&&(p=0),G==v0&&(G=p);var v=this.getAnchor(),J=this.getWidth(),$=this.getHeight(),S=-J*v.x-p,v=-$*v.y-G,J=J+2*p,p=$+2*G;return[($=this.getMatrix()).tf(S,v),$.tf(S,v+p),$.tf(S+J,v+p),$.tf(S+J,v)]},getEditControlPoints:function(p,G,v){G==v0&&(G=0),v==v0&&(v=G);var J=this.getAnchor(),$=this.getWidth(),S=this.getHeight(),O=-$*J.x-G,J=-S*J.y-v,$=$+2*G,G=S+2*v;return p?[{x:O,y:J},{x:O,y:0},{x:O,y:J+G},{x:0,y:J+G},{x:O+$,y:J+G},{x:O+$,y:0},{x:O+$,y:J},{x:0,y:J}]:[(S=this.getMatrix()).tf(O,J),S.tf(O,0),S.tf(O,J+G),S.tf(0,J+G),S.tf(O+$,J+G),S.tf(O+$,0),S.tf(O+$,J),S.tf(0,J)]},rotateAt:function(p,G,v){var J=this._position,$=this._64O,S=new hh($,J.x,J.y).tf(p,G),p=Y0(p*p+G*G),G=P0(J.y-S.y,J.x-S.x)+v;this.setRotation($+v),this.p(S.x+p*S0(G),S.y+p*O0(G))},rotateAroundAxis:function(p,G){this.setQuaternion(this.getQuaternion().multiply(nI.setFromAxisAngle(p,G)))},rotateAroundWorldAxis:function(p,G){this.setQuaternion(this.getQuaternion().premultiply(nI.setFromAxisAngle(p,G)))},rotateX:function(p){return this.rotateAroundAxis(m.AxisX,p)},rotateY:function(p){return this.rotateAroundAxis(m.AxisY,p)},rotateZ:function(p){return this.rotateAroundAxis(m.AxisZ,p)},onParentChanged:function(p,G){LI.superClass.onParentChanged.apply(this,arguments),this._8I()},onPropertyChanged:(e1={},"width|height|position|anchor|rotation|scale|s:layout.h|s:layout.v".split("|").forEach(function(p){e1[p]=!0}),function(G){var p,v=this,J=(LI.superClass.onPropertyChanged.call(v,G),G.property);e1[J]&&!v._layoutUpdating&&v.updateLayoutParameters(null,J),v._69O&&v._69O.each(function(p){p.handleHostPropertyChange(G)}),v._49I&&v._49I.each(function(p){p.fp("agentChange",!0,!1)}),!lj[J]&&"a:layout"!==J.substring(0,8)||(this.updateLayoutAttaches(),(p=v._host)&&p.updateLayoutAttaches()),"s:shape3d.autorotate"!==J&&"s:autorotate"!==J&&"s:shape3d.fixSizeOnScreen"!==J&&"s:fixSizeOnScreen"!==J&&"s:hide.overlapping.group"!==J||(v._47Q=v.s("autorotate")||v.s("shape3d.autorotate")||v.s("fixSizeOnScreen")||v.s("shape3d.fixSizeOnScreen")||v.s("hide.overlapping.group"))}),onHostChanged:function(p,G){this.updateAttach(),this.updateLayoutParameters()},handleHostPropertyChange:function(p){this.updateAttach(p)},onStyleChanged:function(p,G,v){LI.superClass.onStyleChanged.apply(this,arguments),zj[p]&&this.updateAttach()},updateLayoutAttaches:function(){var p;if(!Mi&&this.s("vector.layoutable"))return!!((p=T(this.getImage()))&&p.layoutAttach&&(p=p.layoutAttach)&&p(this))||void 0},updateAttach:function(p){Mi?this.updateLayoutParameters():this._51I||(this._51I=1,this._71O(p),delete this._51I)},_71O:function(p){var G,v,J,$,S,O,W=this,l=W._host,t=p?p.property:v0,z=p?p.oldValue:v0,Z=p?p.newValue:v0;if(l instanceof LI&&(!p||lj[t])){var B=T(l.getImage());if(B&&B.layoutAttach)return}l instanceof E.Grid?t===Hl?W.setElevation(W._54O+Z-z):p&&!tj[t]||(B=W.s("attach.row.index"),$=W.s("attach.column.index"),(v=l.getCellRect(B,$))&&(J=W.s("attach.row.span"),G=W.s("attach.column.span"),1===J&&1===G||(v=eA(v,l.getCellRect(B+J-1,$+G-1))),fj(v,W,"attach.padding",1),W.setRect(v))):l instanceof dI&&0<=(B=W.s("attach.index"))&&(!p||Zj[t])?(J=W.s("attach.thickness"),$=l.getScale(),G=Math.max($.x,$.y),0<J&&W.setHeight(l.getThickness()*J*G),v=W.s("attach.offset"),B<(J=($=l.getPoints()).size())&&(S=l.getPointsMatrix2d(),O=$.get(B),J=J===B+1?$.get(0):$.get(B+1),O=S.apply(O),$=[(J=S.apply(J)).x-O.x,J.y-O.y],(B=iA($))&&(W.s("attach.offset.relative")&&(v*=B),W.s("attach.offset.opposite")&&(v=B-v),S={x:O.x+$[0]/B*v,y:O.y+$[1]/B*v},(O=W.s("attach.gap"))&&(W.s("attach.gap.relative")&&(O*=l.getThickness()*G),S=os(v0,S,J,O)),W.p(S),W.setRotation(P0($[1],$[0]))))):p&&(t===Ll?W.translate(Z.x-z.x,Z.y-z.y):t===Hl?W.setElevation(W._54O+Z-z):Wj[t]?"rotation3d"===t?W.syncRotation3d(l,Z,z):W._11Q(l,t,Z-z):"anchor"!==t&&"width"!==t&&"height"!==t&&"scale"!==t||W.layout(l))},_11Q:(P1=new E.Math.Euler,j1=E.Math.Euler.ReverseOrder,i1=new E.Math.Vector2,r1=new E.Math.Vector2,function(p,G,v){var J=p.p3(),$=p.r3(),S=this.p3(),O=this.r3();if(G===KJ&&(G="rotationY",v=-v),(G===KJ||"rotationY"===G)&&0===O[0]&&0===O[2]&&0===$[0]&&0===$[2]&&0===S[1]&&0===J[1])return this.setRotation(-O[1]-v),i1.set(S[0],S[2]).rotateAround(r1.set(J[0],J[2]),-v),void this.p(i1.x,i1.y);var p=(O=bI[p.getRotationMode()])[0],W=O[1],O=O[2],l=HI[p],t=HI[W],z=HI[O],Z=$m(),p=(G===KJ+p?(z(Z,$[_I[O]]),t(Z,$[_I[W]]),l(Z,v),t(Z,-$[_I[W]]),z(Z,-$[_I[O]])):G===KJ+W?(z(Z,$[_I[O]]),t(Z,v),z(Z,-$[_I[O]])):G===KJ+O&&z(Z,v),Gm(S,J)),l=(lm(p,Z),this.p3(J[0]+p[0],J[1]+p[1],J[2]+p[2]),this.getRotationMode());DI(Z,this.r3(),l),P1.setFromRotationMatrix(Z,j1(l)),this.r3([P1.x,P1.y,P1.z])}),syncRotation3d:(h1=new wh,w1=new kh,d1=new m,function(p,G,v){var J;v[0]===G[0]&&v[1]===G[1]&&v[2]===G[2]||(J=kh.ReverseOrder(p.getRotationMode()),nI.setFromEuler(w1.set(v[0],v[1],v[2],J)),h1.setFromEuler(w1.set(G[0],G[1],G[2],J)),h1.multiply(nI.inverse()),v=p.p3(),G=this.p3(),d1.set(G[0]-v[0],G[1]-v[1],G[2]-v[2]).applyQuaternion(h1),this.p3(v[0]+d1.x,v[1]+d1.y,v[2]+d1.z),this.setQuaternion(this.getQuaternion(nI).premultiply(h1)))}),isHostOn:function(p){if(this._host&&p&&p._69O)for(var G={},v=this._host;v&&v!==this&&!G[v._id];){if(v===p)return!0;v=(G[v._id]=v)._host}return!1},isLoopedHostOn:function(p){return this.isHostOn(p)&&p.isHostOn(this)},getScaledSize:function(){var p=this.getSize(),G=this.getScale();return p.width*=Math.abs(G.x),p.height*=Math.abs(G.y),p},layout:function(p){if(p=p||this.getHost()){var G=this,v=G.s("layout.h")||"center",J=G.s("layout.v")||"center";if("center"!==v||"center"!==J){var $,S,O,W,l,t,z=new E.Math.Vector2,Z=p.getPosition(),B=p.getAnchor(),f=p.getScaledSize(),X=(G.getPosition(),1),q=1;switch(G._layoutUpdating=!0,v){case"left":z.setX(G._layoutHValue-B.x*f.width);break;case"right":z.setX((1-B.x)*f.width-G._layoutHValue);break;case"leftright":$=f.width-G._layoutHValue[2],O=G.getRotation()-p.getRotation(),W=Math.abs(Math.sin(O)),X+=(l=Math.abs(Math.cos(O)))*$/G._layoutHValue[3],q+=W*$/G._layoutHValue[4],z.setX(G._layoutHValue[1]+(G._layoutHValue[5]-B.x)*f.width);break;case"center":z.setX((.5-B.x)*f.width-G._layoutHValue);break;case"scale":O=G.getRotation()-p.getRotation(),W=Math.abs(Math.sin(O)),l=Math.abs(Math.cos(O)),z.setX((.5-B.x)*f.width-G._layoutHValue[1]*f.width/G._layoutHValue[0]),X+=l*(S=f.width/G._layoutHValue[2]-1),q+=W*S}switch(J){case"top":z.setY(G._layoutVValue-B.y*f.height);break;case"bottom":z.setY((1-B.y)*f.height-G._layoutVValue);break;case"topbottom":O||(O=G.getRotation()-p.getRotation(),W=Math.abs(Math.sin(O)),l=Math.abs(Math.cos(O))),X+=W*($=f.height-G._layoutVValue[2])/G._layoutVValue[3],q+=l*$/G._layoutVValue[4],z.setY(G._layoutVValue[1]+(G._layoutVValue[5]-B.y)*f.height);break;case"center":z.setY((.5-B.y)*f.height-G._layoutVValue);break;case"scale":O||(O=G.getRotation()-p.getRotation(),W=Math.abs(Math.sin(O)),l=Math.abs(Math.cos(O))),z.setY((.5-B.y)*f.height-G._layoutVValue[1]*f.height/G._layoutVValue[0]),X+=W*(S=f.height/G._layoutVValue[2]-1),q+=l*S}"leftright"!==v&&"scale"!==v&&"topbottom"!==J&&"scale"!==J||(J=this.getScale(),t=Math.abs(J.x),J=Math.abs(J.y),"leftright"===v||"scale"===v?G.setSize(G._layoutHValue[3]*X/t,G._layoutHValue[4]*q/J):G.setSize(G._layoutVValue[3]*X/t,G._layoutVValue[4]*q/J)),z.rotateAround(null,p.getRotation()),this.setPosition(z.x+Z.x,z.y+Z.y),G._layoutUpdating=K}}},updateLayoutParameters:function(p,G){if(p=p||this.getHost()){var v=this,J=v.s("layout.h"),$=v.s("layout.v");if(J||$){var S,O,W,l,t,z,Z=new E.Math.Vector2,B=p.getPosition(),f=p.getAnchor(),X=p.getScaledSize(),q=v.getPosition(),g=v.getScaledSize();switch(Z.set(q.x-B.x,q.y-B.y),Z.rotateAround(null,-p.getRotation()),J){case"left":v._layoutHValue=Z.x+f.x*X.width;break;case"right":v._layoutHValue=-Z.x+(1-f.x)*X.width;break;case"center":v._layoutHValue=-Z.x+(.5-f.x)*X.width;break;case"leftright":case"scale":S="scale"===J?-Z.x+(.5-f.x)*X.width:(O=v.getAnchor(),W=v.getRotation()-p.getRotation(),l=Math.cos(W),t=Math.sin(W),z=-Math.min(-O.x*l+O.y*t,-O.x*l-(1-O.y)*t,(1-O.x)*l+O.y*t,(1-O.x)*l-(1-O.y)*t),Z.x-(z-f.x)*X.width),"position"===G&&"object"==typeof v._layoutHValue?(v._layoutHValue[0]=X.width,v._layoutHValue[1]=S):v._layoutHValue=[X.width,S,X.width,g.width,g.height,z]}switch($){case"top":v._layoutVValue=Z.y+f.y*X.height;break;case"bottom":v._layoutVValue=-Z.y+(1-f.y)*X.height;break;case"center":v._layoutVValue=-Z.y+(.5-f.y)*X.height;break;case"topbottom":case"scale":S="scale"===$?-Z.y+(.5-f.y)*X.height:(W||(O=v.getAnchor(),W=v.getRotation()-p.getRotation(),l=Math.cos(W),t=Math.sin(W)),z=-Math.min(-O.x*t-O.y*l,-O.x*t+(1-O.y)*l,(1-O.x)*t-O.y*l,(1-O.x)*t+(1-O.y)*l),Z.y-(z-f.y)*X.height),"position"===G&&"object"==typeof v._layoutVValue?(v._layoutVValue[0]=X.height,v._layoutVValue[1]=S):v._layoutVValue=[X.height,S,X.height,g.width,g.height,z]}}}},getSerializableProperties:function(){var p=LI.superClass.getSerializableProperties.call(this);return MS(p,{image:1,host:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,position:1,anchor:1,anchorElevation:1,scale:1,scaleTall:1,_width:1,_height:1,_tall:1,elevation:1}),p}}),E.Edge=function(p,G){bS(YI,this),this.setSource(p),this.setTarget(G)}),sI=(Ph("Edge",Fm,{ms_edge:!0,_icon:"edge_icon",getUIClass:function(){return xI},_22Q:function(){return ck},getSource:function(){return this._source},getTarget:function(){return this._target},getSourceAgent:function(){return this._40I},getTargetAgent:function(){return this._41I},canSetSourceTarget:function(p,G){if(p===this)return!1;if(k(p))return!0;for(var v,J,$,S,O=[this],W=-1,l=0;W<l;)if(v=O[++W]._44I)for($=0,S=(v=v.getArray()).length;$<S;$++)if(J=v[$],zS(J)&&!(0<=O.indexOf(J))){if(J===p)return!1;O.push(J),l++}return!0},setSource:function(p){var G;this._source!==p&&this.canSetSourceTarget(p)&&(G=this._source,this._source=p,G&&G._16I(this),p&&p._2I(this),this._7I(),this.fp("source",G,p))},setTarget:function(p){var G;this._target!==p&&this.canSetSourceTarget(p)&&(G=this._target,this._target=p,G&&G._18I(this),p&&p._4I(this),this._7I(),this.fp("target",G,p))},isLooped:function(){return this._source===this._target&&k(this._source)&&k(this._target)},onPropertyChanged:(U1={},["source","target","sourceAgent","targetAgent","edgeGroup","agentChange","s:edge.width","s:edge.type","s:edge.offset","s:edge.center","s:edge.points","s:edge.segments","s:edge.gap","s:edge.source.t3","s:edge.target.t3","s:edge.color","s:edge.gradient.color","s:edge.pattern","s:edge.dash","s:edge.dash.color","s:edge.dash.pattern","s:edge.dash.offset","s:edge.dash","s:edge.dash","s:repeat.uv.length","s:body.color","s:shape3d","s:shape3d.visible","s:shape3d.image","s:shape3d.smooth","s:shape3d.resolution","s:shape3d.color","s:shape3d.blend","s:shape3d.side","s:shape3d.start.angle","s:shape3d.sweep.angle","s:shape3d.top.cap","s:shape3d.top.image","s:shape3d.top.visible","s:shape3d.top.color","s:shape3d.bottom.cap","s:shape3d.bottom.image","s:shape3d.bottom.visible","s:shape3d.bottom.color","s:shape3d.from.visible","s:shape3d.from.color","s:shape3d.to.visible","s:shape3d.to.color","s:shape3d.uv.union"].forEach(function(p){U1[p]=!0}),function(p){this._49I&&this._49I.each(function(p){p.fp("agentChange",!0,!1)}),"s:alwaysOnTop"!==p.property&&"s:shape3d.alwaysOnTop"!==p.property||(p.newValue?this.setRenderLayer("top"):this.setRenderLayer(K)),U1[p.property]&&(this._needChangeGeometry=!0)}),_7I:function(){var p,G=this,v=function(p){if(p.isLooped())return p._source;var G=qj(p._source),v=qj(p._target);return G===v?p._source:gj(G,v)}(G),v=(G._40I!==v&&((p=this._40I)&&p._15I(G),(G._40I=v)&&v._1I(G),G.fp("sourceAgent",p,v),Hj(p,G._41I),Hj(v,G._41I)),function(p){if(p.isLooped())return p._target;var G=qj(p._source),v=qj(p._target);return G===v?p._target:gj(v,G)}(G));G._41I!==v&&((p=G._41I)&&p._17I(G),(G._41I=v)&&v._3I(G),G.fp("targetAgent",p,v),Hj(p,G._40I),Hj(v,G._40I))},_22I:function(p){this._52I=p,this.fp("edgeGroup",!0,!1)},getEdgeGroup:function(){return this._52I},isEdgeGroupHidden:function(){return this._52I&&this._52I.get(0)!==this&&!this.getStyle(RJ)},getEdgeGroupSize:function(){return this._52I?this._52I.size():1},getEdgeGroupIndex:function(){return this._52I?this._52I.indexOf(this):0},isEdgeGroupAgent:function(){var p=this._52I;return p&&!this.getStyle(RJ)&&1<p.size()&&this===p.get(0)},toggle:function(){this.beginTransaction();var p=this._52I,G=!this.s(RJ);p&&1<p.size()&&(p.each(function(p){p.s(RJ,G)}),p.getSiblings().each(function(G){G!==p&&G.each(function(p){p.fp("edgeGroup",v0,G)})})),this.endTransaction()},setStyle:function(p,G){var v;p!==NJ&&"edge.segments"!==p||(G=lS(v=G)?new o(v):v),YI.superClass.setStyle.call(this,p,G)},onStyleChanged:function(p,G,v){YI.superClass.onStyleChanged.apply(this,arguments),Oj[p]&&Hj(this._41I,this._40I)},getSerializableProperties:function(){var p=YI.superClass.getSerializableProperties.call(this);return MS(p,{source:1,target:1}),p}}),E.Group=function(){bS(sI,this)}),cI=(Ph("Group",LI,{_image:"group_image",_icon:"group_icon",_57O:!1,getUIClass:function(){return NI},onChildAdded:function(p,G){sI.superClass.onChildAdded.apply(this,arguments),this._81I()},onChildRemoved:function(p,G){sI.superClass.onChildRemoved.apply(this,arguments),this._81I()},_81I:function(){var p;this._54I||Mi||(p=this.getChildrenRect())&&(this._53I=1,this.p(b4(this.s("group.position"),p,this.getSize())),delete this._53I)},getChildrenRect:function(){var G,v=this;return v.eachChild(function(p){k(p)&&(G=eA(G,v.getChildRect(p)))}),G},getChildRect:function(G){var v;return k(G)&&G.s(nJ)&&(ZS(G)&&G.isExpanded()&&G.eachChild(function(p){v=eA(v,G.getChildRect(p))}),!v&&G.getRect&&(v=G.getRect())),v},setPosition:function(p,G){this._54I||(G=2===arguments.length?{x:p,y:G}:p,Mi||this._53I||(this._54I=1,M4(this._children,G.x-this._position.x,G.y-this._position.y),delete this._54I),sI.superClass.setPosition.call(this,G))},toggle:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._57O},setExpanded:function(p){var G;this._57O!==p&&(G=this._57O,this._57O=p,this.fp("expanded",G,this._57O),this._fireInvalidateDeep(),this._8I())},_fireInvalidateDeep:function(){this.eachChild(function(p){ZS(p)?p._fireInvalidateDeep():p.iv()})},_8I:function(){sI.superClass._8I.call(this),this.eachChild(function(p){k(p)&&p._8I()})},onStyleChanged:function(p,G,v){sI.superClass.onStyleChanged.apply(this,arguments),"group.position"===p&&this._81I()},getSerializableProperties:function(){var p=sI.superClass.getSerializableProperties.call(this);return p.expanded=1,p}}),E.Camera=function(){bS(cI,this),this.s({"shadow.cast":!1,"shadow.receive":!1,shape3d:"billboard"}),this._viewMatrix=new sh.Matrix4,this._projectMatrix=new sh.Matrix4,this.setScale3d(1,1,-1),this._projectMatrixDirty=!0}),hI=(cI.CubeDirectionParam=[1,0,0,0,-1,0,-1,0,0,0,-1,0,0,1,0,0,0,1,0,-1,0,0,0,-1,0,0,1,0,-1,0,0,0,-1,0,-1,0],Ph("Camera",LI,{ms_ac:["cullingMask"],_cullingMask:3,_22Q:function(){return Camera3dUI},attachRenderTarget:function(p){this._projectMatrixDirty=!0,this.renderTarget=p},detachRenderTarget:function(){this._projectMatrixDirty=!0,this.renderTarget=null},isLayerVisible:function(p){return am(this._cullingMask,p)},isOrtho:function(){return"ortho"===this.s("camera.type")&&!this.isCube()},isCube:function(){return this.renderTarget&&this.renderTarget.isCube()},isPerspective:function(){return!this.isOrtho()},setViewMatrix:(Gh=new E.Math.Matrix4,vh=new E.Math.Euler,function(p){p.isMatrix4?this._viewMatrix.copy(p):this._viewMatrix.fromArray(p),Gh.getInverse(this._viewMatrix),this.p3(Gh.getPosition().toArray()),vh.set(0,0,0,this.getRotationMode(),!0).setFromRotationMatrix(Gh),this.r3([vh.x,vh.y,vh.z])}),getViewMatrix:function(p){var G=qm(null,null,this.r3(),this.getRotationMode(),this.p3()),v=this._viewMatrix;return v.fromArray(G).getInverse(v),v.toArray(p)},setProjectMatrix:function(p){p.isMatrix4?this._projectMatrix.copy(p):this._projectMatrix.fromArray(p),p=this._projectMatrix.getElements(),this.isOrtho()?this.s({"camera.near":(p[14]+1)/p[10],"camera.far":(p[14]-1)/p[10],"camera.ortho.width":2/p[0]}):this.s({"camera.near":p[14]/(p[10]-1),"camera.far":p[14]/(p[10]+1),"camera.fovy":2*Math.atan(1/p[5]),"camera.aspect":p[5]/p[0]}),this._projectMatrixDirty=!1},onPropertyChanged:function(p){cI.superClass.onPropertyChanged.call(this,p),"s:camera.near"!==(p=p.property)&&"s:camera.far"!==p&&"s:camera.fovy"!==p&&"s:camera.aspect"!==p&&"s:camera.ortho.width"!==p||(this._projectMatrixDirty=!0)},getProjectMatrix:function(){var p,G,v,J,$,S,O,W=this;return W._projectMatrixDirty&&(p=W.gv,v=(G=W.isCube())?1:W.s("camera.aspect")||(p?p.getAspect():null)||N.graph3dViewAspect,J=W.s("camera.near")||(p?p.getNear():null)||N.graph3dViewNear,$=W.s("camera.far")||(p?p.getFar():null)||N.graph3dViewFar,S=$m(),W.isOrtho()?(O=(W.s("camera.ortho.width")||(p?p.getOrthoWidth():null)||N.graph3dViewOrthoWidth)/2,vZ(S,-O,O,-(O/=v),O,J,$)):(O=G?Math.PI/2:W.s("camera.fovy")||(p?p.getFovy():null)||N.graph3dViewFovy,GZ(S,O,v,J,$)),W._projectMatrix.fromArray(S),W._projectMatrixDirty=!1),W._projectMatrix.toArray()},lookAt:function(p,G){var v=this.p3();return p.x?this.lookAtDirection([p.x-v[0],p.y-v[1],p.z-v[2]],G):this.lookAtDirection([p[0]-v[0],p[1]-v[1],p[2]-v[2]],G)},lookAtDirection:(F1=new E.Math.Matrix4,C1=new E.Math.Euler,Q1=new E.Math.Vector3,ph=new E.Math.Vector3,function(p,G){F1.lookAtDirection(Q1.copy(p).multiplyScalar(-1),G?ph.copy(G):ph.set(0,1,0)),C1.set(0,0,0,this.getRotationMode(),!0).setFromRotationMatrix(F1),this.r3([C1.x,C1.y,C1.z])}),updateAndRender:function(p){return p.syncRenderState(),p.updateScene(),this.render(p)},render:function(p){var G=this,v=p.getGL();if(!v)return!1;var J,$=G.renderTarget,S=$?(J=$.width,$.height):(O=p.getDevicePixelRatio(),J=p.getWidth()*O,p.getHeight()*O),O=((G.gv=p)._camera=G,p._18Q=null,p._frameState.renderState.glState.color.clear.slice(0)),W=(LZ(v,G.s("camera.background")),p.getEye);if(p.getEye=function(){return G.p3()},G.isCube())for(var l=cI.CubeDirectionParam,t=0;t<6;t++)$&&$.bind(v,t),G.lookAtDirection([l[6*t+0],l[6*t+1],l[6*t+2]],[l[6*t+3],l[6*t+4],l[6*t+5]]),!1!==G.s("camera.clear")&&v.clear(v.COLOR_BUFFER_BIT),p.setViewport(v,0,0,J,S),G.s("camera.onlySky")?p.renderSky():p.renderScene({renderAxis:G.s("camera.renderAxis"),renderGrid:G.s("camera.renderGrid"),renderEdit:G.s("camera.renderEdit"),renderReflector:!1}),$&&$.unbind(v);else $&&$.bind(v),!1!==G.s("camera.clear")&&v.clear(v.COLOR_BUFFER_BIT),p.overlappingBox.clear(),p.setViewport(v,0,0,J,S),G.s("camera.onlySky")?p.renderSky():p.renderScene({renderAxis:G.s("camera.renderAxis"),renderGrid:G.s("camera.renderGrid"),renderEdit:G.s("camera.renderEdit")}),$&&$.unbind(v);return p.getEye=W,LZ(v,O),p._18Q=null,p._camera=null,!(G.gv=null)}}),E.Block=function(){bS(hI,this),this.s({"shadow.cast":!1,"shadow.receive":!1})}),G=(Ph("Block",LI,{_icon:"block_icon",_clickThroughEnabled:!1,_syncSize:!0,_scaleMode:"2d",ms_ac:["clickThroughEnabled","syncSize","scaleMode"],getUIClass:function(){return mI},_22Q:function(){return sk},onChildAdded:function(p,G){hI.superClass.onChildAdded.apply(this,arguments),this.updateFromChildren()},onChildRemoved:function(p,G){hI.superClass.onChildRemoved.apply(this,arguments),this.updateFromChildren()},_getBoundingBox:(th=new eh,function(p,G){if(!(p=p instanceof LI?[p]:p)||0===p.length)return v0;var G=[],v=(function(p,J){var $=(new eh).makeRotationFromEuler(this.getEuler()).setPosition((new m).fromArray(this.p3()));$.getInverse($),p.forEach(function(p){var G,v;k(p)&&(G=J,v=$,th.fromArray(Xm(p)),p=p.getAnchor3d(),G.push((new m).set(0-p.x,0-p.y,0-p.z).applyMatrix4(th).applyMatrix4(v)),G.push((new m).set(0-p.x,0-p.y,1-p.z).applyMatrix4(th).applyMatrix4(v)),G.push((new m).set(0-p.x,1-p.y,0-p.z).applyMatrix4(th).applyMatrix4(v)),G.push((new m).set(0-p.x,1-p.y,1-p.z).applyMatrix4(th).applyMatrix4(v)),G.push((new m).set(1-p.x,0-p.y,0-p.z).applyMatrix4(th).applyMatrix4(v)),G.push((new m).set(1-p.x,0-p.y,1-p.z).applyMatrix4(th).applyMatrix4(v)),G.push((new m).set(1-p.x,1-p.y,0-p.z).applyMatrix4(th).applyMatrix4(v)),G.push((new m).set(1-p.x,1-p.y,1-p.z).applyMatrix4(th).applyMatrix4(v)))})}.call(this,p,G),[1/0,1/0,1/0]),J=[-1/0,-1/0,-1/0];return G.forEach(function(p){v[0]=Math.min(p.x,v[0]),v[1]=Math.min(p.y,v[1]),v[2]=Math.min(p.z,v[2]),J[0]=Math.max(p.x,J[0]),J[1]=Math.max(p.y,J[1]),J[2]=Math.max(p.z,J[2])}),{min:v,max:J}}),updateFromChildren:function(){var p,G,v,J,$,S,O,W,l;Mi||this._updatingToChildren||!this._syncSize||0===this.size()||this._freezeSyncFromChildren||(v=this._getBoundingBox(this.toChildren(k)))&&(this._updatingFromChildren=1,p=(new m).fromArray(this.getScale3d()),G=(new m).fromArray(v.min),v=(new m).fromArray(v.max),O=N.blockMinSize,l=new m,0===(v=v.clone().sub(G)).x&&l.setX(.5),0===v.y&&l.setY(.5),0===v.z&&l.setZ(.5),J=this._width==v0||-1===this._width,$=new m(this.getAnchor3d()),S=p.clone().multiply((new m).fromArray(this.s3())),0===(W=v.clone()).x&&W.setX(O),0===W.y&&W.setY(O),0===W.z&&W.setZ(O),S=(O=$.clone().multiply(S)).clone().multiplyScalar(-1).sub(G).divide(W).add(O.divide(W)).add(l),O=this.s("keepPosition"),J||this._anchorChanged||this._scaleChanged||!O?(W=($=!J&&O?S:$).clone().multiply(v).add(G).applyEuler(this.getEuler()).add((new m).fromArray(this.p3())),this.p3([W.x,W.y,W.z])):this.setAnchor3d(S.x,S.y,S.z),l=new m(1,1,1).divide(p).multiply(v),this.s3(Math.abs(l.x),Math.abs(l.y),Math.abs(l.z)),delete this._updatingFromChildren)},setPosition:function(p,G){this._updatingToChildren||(G=2===arguments.length?{x:p,y:G}:p,Mi||this._updatingFromChildren||(this._updatingToChildren=1,M4(this._children,G.x-this._position.x,G.y-this._position.y),delete this._updatingToChildren),hI.superClass.setPosition.call(this,G))},setSize3d:function(){this.beginTransaction(),hI.superClass.setSize3d.apply(this,arguments),this.endTransaction()},setTall:function(p){var G;this._updatingToChildren||(this.beginTransaction(),(p=J0(p,N.blockMinSize))!==(G=this.getTall())&&hI.superClass.setTall.call(this,p),Mi||this._updatingFromChildren||(this._updatingToChildren=1,this._adjustChildTallOrScale(p/G,"size"),delete this._updatingToChildren,this.updateFromChildren()),this.endTransaction())},setWidth:function(p){return this.setSize(p,this.getHeight())},setHeight:function(p){return this.setSize(this.getWidth(),p)},setSize:function(p,G){var v,J,$=N.blockMinSize;p=J0(p,$),G=J0(G,$),($=this)._updatingToChildren||(2!==arguments.length&&(G=p.height,p=p.width),this.beginTransaction(),v=$.getWidth(),J=$.getHeight(),p!==v&&hI.superClass.setWidth.call($,p),G!==J&&hI.superClass.setHeight.call($,G),Mi||$._updatingFromChildren||($._updatingToChildren=1,$._adjustChildScaleOrSize(p/v,G/J,"size"),delete $._updatingToChildren,$.updateFromChildren()),this.endTransaction())},_adjustChildScaleOrSize:function(t,z,Z){var B,f;this._syncSize&&(B=this.getPosition(),f=this.getRotation(),this.eachChild(function(p){var G,v,J,$,S,O,W,l;k(p)&&($=p.getPosition(),l=p.getRotation(),G=p.getWidth(),v=p.getHeight(),O=(J=p.getScale()).x*G,W=J.y*v,0!=O&&0!=W&&(t*z<0&&p.setRotation(-1*l),($=new hh(l,$.x,$.y,O,W)).translate(-B.x,-B.y),$.rotate(-f),l=P0($.b*Math.sign(O),$.a*Math.sign(O)),$.scale(t,z),W=S0(l),l=Math.abs(W)<.001?(O=O0(l),S=$.b/O,-$.c/O):(S=$.a/W,$.d/W),"scale"===Z?p.setScale(S/G,l/v):"size"===Z&&(O=S/J.x,W=l/J.y,p.setScale(cS(S)*Math.abs(J.x),cS(l)*Math.abs(J.y)),p instanceof E.Shape?(p.setWidthForce(Math.max(Math.abs(O),1e-5)),p.setHeightForce(Math.max(Math.abs(W),1e-5))):p.setSize(Math.max(.01,Math.abs(O)),Math.max(.01,Math.abs(W)))),$.rotate(f),$.translate(B.x,B.y),p.setPosition($.tx,$.ty)))}))},_calcChangeFactor:function(p,G,v,J){var p=I(p),$=(v=I(v))<p?p/v:v/p;return p=I(G),v=I(J),J0($,v<p?p/v:v/p)},setElevation:function(p){this._updatingToChildren||0!=(p-=this.getElevation())&&(Mi||this._updatingFromChildren||(this._updatingToChildren=1,M4(this._children,0,p,0),delete this._updatingToChildren),hI.superClass.setElevation.apply(this,arguments))},setScaleTall:function(p){var G=this;if(!G._updatingToChildren){var v,J=G.getScaleTall();if(I(p)<.01&&(p=.01*(cS(p)||cS(J))),"3d"===G._scaleMode)return v=G.getScale(),void G.setScale3d(v.x,p,v.y);hI.superClass.setScaleTall.call(G,p),Mi||G._updatingFromChildren||(G._updatingToChildren=1,G._adjustChildTallOrScale(p/J,"scale"),delete G._updatingToChildren,G._scaleChanged=1,this.updateFromChildren(),delete G._scaleChanged)}},_adjustChildTallOrScale:function(v,J){var $;this._syncSize&&($=this.getElevation(),this.eachChild(function(p){var G;k(p)&&("size"===J?(G=p.getTall(),v<0&&p.setScaleTall(-1*p.getScaleTall()),p.setTall(Math.max(.01,Math.abs(G*v)))):(G=p.getScaleTall(),p.setScaleTall(G*v)),p.setElevation($+(p.getElevation()-$)*v))}))},setAnchor3d:function(){var p;if(!this._updatingToChildren)return this.beginTransaction(),(p=hI.superClass.setAnchor3d.apply(this,arguments))&&!Mi&&!this._updatingFromChildren&&this._syncSize&&(this._anchorChanged=1,this.updateFromChildren(),delete this._anchorChanged),this.endTransaction(),p},setAnchor:function(p,G,v){var J=this;if(!J._updatingToChildren){var $=J.getAnchor(),S=hI.superClass.setAnchor.apply(J,arguments);if(Mi||J._updatingFromChildren||!J._syncSize)return S;J._updatingToChildren=1;var O=J.getAnchor(),W=(l=J.getSize()).width*($.x-O.x),l=l.height*($.y-O.y),$=(new eh).compose(new m,this.getQuaternion(),new m(this.getScale3d())),t=new m(W,0,l).applyMatrix4($);return J.eachChild(function(p){var G;k(p)&&(G=new m(p.p3()),p.p3(G.add(t).toArray()))}),delete J._updatingToChildren,S}},setAnchorElevation:function(p){var G=this;if(!G._updatingToChildren){var v=G.getAnchorElevation(),J=hI.superClass.setAnchorElevation.apply(G,arguments);if(Mi||G._updatingFromChildren||!G._syncSize)return J;G._updatingToChildren=1;var $=G.getAnchorElevation(),v=G.getTall()*(v-$),$=(new eh).compose(new m,this.getQuaternion(),new m(this.getScale3d())),S=new m(0,v,0).applyMatrix4($);return G.eachChild(function(p){var G;k(p)&&(G=new m(p.p3()),p.p3(G.add(S).toArray()))}),delete G._updatingToChildren,J}},setRotation:function(p){this._updateChildrenRotation3d("rotation",p)},setRotationX:function(p){this._updateChildrenRotation3d("rotationX",p)},setRotationZ:function(p){this._updateChildrenRotation3d("rotationZ",p)},setRotation3d:function(p,G,v){var J,$,S=this;S._updatingToChildren||(J=S.r3(),hI.superClass.setRotation3d.apply(S,arguments),$=S.r3(),Mi||S._updatingFromChildren||(S._updatingToChildren=1,S.eachChild(function(p){k(p)&&p.syncRotation3d(S,$,J)}),delete S._updatingToChildren))},_updateChildrenRotation3d:function(p,G){var v;this._updatingToChildren||(v=this[GS(p)](),hI.superClass[vS(p)].call(this,G),Mi||this._updatingFromChildren||this._updateRotationToChildren(p,G-v))},_updateRotationToChildren:function(G,v){var J=this;J._updatingToChildren=1,J.eachChild(function(p){k(p)&&p._11Q(J,G,v)}),delete J._updatingToChildren},setScale:function(p,G){var v,J=this;J._updatingToChildren||(null==G&&(G=p.y,p=p.x),v=J.getScale(),I(p)<.01&&(p=.01*(cS(p)||cS(v.x))),I(G)<.01&&(G=.01*(cS(G)||cS(v.y))),"3d"===J._scaleMode?J.setScale3d(p,J.getScaleTall(),G):(hI.superClass.setScale.call(J,p,G),Mi||J._updatingFromChildren||(J._updatingToChildren=1,p/=v.x,G/=v.y,J._adjustChildScaleOrSize(p,G,"scale"),delete J._updatingToChildren,J._scaleChanged=1,J.updateFromChildren(),delete J._scaleChanged)))},onPropertyChanged:function(p){hI.superClass.onPropertyChanged.call(this,p),"s:3d.visible"===p.property&&this._invalidateChildrenBatch()},_invalidateChildrenBatch:function(){this.eachChild(function(p){(p.s("batch")||p.s("wf.geometry")||p.s("wf.visible"))&&p.iv(),p instanceof hI&&p._invalidateChildrenBatch()})},getSerializableProperties:function(){var p=hI.superClass.getSerializableProperties.call(this);return p.clickThroughEnabled=1,p.syncSize=1,p.scaleMode=1,p},setScale3d:(Jh=new m,$h=new m,Sh=new m,Oh=new eh,Wh=new wh,lh=new m,function(p,G,v){var J,$,S=this,G="number"==typeof p?{x:p,y:G,z:v}:p.length?{x:p[0],y:p[1],z:p[2]}:p;"3d"!==S._scaleMode?hI.superClass.setScale3d.apply(S,arguments):S._syncSize&&0!==S.size()&&((J=S.getMatrix4()).getInverse(J),hI.superClass.setScaleTall.call(S,G.y),hI.superClass.setScale.call(S,G.x,G.z),$=S.getMatrix4(),Mi||S._updatingFromChildren||(S._updatingToChildren=1,S.eachChild(function(p){var G;k(p)&&($h.fromArray(p.s3()),p instanceof E.Polyline?(G=p.getThickness(),$h.x=$h.x||G,$h.y=$h.y||G,$h.z=$h.z||G,lh.copy(p.getScale3d()).multiplyScalar(G),p.getQuaternion(Wh),Jh.copy(p.p3()),Sh.copy(p.getFinalScale3d()),Sh.x=Sh.x||lh.x,Sh.y=Sh.y||lh.y,Sh.z=Sh.z||lh.z,Oh.compose(Jh,Wh,Sh)):p.getMatrix4(Oh),Oh.premultiply(J).premultiply($),Oh.decompose(Jh,Wh,Sh),Sh.divide($h),p.setQuaternion(Wh),p.p3(Jh.toArray()),p.setScale3d(Sh.toArray()))}),delete S._updatingToChildren,S._scaleChanged=1,S.updateFromChildren(),delete S._scaleChanged))})}),E.Grid=function(){bS(E.Grid,this)}),wI=(Ph("Grid",LI,{IRotatable:!1,_icon:"grid_icon",_image:v0,getUIClass:function(){return uI},setRotation:function(){},getCellRect:function(p,G){var v=this.s("grid.row.count"),J=this.s("grid.column.count");if(v<=0||J<=0||p<0||v<=p||G<0||J<=G)return v0;var $,S,O,W=this.getRect(),l=this.s("grid.row.percents"),t=this.s("grid.column.percents");if(fj(W,this,"grid.border",-1),l&&l._as&&(l=l._as),t&&t._as&&(t=t._as),l&&l.length===v){for($=O=0;$<p;$++)O+=W.height*l[$];W.y+=O,W.height=W.height*l[p]}else W.height=W.height/v,W.y+=W.height*p;if(t&&t.length===J){for($=S=0;$<G;$++)S+=W.width*t[$];W.x+=S,W.width=W.width*t[G]}else W.width=W.width/J,W.x+=W.width*G;return xA(W,-this.s("grid.gap")),W}}),E.Text=function(){bS(wI,this),this.setSize(100,50),this.s("text","TEXT")}),dI=(Ph("Text",LI,{_icon:"text_icon",_image:"__text__",getUIClass:function(){return TI},setWidth:function(p){wI.superClass.setWidth.call(this,p=p||.001)},setHeight:function(p){wI.superClass.setHeight.call(this,p=p||.001)},toLabel:function(){return this._displayName||this._name||this.s("text")}}),K0("__text__",{width:{value:100,isSafeFunc:!0,func:function(p){return p?p._width:100}},height:{value:50,isSafeFunc:!0,func:function(p){return p?p._height:50}},comps:[{type:"text",relative:!0,rect:[0,0,1,1],text:{func:"style@text"},align:{func:"style@text.align"},vAlign:{func:"style@text.vAlign"},color:{func:"style@text.color"},font:{func:"style@text.font"},shadow:{func:"style@text.shadow"},shadowColor:{func:"style@text.shadow.color"},shadowBlur:{func:"style@text.shadow.blur"},shadowOffsetX:{func:"style@text.shadow.offset.x"},shadowOffsetY:{func:"style@text.shadow.offset.y"},scaleX:{func:"style@text.scale.x"},scaleY:{func:"style@text.scale.y"},gradient:{func:"style@text.gradient"},gradientColor:{func:"style@text.gradient.color"},gradientPack:{func:"style@text.gradient.pack"},decoration:{func:"style@text.decoration"},vertical:{func:"style@text.vertical"},verticalGap:{func:"style@text.vertical.gap"},wrap:{func:"style@text.wrap"},letterGap:{func:"style@text.letter.gap"},borderWidth:{func:"style@text.border.width"},borderColor:{func:"style@text.border.color"}}]}),E.Shape=function(){bS(dI,this),this._59O=new o}),PI=(dI.__de__=i0,Ph("Shape",LI,{ms_ac:["thickness","closePath"],_icon:"shape_icon",_thickness:10,_closePath:!1,getUIClass:function(){return KI},_22Q:function(){return hk},getLength:function(p){return AS(aE(this._59O,this._58O,p,this._closePath))},getSegments:function(){return this._58O},toSegments:function(){var p=this._58O;return p&&new o(p._as.slice(0))},setSegments:function(p){var G=this._58O;p=p?lS(p)?new o(p.slice(0)):new o(p._as.slice(0)):null,(G&&p&&G._as.join(",")!==p._as.join(",")||G!==p)&&(this._58O=p,this.fp("segments",G,p))},getPoints:function(){return this._59O},toPoints:function(){var p=this._59O;return new o(p._as.slice(0))},getPointsMatrix2d:function(){var p=new sh.Matrix2d,G=this.getPosition(),v=this.getScale(),J=this.getRotation();return p.translate(-G.x,-G.y).scale(v.x,v.y).rotate(J).translate(G.x,G.y),p},getPointsMatrix3d:function(){var p=new sh.Matrix4,G=p.getElements(),v=this.p3(),J=(Fs(G,v),DI(G,this.getFinalRotation3d(),this.getRotationMode()),this.getScale3d()),$=this._dynamicScale3d;return $&&(J[0]*=$[0],J[1]*=$[1],J[2]*=$[2]),Cs(G,J),Fs(G,vm(v)),p},setPoints:function(p,G){var v,J,$=this,S=$._59O;p=p?lS(p)?new o(p.slice(0)):new o(p._as.slice(0)):new o,G&&(v=$.getPosition(),J=new hh($.getRotation(),0,0,$.getScale().x,$.getScale().y)),(S&&p&&S._as.join(",")!==p._as.join(",")||S!==p)&&($._59O=p,$.fs(),$.fp("points",S,p)),G&&(p=(S=$.getPosition()).x-v.x,G=S.y-v.y,v=J.tf(p,G),$.setPosition(S.x-p+v.x,S.y-G+v.y))},setPoints3d:function(p,G){var v=new m(this.p3()),J=this.getPointsMatrix3d();J.setPosition(new m),jI.superClass.setPoints.call(this,p),G&&(p=new m(this.p3()).clone().sub(v).applyMatrix4(J),v.add(p),this.p3(v.x,v.y,v.z))},addPoint:function(p,G,v){var J=this.toPoints();J.add(p,G),this.setPoints(J,v)},setPoint:function(p,G,v){var J=this.toPoints();J.set(p,G),this.setPoints(J,v)},removePointAt:function(p){var G=this.toPoints();G.removeAt(p),this.setPoints(G)},setWidthForce:function(p){var G,v,J,$,S=this;S._55I||Mi||!S.getWidth()||(S._55I=1,G=S._position.x,v=p/S.getWidth(),J=S.toPoints(),$=new o,1!=v&&(J.each(function(p){$.add({x:(p.x-G)*v+G,y:p.y,e:p.e})}),S.setPoints($),mE(S,[v,0,0,1,G*(1-v),0]),S.fs()),delete S._55I),dI.superClass.setWidth.call(S,p)},setWidth:function(p){return this.setWidthForce(p<FA?FA:p)},setHeightForce:function(p){var G,v,J,$,S=this;S._55I||Mi||!S.getHeight()||(S._55I=1,G=S._position.y,v=p/S.getHeight(),J=S.toPoints(),$=new o,1!=v&&(J.each(function(p){$.add({x:p.x,y:(p.y-G)*v+G,e:p.e})}),S.setPoints($),mE(S,[1,0,0,v,0,G*(1-v)]),S.fs()),delete S._55I),dI.superClass.setHeight.call(S,p)},setHeight:function(p){return this.setHeightForce(p<FA?FA:p)},setAnchorElevation:function(p){this._55I=!0;var G,v=this._updatingAnchor3d,p=(Mi||v||(G=this.getAnchorElevation(),0!=(G=this.getTall()*(G-p))&&this.shiftPointsElevation(G)),dI.superClass.setAnchorElevation.apply(this,arguments));return v||delete this._55I,p},getShapeElevation:function(p){return this._54O-(this.getTall()||0)*(this._anchorElevation-.5)},setAnchor3d:function(p,G,v,J){var $,S,O,W,l,t=this,p=("number"==typeof p?$={x:p,y:G,z:v}:($=p.length?{x:p[0],y:p[1],z:p[2]}:p,J=G),t._55I=!0,t._updatingAnchor3d=!0,t.beginTransaction(),Mi||(v=t.getAnchor3d(),p=t.getSize(),G=t.getTall(),S=p.width*(v.x-$.x),O=p.height*(v.z-$.z),W=G*(v.y-$.y),J||t.shiftPoints(S,O,W),l=t.p3()),dI.superClass.setAnchor3d.apply(t,arguments));return Mi||J&&(G=t.p3(),t.shiftPoints(G[0]-l[0]+S,G[2]-l[2]+O,G[1]-l[1]+W)),t.endTransaction(),delete t._updatingAnchor3d,delete t._55I,p},setAnchor:function(p,G,v){var J,$,S,O=this,W=(O._55I=!0,O._updatingAnchor3d),l=!Mi&&!W,G=(l&&("number"==typeof p?$={x:p,y:G}:($=p.length?{x:p[0],y:p[1]}:p,v=G),p=O.getAnchor(),J=(G=O.getSize()).width*(p.x-$.x),$=G.height*(p.y-$.y),v||O.shiftPoints(J,$),S=O.getPosition()),dI.superClass.setAnchor.apply(O,arguments));return l&&(p=O.getPosition(),v&&O.shiftPoints(p.x-S.x+J,p.y-S.y+$)),W||delete O._55I,G},shiftPoints:function(v,J,$){var S,p,O;(v||J||$)&&(S=this.getElevation()||0,p=this.toPoints(),O=new o,p.each(function(p){var G=p.e;O.add({x:p.x+v,y:p.y+J,e:G=$?(G==v0?S:G)+$:G})}),this.setPoints(O),this.fs())},shiftPointsElevation:function(p){return this.shiftPoints(0,0,p)},setPosition:function(p,G){var v=this;if(!v._28Q){if(v._28Q=1,!v._55I&&!Mi){if(p=(G=2===arguments.length?{x:p,y:G}:p).x-v._position.x,G=G.y-v._position.y,0==p&&0==G)return void delete v._28Q;v._55I=1,v.shiftPoints(p,G),mE(v,[1,0,0,1,p,G]),delete v._55I}dI.superClass.setPosition.apply(v,arguments),delete v._28Q}},fs:function(){this.fireShapeChange()},_70I:function(){if(2!==this._59O.size())return!1;var p=this._58O;return!p||2===p.size()&&1===p.get(0)&&2===p.get(1)},fireShapeChange:function(){var p;this._55I||Mi||(p=rA(this._59O))&&(this._55I=1,this.setRect(p),delete this._55I),this.fp(qJ,!1,!0)},getSerializableProperties:function(){var p=dI.superClass.getSerializableProperties.call(this);return p.segments=1,p.points=1,p.thickness=1,p.closePath=1,p}}),E.Points=function(){bS(PI,this)}),jI=(Ph("Points",LI,{_59O:[],_colors:[],_sizes:[],_uvoffsets:[],_22Q:function(){return wk},getPoints:function(){return this._59O},setPoints:function(p){var G=this._59O,v=(p=p?p.slice(0):[])[0];if($S(v)){var J=p;p=[];for(var $=0,S=J.length;$<S;$+=3)p.push({x:J[$],e:J[$+1],y:J[$+2]})}this._59O=p,this._pointsDirty=!0,this.fp("points",G,this._59O)},setPoint:function(p,G){var v=this._59O.slice(0);v[p]=G,this.setPoints(v)},addPoint:function(p){this.setPoint(this._59O.length,p)},getColors:function(){return this._colors},setColors:function(p){var G=this._colors;p=p?p.slice(0):[],this._colors=p,this._colorsDirty=!0,this.fp("colors",G,p)},setPointColor:function(p,G){var v=this._colors.slice(0);v[p]=G,this.setColors(v)},getSizes:function(){return this._sizes},setSizes:function(p){var G=this._sizes;p=p?p.slice(0):[],this._sizes=p,this._sizesDirty=!0,this.fp("sizes",G,this._sizes)},setPointSize:function(p,G){var v=this._sizes.slice(0);v[p]=G,this.setSizes(v)},getUvoffsets:function(){return this._uvoffsets},setUvoffsets:function(p){var G=this._uvoffsets;p=p?p.slice(0):[],this._uvoffsets=p,this._offsetsDirty=!0,this.fp("uvoffsets",G,this._uvoffsets)},setPointUvoffset:function(p,G,v){var J;"object"==typeof G?(J=G[0],v=G[1]):J=G,(G=this._uvoffsets.slice(0))[2*p+0]=J,G[2*p+1]=v,this.setUvoffsets(G)},getPointInfo:function(p){if(!(G=this.getPoints())||G[p]==v0)return v0;var G=[(G=G[p]).x,G.e,G.y],v=this.mat||Xm(this),J=[G[0],G[1],G[2]];return lm(J,v),v=this.getColors()[p]||this.s("points.color"),{size:(p=this.getSizes()[p])==v0?this.s("points.size"):p,color:v,local:G,world:J}},getSerializableProperties:function(){var p=PI.superClass.getSerializableProperties.call(this);return p.points=1,p.colors=1,p.sizes=1,p.uvoffsets=1,p},onPropertyChanged:function(p){PI.superClass.onPropertyChanged.call(this,p),"s:points.color"===(p=p.property)?this._colorsDirty=!0:"s:points.size"===p?this._sizesDirty=!0:"s:points.model"===p&&(this._modelDirty=!0)},getWidth:function(){if(0<=this._width)return this._width;var p=this.getStyle("points.model");return(p=p&&rs(p))&&p.rawS3?p.rawS3[0]:1},getHeight:function(){if(0<=this._height)return this._height;var p=this.getStyle("points.model");return(p=p&&rs(p))&&p.rawS3?p.rawS3[2]:1},getTall:function(){if(0<=this._tall)return this._tall;var p=this.getStyle("points.model");return(p=p&&rs(p))&&p.rawS3?p.rawS3[1]:1}}),E.Polyline=function(){bS(jI,this),this.s({"shape.background":null,"shape.border.width":2})}),iI=(Ph("Polyline",dI,{_icon:"polyline_icon",_22Q:function(){return Pk},getUIClass:function(){return aI},setClosePath:function(p){},setTall:function(p){var G,v,J,$,S=this;S.beginTransaction(),S._55I||S._24Q||Mi||!S.getTall()||(S._24Q=1,G=S._54O,1!=(v=p/S.getTall())&&(J=S.toPoints(),$=new o,J.each(function(p){$.add({x:p.x,y:p.y,e:p.e==v0?p.e:(p.e-G)*v+G})}),S.setPoints($),S.fs()),delete S._24Q),jI.superClass.setTall.call(S,p),S.endTransaction()},setElevation:function(p){this.beginTransaction(),this._55I||this._24Q||Mi||(this._24Q=1,0!=(p-=this._54O)&&this.shiftPointsElevation(p),delete this._24Q),jI.superClass.setElevation.apply(this,arguments),this.endTransaction()},fireShapeChange:function(){var p=this,G=p._59O;if(!p._55I&&!p._24Q&&!Mi){var v=G.size();if(v){for(var J=1,$=G.get(0),S=p._54O,O=($.e==v0&&($.e=S),$.e),W=0;J<v;J++){($=G.get(J)).e==v0&&($.e=S);var l=$0(O,$.e),t=J0(O+W,$.e),O=l,W=t-l}p._24Q=1,p.setTall(W),p.setElevation(O+W*p._anchorElevation),delete p._24Q}}jI.superClass.fireShapeChange.apply(p,arguments)},onPropertyChanged:(zh={},["points","segments","thickness","position","elevation","rotation","rotationX","rotationZ","rotationMode","scale","scaleTall","s:shape.border.color","s:shape.border.gradient.color","s:shape.border.pattern","s:shape.dash","s:shape.dash.color","s:shape.dash.pattern","s:shape.dash.offset","s:shape.dash","s:shape.dash","s:3d.clip.direction","s:repeat.uv.length","s:body.color","s:shape3d","s:shape3d.visible","s:shape3d.image","s:shape3d.smooth","s:shape3d.resolution","s:shape3d.color","s:shape3d.blend","s:shape3d.side","s:shape3d.start.angle","s:shape3d.sweep.angle","s:shape3d.top.cap","s:shape3d.top.image","s:shape3d.top.visible","s:shape3d.top.color","s:shape3d.bottom.cap","s:shape3d.bottom.image","s:shape3d.bottom.visible","s:shape3d.bottom.color","s:shape3d.from.visible","s:shape3d.from.color","s:shape3d.to.visible","s:shape3d.to.color","s:shape3d.uv.union"].forEach(function(p){zh[p]=!0}),function(p){jI.superClass.onPropertyChanged.call(this,p),zh[p.property]&&(this._needChangeGeometry=!0)})}),E.SubGraph=function(){bS(iI,this)}),rI=(Ph("SubGraph",LI,{ISubGraph:1,_image:"subGraph_image",_icon:"subGraph_icon",_8I:function(){iI.superClass._8I.call(this),this.eachChild(function(p){k(p)&&p._8I()})}}),N.loadingRefGraph=0,E.RefGraph=function(){bS(rI,this)}),eI=(Ph("RefGraph",hI,{_icon:"refGraph_icon",getRef:function(){return this._ref},setRef:function(p){var G=this._ref;this._ref=p,this.fp("ref",G,p),this.updateRef()},_21I:function(p){rI.superClass._21I.apply(this,arguments),this.updateRef()},updateRef:function(){var v,G,J=this;N.loadingRefGraph++,J.clearChildrenFromDataModel(),N.loadingRefGraph--,J._ref&&J._dataModel&&(J._xhrLoadHandler&&(J._xhrLoadHandler.cancel=!0),v=Mi,(G=J._xhrLoadHandler=function(p){var G;p&&J._dataModel&&(N.loadingRefGraph++,G=J._pendingUpdateInfo={needToRestore:v},v&&(G.p3=J.p3(),G.s3=J.s3(),G.r3=J.r3(),G.anchor3d=J.getAnchor3d(),G.scale3d=J.getScale3d()),J.r3(0,0,0),J.setScale3d(1,1,1),J.setAnchor3d(.5,.5,.5),J.p3(0,0,0),G=N.parse(p),(p=J._dataModel.deserialize(G,J,{justDatas:!0})).each(function(p){p._refGraph=J}),J.checkPendingUpdateInfo(),N.loadingRefGraph--,N.handleRefGraphLoaded(J,p,G))}).xhrLoadCalled=!1,N.load(J._ref,function(p){G.cancel||(G.xhrLoadCalled?G(p):XA(function(){G(p)}))}),G.xhrLoadCalled=!0)},checkPendingUpdateInfo:function(){var G,p=this,v=p._pendingUpdateInfo;v?(G=!0,this.eachChild(function(p){(p._pendingCheckImageJSON||p._pendingUpdateInfo)&&(G=!1)}),G&&(N.loadingRefGraph++,p._pendingUpdateInfo=null,p.updateFromChildren(),v.needToRestore&&(p.setAnchor3d(v.anchor3d),p.setScale3d(v.scale3d),p.r3(v.r3),p.p3(v.p3)),this.getParent()instanceof rI&&this.getParent().checkPendingUpdateInfo(),p.onPendingUpdated&&p.onPendingUpdated(),N.loadingRefGraph--)):p.onPendingUpdated&&(N.loadingRefGraph++,p.onPendingUpdated(),N.loadingRefGraph--)},getSerializableProperties:function(){var p=rI.superClass.getSerializableProperties.call(this);return p.ref=1,p}}),E.EdgeGroup=function(p,G){this._70O=p,this._siblings=G;for(var v,J=0,$=p.size(),S=F[RJ];J<$;J++)if((v=p.get(J).getStyle(RJ,!1))!=v0){S=v;break}for(S==v0&&(S=!0),(G=(G=N.edgeGroupAgentFunc)&&G(p))&&G!==p.get(0)&&(p.remove(G),p.add(G,0)),J=0;J<$;J++)p.get(J).s(RJ,S)},Ph("EdgeGroup",d,{getEdges:function(){return this._70O},size:function(){return this._70O.size()},get:function(p){return this._70O.get(p)},indexOf:function(p){return this._70O.indexOf(p)},each:function(p,G){this._70O.each(p,G)},getSiblings:function(){return this._siblings},eachSiblingEdge:function(G,v){this._siblings.each(function(p){p._70O.each(G,v)})}}),MS(N,{setConnectAction:function(p,G,v){var J=di[p]={type:p,action:G};if(v)for(var $ in v)J[$]=v[$]},getConnectAction:function(p,G){if(!G){if(!p)return null;G=p.getCurrentConnectActionType()}return di[G]},doConnectAction:function(G,p,v,J){if(J=J||G.getCurrentConnectActionType(),!(J=di[J]))return!1;var $=J.action;return!!$&&(p instanceof U.Group?G.sm().getSelection().each(function(p){$.call(null,G,p,v)}):$.call(null,G,p,v),!0)},doDeleteConnectionAction:function(G,p,v){if(v=v||G.getCurrentConnectActionType(),!(v=di[v])||!v.delete)return!1;var J=v.delete.action;return!!J&&(p instanceof U.Group?G.sm().getSelection().each(function(p){J.call(null,G,p)}):J.call(null,G,p),!0)}}),E.JSONSerializer=function(p,G){this.dm=this._dataModel=p,N.forceHierarchicalSerialization?this._hierarchical=!0:this._hierarchical=G==v0?p.isHierarchicalRendering():G}),AI=(Ph("JSONSerializer",d,{ms_ac:["hierarchical"],serialize:function(p){return N.stringify(this.toJSON(),p)},toJSON:function(){var p,G,v=this,J=v.dm,$=J.getRoots(),S=v.json={v:N.getVersion(),p:{},a:{},d:[]},O=J.getSerializableAttrs();for(G in(p=J.getInit())&&(S.init=p),(p=J.getName())&&(S.p.name=p),(p=J.getBackground())&&(S.p.background=p),(p=J.getLayers())&&(S.p.layers=p),(p=J.getEnvmap())&&(S.p.envmap=p),(p=J.getEnvmapType())&&(S.p.envmapType=p),S.p.autoAdjustIndex=J.isAutoAdjustIndex(),S.p.hierarchicalRendering=J.isHierarchicalRendering(),O){var W=J.a(G);W!==K&&v[el](G,W,S.a)}return nS(S.a)&&delete S.a,v._hierarchical?$.each(v.serializeData,this):J.each(function(p){v.serializeData(p)}),J.fireSerializeEvent({type:"serialize",json:S}),J.getPostProcessingData()&&(S.p.postProcessingData=J.getPostProcessingData()),S},isSerializable:function(p){return!0},getProperties:function(p){return p.getSerializableProperties()},getStyles:function(p){return p.getSerializableStyles()},getAttrs:function(p){return p.getSerializableAttrs()},serializeData:function(p){var G=this;if(G.isSerializable(p)&&!p._refGraph){var v,J,$,S,O,W=new(LA(p.getClassName())||p.getClass()),l={c:p.getClassName(),i:p.getId(),p:{},s:{},a:{}};for(v in G.json.d.push(l),G.getProperties(p))/^_/.test(v)?(O=p[v],"_width"!==v&&"_height"!==v||O!=v0&&-1!==O||(S==K&&($=(p.s("layout.h")||p.s("layout.v"))&&p.getHost()||p instanceof E.Node&&($=p.getParent())&&$ instanceof E.Block||p.s("fullscreen"),S=p.hasInheritedSize()),$&&S&&(O=p[v]="_width"===v?p.getWidth():p.getHeight())),O!==W[v]&&G[el](v.substr(1),O,l.p)):p[J=GS(v)]&&(O=p[J]())!==W[J]()&&G[el](v,O,l.p);for(v in G.getStyles(p))(O=p.s(v))!==W.s(v)&&G[el](v,O,l.s);for(v in G.getAttrs(p))(O=p.a(v))!==W.a(v)&&G[el](v,O,l.a);nS(l.p)&&delete l.p,nS(l.s)&&delete l.s,nS(l.a)&&delete l.a}G._hierarchical&&p.getChildren().each(G.serializeData,G)},serializeValue:function(p,G,v){tS(G)?G={__a:G._as}:G instanceof Fm?G={__i:G.getId()}:G instanceof Cm&&(G={__dm:G.serialize(0)}),v[p]=G},deserialize:function(p,G,v){var J=this;if(!JS(p)||!/.json$/.test(p))return J.deserializeImpl(p,G,v);N.xhrLoad(p,function(p){J.deserializeImpl(p,G,v)})},deserializeImpl:function(p,G,v){var J=this.dm,$=(J.setDeserializing(!0),v=SS(v)?{setId:v}:WS(v)?{finishFunc:v}:v||{},p=this.json=JS(p)?N.parse(p):p,!v.justDatas&&p.a&&p.a.onPreDeserialize&&!v.disableOnPreDeserialize&&p.a.onPreDeserialize(p,J,v.view),J.beginTransaction(),Mi++,this._82I={},new o),S=new o,O=0,W=p.d.length;if(v.justDatas||(!v.disableInit&&WS(p.init)&&p.init(J),J.setInit(p.init)),!v.justDatas){for(var l in p.a)J.a(l,this[Al](p.a[l]));for(var t in p.p)J[vS(t)](p.p[t])}for(;O<W;O++){var z=p.d[O],Z=new(LA(z.c)),B=z.i;v.setId&&B!=v0&&(Z._id=B),this._82I[B]=Z,$.add(Z),S.add(z)}for(O=0;O<W;O++)this.deserializeData($.get(O),S.get(O));return $.each(function(p){G&&!p.getParent()&&p.setParent(G),J.add(p)}),v.__innerHandler__&&v.__innerHandler__(p,J,v.view,$),J.fireSerializeEvent({type:"deserialize",json:p}),Mi--,Ni||J.each(function(p){p instanceof LI&&p.updateLayoutAttaches()}),J.endTransaction(),!v.justDatas&&p.a&&p.a.onPostDeserialize&&!v.disableOnPostDeserialize&&p.a.onPostDeserialize(p,J,v.view,$),v.finishFunc&&v.finishFunc(p,J,v.view,$),J.setDeserializing(!1),$},deserializeData:function(p,G){for(var v in G.p)p[vS(v)](this[Al](G.p[v]));for(v in G.s)p.s(v,this[Al](G.s[v]));for(v in G.a)p.a(v,this[Al](G.a[v]))},deserializeValue:function(p){if(OS(p)){var G,v=p.__i;if(v!=v0)return this._82I[v];if((v=p.__dm)!=v0)return(G=new E.DataModel).deserialize(v),G;if(v=p.__a,lS(v))return new o(v)}return p}}),MS(Cm,{serialize:function(p,G){return new eI(this,G).serialize(p)},toJSON:function(p){return new eI(this,p).toJSON()},deserialize:function(p,G,v){return new eI(this).deserialize(p,G,v)}}),E.OverlappingBox=function(p){this.gv=p,this.boxes={}}),kI=(Ph("OverlappingBox",d,{clear:function(){var p,G=this.boxes;for(p in G)G[p].length=0},isOverlapping:function(p,G){var v,J,$,S,O=this.boxes,W=O[p];for(W?(v=W.rects,J=W.length):W=O[p]={rects:v=[],length:J=0},$=0;$<J;$++)if((S=v[$]).x<G.x+G.w&&S.x+S.w>G.x&&S.y<G.y+G.h&&S.h+S.y>G.y)return!0;return v.length<=J?(v.push(G),W.length++):v[W.length++]=G,!1}}),MS(N,{fetch:function(p,G){p.open((G=G||{}).method||"GET",G.url||"",!(null!=G.sync&&G.sync)),"json"===G.dataType&&p.setRequestHeader("Content-Type","application/json"),G.responseType&&(p.responseType=G.responseType),p.send(G.data)},convertImageSrc:function(p,G){(G=G&&"function"==typeof G?G:function(){})(p)}}),E.Request=function(){}),II=(Ph("Request",d,{_mimeType:K,getXhr:function(){return this._xhr||(this._xhr=new XMLHttpRequest,this.overrideMimeType("text/plain")),this._xhr},send:function(p){var G=this.getXhr();p.mimeType&&this.overrideMimeType(p.mimeType),G.onload=this.onload,G.onerror=this.onerror,N.fetch(G,p)},onload:function(){},onerror:function(){},getResponseType:function(){return this.getXhr().responseType},setOverrideMimeType:function(p){this.overrideMimeType(p)},getMimeType:function(){return this._mimeType},overrideMimeType:function(p){this.getXhr().overrideMimeType(this._mimeType=p)},getResponseHeader:function(p){return this.getXhr().getResponseHeader(p)},getResponseText:function(){var p=this.getXhr();return p.response||p.responseText},getStatus:function(){return this.getXhr().status}}),wj.GraphView=function(p){var G=this;G._24I={},G._34I=new o,G.enableDirtyRect(),G._25I={},G._56I={},G._view=ES(1,G),G._canvas=xS(G._view),G.dm(p||new Cm),this._coreInteractor=new p3(this),G.setEditable(!1),G.setScrollBarVisible(N.graphViewScrollBarVisible),G._initView()},p("GraphView",d,{ms_v:1,ms_gv:1,ms_bnb:1,ms_tip:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,_52o:1,_51o:1,ms_ac:[pl,Gl,CJ,QJ,"resettable","editInteractor",FJ,"zoomable","pannable","rectSelectable","autoScrollZone",ll,"movableFunc","editableFunc","pointEditableFunc","rectEditableFunc","rotationEditableFunc","anchorEditableFunc","rectSelectBackground","rectSelectBorderColor","editPointSize","editPointBorderColor","editPointBackground","hoverDelay"],_zoomable:N.graphViewZoomable,_resettable:N.graphViewResettable,_pannable:N.graphViewPannable,_rectSelectable:N.graphViewRectSelectable,_autoScrollZone:N.graphViewAutoScrollZone,_rectSelectBackground:N.graphViewRectSelectBackground,_rectSelectBorderColor:N.graphViewRectSelectBorderColor,_editPointSize:N.graphViewEditPointSize,_editPointBorderColor:N.graphViewEditPointBorderColor,_editPointBackground:N.graphViewEditPointBackground,_scrollBarColor:A4,_scrollBarSize:Z,_autoHideScrollBar:Nh,_autoMakeVisible:E4,_currentActionType:null,getCoreInteractor:function(){return this._coreInteractor},getLayers:function(){return this._dataModel.getLayers()},setLayers:function(p){this._dataModel.setLayers(p)},setEditable:function(p){var G,v=this,J=v.__interactorMap__;J||(G=wj.XEditInteractor,J=v.__interactorMap__={scrollBar:new S3(v),select:new v3(v),edit:new(G||t3)(v),text:new $3(v),move:new J3(v),default:new G3(v),touch:new O3(v,{editable:!1})}),p?(v._uieditable=!0,v.setInteractors([J.scrollBar,J.select,J.text,J.edit,J.move,J.default,J.touch])):(v._uieditable=!1,v.setInteractors([J.scrollBar,J.select,J.move,J.default,J.touch]))},getCanvas:function(){return this._canvas},_33I:function(p){var G=p.getUIClass();return G?new G(this,p):v0},getDataUI:function(p){var G=this._25I[p._id];return G===K&&(G=this._33I(p),this._25I[p._id]=G),G},getNodeRect:function(p){return N.getNodeRect(this,p)},getFullscreenDatas:function(){return this._dataModel.getFullscreenDatas()},getEdgeInfo:function(p){return(p=this.getDataUI(p))?(p._79o(),p._78o):null},getEdgeSourcePosition:function(p){var G=(p=this.getDataUI(p)).s,p=p._data._40I;return Lj(this,p,G("edge.source.position"),G("edge.source.offset.x"),G("edge.source.offset.y"),G("edge.source.anchor.x"),G("edge.source.anchor.y"))},getEdgeTargetPosition:function(p){var G=(p=this.getDataUI(p)).s,p=p._data._41I;return Lj(this,p,G("edge.target.position"),G("edge.target.offset.x"),G("edge.target.offset.y"),G("edge.target.anchor.x"),G("edge.target.anchor.y"))},invalidateAll:function(p){var G=this;if(p){for(var v in G._25I)(v=G._25I[v])&&v.dispose();G._25I={},G._56I={},G._24I={},G._34I.clear(),G.redraw()}else G.dm().each(function(p){G.invalidateData(p)})},invalidateSelection:function(){var G=this;G.sm().each(function(p){G.invalidateData(p)})},invalidateData:function(p){this._24I[p._id]=p,this._21Q(p),this.iv()},_21Q:function(p){var G,v=this._24I;zS(p)&&Pi[p.s(mJ)]&&((G=p.getSourceAgent())&&G.getAgentEdges().each(function(p){v[p._id]=p}),(G=p.getTargetAgent())&&G.getAgentEdges().each(function(p){v[p._id]=p}),this.iv())},redraw:function(p){this._32I||(p?this._34I.add(p):(this._32I=1,this._34I.clear()),this.iv())},each:function(p,G){var v=0,J=this.getLayers(),$=this._dataModel,S=$._datas._as,O=S.length;if(J)for(var W={},l=($.isHierarchicalRendering()&&$.eachByHierarchical(function(p){B=p._layer,(Z=(Z=W[B])||(W[B]=[])).push(p)}),J.length);v<l;v++){var t,z,Z,B=J[v];if(OS(B)&&(B=B.name),$.isHierarchicalRendering()){if((Z=W[B])&&0<(t=Z.length))for(var f=0;f<t;f++)if(z=Z[f],!1===(G?p.call(G,z):p(z)))return}else for(f=0;f<O;f++)if((z=S[f])._layer===B&&!1===(G?p.call(G,z):p(z)))return}else if($.isHierarchicalRendering())this._dataModel.eachByHierarchical(p,null,G);else for(;v<O;v++)if(z=S[v],!1===(G?p.call(G,z):p(z)))return},reverseEach:function(p,G){var v,J=this._dataModel,$=J._layers,S=J._datas._as,O=S.length;if($){var W={};for(J.isHierarchicalRendering()&&J.reverseEachByHierarchical(function(p){Z=p._layer,(z=(z=W[Z])||(W[Z]=[])).push(p)}),v=$.length-1;0<=v;v--){var l,t,z,Z=$[v];if(OS(Z)&&(Z=Z.name),J.isHierarchicalRendering()){if((z=W[Z])&&0<(l=z.length))for(var B=0;B<l;B++)if(t=z[B],!1===(G?p.call(G,t):p(t)))return}else for(B=O-1;0<=B;B--)if((t=S[B])._layer===Z&&!1===(G?p.call(G,t):p(t)))return}}else if(J.isHierarchicalRendering())J.reverseEachByHierarchical(p,null,G);else for(v=O-1;0<=v;v--)if(t=S[v],!1===(G?p.call(G,t):p(t)))return},getViewRect:function(){return this._29I},getContentRect:function(){var p,G,v=this,J=v._84I;return J||(p=this.dm().a("width"),G=this.dm().a("height"),0<p&&0<G?v._84I={x:0,y:0,width:p,height:G}:(v.each(function(p){v.isVisible(p)&&(J=eA(J,v.getDataUIBounds(p)))}),v._84I=J||xi)),v._84I},getScrollRect:function(){return eA(this.getContentRect(),this._29I)},makeCenter:function(p,G,v){var J,$,S,O,W=this;W.getWidth()&&W.getHeight()?(W.makeVisible(p),W.validate(),($=W.getDataUIBounds(p))&&(O=W.getWidth(),J=W.getHeight(),S=$.x+$.width/2,$=$.y+$.height/2,S=-S*W._zoom+O/2,O=-$*W._zoom+J/2,W.setTranslate(S,O,G))):v||XA(W.makeCenter,W,[p,G,!0],500)},fitData:function(G,v,J,$,p){var S,O=this;O.getWidth()&&O.getHeight()?(S=function(){O.makeVisible(G),O.validate();var p=O.getDataUIBounds(G);p&&(p=MA(p),xA(p,J==v0?20:J),O.fitRect(p,v,$))},v?N.callWhenLoaded(S):S()):p||XA(O.fitData,O,[G,v,J,$,!0],500)},fitContent:function(G,v,J,p){var $,S=this;S.getWidth()&&S.getHeight()?($=function(){S.validate();var p=MA(S.getContentRect());xA(p,v==v0?20:v),S.fitRect(p,G,J)},G?N.callWhenLoaded($):$()):p||XA(S.fitContent,S,[G,v,J,!0],500)},fitRect:function(p,G,v){var J=this,$=J.getWidth(),S=J.getHeight(),O=p.x+p.width/2,W=p.y+p.height/2,l=$0($/p.width,S/p.height),O=-O*(p=J._zoom)+$/2,$=-W*p+S/2;0===l||isNaN(l)||(v&&(l=$0(1,l)),G?(J._65I&&(delete J._65I.finishFunc,J._65I.stop(!0)),J._14o&&J._14o.stop(!0),J.setTranslate(O,$,{finishFunc:function(){J.setZoom(l,G)}})):(J.setTranslate(O,$),J.setZoom(l)))},fitSelection:function(p,G,v){var J=this,$=J.sm(),S=null;$.size()&&($.each(function(p){S=eA(J.getDataUIBounds(p),S)}),p&&xA(S,p),J.fitRect(S,G,v))},toCanvas:function(p,G,v){G=G||this._zoom,this.validateImpl();var J=this.getContentRect(),v=(v&&xA(J,v),J.width||(J.width=10),J.height||(J.height=10),xS()),$=J.x*G,S=J.y*G,O=Math.ceil(J.width*G),J=Math.ceil(J.height*G),W=(mS(v,O,J,1),GE(v)),O=((p=p||this._dataModel.getBackground())&&VE(W,0,0,O,J,p),JE(W,-$,-S),W.scale(G,G),this._zoom);return this._zoom=G,this._42(W),this._zoom=O,W.restore(),this.redraw(),v},toDataURL:function(p,G,v,J){return this.toCanvas(p,v,J).toDataURL(G||"image/png",1)},getClipBounds:function(){return this._74O},_42:function(O,W){var p,G,l=this,v=l.dm().getBackground(),J=(v&&(p=l.dm().a("width"),G=l.dm().a("height"),0<p&&0<G&&VE(O,0,0,p,G,v)),l.__htmlOrderList),t=[],z=l._forcedLayoutHTML;if(l._93db(O,W),l.each(function(p){var G,v,J,$,S=l.getDataUI(p);S&&(G=l._56I[p._id],$=S._htmlView,G&&(v=S._79o(),$=S._htmlView,E.HtmlNode&&p instanceof E.HtmlNode?S._42(O):(p=l.getViewRect(),J=$&&$.layoutHTML,!W||IA(W,v)?(J&&($.layoutHTML(),S.__outerLayout&&delete S.__outerLayout),S._42(O)):IA(p,v)||!J||S.__outerLayout&&!z||($.layoutHTML(),S.__outerLayout=!0))),$&&(t.push($),($=$.getView?$.getView():$).style.display=G?"block":lJ))}),J&&0<t.length){var $=!1;if(J.length!==t.length)$=!0;else for(var S=0;S<t.length;S++)if(t[S]!==J[S]){$=!0;break}$&&(t.forEach(function(p){!1!==p.autoAdjustIndex&&l.appendHTML(p,!0)}),this.__htmlOrderList=t)}else this.__htmlOrderList=t;l._92db(O,W)},disableDirtyRect:function(){this._shouldRedrawAll=X},enableDirtyRect:function(){var p=this;p._shouldRedrawAll=function(){return p._32I}},validateImpl:function(){this.tryUpdateRootData();var v,G,J,p,$,S,O,W=this,l=W.tx(),t=W.ty(),z=W._zoom,Z=W._canvas,B=this.getWidth(),f=this.getHeight(),X=W._29I,q={x:-l/z,y:-t/z,width:B/z,height:f/z},g={},M=W._34I,L=W._24I,H=W._shouldRedrawAll(),_=W._23I;for(v in W._24I={},B===Z.clientWidth&&f===Z.clientHeight||(mS(Z,B,f),W._forcedLayoutHTML=H=1),H||YS(q,X)||(W._forcedLayoutHTML=H=1),W._29I=q,W.each(function(p){v=p._id;var G=g[v]=W.isVisible(p);G!==W._56I[v]&&(L[v]=p,(J=W.getDataUI(L[v]))&&J._84o(G),W._84o(p,G))},W),L)(J=W.getDataUI(L[v]))&&(!H&&W._56I[v]&&(p=J._79o())&&M.add(p),J.invalidate()),W._83I=1;if(W._56I=g,!H)for(v in L)g[v]&&(J=W.getDataUI(L[v]))&&(p=J._79o())&&M.add(p);H?G=q:(M.each(function(p){IA(q,p)&&(G=eA(G,p))}),G&&(xA(G,J0(1,1/z)),G.x=n0(G.x*z)/z,G.y=n0(G.y*z)/z,G.width=D0(G.width*z)/z,G.height=D0(G.height*z)/z,G=EA(q,G))),(W._74O=G)&&0!==G.width&&0!==G.height&&(X=GE(Z),Z=G.x,$=G.y,S=G.width,O=G.height,Z=Math.floor((Z*z+l)*Rh),$=Math.floor(($*z+t)*Rh),S=Math.ceil(S*z*Rh)+1,O=Math.ceil(O*z*Rh)+1,H||(G.x=(Z/Rh-l)/z,G.y=($/Rh-t)/z,G.width=S/Rh/z,G.height=O/Rh/z),X.beginPath(),X.rect(Z,$,S,O),X.clip(),X.clearRect(Z,$,S,O),vE(X,l,t,z),W._42(X,G),X.restore(),delete W._74O),M.clear(),delete W._32I,delete W._forcedLayoutHTML,_&&0<B&&0<f&&((J=W.getDataUI(_))&&(p=J._79o(),$=(Z=W._29I).x,S=Z.y,O=Z.width,l=Z.height,z=W._zoom,p&&!IA(p,Z)&&(p.x+p.width<$&&W.tx(-p.x*z),p.x>$+O&&W.tx(-(p.x+p.width-O)*z),p.y+p.height<S&&W.ty(-p.y*z),p.y>S+l&&W.ty(-(p.y+p.height-l)*z))),delete W._23I),W._83I&&(delete W._83I,delete W._84I),W._98O(),W.countFrame(),nS(W._24I)||XA(W.iv,W)},isValidGuideLineSource:function(p){return!0},tryUpdateRootData:function(){if(!this._rootDataUpdating){this._rootDataUpdating=!0;var p,G,v=this.getFullscreenDatas();for(G in v)p=v[G],this.scaleRootData(p);this.onRootDataUpdated&&this.onRootDataUpdated(),this._rootDataUpdating=!1}},scaleRootData:function(p){if("uniform"===(Z=p.s("fullscreen"))||"fill"===Z){p.getRotation()&&p.setRotation(0);var G=p.s("fullscreen.gap")||0,v=this.getWidth(),J=this.getHeight();if(v&&J){var v=v-2*G,J=J-2*G,$=p.getAnchor(),S=(O=p.getScaledSize()).width,O=O.height;if(t=p.s("fullscreen.lock"))return"uniform"===Z?S/O<v/J?(z=J/O,S=O*v/J):(z=v/S,O=S*J/v):"v"===t?(S=v/(z=J/O),p.getWidth()!==S&&p.setWidth(S)):(O=J/(z=v/S),p.getHeight()!==O&&p.setHeight(O)),this.setZoom(z),W=G-(p.getX()-$.x*S)*z,l=G-(p.getY()-$.y*O)*z,W!==this.tx()&&this.tx(W),void(l!==this.ty()&&this.ty(l));var W=this.tx(),l=this.ty(),t={x:(-W+G)/(z=this._zoom),y:(-l+G)/z,width:v/z,height:J/z},z=("uniform"===Z&&(W=S/O,G=(l=Math.min(t.width,t.height*W))/W,t.x+=.5*(t.width-l),t.y+=.5*(t.height-G),t.width=l,t.height=G),v=t.width/p.getScaleX(),J=t.height/p.getScaleY(),p.getWidth()==v&&p.getHeight()===J||p.setSize(v,J),t.x+$.x*t.width),Z=t.y+$.y*t.height;z===(S=p.getPosition()).x&&Z===S.y||p.setPosition(z,Z)}}},isScrollBarVisible:function(){return!!this._79O},setScrollBarVisible:function(p){var G=this;p!==G.isScrollBarVisible()&&(p?(KS(G._view,G._79O=yS()),KS(G._79O,G._27I=yS()),KS(G._79O,G._28I=yS())):(KA(G._79O),delete G._79O,delete G._27I,delete G._28I),G.fp("scrollBarVisible",!p,p))},getDebugTip:function(){return""},showScrollBar:function(){var p=this;p._79O&&(p._85I||(I0(function(){p._86I()},pA),p.iv()),p._85I=new Date)},_86I:function(){var p=this;p._85I&&((new Date).getTime()-p._85I.getTime()>=pA?(delete p._85I,p.iv()):I0(function(){p._86I()},pA))},getVScrollBar:function(){return this._27I},getHScrollBar:function(){return this._28I},_98O:function(){var p=this._27I,G=this._28I;if(this._79O){if(this._autoHideScrollBar&&!this._85I)return p.style.visibility=aJ,void(G.style.visibility=aJ);var v=this.getScrollBarColor(),J=this._zoom,$=this.getScrollBarSize(),S=this.getViewRect(),O=this.getScrollRect(),W=S.height*J,l=O.height*J,t=S.width*J-$-2,z=W*((S.y-O.y)*J/l),Z=W/l*W,B=p.style,l=(W<l-.5?(Z<GA&&(W<(z=(z=z+Z/2-GA/2)<0?0:z)+GA&&(z=W-GA),Z=GA),P(p,t,z,$,Z),B.visibility=uJ,B.background=v,B.borderRadius=$/2+tJ):B.visibility=aJ,S.width*J),W=O.width*J,z=S.height*J-$-2,t=l*((S.x-O.x)*J/W),p=l/W*l,B=G.style;l<W-.5?(p<GA&&(l<(t=(t=t+p/2-GA/2)<0?0:t)+GA&&(t=l-GA),p=GA),P(G,t,z,p,$),B.visibility=uJ,B.background=v,B.borderRadius=$/2+tJ):B.visibility=aJ}},setDataModel:function(p){var G=this,v=G._dataModel,J=G._selectionModel;v!==p&&(v&&(v.ump(G.handleDataModelPropertyChange,G),v.umm(G.handleDataModelChange,G),v.umd(G.handleDataPropertyChange,G),v.removeIndexChangeListener(G._75O,G),v.removeHierarchyChangeListener(G.handleHierarchyChange,G),J||v.sm().ums(G.handleSelectionChange,G)),(G._dataModel=p).mp(G.handleDataModelPropertyChange,G),p.mm(G.handleDataModelChange,G),p.md(G.handleDataPropertyChange,G),p.addIndexChangeListener(G._75O,G),p.addHierarchyChangeListener(G.handleHierarchyChange,G),J?J._21I(p):p.sm().ms(G.handleSelectionChange,G),G.invalidateAll(!0),G.fp(Dl,v,p),G.updateBackground())},getLayersInfo:function(){var p;return this._layersInfo===K&&((p=this.getLayers())?(this._layersInfo={},p.forEach(function(p){var G=OS(p)?p.name:p;this._layersInfo[G]=p},this)):this._layersInfo=null),this._layersInfo},calculateEdgePosition:function(p,G,v){p instanceof E.Data?(J=this.getDataUI(p),W=rj(J)):(W=rj(null,p,arguments[1]),G=arguments[2],v=arguments[3]);var W,J,$=function(v){var J=1/0,$=0,S=new H;function p(p){var G;return 0<=p&&p<=1&&(S=Ij(W,100*p),(G=(v.x-S.x)*(v.x-S.x)+(v.y-S.y)*(v.y-S.y))<J&&(J=G,$=p,1))}for(var G=0;G<100;++G)p(G/100);for(var O=.005;.001<O;)p($-O)||p($+O)||(O/=2);return $}(G=2===G.length?new H(G[0],G[1]):G),S=Ij(W,100*$);if(!v)for(var O=J?Ej(J):Ej(p,arguments[1]),l=new H(S.x,S.y),t=49/(this._zoom*this._zoom),z=0,Z=O.length;z<Z;z++)if(l.distanceToSquared(O[z])<t)return{index:z,point:O[z],distance:Math.sqrt((O[z].x-G.x)*(O[z].x-G.x)+(O[z].y-G.y)*(O[z].y-G.y))};return{percent:$,point:S,distance:Math.sqrt((S.x-G.x)*(S.x-G.x)+(S.y-G.y)*(S.y-G.y))}},getPercentPositionOfPath:function(p,G){var v;return p instanceof E.Data?(v=this.getDataUI(p),v=rj(v)):(v=rj(null,p,arguments[1]),G=arguments[2]),Ij(v,G)},getNeareastPositionOfPath:function(){return this.calculateEdgePosition.apply(this,arguments)},getPointsOfPath:function(p){for(var G,v,J,$,J=p instanceof E.Data?(G=this.getDataUI(p),v=(G=ij(G)).points,G.segments):(v=p,arguments[1]),S=p instanceof E.Shape?p.getPointsMatrix2d():new sh.Matrix2d,O=[],W=-1,l=-1,t=0,z=(J||v).length;t<z;t++)5!==($=J?J.get(t):1)&&(l++,3===$?(uM(O,v,W+1,l,"C",S),uM(O,v,W+2,l,"M",S),W+=2):4===$?(uM(O,v,W+1,l-1,"R",S),uM(O,v,W+2,l,"L",S),uM(O,v,W+3,l,"M",S),W+=3):(uM(O,v,W+1,l,"M",S),W+=1));return O},calculateAttachPoint:(Zh=new H,Bh=new H,fh=new H,function(p,G){var v=this.getAttachPoints(p);if(!v||!v.length)return null;fh.set(G.x,G.y);for(var J,$,S,O,W=1/0,l=0,t=v.length;l<t;l++)S=v[l],Bh.x=S.x,Bh.y=S.y,Zh.x=S.offsetX||0,Zh.y=S.offsetY||0,S=Lj(this,p,0,Zh.x,Zh.y,Bh.x,Bh.y),($=fh.distanceToSquared(S))<W&&(J=l,W=$,O=S);return W=Math.sqrt(W),"close"===(G=this.getAttachStyle(p))&&p.s("attach.close.threshold")/this._zoom<W?null:{index:J,distance:W,info:v[J],point:O}}),getAttachPoints:function(p){var G=p.s("attach.points");return G||((G=T(p._image))?V(G.attachPoints,p,this)||null:void 0)},getAttachStyle:function(p){var G=p.s("attach.style");return G||((G=T(p._image))?V(G.attachStyle,p,this)||"close":void 0)},updateLayers:function(){this._layersInfo=K,this.invalidateSelection(),this.redraw()},updateBackground:function(){var p=this.dm().a("width"),G=this.dm().a("height");this._canvas.style.background=!(0<p&&0<G)&&this.dm().getBackground()||""},handleDataModelPropertyChange:function(p){var G,v;"background"===p.property?(G=this._canvas.style.background,v=p.newValue||"",this.updateBackground(),this.fp("canvasBackground",G,v),this.redraw()):"a:width"===p.property||"a:height"===p.property?(this._83I=1,this.updateBackground(),this.redraw()):"layers"===p.property?this.updateLayers():"hierarchicalRendering"===p.property&&this.redraw()},handleDataPropertyChange:function(p){this.dm().isHierarchicalRendering()&&"parent"===p.property&&p.data.hasChildren()&&this.redraw(),this.invalidateData(p.data)},onPropertyChanged:function(p){var G,v=p.property;this.redraw(),"zoom"===v?(G=this.sm().getSelection()).size()&&G.each(function(p){p.invalidate()}):"dataModel"===v&&(this._83I=1),Jj[v]?this.showScrollBar():v===FJ&&this.onCurrentSubGraphChanged(p)},onCurrentSubGraphChanged:function(p){this.sm().cs(),this.reset()},handleDataModelChange:function(p){var G,v,J,$=this,S=p.kind,p=p.data;$._83I=1,"add"===S?($.invalidateData(p),zS(p)&&p.getEdgeGroup()&&p.getEdgeGroup().eachSiblingEdge($.invalidateData,$),p.getHost&&p.getHost()&&p.getHost().updateLayoutAttaches()):S===LJ?($._21Q(p),G=p._id,(v=$._25I[G])&&($._56I[G]&&(J=v._79o())&&$.redraw(J),v.dispose(),delete $._25I[G],delete $._24I[G],delete $._56I[G]),p===$._currentSubGraph&&$.setCurrentSubGraph(v0)):S===HJ&&($.invalidateAll(!0),$.setCurrentSubGraph(v0))},_75O:function(p){this.invalidateData(p.data)},handleHierarchyChange:function(p){this.dm().isHierarchicalRendering()&&p.data.hasChildren()&&this.redraw(),this.invalidateData(p.data)},adjustIndex:function(p){if(this.isVisible(p)){this.dm().beginTransaction();for(var G=p;G._parent&&this.isVisible(G._parent);)G=G._parent;G&&G!==p&&this._dataModel.adjustIndex(G),this._dataModel.adjustIndex(p),this.dm().endTransaction()}},getImage:function(p){return p.getImage?p.getImage():K},getSelectWidth:function(p){var G=T(this.getImage(p));return G&&V(G.disableSelectedBorder,p,this)?0:p.s("select.width")},getSelectColor:function(p){return p.s("select.color")},isSelectable:function(p,G){return!!this.isSelected(p)||!(!G&&p.getParent()instanceof hI&&this.isSelectable(p.getParent(),!0)&&p.getParent().isSyncSize())&&((!(G=(G=this.getLayersInfo())&&G[p._layer])||!1!==G.selectable)&&(p.s("2d.selectable")&&this.sm().isSelectable(p)))},isMovable:function(p){if(zS(p)&&p.getStyle(mJ)!==hJ)return!1;var G=this.getLayersInfo();return(!(G=G&&G[p._layer])||!1!==G.movable)&&(!!p.s("2d.movable")&&(!this._movableFunc||this._movableFunc(p)))},isEditable:function(p){if(E._uiSerializing)return this._uieditable;if(!this._editInteractor||!this.isSelected(p))return!1;if(ZS(p)){var G=this.getDataUI(p);if(!G||G._88I)return!1}return(!zS(p)||p.getStyle(mJ)===hJ)&&((!(G=(G=this.getLayersInfo())&&G[p._layer])||!1!==G.editable)&&(!!p.s("2d.editable")&&(!this._editableFunc||this._editableFunc(p))))},handleDelete:function(p){this._editInteractor&&(this._editInteractor.handleDelete?this._editInteractor.handleDelete():this.removeSelection())},isPointEditable:function(p){return(!k(p)||0===p.getRotation())&&(!this._pointEditableFunc||this._pointEditableFunc(p))},isRectEditable:function(p){return!this._rectEditableFunc||this._rectEditableFunc(p)},isAnchorEditable:function(p){return!this._anchorEditableFunc||this._anchorEditableFunc(p)},isRotationEditable:function(p){return!(!p.setRotation||!1===p.IRotatable)&&(!this._rotationEditableFunc||this._rotationEditableFunc(p))},isSourceTargetEditable:function(p,G,v){return!0},getRotationPoint:function(p){var G=p.getAnchor(),v=p.getScale(),J=this._zoom,G=Z4(p.getRotation(),0,-p.getHeight()*v.y*G.y-(v.y<0?-1:1)*(u0?32:16)/J),v=p.p();return G.x+=v.x,G.y+=v.y,G},getLogicalPoint:function(p){return RA(p,this._canvas,this.tx(),this.ty(),this._zoom,this._zoom)},getScreenPoint:function(p,G){var v;return"object"==typeof p?G=p.x!==K?(v=p.x,p.y):(v=p[0],p[1]):v=p,NA(v,G,this._canvas,this.tx(),this.ty(),this._zoom,this._zoom)},getSelectedDataAt:function(p){var G=this;return this.getDataAt(p,function(p){return G.isSelected(p)})},getDataInfoAt:function(p,G,v){var J=this.lp(p),$=this.getDataAt(J,G,v);if($){var S={data:$,ui:p=this.getDataUI($),point:J},O=p._38o;if(O){var W,l=O.icons;for(W in l){var t=l[W],z=O.rects[W];if(z)for(var Z=V(t.names,$,this),t=Z?Z.length:0,B=z.rotation,f=t-1;0<=f;f--){var X=Z[f],q=z[f];if(AA(q,J,B))return S.part="icons",S.name=W,S.icon=X,S.rect=q,S.index=f,S.rotation=B,S}}}if(this.isNoteVisible($)){if(p.note2Info&&AA(p.note2Info.clickRect,J,v0,p.note2Info.scale))return S.part="note2",S;if(p.noteInfo&&AA(p.noteInfo.clickRect,J,v0,p.noteInfo.scale))return S.part="note",S}if(this.isLabelVisible($)){if(p.label2Info&&AA(p.label2Info.rect,J,p.label2Info.rotation,p.label2Info.scale))return S.part="label2",S;if(p.labelInfo&&AA(p.labelInfo.rect,J,p.labelInfo.rotation,p.labelInfo.scale))return S.part="label",S}if($.isInRect&&$.isInRect(J))return S.part="body",S}return S},getDataAt:function(G,v,J){G.target&&(G=this.lp(G));var $,S=this._zoom;return this.reverseEach(function(p){if((v?v(p):this.isSelectable(p))&&this.rectIntersects(p,pS(G.x,G.y,J,S)))return $=p,!1},this),$},getIconInfoAt:function(p,G){if(p.target&&(p=this.lp(p)),G=G||this.getDataAt(p)){var v=this.getDataUI(G);if(v&&v._38o){var J=v._38o,$=new o;for(O in J.icons)$.add(O);for(var S=$.size()-1;0<=S;S--)for(var O=$.get(S),W=J.rects[O],l=W.rotation,t=W.length-1;0<=t;t--){var z=W[t],Z=z.width,B=z.height,f={x:p.x-z.x-Z/2,y:p.y-z.y-B/2};if(l!=v0&&(f=Z4(-l,f.x,f.y)),AA(z={x:-Z/2,y:-B/2,width:Z,height:B},f))return{key:O,index:t,name:J.icons[O].names[t],rect:W[t],point:p,rotation:l,relativeRect:z,relativePoint:f,data:G}}}}return v0},getDatasInRect:function(G,v,J){J===K&&(J=1);var $=this,S=new o;return $.reverseEach(function(p){J&&!$.isSelectable(p)||(v?$.rectIntersects(p,G):$.rectContains(p,G))&&S.add(p)}),S},moveSelection:function(p,G){this.dm().beginTransaction(),M4(this.sm().toSelection(this.isMovable,this),p,G),this.dm().endTransaction()},moveDatas:function(p,G,v){this.dm().beginTransaction(),p instanceof o||(p=new o(p)),M4(p,G,v),this.dm().endTransaction()},getDataUIBounds:function(p){return(p=this.getDataUI(p))?p._79o():v0},drawData:function(G,p,v){var J,$=this.getDataUI(p);$&&(J=$._79o(),v&&!IA(v,J)||($._42(G),p instanceof E.Block&&p.eachChild(function(p){this.isVisible(p)&&this.drawData(G,p,v)},this)))},getBoundsForGroup:function(p){return p.s(nJ)?this.getDataUIBounds(p):v0},isPixelPerfect:function(p){return p.s("pixelPerfect")},rectIntersects:function(p,G){this.validate();var v=v0;if(this._56I[p._id]&&($=this._25I[p._id])){var J=$._79o();if(kA(G,J))v=!0;else if((G=EA(G,J))&&(v=$.rectIntersects?$.rectIntersects(G):v)==v0){if(!this.isPixelPerfect(p))return!0;var J=G.x,$=G.y,S=G.width,O=G.height,W=this._zoom,l=S*O*W*W,t=((t=N.hitMaxArea)<l&&(W*=Math.sqrt(t/l)),J*=W,$*=W,kE(S=(S*=W)<2?2:S,O=(O*=W)<2?2:O));JE(t,-J,-$),t.scale(W,W),this._drawForChecking=!0,this.drawData(t,p,G),this._drawForChecking=!1;try{for(var z=0,Z=t.getImageData(0,0,S,O).data;z<Z.length;z+=4)if(0!==Z[z+3]){v=!0;break}t.restore()}catch(p){AE=v0,v=!1}}}return!!v},rectContains:function(p,G){return!(!this._56I[p._id]||!(p=this._25I[p._id]))&&kA(G,p._79o())},reset:function(){this.setZoom(1),this.setTranslate(0,0)},handleKeyDown:function(p){var G,v,J,$,S;N.isInput(p.target)||(v=(S=(G=this)._focusData)&&G._25I[S._id],$=0,J=G._dataModel._datas,S&&S._enabled&&S._editable&&v&&v.onKeyDown&&!0===v.onKeyDown(p)||(9===p.keyCode&&(S&&($=J.indexOf(S),dA(p)?-1==--$&&($=0):++$===J.size()&&($=0)),G._focusData=S=J.get($),G.sm().setSelection(S)),_E(p)?G.selectAll():PE(p)&&G.isResettable()&&G.reset(),G.sm().isEmpty()?G._editing||(v=G.tx(),J=G.ty(),$=!1,S=dA()?100:10,cE(p)&&(v-=S,$=!0),hE(p)&&(J-=S,$=!0),wE(p)&&(v+=S,$=!0),dE(p)&&(J+=S,$=!0),$&&G.setTranslate(v,J)):(bE(p)&&G.handleDelete(p),S=dA()?10:1,cE(p)&&(G.moveSelection(-S,0),G.fi({kind:"moveLeft"})),hE(p)&&(G.moveSelection(0,-S),G.fi({kind:"moveUp"})),wE(p)&&(G.moveSelection(S,0),G.fi({kind:"moveRight"})),dE(p)&&(G.moveSelection(0,S),G.fi({kind:"moveDown"})))))},handleScroll:function(p,G){if(tA(p),this.isZoomable()){if(!this.getEditInteractor()){var v=this.getDataAt(p);if(v){var J=T(this.getImage(v));if(J&&V(J.scrollable,v,this))return}}var $,S=this.getFullscreenDatas();for($ in S)if(S[$].s("fullscreen.lock"))return;J=this.lp(p),0<G?this.scrollZoomIn(J):G<0&&this.scrollZoomOut(J)}},handlePinch:function(p,G,v){!this.isZoomable()||Math.abs(G-v)<N.pinchZoomThreshold||(v<G?this.pinchZoomIn(p):this.pinchZoomOut(p))},checkDoubleClickOnNote:function(p,G){var v=this.lp(p),J=this.getDataUI(G),$=J.note2Info;return $&&G.s("note2.toggleable")&&AA($.clickRect,v)?(G.s(xJ,!G.s(xJ)),this.fi({kind:"toggleNote2",event:p,data:G}),!0):!!(($=J.noteInfo)&&G.s("note.toggleable")&&AA($.clickRect,v))&&(G.s(yJ,!G.s(yJ)),this.fi({kind:"toggleNote",event:p,data:G}),!0)},_84o:function(p,G){},isNoteVisible:function(p){return.15<this._zoom},isLabelVisible:function(p){return.15<this._zoom},isEditVisible:function(p){return.15<this._zoom},autoScroll:function(p,G){var v=this,J=v.getAutoScrollZone(),$=J/v.getZoom(),S=J/4,O=v._29I,p=v.lp(p),W={x:v.tx(),y:v.ty()};return p&&0<J&&O&&(p.x-O.x<$?v.translate(S,0):O.x+O.width-p.x<$&&v.translate(-S,0),p.y-O.y<$?v.translate(0,S):O.y+O.height-p.y<$&&v.translate(0,-S)),W.x=v.tx()-W.x,W.y=v.ty()-W.y,G&&(G.x+=W.x,G.y+=W.y),W},getMoveMode:function(p,G){return(G=G.s("2d.move.mode"))||(ci[88]?"x":ci[89]?"y":"xy")},getSerializableProperties:function(){return{scrollBarColor:1,scrollBarSize:1,autoMakeVisible:1,autoHideScrollBar:1,editable:1,resettable:1,pannable:1,rectSelectable:1,autoScrollZone:1,visibleFunc:1,movableFunc:1,editableFunc:1,pointEditableFunc:1,rectEditableFunc:1,anchorEditableFunc:1,rotationEditableFunc:1,rectSelectBackground:1,rectSelectBorderColor:1,editPointSize:1,editPointBorderColor:1,editPointBackground:1,hoverDelay:1,dataModel:1,selectionModel:1,currentSubGraph:1,zoom:1,translateX:1,translateY:1}},serializeProperty:function(p,G,v){return"currentSubGraph"===G?{__i:p.getId()}:v.serializeProperty(p,G,this)},deserializeProperty:function(p,G,v){return"currentSubGraph"===G?this.dm().__idMap[p.__i]:v.deserializeProperty(p,G,this)},setDefaultCursor:function(p,G){this._defaultCursor=p,!1!==G&&this.setCursor(p)},getCurrentConnectActionType:function(){return this._currentActionType},setCurrentConnectActionType:function(p){return!(p!==v0&&!N.getConnectAction(null,p)||(this._currentActionType=p,this.redraw(),0))},getEditStyle:function(p){var G=this.getEditInteractor();return G?G.getStyle(p):K},setEditStyle:function(p,G,v){var J=this.getEditInteractor();return!!J&&(J.setStyle(p,G,v),!0)},isConnectActionVisible:function(p){var G=N.getConnectAction(this);return!!G&&(G=G.visible,WS(G)?G(this,p):G)},isInteractive:function(p){if(this._drawForChecking)return!1;var G=T(this.getImage(p));return!(!G||!V(G.interactive,p,this))||p.s("interactive")},getRenderingStyleIconName:function(){return EI},appendHTML:function(p,G){var v=this.getView();if(!(G||p&&p.parentNode!==v))return!1;var J=p.getView&&p.getView(),$=p.beforeCanvas;return!(!G&&J&&J.parentNode===v)&&((p.getView||p.isSelfViewEvent)&&(p=p.getView()),G=this.getEditInteractor(),$?v.insertBefore(p,this.getCanvas()):G&&G._canvas?v.insertBefore(p,G._canvas):this.isScrollBarVisible()?v.insertBefore(p,this.getView().lastChild):KS(v,p),!0)},_layoutHTMLImpl:function(p,G,v){var J,$,S,O,W,l;1<arguments.length?($=this._zoom,(G=G.getView?(J=G).getView():G).style.position="absolute",v?(S=p.getRect(),P(J||G,this.tx()+S.x*$,this.ty()+S.y*$,S.width*$,S.height*$)):(v=new ch,S=p.getAnchorRect(),O=p.getPosition(),W=p.getScale(),l=G.style,P(J||G,S),v.appendTranslate(this.tx(),this.ty()),v.appendScale($,$),v.append(new ch(p.getRotation(),O.x,O.y,W.x,W.y)),QS(l,"transform","matrix("+v.a.toFixed(5)+", "+v.b.toFixed(5)+", "+v.c.toFixed(5)+",\n    "+v.d.toFixed(5)+", "+v.tx.toFixed(5)+", "+v.ty.toFixed(5)+")"),QS(l,"transformOrigin",(-S.x).toFixed(5)+"px "+(-S.y).toFixed(5)+"px"),G.updateAppendMatrix=!0)):this._layoutHTML&&this._layoutHTML()},getTextEditInfo:function(p){if(p instanceof wI)return{name:"text",accessType:"s",font:p.s("text.font"),isMultiline:!0}},getState:function(p){var G=p.s("state");return G||((G=T(p._image))?V(G.state,p,this)||null:void 0)},getShape:function(p){return p.getStyle(qJ)}}),d.defineProperties(wj.GraphView.prototype,{layoutHTML:{get:function(){return this._layoutHTMLImplBind||(this._layoutHTMLImplBind=this._layoutHTMLImpl.bind(this)),this._layoutHTMLImplBind},set:function(p){this._layoutHTML=p}}}),function(p,G){this.gv=p,this.s=function(p){return G.getStyle(p)},this._data=G,this._87I=new o}),EI=v0,yI=(oA(II,d,{_6I:v0,ms_icons:1,_84o:function(p){},dispose:function(){},isShadowed:function(){return this.s("shadow")||this.gv.isSelected(this._data)&&"shadow"===this.s("select.type")},getSelectWidth:function(){return!this.gv.isSelected(this._data)||this.isShadowed()?0:this.gv.getSelectWidth(this._data)},getSelectColor:function(){return this.gv.getSelectColor(this._data)},getBodyColor:function(p){var G=this._data;return this.gv.getBodyColor(G)||(p?G.getStyle(p):v0)},_2Q:function(p){return this.s(p)},_1Q:function(p,G,v,J){var $,S=this.s,O=S("2d.gray"),W=S(G+".dash.color");O&&(W=N.toGrayColor(W)),p.strokeStyle=W,p.lineWidth=v,p.stroke(),S(G+".dash.3d")&&($=S(G+".dash.3d.color"),uE(p,W,O?N.toGrayColor($):$,v,this.gv._zoom,S(G+".dash.3d.accuracy"))),_m(p,J)},invalidate:function(){this._6I=v0},_79o:function(){var p,G,v=this;return v._6I||(p=v._data,G=v.gv,v.labelInfo=v.label2Info=v.noteInfo=v.note2Info=v._38o=v0,v._87I.clear(),v.interactiveInfo=G.isInteractive(p)?{}:v0,v._3O(),v._55O=G.isEditable(p)?{_42O:G.isRectEditable(p),_43O:G.isPointEditable(p),_56O:G.isRotationEditable(p)}:v0,v._6I=v._81o()),v._6I},_3O:function(){},getPosition:function(p,G,v,J){return xi},_68o:function(p,G){var v,J;p&&this._87I.add(G?(G=new hh(G),v=p.width/2,J=p.height/2,(G=rA([G.tf(-v,-J),G.tf(v,-J),G.tf(v,J),G.tf(-v,J)])).x+=p.x+v,G.y+=p.y+J,G):p)},_81o:function(){var G,p,v,J,$=this,S=$.s;return $._24O(jJ,"getLabel"),$._24O(iJ,"getLabel2"),$._26O(rJ,"getNote"),$._26O(eJ,"getNote2"),$._15O(),$._55O&&$._48O(),$._87I.each(function(p){G=eA(G,p)}),G&&S("shadow.interactable")&&(p=$.isShadowed(),v=S("shadow2"),J=MA(G),v?(J.x+=S("shadow2.offset.x"),J.y+=S("shadow2.offset.y"),xA(J,S("shadow2.blur"))):p&&(J.x+=S("shadow.offset.x"),J.y+=S("shadow.offset.y"),xA(J,S("shadow.blur"))),G=eA(G,J)),$._87I.clear(),G},_42:function(p){var G,v,J,$,S,O,W,l=this,t=l._data,z=l.gv,Z=l.s,B=Z("opacity"),f=this.isShadowed(),X=Z("shadow2");(f||X)&&(G=p.shadowOffsetX,v=p.shadowOffsetY,J=p.shadowBlur,$=p.shadowColor,S=z.getZoom()*N.devicePixelRatio,p.shadowOffsetX=Z((O=f?"shadow":"shadow2")+".offset.x")*S,p.shadowOffsetY=Z(O+".offset.y")*S,p.shadowBlur=Z(O+".blur")*S,p.shadowColor=f?l.getSelectColor():Z(O+".color")),B!=v0&&(W=p.globalAlpha,p.globalAlpha=B),l._80o(p),z.isLabelVisible(t)&&(z._drawForChecking&&!Z("label.selectable")||bj(p,l.labelInfo),z._drawForChecking&&!Z("label2.selectable")||bj(p,l.label2Info)),z.isNoteVisible(t)&&(nj(p,l.noteInfo),nj(p,l.note2Info)),l._99O(p),B!=v0&&(p.globalAlpha=W),(f||X)&&(p.shadowOffsetX=G,p.shadowOffsetY=v,p.shadowBlur=J,p.shadowColor=$)},_80o:function(p){},_47O:function(p){},_24O:function(p,G){var v,J,$,S=this._data,O=this.gv,W=this.s,l=O[G](S);l!=v0&&(v=W(p+".scale"),$=W(p+".max"),J=W(p+".position"),O=this[p+"Info"]={label:l,scale:v,color:O[G+"Color"](S),font:W(p+".font"),opacity:W(p+".opacity"),align:W(p+".align"),decoration:W(p+".decoration"),rotation:this.getRotation(W(p+".rotation"),!1,J),background:O[G+"Background"](S)},G=aS(O,l),0<$&&$<G.width&&(O.labelWidth=G.width,G.width=$),1!==v&&(G.width*=v,G.height*=v),S=this.getPosition(J,W(p+".offset.x"),W(p+".offset.y"),G,W(p+".position.fixed")),G.x=S.x-G.width/2,G.y=S.y-G.height/2,this._68o(O.rect=G,O.rotation),1!==v&&(l=G.width/v,$=G.height/v,O.rect={x:S.x-l/2,y:S.y-$/2,width:l,height:$}))},_26O:function(p,G){var v,J,$,S,O,W=this.gv,l=this._data,t=this.s,z=W[G](l);z!=v0&&(v=t(p+".scale"),W=this[p+"Info"]={note:z,scale:v,data:l,view:W,expanded:t(p+".expanded"),font:t(p+".font"),color:t(p+".color"),opacity:t(p+".opacity"),align:t(p+".align"),icon:t(p+".icon"),backgroundImage:t(p+".backgroundImage"),borderWidth:t(p+".border.width"),borderColor:t(p+".border.color"),background:W[G+"Background"](l)},J=(G=this.getPosition(t(p+".position"),t(p+".offset.x"),t(p+".offset.y"))).x,G=G.y,W.expanded?($=t(p+".max"),(O=(O=t(p+".backgroundImage"))?(O=T(O),{width:Am(O,l),height:km(O,l)}):aS(W,z)).width+=6,O.height+=2,0<$&&$<O.width&&(W.labelWidth=O.width,O.width=$),$=O.width,S=O.height+8,W.clickRect={x:J-$*v/2,y:G-S*v,width:$*v,height:S*v*O.height/S}):(S=(z=t(p+".icon"))?(z=T(z),$=Am(z,l),km(z,l)):($=12,18),W.clickRect={x:J-$*v/2,y:G-S*v,width:$*v,height:S*v}),W.rect={x:J-$/2,y:G-S*v/2-S/2,width:$,height:S},O=D0(W.borderWidth/2)*v,this._68o({x:J-$*v/2-O,y:G-S*v-O,width:$*v+2*O,height:S*v+2*O}))},_48O:function(){},_99O:function(p){var G=this._38o;if(G){var v,J=this.gv,$=this._data,S=G.icons,O=this.interactiveInfo;for(v in O&&(O._38o={}),S){var W=S[v],l=G.rects[v];if(l){O&&(O._38o[v]=[]);var t,z=V(W.opacity,$,J),Z=V(W.names,$,J),B=Z?Z.length:0,f=l.rotation;z!=v0&&(t=p.globalAlpha,p.globalAlpha*=z);for(var X=0;X<B;X++){var q,g,M=Z[X],M=T(M),L=l[X],H=(f&&(q=L.x+L.width/2,g=L.y+L.height/2,p.save(),JE(p,q,g),$E(p,f),JE(p,-q,-g)),O&&O._38o[v].push(p.interactiveInfo={compInfos:[],matrix:f?new ch(f,q,g).appendTranslate(-q,-g):new ch}),EI);EI=v,BA(p,M,V(W.stretch,$,J),L.x,L.y,L.width,L.height,this._data,this.gv),EI=H,p.interactiveInfo=v0,f&&p.restore()}z!=v0&&(p.globalAlpha=t)}}}}}),function(p,G){bS(yI,this,[p,G])}),xI=(oA(yI,II,{_checkEmptyRect:!0,_40O:function(p,G){var v,J=this.s,$=p.rect,S=((p.borderColor=this.gv.getBorderColor(this._data))&&(p.borderType=J("border.type"),p.borderWidth=J("border.width"),p.borderPadding=J("border.padding"),G=J0(G,p.borderPadding+p.borderWidth/2)),this._data.getScale()),S=J0(1,J0(I(S.x),I(S.y)));(p.selectWidth=this.getSelectWidth())&&(v=this.gv._zoom,p.selectType=J("select.type"),p._97o=this.getSelectColor(),p.selectPadding=J("select.padding"),G=J0(G,(p.selectPadding+p.selectWidth/2/v)/S)),0<G&&(G*=S,$=MA($),xA($,G)),this._68o($)},_39O:function(p,G){var v,J,$,S,O,W=G.rect;0<G.borderWidth&&(O=G.borderPadding,p.strokeStyle=G.borderColor,p.lineWidth=G.borderWidth,oE(p,G.borderType,{x:W.x-O,y:W.y-O,width:W.width+2*O,height:W.height+2*O}),p.stroke()),0<G.selectWidth&&(J=this.gv._zoom,O=G.selectPadding,p.strokeStyle=G._97o,p.lineWidth=G.selectWidth/J,G.rotation!=v0&&(p.save(),p.translate(G.position.x,G.position.y),p.rotate(G.rotation),v=(J=this._data).getWidth(),J=J.getHeight(),$=G.scale,S=G.anchor,W={x:$.x*(-v*S.x),y:$.y*(-J*S.y),width:$.x*v,height:$.y*J}),oE(p,G.selectType,{x:W.x-O,y:W.y-O,width:W.width+2*O,height:W.height+2*O}),G.rotation!=v0&&p.restore(),p.stroke())},dispose:function(){var p=this._htmlView;yI.superClass.dispose.call(this),p&&(p.onHTMLRemoved&&p.onHTMLRemoved(),KA(p))},_3O:function(){var p,G=this,v=G.s,J=G._data,$=G.gv,S=$.getShape(J),O=G.getBodyColor(),W=v("shape.border.color"),l=((O=(W=G._83o=S?{shape:S,_53o:G.getBodyColor("shape.background"),_27Q:T(v("shape.repeat.image"),O),shapeGradientPack:v("shape.gradient.pack"),shapeBorderGradientPack:v("shape.border.gradient.pack"),_54o:v("shape.border.width"),_55o:W,shapeBorderRepeatImage:T(v("shape.border.repeat.image"),W),_56o:v("shape.border.3d"),_57o:v("shape.border.3d.color"),_58o:v("shape.border.3d.accuracy"),shapeGradient:v("shape.gradient"),_59o:v("shape.gradient.color"),_60o:v("shape.border.pattern"),_61o:v("shape.border.cap"),_62o:v("shape.border.join"),shapeForeground:v("shape.foreground"),bodyColor:O,gray:v("2d.gray")}:{img:T($.getImage(J),O),bodyColor:O,gray:v("2d.gray"),stretch:v("image.stretch")}).img)&&O.renderHTML?(G._htmlInfo&&G._htmlInfo.img!==O&&(G._htmlInfo=v0),G._htmlInfo||(G._htmlInfo={img:O,cache:{}}),l=O.renderHTML(J,$,G._htmlInfo.cache)):G._htmlInfo=v0,G._htmlView&&G._htmlView!==l&&(G._htmlView.onHTMLRemoved&&G._htmlView.onHTMLRemoved(),KA(G._htmlView.getView?G._htmlView.getView():G._htmlView)),(G._htmlView=l)&&$.appendHTML(l)&&(l.onHTMLAddedSync&&l.onHTMLAddedSync(),l.onHTMLAdded&&XA(l.onHTMLAdded)),W.rect=J.getRect(),W.position=J.p(),W.scale=J.getScale(),W.anchor=J.getAnchor(),W.rotation=J.getRotation(),S===y&&(W._63o=v("shape.depth")),0);S?(l=xE(v0,W._54o/2,W._62o),G.s("shape.dash")&&(l=J0(l,(G.s("shape.dash.width")||W._54o)/2))):O&&O.boundExtend&&(l=V(O.boundExtend,J,$),O.boundExtendAbsolute?(p=J.getScale(),l/=$._zoom*J0(1,J0(I(p.x),I(p.y)))):V(O.fitSize,J,$)||(p=V(O.width,J,$),O=V(O.height,J,$),l*=J0(J.getWidth()/p,J.getHeight()/O))),G._40O(W,l),($=v("clip.percentage"))!=K&&(W.clipRect=jS(J.getAnchorRect(),v("clip.direction"),$)),S&&((p=v("shape.fill.clip.percentage"))!=K&&(W.shapeClipRect=jS(J.getAnchorRect(),v("shape.fill.clip.direction"),p)),(O=v("shape.foreground.clip.percentage"))!=K&&(W.shapeForegroundClipRect=jS(J.getAnchorRect(),v("shape.foreground.clip.direction"),O))),v("clip.host")&&J.getHost()&&(W.clipHost=!0)},getPosition:function(p,G,v,J){return(p=b4(p,this._83o.rect,J)).x+=G,p.y+=v,p},_80o:function(v){var p,G,J,$,S,O,W,l,t,z,Z,B,f,X=this,q=X.s,g=X.gv,M=X._data,L=X._83o,H=L.rect,_=L.position,b=L.rotation,n=L.anchor,D=L.scale,Y=L.shape,s=L.clipHost,c=L.clipRect;(!X._checkEmptyRect||0<H.width&&0<H.height)&&(s&&(H=M.getHost().getCorners(),v.save(),v.beginPath(),H.forEach(function(p,G){G?v.lineTo(p.x,p.y):v.moveTo(p.x,p.y)}),v.clip()),(H=M.getSize()).x=-H.width*n.x,H.y=-H.height*n.y,v.save(),JE(v,_.x,_.y),$E(v,b),SE(v,D.x,D.y),c&&(v.beginPath(),v.rect(c.x,c.y,c.width,c.height),v.clip()),g._drawForChecking&&L.img&&!1===V(L.img.pixelPerfect,M,g)?VE(v,H.x,H.y,H.width,H.height,"#888888"):X.freeDraw?X.freeDraw(v,H,L):Y?(n=L._60o,c=Hm(v,n),Z=L._27Q,p=L._54o,f=L.shapeGradientPack,G=L.gray,J=v.lineJoin,$=v.lineCap,t=function(p){return G?N.toGrayColor(p):p},"roundRect"===Y?S=q("shape.corner.radius"):"polygon"===Y?(S=q("shape.polygon.side"),O=q("shape.corner.radius"),W=q("shape.regular")):"arc"===Y&&(S=q("shape.arc.from"),O=q("shape.arc.to"),W=q("shape.arc.close"),l=q("shape.arc.oval")),v.lineJoin=L._62o,v.lineCap=L._61o,(z=t(L._53o))||Z||f?((B=L.shapeClipRect)&&(v.save(),v.beginPath(),v.rect(B.x,B.y,B.width,B.height),v.clip()),oE(v,Y,H,S,O,W,l),f?NE(v,f,function(p){return IE(p,L.bodyColor)},!1,H):Z?FE(v,Z,t(L.bodyColor),null,M,g):UE(v,z,L.shapeGradient,t(L._59o),H),v.fill(),f&&v.restore(),B&&v.restore(),v!==c&&oE(c,Y,H,S,O,W,l)):oE(c,Y,H,S,O,W,l),(Z=L.shapeForeground)&&(v.save(),(f=L.shapeForegroundClipRect)&&(v.beginPath(),v.rect(f.x,f.y,f.width,f.height),v.clip()),oE(v,Y,H,S,O,W,l),UE(v,Z,q("shape.foreground.gradient"),t(q("shape.foreground.gradient.color")),H),v.fill(),v.restore()),0<p&&((B=q("shape.border.width.absolute"))&&(v.save(),v.setTransform(1,0,0,1,0,0)),v.lineWidth=p,f=t(L._55o),(Z=L.shapeBorderGradientPack)?NE(v,Z,t,!0,H):L.shapeBorderRepeatImage?CE(v,L.shapeBorderRepeatImage,f,null,M,g):v.strokeStyle=f,v.stroke(),Z&&v.restore(),B&&v.restore(),L._56o&&uE(v,f,t(L._57o),p,g._zoom,L._58o)),_m(v,n),q("shape.dash")&&0<(Z=q("shape.dash.width")||p)&&(n=q("shape.dash.pattern"),(c=Hm(v,n,X._2Q("shape.dash.offset")))!==v&&oE(c,Y,H,S,O,W,l),X._1Q(v,"shape",Z,n)),$4(v,z,L._63o,H),v.lineJoin=J,v.lineCap=$):((B=X.interactiveInfo)&&(v.interactiveInfo=B.bodyInfo={compInfos:[],matrix:new ch(b,_.x,_.y,D.x,D.y)}),L.gray&&(v.compGray=!0),(f=L.img)&&f.cacheRule!=v0&&(f=Pj(v,f,L.stretch,H.width,H.height,M,g,L.bodyColor)),BA(v,f,L.stretch,H.x,H.y,H.width,H.height,M,g,L.bodyColor),v.compGray=!1,v.interactiveInfo=v0),v.restore(),s&&v.restore()),X._39O(v,L)},_48O:function(){},_47O:function(p){}}),function(p,G){bS(xI,this,[p,G])}),RI=function(p,G,v,J){var $=iA(p,G);return v=(J?$0:Dj)(v,$),$?v/=$:v=0,{x:p.x+(G.x-p.x)*v,y:p.y+(G.y-p.y)*v}},NI=(oA(xI,II,{_3O:function(){var p,G,v,J,$,S,O,W,l,t=this,z=t._data,Z=t.gv,B=t.s,f=B(mJ),X=z.isLooped(),q=B("edge.width"),g=t.getBodyColor("edge.color"),M=B("edge.center"),L=B("edge.offset"),H=Z.getBorderColor(z),_=H?B("border.width"):0,b=t.getSelectWidth(),n=z._40I,D=z._41I;(g=t._78o=n&&D?{looped:X,type:f,width:q,center:M,color:g,repeatImage:T(B("edge.repeat.image"),g),borderColor:H,borderWidth:_,_97o:b?t.getSelectColor():v0,selectWidth:b,pattern:B("edge.pattern"),cap:B("edge.cap"),join:B("edge.join"),is3d:B("edge.3d"),_67o:B("edge.3d.color"),_66o:B("edge.3d.accuracy"),gray:B("2d.gray")}:v0)&&((H=N.getEdgeType(f))?(H=H(z,cj(t,Z,z,X,f),Z,t._19Q)).points&&1<H.points.size()?(g.edgeTypeInfo=H,p=rA(g.edgeTypeInfo.points)):H[oJ]&&H.rect&&(p=(g.edgeTypeInfo=H).rect):(H=B("edge.source.anchor.x"),S=B("edge.source.anchor.y"),J=B("edge.target.anchor.x"),$=B("edge.target.anchor.y"),G=Mj(Z,z,"source"),v=Mj(Z,z,"target"),f===hJ?(W=(O=g.points=B(NJ)||om).size(),g.segments=B("edge.segments"),H=H!==K||S!==K||zS(n),S=J!==K||$!==K||zS(D),M||(L?(H||(G=RI(G,W?O.get(0):v,L,W)),S||(v=RI(v,W?O.get(W-1):G,L,W))):(H||(l=hS(G,W?O.get(0):v,pj(Z,n)))&&(G={x:l[0],y:l[1]}),S||(l=hS(W?O.get(W-1):G,v,pj(Z,D)))&&(v={x:l[0],y:l[1]}))),p=eA(rA(g.points),rA(G,v))):(J=cj(t,Z,z,X,f),t._19Q||(J=-J),X?((G=MA(G)).x=Z.getNodeRect(n).x,g.radius=J,p={x:G.x-J,y:G.y-J,width:2*J,height:2*J}):($=iA(G,v),S={x:H=Dj(L,$),y:J},O={x:$-H,y:J},W=P0(v.y-G.y,v.x-G.x),D=g.mat=new hh(W),g.orienAngle=W,g.angle=v.x<G.x?W+j:W,g.rect={x:S.x,y:S.y,width:O.x-S.x,height:0},g.origin=G,(S=D.tf(S)).x+=G.x,S.y+=G.y,(O=D.tf(O)).x+=G.x,O.y+=G.y,M?((l=D.tf(l={x:$,y:0})).x+=G.x,l.y+=G.y,p=rA([G,S,O,l]),g.c1=G,g.c2=l):p=rA(S,O),G=S,v=O)),g.sourcePoint=G,g.targetPoint=v,z._lastSourcePoint=G,z._lastTargetPoint=v),f=0,B("edge.dash")&&(f=B("edge.dash.width")||q),X="square"===g.cap?.71:.5,xE(p,J0(f*X,q*X+_+b),g.join),t._68o(p))},getRotation:function(p,G,v){p=p||0;var J=this._78o;if(J){var $,S=J.angle,O=J.points,W=J.edgeTypeInfo;if(S!=v0)return G?J.orienAngle+p:S+p;if(W&&W[oJ])return W.getRotation?W.getRotation(this,p,G,v):0;if(W&&W.points)return $=(S=W.points).size(),vj[v]?$&&$%2==0?Yj(S.get($/2-1),S.get($/2),G,p):p:Gj[v]?Yj(S.get(0),S.get(1),G,p):Yj(S.get($-2),S.get($-1),G,p);if(O)return $=O.size(),vj[v]?$&&$%2==0?Yj(O.get($/2-1),O.get($/2),G,p):0===$?Yj(J.sourcePoint,J.targetPoint,G,p):p:Gj[v]?Yj(J.sourcePoint,$?O.get(0):J.targetPoint,G,p):Yj($?O.get($-1):J.sourcePoint,J.targetPoint,G,p)}return p},getPosition:function(p,G,v,J,$){var S=this._78o;if(S){var O=S.type,W=S.points,l=S.edgeTypeInfo,t=S.sourcePoint,z=S.targetPoint;if(!O)return S.looped?{x:t.x-S.radius+G,y:t.y+v}:($&&t&&z&&(t.x>z.x||t.x===z.x&&t.y>z.y)&&(p=_4[p],v=-v),(Z=b4(p,S.rect,J)).x+=G,Z.y+=v,(Z=S.mat.tf(Z)).x+=S.origin.x,Z.y+=S.origin.y,Z);if(l&&l[oJ])return l.getPosition?l.getPosition(this,p,G,v,J,$):{x:(t.x+z.x)/2,y:(t.y+z.y)/2};if(W){var Z,B,f=W.size();if(vj[p]){if(f){if(0==(B=f%2))return sj(W.get(f/2-1),W.get(f/2),p,G,v,J,$);Z=W.get((f-B)/2)}else Z={x:(t.x+z.x)/2,y:(t.y+z.y)/2};return(Z=b4(p,{x:Z.x,y:Z.y,width:0,height:0},J)).x+=G,Z.y+=v,Z}return Gj[p]?sj(t,f?W.get(0):z,p,G,v,J,$):sj(f?W.get(f-1):t,z,p,G,v,J,$)}if(l)return f=(O=l.points).size(),vj[p]?0==(B=f%2)?sj(O.get(f/2-1),O.get(f/2),p,G,v,J,$):(Z=O.get((f-B)/2),(Z=b4(p,{x:Z.x,y:Z.y,width:0,height:0},J)).x+=G,Z.y+=v,Z):Gj[p]?sj(O.get(0),O.get(1),p,G,v,J,$):sj(O.get(f-2),O.get(f-1),p,G,v,J,$)}return xi},_42:function(p){this._78o&&xI.superClass._42.call(this,p)},drawPath:function(G,p){G.beginPath();var v,J,$,S,O=p.type,W=p.points,l=p.segments,t=p.edgeTypeInfo;!O||W?(v=(J=p.sourcePoint).x,J=J.y,$=(S=p.targetPoint).x,S=S.y,O?l?((O=new o({x:v,y:J})).addAll(W),O.add({x:$,y:S}),KE(G,O,l)):(G.moveTo(v,J),W.each(function(p){G.lineTo(p.x,p.y)}),G.lineTo($,S)):p.looped?G.arc(v,J,p.radius,0,W0,!0):p.center?(G.moveTo(p.c1.x,p.c1.y),G.lineTo(v,J),G.lineTo($,S),G.lineTo(p.c2.x,p.c2.y)):(G.moveTo(v,J),G.lineTo($,S))):t&&(t.points?KE(G,t.points,t.segments):t[oJ]&&t[oJ](G,t))},_80o:function(p){var G=this.s,v=this._78o,J=v.width,$=v.selectWidth,S=v.borderWidth,O=v.repeatImage,W=p.lineJoin,l=p.lineCap,t=v.gray,z=v.pattern,Z=(p.lineJoin=v.join,p.lineCap=v.cap,this.drawPath(Hm(p,z),v),G("edge.width.absolute")),$=(Z&&(p.save(),p.setTransform(1,0,0,1,0,0)),$&&(p.strokeStyle=v._97o,p.lineWidth=J+2*(S+$),p.stroke()),S&&(p.strokeStyle=t?N.toGrayColor(v.borderColor):v.borderColor,p.lineWidth=J+2*S,p.stroke()),t?N.toGrayColor(v.color):v.color);O?CE(p,O,$,null,this._data,this.gv):p.strokeStyle=$,p.lineWidth=J,p.stroke(),v.is3d&&(S=t?N.toGrayColor(v._67o):v._67o,uE(p,$,S,J,this.gv._zoom,v._66o)),G("edge.dash")&&(z=G("edge.dash.pattern"),(O=Hm(p,z,this._2Q("edge.dash.offset")))!==p&&this.drawPath(O,v),this._1Q(p,"edge",G("edge.dash.width")||J,z)),Z&&p.restore(),_m(p,z),p.lineJoin=W,p.lineCap=l},_48O:function(){},_47O:function(p){}}),function(p,G){bS(NI,this,[p,G])}),mI=(oA(NI,yI,{_3O:function(){var G,v,p,J,$,S,O,W,l,t,z,Z,B,f,X,q,g=this.s,M=this._data,L=this.gv;this._88I=v0,M.isExpanded()&&M.eachChild(function(p){k(p)&&(p=L.getBoundsForGroup(p))&&((v=v||[]).push(p),G=eA(G,p))}),G?(S=L.getLabel(M),$=g("group.type"),J=(p=g("group.border.width")||0)/2,g("group.border.width.absolute")&&(p/=L._zoom),l=v,t=G,G="oval"===(W=$)?(z=0,B=t.height/t.width,Z=B*B,X=t.x+t.width/2,q=t.y+t.height/2,IM(l).forEach(function(p){var G=p.x-X,p=p.y-q;z<(G=G*G+p*p/Z)&&(z=G)}),B*=z=Y0(z),{x:X-z,y:q-B,width:2*z,height:2*B}):"circle"===W?(f=0,X=t.x+t.width/2,q=t.y+t.height/2,IM(l).forEach(function(p){var G=p.x-X,p=p.y-q;f<(G=G*G+p*p)&&(f=G)}),f=Y0(f),{x:X-f,y:q-f,width:2*f,height:2*f}):("roundRect"===W&&xA(t,$0(t.width,t.height)/16),t),fj(G,M,"group.padding",1),xA(G,p),M=this._88I={type:$,rect:G,_64o:G},$||S==v0||($=this.labelInfo={label:S,color:g("group.title.color"),font:g("group.title.font"),align:g("group.title.align")},B=(S=aS($,S)).width+p,S=S.height+p,l=g("group.title.align"),(W=g("group.title.orientation"))===pJ||W===GJ?(G.height+=p,B>G.width&&(G.width=B)):W!==C0&&W!==Q0||(G.width+=p,B>G.height&&(G.height=B)),l=l===C0?G.x:l===Q0?G.x+G.width-B:G.x+G.width/2-B/2,W===GJ?(M.titleRect={x:G.x,y:G.y+G.height,width:G.width,height:S},M.rect={x:G.x,y:G.y,width:G.width,height:G.height+S},$.rect={x:l,y:G.y+G.height,width:B,height:S}):W===C0?(O=M.titleRect={x:G.x-S,y:G.y,width:S,height:G.height},M.rect={x:G.x-S,y:G.y,width:G.width+S,height:G.height},$.rect={x:O.x+S/2-G.height/2,y:O.y+G.height/2-S/2,width:G.height,height:S},$.rotation=-Math.PI/2):W===Q0?(O=M.titleRect={x:G.x+G.width,y:G.y,width:S,height:G.height},M.rect={x:G.x,y:G.y,width:G.width+S,height:G.height},$.rect={x:O.x+S/2-G.height/2,y:O.y+G.height/2-S/2,width:G.height,height:S},$.rotation=Math.PI/2):(M.titleRect={x:G.x,y:G.y-S,width:G.width,height:S},M.rect={x:G.x,y:G.y-S,width:G.width,height:G.height+S},$.rect={x:l,y:G.y-S-J,width:B,height:S+p})),this._40O(M,g("group.border.width")/2)):NI.superClass._3O.call(this)},getPosition:function(p,G,v,J){var $=this._88I;return $?((p=b4(p,$.rect,J)).x+=G,p.y+=v,p):NI.superClass.getPosition.apply(this,arguments)},_24O:function(p,G){var v=this._88I;v&&!v.type&&"label2"!==p||NI.superClass._24O.call(this,p,G)},_80o:function(p){var G=this._88I;if(G){var v=this._data,J=this.s,$=this.gv,S=G.type,O=G.rect,W=G._64o,l=G.titleRect,t=this.getBodyColor(),z=T(J("group.image"),t),Z=J("group.image.stretch"),B=this.getBodyColor("group.background"),f=T(J("group.repeat.image"),t),X=J("group.gradient.pack"),q=J("group.gradient"),g=J("group.gradient.color"),M=J("group.border.width"),L=J("group.border.color"),H=J("group.border.pattern"),_=J("group.title.orientation"),b=J("group.depth"),n=J("group.border.radius"),D=J("group.border.join"),Y=J("group.border.cap"),s=(J("group.border.width.absolute")&&(M/=$._zoom),L),c=J("group.border.repeat.image");if((c=c&&T(c,L))&&(s=QE(p,c,L,null,v,$)),S)c=p.lineJoin,L=p.lineCap,p.lineJoin=D,p.lineCap=Y,z?(p.save(),oE(p,S,O,n),p.clip(),BA(p,z,Z,O.x,O.y,O.width,O.height,v,$,t),p.restore(),0<M&&(h=Hm(p,H),oE(h,S,O,n),p.lineWidth=M,p.strokeStyle=s,p.stroke(),_m(p,H))):(h=Hm(p,H),B||f||X?(oE(p,S,O,n),X?NE(p,X,function(p){return IE(p,t)},!1,O):f?FE(p,f,t,null,v,$):UE(p,B,q,g,O),p.fill(),X&&p.restore(),p!==h&&oE(h,S,O,n)):oE(h,S,O,n),0<M&&(p.lineWidth=M,p.strokeStyle=s,p.stroke()),_m(p,H),S===y&&$4(p,B,b,O)),p.lineJoin=c,p.lineCap=L;else{var h,X=J("group.title.background");if((!n||n<0)&&(n=0),z)BA(p,z,Z,W.x,W.y,W.width,W.height,v,$,this.getBodyColor());else if(B||f)if(f?FE(p,f,t,null,v,$):UE(p,B,q,g,W),0===M)oE(p,y,W),p.fill(),$4(p,B,b,W);else{switch(p.beginPath(),_){case GJ:v4(p,W.x,W.y,W.width,W.height,n,n,0,0);break;case C0:v4(p,W.x,W.y,W.width,W.height,0,n,0,n);break;case Q0:v4(p,W.x,W.y,W.width,W.height,n,0,n,0);break;case pJ:v4(p,W.x,W.y,W.width,W.height,0,0,n,n)}p.fill()}if(l&&X)if(0===M)VE(p,l.x,l.y,l.width,l.height,X),$4(p,X,b,l);else{switch(p.beginPath(),p.fillStyle=X,_){case GJ:v4(p,l.x,l.y,l.width,l.height,0,0,n,n);break;case C0:v4(p,l.x,l.y,l.width,l.height,n,0,n,0);break;case Q0:v4(p,l.x,l.y,l.width,l.height,0,n,0,n);break;case pJ:v4(p,l.x,l.y,l.width,l.height,n,n,0,0)}p.fill()}0<M&&(h=Hm(p,H),oE(h,"roundRect",O,n),p.save(),p.lineWidth=M,p.strokeStyle=s,p.lineJoin=D,p.lineCap=Y,p.closePath(),p.stroke(),l&&J("group.splitLine")&&(S=l.x,c=l.y,L=l.width,z=l.height,p.beginPath(),_===GJ?(p.moveTo(S,c),p.lineTo(S+L,c)):_===C0?(p.moveTo(S+L,c),p.lineTo(S+L,c+z)):_===Q0?(p.moveTo(S,c),p.lineTo(S,c+z)):(p.moveTo(S,c+z),p.lineTo(S+L,c+z))),p.stroke(),p.restore(),_m(h,H))}this._39O(p,G)}else NI.superClass._80o.call(this,p)}}),function(p,G){bS(mI,this,[p,G])}),KI=(oA(mI,yI,{_80o:function(p){this._39O(p,this._83o)}}),function(p,G){bS(KI,this,[p,G])}),aI=(oA(KI,yI,{_3O:function(){var p=this._data,G=this.s,v=this.gv,J=p.getPoints(),$=v.getBorderColor(p),S=$?G("border.width"):0,O=this.getSelectWidth(),W=G("shape.border.width"),l=p.getRect(),t=p.getAnchorRect(),v=v.getBodyColor(p),z=G("shape.border.color");(J=this._99o=J.isEmpty()?v0:{rect:l,rotation:p.getRotation(),fillRule:G("shape.fill.rule"),scale:p.getScale(),position:p.p(),points:J,segments:p.getSegments(),bodyColor:v,borderColor:$,borderWidth:S,_94o:G("shape.border.3d"),_95o:G("shape.border.3d.color"),_96o:G("shape.border.3d.accuracy"),_97o:O?this.getSelectColor():v0,selectWidth:O,_53o:G("shape.background"),_27Q:T(G("shape.repeat.image"),v),shapeGradientPack:G("shape.gradient.pack"),shapeBorderGradientPack:G("shape.border.gradient.pack"),_54o:W,_55o:z,shapeBorderRepeatImage:T(G("shape.border.repeat.image"),z),shapeGradient:G("shape.gradient"),_59o:G("shape.gradient.color"),_60o:G("shape.border.pattern"),_61o:G("shape.border.cap"),_62o:G("shape.border.join"),shapeForeground:G("shape.foreground"),gray:G("2d.gray")})&&(t.x+=J.position.x,t.y+=J.position.y,J.gradientRect=t,$=p.getScale(),v=J0(1,J0(I($.x),I($.y))),G("shape.dash")&&G("shape.dash.width")>W&&(W=G("shape.dash.width")),(z=G("shape.border.width.absolute")?(W+S+O)/this.gv._zoom/v:W*("square"===J._61o?.71:.5)+S+O/this.gv._zoom/v)&&(z*=v,l=MA(l),xE(l,z,J._62o)),this._68o(l),(t=G("clip.percentage"))!=K&&(J.clipRect=jS(p.getAnchorRect(),G("clip.direction"),t)),($=G("shape.fill.clip.percentage"))!=K&&(J.shapeClipRect=jS(p.getAnchorRect(),G("shape.fill.clip.direction"),$)),(W=G("shape.foreground.clip.percentage"))!=K&&(J.shapeForegroundClipRect=jS(p.getAnchorRect(),G("shape.foreground.clip.direction"),W)))},getPosition:function(p,G,v,J){var $=this._99o;return $?((p=b4(p,$.rect,J)).x+=G,p.y+=v,p):xi},_42:function(p){this._99o&&KI.superClass._42.call(this,p)},_80o:function(p){function G(p){return b?N.toGrayColor(p):p}var v,J=this,$=J.s,S=J._99o,O=S.position,W=S.scale,l=S.rotation,t=S.borderWidth,z=J.gv._zoom,Z=S.selectWidth/z,B=S._27Q,f=S.shapeGradientPack,X=S._54o,q=S.clipRect,g=S.shapeClipRect,M=S.points,L=S.segments,H=J._data.isClosePath(),_=S.fillRule,b=S.gray,n=G(S._53o),D=n||B||f,l=(p.save(),JE(p,O.x,O.y),$E(p,l),SE(p,W.x,W.y),q&&(p.beginPath(),p.rect(q.x,q.y,q.width,q.height),p.clip()),D&&g&&(p.save(),p.beginPath(),p.rect(g.x,g.y,g.width,g.height),p.clip()),MA(S.rect)),W=(E.Default.extractShapeTranslation?((M=MA(M)).forEach(function(p){p.x-=O.x,p.y-=O.y}),l.x-=O.x,l.y-=O.y):JE(p,-O.x,-O.y),$("shape.border.width.absolute")),q=S._60o,Y=(W&&q&&(q=q.map(function(p){return p*z})),Hm(p,q)),s=p.lineJoin,c=p.lineCap,h=(p.lineJoin=S._62o,p.lineCap=S._61o,G(S.bodyColor));D?(KE(p,M,L,H),f?NE(p,f,function(p){return IE(p,S.bodyColor)},!1,l):B?FE(p,B,h,null,J._data,J.gv):UE(p,v=h||n,S.shapeGradient,G(S._59o),S.gradientRect),p.fill(_),f&&p.restore(),g&&(p.restore(),JE(p,-O.x,-O.y)),Y!==p&&KE(Y,M,L,H)):KE(Y,M,L,H),(D=S.shapeForeground)&&(p.save(),(B=S.shapeForegroundClipRect)&&(JE(p,O.x,O.y),p.beginPath(),p.rect(B.x,B.y,B.width,B.height),p.clip(),JE(p,-O.x,-O.y)),KE(p,M,L,H),UE(p,D,$("shape.foreground.gradient"),G($("shape.foreground.gradient.color")),S.gradientRect),p.fill(_),p.restore()),W&&(p.save(),p.setTransform(1,0,0,1,0,0)),Z&&(p.strokeStyle=S._97o,p.lineWidth=X+2*(t+Z),p.stroke()),t&&(p.strokeStyle=G(S.borderColor),p.lineWidth=X+2*t,p.stroke()),X&&(v=G(S._55o),(f=S.shapeBorderGradientPack)?NE(p,f,G,!0,l):S.shapeBorderRepeatImage?CE(p,S.shapeBorderRepeatImage,v,null,J._data,J.gv):p.strokeStyle=v=!n&&h?h:v,p.lineWidth=X,p.stroke(),f&&p.restore(),S._94o&&uE(p,v,G(S._95o),X,z,S._96o)),_m(p,q),$("shape.dash")&&0<(g=$("shape.dash.width")||X)&&(q=$("shape.dash.pattern"),W&&(q=q.map(function(p){return p*z})),(Y=Hm(p,q,J._2Q("shape.dash.offset")))!==p&&KE(Y,M,L,H),J._1Q(p,"shape",g,q)),W&&p.restore(),p.lineJoin=s,p.lineCap=c,p.restore()},_48O:function(){},_47O:function(p){}}),function(p,G){bS(aI,this,[p,G])}),uI=(oA(aI,KI,{getRotation:(Mh=new H,Lh=new H,Hh=new ch,function(p,G,v){p=p||0;var J,$,S=this._data,O=S.getPoints(),W=O.size();return 1<W?($=S.p(),S=S.getScale(),Hh.identity().translate(-$.x,-$.y).scale(S.x,S.y).translate($.x,$.y),$=vj[v]?(J=O.get((S=(W-W%2)/2)-1),O.get(S)):Gj[v]?(J=O.get(0),O.get(1)):(J=O.get(W-2),O.get(W-1)),Hh.apply(J,Mh),Hh.apply($,Lh),Yj(Mh,Lh,G,p)):p}),getPosition:(Xh=new H,qh=new H,gh=new H,function(p,G,v,J,$){var S=this._data,O=S.getPoints(),W=O.size();if(1<W){if(S=S.getPointsMatrix2d(),vj[p]){var l=W%2,t=(W-l)/2,z=O.get(t-1),t=O.get(t);if(0!=l)return(l=b4(p,xi,J)).x+=G,l.y+=v,S.apply(z,Xh),S.apply(t,qh),S.identity().rotate(gh.copy(qh).sub(Xh).angle()).apply(l,Xh).add(qh)}else t=Gj[p]?(z=O.get(0),O.get(1)):(z=O.get(W-2),O.get(W-1));return S.apply(z,Xh),S.apply(t,qh),sj(Xh,qh,p,G,v,J,$)}return xi})}),function(p,G){bS(uI,this,[p,G])}),TI=(oA(uI,yI,{_3O:function(){uI.superClass._3O.call(this);var p=this.s,G=this._83o;this._82o=G.img||G.shape?v0:{background:this.getBodyColor("grid.background"),depth:p("grid.depth"),rect:G.rect,_88o:p("grid.cell.depth"),cellBorderColor:p("grid.cell.border.color"),_89o:p("grid.row.count"),_90o:p("grid.column.count"),block:p("grid.block"),_91o:p("grid.block.color"),_92o:p("grid.block.padding"),_93o:p("grid.block.width")}},_80o:function(p){var G=this._82o;if(G){var v,J,$=this._data,S=G.background,O=G.rect,W=G.block,l=G._91o,t=G._92o,z=G._93o,Z=G._88o,B=G.cellBorderColor,f=G._89o,X=G._90o;if(S)if(VE(p,O.x,O.y,O.width,O.height,S),$4(p,S,G.depth,O),Z)for(v=0;v<f;v++)for(J=0;J<X;J++)(O=$.getCellRect(v,J))&&$4(p,S,Z,O);else if(B){for(p.beginPath(),v=0;v<f;v++)for(J=0;J<X;J++)(O=$.getCellRect(v,J))&&p.rect(O.x,O.y,O.width,O.height);p.strokeStyle=B,p.lineWidth=1,p.stroke()}if("h"===W)for(v=0;v<f;v++)O=eA($.getCellRect(v,0),$.getCellRect(v,X-1)),xA(O,t),J4(p,l,O.x,O.y,O.width,O.height,z);else if("v"===W)for(J=0;J<X;J++)O=eA($.getCellRect(0,J),$.getCellRect(f-1,J)),xA(O,t),J4(p,l,O.x,O.y,O.width,O.height,z);this._39O(p,this._83o)}else uI.superClass._80o.call(this,p)}}),function(p,G){bS(TI,this,[p,G])}),VI=B?xS().getContext("2d"):v0,J=(oA(TI,yI,{_checkEmptyRect:!1,_81o:function(){var O,p,W,G,v,J,l,t,$,S,z,Z,B,f,X,q=this._data,g=TI.superClass._81o.call(this),M=q.s("text");return M!=v0&&(M+="",O=q.s("text.font"),f=q.s("text.align"),p=q.s("text.vAlign"),Z=q.s("text.wrap"),z=q.s("text.vertical"),W=q.s("text.vertical.gap"),X=q.s("text.letter.gap")||0,G=q.getWidth(),v=q.getHeight(),null==W&&(W=1),z?(l=((B=Z?uS(M,v,O,X,z,W):[M]).length-1)*X,t=0,VI.textBaseline=pJ,VI.font=O,B.forEach(function(p){for(var G=p.length,v=0,J=(G-1)*W,$=0;$<G;$++){var S=VI.measureText(p[$]);J+=S.fontBoundingBoxDescent||DA(O,p[$]).height,v=J0(v,S.width)}l+=v,t=J0(J,t)}),B.length,B.forEach(function(p){}),J={width:l,height:t}):1<(Z=(B=Z?uS(M,G,O,X,z,W):M.split("\n")).length)?(z=DA(O,M).height,l=0,t=z*Z+W*(Z-1),B.forEach(function(p){l=J0(l,DA(O,p).width)}),J={width:l,height:t}):(J=DA(O,M),X&&(J.width+=(M.length-1)*X)),z=J.width,Z=J.height,B=q.getAnchor(),"left"===f?$=-G*B.x:"center"===f?$=-G*B.x+(G-z)/2:"right"===f&&($=G*(1-B.x)-J.width),"top"===p?S=-v*B.y:"middle"===p?S=-v*B.y+(v-Z)/2:"bottom"===p&&(S=v*(1-B.y)-J.height),M=q.getMatrix(),X=rA([M.tf($,S),M.tf($+z,S),M.tf($+z,S+Z),M.tf($,S+Z)]),(g=eA(g,X))&&q.s("text.shadow")&&((f=MA(g)).x+=q.s("text.shadow.offset.x"),f.y+=q.s("text.shadow.offset.y"),xA(f,q.s("text.shadow.blur")),g=eA(g,f))),g}}),wj.Interactor=function(p){this.gv=this._graphView=p}),oI=(p("Interactor",d,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners(),this.clear()},clear:function(){},fi:function(p){this.gv.fi(p)},setCursor:function(p){u0||this.gv.setCursor(p)},startDragging:function(p){this._lastClientPoint=i(p),this._lastLogicalPoint=this.gv.lp(p),mA(this,p)},clearDragging:function(p){this._lastClientPoint=this._lastLogicalPoint=this._logicalPoint=v0},autoScroll:function(p){return this.gv.autoScroll(p,this._lastClientPoint)}}),v0),UI=function(p){oI.handleWindowTouchMove(p)},FI=function(p){oI.handleWindowTouchEnd(p),_0(h,pi,UI),_0(h,Gi,FI),oI=v0},CI=function(p){oI.handleWindowMouseMove(p)},QI=function(p){oI.handleWindowMouseUp(p),_0(h,Ul,CI),_0(h,Fl,QI),oI=v0},p3=function(p){var G=this;G.gv=p,G._is2d=p instanceof wj.GraphView,G._eventListeners={},["mousedown","mousemove","mouseleave","touchstart","touchmove","touchend","mouseup",$i,"wheel"].forEach(function(p){G.addListener(p)}),G.initImageResource()},G3=(oA(p3,J,{enableVR:function(p){!!this._vrEnable!==p&&((this._vrEnable=p)?this.gv.vr.mp(this.onVRControllerChange,this):this.gv.vr.ump(this.onVRControllerChange,this))},onVRControllerChange:function(p){var G=p.property,v=(p=p.newValue).id,J=this.gv.vr.getController(v).getRay();if(J)switch(J.controllerId=v,this.gv.vr.getRayEventType(J,G,p[Yl])){case"down":this.handle_mousedown(J);break;case"up":oI&&QI(J);break;case"move":this.handle_mousemove(J),oI&&this.handleWindowMouseMove(J)}},setPreventEventDefault:function(p,G){var v=this._eventListeners[p];v?v._prevent=G:this._eventListeners[p]=v={_removal:K,_prevent:G}},removeListener:function(p){(p=this._eventListeners[p])&&p._removal&&(p._removal(),p._removal=K)},addListener:function(G){var p,v=this,J=v._eventListeners[G];J||(v._eventListeners[G]=J={_removal:K,_prevent:!0}),J&&J._removal||(p=function(p){J._prevent&&N.preventDefault(p),v.disabled||v.gv._48Q||("wheel"===G?LS(v,p):v["handle_"+G](p))},H0(v.gv.getView(),G,p),J._removal=function(){_0(v.gv.getView(),G,p)})},handleWindowTouchMove:function(p){this.handleWindowMouseMove(p)},handleWindowMouseMove:function(p){!this.downInfo||ZE(p)&&1!==hA(p)?this.isDragging&&(this.handleDownInfo("onEndDrag",p),this.isDragging=!1):this.isDragging?this.handleDownInfo("onDrag",p):(this.handleDownInfo("onBeginDrag",p),this.isDragging=!0)},handleWindowTouchEnd:function(p){this.handleWindowMouseUp(p)},handleWindowMouseUp:function(p){if(this.isDragging&&(this.handleDownInfo("onEndDrag",p),this.isDragging=!1),this.downInfo){var G=this.handle("onUp",p);if(G&&G.data===this.downInfo.data){this.handleMissingUp(p);var v=this,J=2===p.button?"onContextMenu":"onClick";if(G.data.s("disableDoubleClick")||!v._dbclickTimer)return void(v._dbclickTimer=I0(function(){delete v._dbclickTimer,v.handleClick(p,J,G),v.downInfo=v0},N.clickDelay));E0(v._dbclickTimer),delete v._dbclickTimer,J="onDoubleClick",v.handleClick(p,J,G)}else this.handleDownInfo("onUp",p);this.downInfo=v0,this.downComps=v0}},handle_mouseleave:function(p){var G=this,v=G.gv,J=(G._hoverTimer&&(E0(G._hoverTimer),delete G._hoverTimer),G.currentInfo?G.currentInfo.data:v0);if(J){if(J.s("onLeave")&&J.s("onLeave")(p,J,v),G.fire("data","onLeave",p,J),v=G.currentInfo?G.currentInfo.hits:v0)for(var $ in v)G.handleLeave(p,$);G.currentInfo=v0}},handle_mousewheel:function(p){p.scrollDelta=p.wheelDelta/40,this.handle("onScroll",p)},handle_DOMMouseScroll:function(p){p.scrollDelta=2===p.axis?-p.detail:0,this.handle("onScroll",p)},handle_touchstart:function(p){this.handle_mousedown(p)},handle_touchmove:function(p){this.handle("onMove",p)},handle_mousedown:function(p){var G;this.isDragging&&(this.handleDownInfo("onEndDrag",p),this.isDragging=!1),this.downComps=[],this.downInfo=this.handle("onDown",p),this.downInfo&&this!==oI&&(G=ZE(p),oI?G?oI.handleWindowTouchEnd(p):oI.handleWindowMouseUp(p):G?(H0(h,pi,UI),H0(h,Gi,FI)):(H0(h,Ul,CI),H0(h,Fl,QI)),oI=this)},handle_touchend:function(p){this.handle_touchend(p)},handle_mouseup:function(p){this.downInfo||this.isDragging||this.handle("onUp",p)},handle_mousemove:function(p){var G=this,v=G.gv;if(G._hoverTimer&&(E0(G._hoverTimer),delete G._hoverTimer),!v._panning&&!v._moving){var J,$,S,O=G.handle("onMove",p),W=this.currentInfo?this.currentInfo.data:v0,l=this.currentInfo?this.currentInfo.hits:v0;if(O&&($=O.data,S=O.hits,G._hoverTimer=I0(function(){E0(G._hoverTimer),delete G._hoverTimer,G.handle("onHover",p,O)},v.getHoverDelay()||N.hoverDelay)),$!==W){if(W&&(W.s("onLeave")&&W.s("onLeave")(p,W,v),this.fire("data","onLeave",p,W)),$&&($.s("onEnter")&&$.s("onEnter")(p,$,v),this.fire("data","onEnter",p,$)),l)for(J in l)this.handleLeave(p,J);if(S)for(J in S){var t,z,Z=S[J];(z=(t=$._interactPrefix=Z.prefix)&&$.a(t+"onEnter")||Z.target.onEnter)&&z.call(Z.target,p,$,v,Z.point,Z.width,Z.height),this.fire(Z.type,"onEnter",Z.event,Z.data,Z.image,Z.comp,Z.point,Z),$._interactPrefix=null}}else{if(l)for(J in l)S&&S[J]||this.handleLeave(p,J);if(S)for(J in S)l&&l[J]||(Z=S[J],(z=(t=$._interactPrefix=Z.prefix)&&$.a(t+"onEnter")||Z.target.onEnter)&&z.call(Z.target,p,$,v,Z.point,Z.width,Z.height),this.fire(Z.type,"onEnter",Z.event,Z.data,Z.image,Z.comp,Z.point,Z),$._interactPrefix=null)}this.currentInfo=O}},handle:function(p,G,v){var J,$=this.gv;if(this._is2d){if((v=v||$.getDataInfoAt(G))&&$.isInteractive(v.data))return(J=v.ui.interactiveInfo)&&((O=v.data).s(p)&&O.s(p)(G,O,$),this.fire("data",p,G,O),"body"===v.part&&J.bodyInfo?v.hits=this.handleImage(S="body",$.getImage(O),p,G,O,v.point,J.bodyInfo):"icons"===v.part&&J._38o&&(z=J._38o[v.name])&&z[v.index]&&(S="icons|"+v.name+"|"+v.index,v.hits=this.handleImage(S,v.icon,p,G,O,v.point,z[v.index]))),v}else{if(!v)if(G&&G instanceof E.Math.Ray&&$.isVREnabled()){var S=$.vr.intersectWorld(G),O=S.data,W=S.intersect;if($.vr.renderRayDuringInteraction(G,O,W),!O)return;if(!(J=(l=$.getData3dUI(O)).interactiveInfo))return;v={data:O,part:W.part,ui:l}}else{if(!(v=this.getDataInfoAt(G)))return;v=v&&{data:v.data,part:v.part}}if($.isInteractive(v.data)){if(!W){O=v.data;var l=$.getData3dUI(O);if(!(J=(v.ui=l).interactiveInfo))return v;if(!(W=$.intersectObject(G,O)))return v}O.s(p)&&O.s(p)(G,O,$),this.fire("data",p,G,O);var t,z=W.part;return(t=(t="body"!==z?O.s(z+".image")||O.s("shape3d."+z+".image"):t)||O.s("all.image")||O.s("shape3d.image"))&&(J="object"==typeof t?J[t.uuid]:J[t])&&J.bodyInfo&&(v.part="body",v.interactiveInfo=J,v.point=this._convertUVToPoint(W.uv,J,O,z,t),v.image=t,v.hits=this.handleImage("body",t,p,G,O,v.point,J.bodyInfo)),v}}},_handleLeaveOrMissing:function(p,G,v){var J,$,S,O,W,l="leave"===p?this.currentInfo:this.downInfo;l&&(J=l.interactiveInfo||l.ui.interactiveInfo)&&($=l.data,this._is2d?(O=this.gv.lp(G),"body"===l.part&&J.bodyInfo?(W="body","leave"===p?this.handleLeaveImage(v,W,this.gv.getImage($),G,$,O,J.bodyInfo):this.handleMissingUpImage(W,this.gv.getImage($),G,$,O,J.bodyInfo)):"icons"===l.part&&J._38o&&(S=J._38o[l.name])&&S[l.index]&&(W="icons|"+l.name+"|"+l.index,"leave"===p?this.handleLeaveImage(v,W,l.icon,G,$,O,S[l.index]):this.handleMissingUpImage(W,l.icon,G,$,O,S[l.index]))):J.bodyInfo&&(O=(W=this.gv.intersectObject(G,$))&&W.uv?this._convertUVToPoint(W.uv,J,$,W.part,l.image):{x:1/0,y:1/0},"leave"===p?this.handleLeaveImage(v,"body",l.image,G,$,O,J.bodyInfo):this.handleMissingUpImage("body",l.image,G,$,O,J.bodyInfo)))},handleClick:function(p,G,v){var J,$,S,O,W=this.downInfo;W&&v&&(J=v.interactiveInfo||v.ui.interactiveInfo,$=v.data,O=this.gv,$.s(G)&&$.s(G)(p,$,O),this.fire("data",G,p,$),J&&(this._is2d?W.part===v.part&&(S=O.lp(p),"body"===v.part&&J.bodyInfo&&this.handleClickImage("body",O.getImage($),G,p,$,S,J.bodyInfo,v)):J.bodyInfo&&(O=O.intersectObject(p,$))&&(S=this._convertUVToPoint(O.uv,J,$,O.part,W.image),this.handleClickImage("body",W.image,G,p,$,S,J.bodyInfo,v))))},handleDownInfo:function(p,G){var v,J,$,S,O,W,l,t;this.downInfo&&(v=this.downInfo,J=this.gv,($=v.interactiveInfo||v.ui.interactiveInfo)&&((O=v.data).s(p)&&O.s(p)(G,O,J),this.fire("data",p,G,O),this._is2d?(W=J.lp(G),"body"===v.part&&$.bodyInfo?this.handleDownInfoImage(S="body",J.getImage(O),p,G,O,W,$.bodyInfo):"icons"===v.part&&$._38o&&(l=$._38o[v.name])&&l[v.index]&&(S="icons|"+v.name+"|"+v.index,this.handleDownInfoImage(S,v.icon,p,G,O,W,l[v.index]))):$.bodyInfo&&("onBeginDrag"===p?(t=J._raycaster.intersectObjectAndRecordTriangle(G,O))&&($.beginDragIntersectInfo=t.triangleInfo):t=J.intersectObject(G,O),(t=t||("onDrag"!==p&&"onEndDrag"!==p||!$.beginDragIntersectInfo?t:J._raycaster.intersectLastTriangle(G,$.beginDragIntersectInfo)))&&(W=this._convertUVToPoint(t.uv,$,O,t.part,v.image),this.handleDownInfoImage("body",v.image,p,G,O,W,$.bodyInfo)))))},fire:function(p,G,v,J,$,S,O,W){this.gv.fi({kind:G,type:p,event:v,data:J,image:$,comp:S,view:this.gv,point:O,width:W?W.width:K,height:W?W.height:K})},handleImage:function(p,G,v,J,$,S,O){var W={};if(G=G&&T(G))for(var l,t=this.gv,z=O.rect,Z=((X=this.convertPoint(S,O)).inRect&&(G[v]&&G[v](J,$,t,X,z.width,z.height),this.fire("image",v,J,$,G,K,X,z),W[p+"|image"]={target:G,type:"image",image:G,data:$,event:J,point:X,width:z.width,height:z.height}),O.compInfos),B=G,f=Z.length-1;0<=f;f--){var X,q=(g=Z[f]).comp;if((X=this.convertPoint(S,g,B,q,t,$)).inRect){var g,z=g.rect,M=(g=$._interactPrefix=g.prefix)&&$.a(g+v)||q[v];if(M&&(l=M.call(q,J,$,t,X,z.width,z.height)),this.fire("comp",v,J,$,G,q,X,z),!0!==l&&(G=z.image)&&(G[v]&&(l=G[v](J,$,t,X,z.width,z.height)),this.fire("image",v,J,$,G,K,X,z)),$._interactPrefix=null,W[p+"|"+f]={target:q,type:"comp",comp:q,image:G,data:$,event:J,point:X,width:z.width,height:z.height,prefix:g},this.downComps&&this.downComps.push(q),G&&(W[p+"|"+f+"|image"]={target:G,type:"image",image:G,data:$,event:J,point:X,width:z.width,height:z.height,prefix:g}),!0===l)break}}return W},handleLeave:function(p,G){return this._handleLeaveOrMissing("leave",p,G)},handleMissingUp:function(p){return this._handleLeaveOrMissing("missing",p)},handleLeaveImage:function(p,G,v,J,$,S,O){if(v=v&&T(v))for(var W,l=this.gv,t=O.rect,z=this.convertPoint(S,O),Z=(p===G+"|image"&&(v.onLeave&&v.onLeave(J,$,l,z,t.width,t.height),this.fire("image","onLeave",J,$,v,K,z,t)),O.compInfos),B=v,f=Z.length-1;0<=f;f--){var X=(q=Z[f]).comp,z=this.convertPoint(S,q,B,X,l,$),t=q.rect,q=$._interactPrefix=q.prefix;if(p===G+"|"+f&&((q=q&&$.a(q+"onLeave")||X.onLeave)&&(W=q.call(X,J,$,l,z,t.width,t.height)),this.fire("comp","onLeave",J,$,v,X,z,t)),!0!==W&&(v=t.image)&&p===G+"|"+f+"|image"&&(v.onLeave&&(W=v.onLeave(J,$,l,z,t.width,t.height)),this.fire("image","onLeave",J,$,v,K,z,t)),!($._interactPrefix=null)===W)break}},handleMissingUpImage:function(p,G,v,J,$,S){var O="onUp",W=this.downInfo.hits;if(W&&G&&(G=T(G)))for(var l,t=this.gv,z=S.rect,Z=(!(X=this.convertPoint($,S)).inRect&&W[p+"|image"]&&(G.onUp&&G.onUp(v,J,t,X,z.width,z.height),this.fire("image",O,v,J,G,K,X,z)),S.compInfos),B=G,f=Z.length-1;0<=f;f--){var X,q=(g=Z[f]).comp;if(!(X=this.convertPoint($,g,B,q,t,J)).inRect){var z=g.rect,g=J._interactPrefix=g.prefix;if(W[p+"|"+f]&&((g=g&&J.a(g+O)||q.onUp)&&(l=g.call(q,v,J,t,X,z.width,z.height)),this.fire("comp",O,v,J,G,q,X,z)),!0!==l&&(G=z.image)&&W[p+"|"+f+"|image"]&&(G.onUp&&(l=G.onUp(v,J,t,X,z.width,z.height)),this.fire("image",O,v,J,G,K,X,z)),!(J._interactPrefix=null)===l)break}}},handleDownInfoImage:function(p,G,v,J,$,S,O){var W=this.downInfo.hits;if(W&&G&&(G=T(G)))for(var l,t=this.gv,z=O.rect,Z=this.convertPoint(S,O),B=(W[p+"|image"]&&(G[v]&&G[v](J,$,t,Z,z.width,z.height),this.fire("image",v,J,$,G,K,Z,z)),O.compInfos),f=G,X=B.length-1;0<=X;X--){var q=(g=B[X]).comp,Z=this.convertPoint(S,g,f,q,t,$),z=g.rect,g=$._interactPrefix=g.prefix,M=0<=["onDrag","onEndDrag"].indexOf(v);if((!M&&W[p+"|"+X]||M&&this.downComps&&0<=this.downComps.indexOf(q))&&((M=g&&$.a(g+v)||q[v])&&(l=M.call(q,J,$,t,Z,z.width,z.height)),this.fire("comp",v,J,$,G,q,Z,z)),!0!==l&&(G=z.image)&&W[p+"|"+X+"|image"]&&(G[v]&&(l=G[v](J,$,t,Z,z.width,z.height)),this.fire("image",v,J,$,G,K,Z,z)),!($._interactPrefix=null)===l)break}},handleClickImage:function(p,G,v,J,$,S,O,W){var l=this.downInfo.hits,t=W.hits;if(l&&G&&(G=T(G)))for(var z,Z=this.gv,B=O.rect,f=this.convertPoint(S,O),X=(l[p+"|image"]&&(G[v]&&G[v](J,$,Z,f,B.width,B.height),this.fire("image",v,J,$,G,K,f,B)),O.compInfos),q=G,g=X.length-1;0<=g;g--){var M=(L=X[g]).comp,f=this.convertPoint(S,L,q,M,Z,$),B=L.rect,L=$._interactPrefix=L.prefix;if(l[p+"|"+g]&&t[p+"|"+g]&&((L=L&&$.a(L+v)||M[v])&&(z=L.call(M,J,$,Z,f,B.width,B.height)),this.fire("comp",v,J,$,G,M,f,B)),!0!==z&&(G=B.image)&&l[p+"|"+g+"|image"]&&(G[v]&&(z=G[v](J,$,Z,f,B.width,B.height)),this.fire("image",v,J,$,G,K,f,B)),!($._interactPrefix=null)===z)break}},initImageResource:function(){N.setImage("coreInteractorRayHitImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",opacity:.3,rotation:-1.593,rect:[.73315,.6933,14.5337,14.61341]},{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",rotation:-1.593,rect:[3.56695,3.75073,8.8661,8.49856]}]})},_convertUVToPoint:function(p,G,v,J,$){if(!p)return{x:1/0,y:1/0};var S,G=G.bodyInfo.rect,J=(v&&$&&(J="body"===J?(S=v.s("shape3d.uv.scale"),v.s("shape3d.uv.offset")):(S=v.s(J+".uv.scale")||v.s("all.uv.scale"),v.s(J+".uv.offset")||v.s("all.uv.offset")),(S||J)&&($=N.getImage($),v=sh.isPOT($.width)&&sh.isPOT($.height),$=p.x*(S?S[0]:1)+(J?J[0]:0),S=p.y*(S?S[1]:1)+(J?J[1]:0),v&&($=$%1+(0<$?0:1),S=S%1+(0<S?0:1)),p.set($,S))),p.clone());return(v=p.multiply({x:G.width,y:G.height})).local=J,v},convertPoint:function(p,G,v,J,$,S){var O=G.rect,W=G.matrix.applyInverse(p).sub(O);if(!(0<=W.x&&0<=W.y&&W.x<=O.width&&W.y<=O.height))return W;if(J&&V(J.pixelPerfect,S,$)){var l=1,t=!1,p=(O=this._is2d?(l=$.getZoom(),pS(p.x,p.y,K,l)):pS(p.x,p.y)).x,z=O.y,Z=O.width,B=Z*(O=O.height)*l*l,f=((f=N.hitMaxArea)<B&&(l*=Math.sqrt(f/B)),p*=l,z*=l,kE(Z=(Z*=l)<2?2:Z,O=(O*=l)<2?2:O)),p=((B=new ch(0,-p,-z,l,l)).append(G.matrix),$._drawForChecking=!0,J.transform=B,v.fitSize),z=(G.refRect&&G.refRect.fitSize?(J.refRect=G.refRect,v.fitSize=!0):v.fitSize=!1,v.comps);v.comps=[J],Im(f,v,0,0,Z,O,S,self),v.comps=z,v.fitSize=p,delete J.refRect,delete J.unionRect,delete J.transform,$._drawForChecking=!1;try{for(var X=0,q=f.getImageData(0,0,Z,O).data;X<q.length;X+=4)if(0!==q[X+3]){t=!0;break}f.restore()}catch(p){AE=v0,t=!1}W.inRect=t}else W.inRect=!0;return W},getDataInfoAt:function(p,G){return $k.prototype.getDataInfoAt.call(this,p,G)}}),wj.DefaultInteractor=function(p){bS(G3,this,[p])}),v3=(p("DefaultInteractor",J,{handle_mousedown:function(p){tA(p);var G,v=this.gv,J=v.getDataAt(p);!v.setFocus(p)||v._editing||v._scrolling||(wA(p)?v.handleDoubleClick(p,J):v.handleClick(p,J),G=sA(p),!PE()&&!G&&J&&(v.isMovable(J)||v._39Q(J))||!v.isPannable()||!YA(p)&&!G||PA(p)||(this._tx=v.tx(),this._ty=v.ty(),this.startDragging(p)))},handleWindowMouseUp:function(p){var G=this.gv;G._panning&&(delete G._panning,G.onPanEnded(),this.fi({kind:"endPan",event:p})),delete this._tx,delete this._ty,this.clearDragging()},handle_mousemove:function(p){var G=this,v=G.gv;G._hoverTimer&&(E0(G._hoverTimer),delete G._hoverTimer),G._hoverTimer=I0(function(){G.fi({kind:"hover",event:p}),E0(G._hoverTimer),delete G._hoverTimer},v.getHoverDelay()||N.hoverDelay)},handle_mouseleave:function(p){this._hoverTimer&&(E0(this._hoverTimer),delete this._hoverTimer)},handleWindowMouseMove:function(p){var G=this.gv,p=(this.fi({kind:G._panning?"betweenPan":"beginPan",event:p}),G._panning=1,_j(G,p,this._lastClientPoint));G.setTranslate(this._tx+p.x,this._ty+p.y)},handle_mousewheel:function(p){this.gv.handleScroll(p,p.wheelDelta)},handle_DOMMouseScroll:function(p){2===p.axis&&this.gv.handleScroll(p,-p.detail)},handle_keydown:function(p){this.gv.handleKeyDown(p)}}),wj.SelectInteractor=function(p){bS(v3,this,[p])}),J3=(p("SelectInteractor",J,{_42:function(){var p=this.gv,G=p.getZoom(),v=this.mark,J=this.div,$=(J||(J=this.div=yS(),KS(this.getView(),J)),{});$.x=v.x*G+p.tx(),$.y=v.y*G+p.ty(),$.width=v.width*G,$.height=v.height*G,P(J,$),this.intersects()?(J.style.border="",J.style.background=p.getRectSelectBackground()):(J.style.background="",J.style.border="1px solid "+p.getRectSelectBorderColor())},handle_mousedown:function(p){var G,v,J=this.gv;this._57I=v0,this.pendingClickThrough=v0,J._editing||J._scrolling||PE()||sA(p)||(G=J.getDataAt(p),v=J.sm(),G?PA(p)?v.co(G)?v.rs(G):v.as(G):v.co(G)?G instanceof hI&&G.isClickThroughEnabled()&&YA(p)&&(this.pendingClickThrough=i(p)):v.ss(G):PA(p)||!J.isPannable()?YA(p)&&(PA(p)||v.cs(),J.isRectSelectable()&&(this.startDragging(p),J._77O=1)):YA(p)&&(this._57I=i(p)))},handle_mouseup:function(p){var G,v=this.gv,J=this._57I;J&&(iA(J,i(p))<=1&&v.sm().cs(),this._57I=v0),this.pendingClickThrough&&(iA(this.pendingClickThrough,i(p))<=1&&(G=v.getDataAt(p))instanceof hI&&G.isClickThroughEnabled()&&(J=v.getDataAt(p,function(p){return p.getParent()===G&&v.isSelectable(p,!0)}))&&(p.clickThrough=!0,v.sm().ss(J)),this.pendingClickThrough=v0)},handleWindowMouseUp:function(p){this.clear(p)},handleWindowMouseMove:function(p){var G=this,v=G.gv;G._logicalPoint=v.lp(p),G.mark?(G.fi({kind:"betweenRectSelect",event:p}),v.isPannable()&&G.autoScroll(p),G.redraw()):G.fi({kind:"beginRectSelect",event:p}),G.mark=rA(G._lastLogicalPoint,G._logicalPoint),G.redraw()},intersects:function(){var p=this._lastLogicalPoint,G=this._logicalPoint;return p.x>G.x||p.y>G.y},clear:function(p){var G,v,J,$,S=this,O=S.gv,W=S.mark;S._57I=v0,S.pendingClickThrough=v0,S._lastLogicalPoint&&(W&&(0===W.width||0===W.height||(W=O.getDatasInRect(W,S.intersects())).isEmpty()||(G=O.sm(),v=G.toSelection(),J=dA(p),$=p.altKey,W.each(function(p){G.co(p)?J&&!$||v.remove(p):(!$||J&&$)&&v.add(p)}),G.ss(v)),KA(S.div),delete S.div,delete S.mark,S.redraw(),S.fi({kind:"endRectSelect",event:p}),O.onRectSelectEnded()),S.clearDragging(),delete O._77O)},redraw:function(){var p=this;p._draw||(p._draw=1,I0(function(){p.mark&&p._42(),delete p._draw},16))}}),wj.MoveInteractor=function(p){bS(J3,this,[p])}),$3=(p("MoveInteractor",J,{handle_mousedown:function(p){var G,v=this.gv;!YA(p)||v._editing||v._scrolling||PE()||(!(G=v.getSelectedDataAt(p))||v._39Q(G)&&!v.isMovable(G)?v._focusData=v0:(this._data=G,v.handleMouseDown&&v.handleMouseDown(p,G),this.startDragging(p),v.isMovable(G)&&(v._moving=1)))},handleWindowMouseUp:function(p){var G=this.gv;G.handleMouseUp&&G.handleMouseUp(p,this._data),this.clear(p)},handleWindowMouseMove:function(p){var G,v,J,$,S=this,O=S._data,W=S.gv;W._93O&&W._93O(p,O)||W._moving&&(S._logicalPoint||S.fi({kind:"prepareMove",event:p}),G={kind:$=S._logicalPoint?"betweenMove":"beginMove",event:p},v=S._logicalPoint=W.lp(p),"beginMove"!=$||S._alreadyBeginTransaction||(S._alreadyBeginTransaction=!0,W.getDataModel().beginTransaction()),J=($=S._calcShift($,p)).x,$=$.y,(O=S.gv.getMoveMode(p,O))&&("x"===O?$=0:"y"===O?J=0:"xy"!==O&&(J=$=0)),W.moveSelection(J,$),S._lastLogicalPoint=v,S.autoScroll(p),S.fi(G))},_calcShift:function(p,G){var v=this._logicalPoint,J=this._lastLogicalPoint;return{x:v.x-J.x,y:v.y-J.y}},clear:function(p){var G=this.gv;this._lastLogicalPoint&&(this._lastLogicalPoint=this._data=G._moving=v0,this._logicalPoint&&(this.fi({kind:"endMove",event:p}),G.onMoveEnded()),this.clearDragging()),this._alreadyBeginTransaction&&(this._alreadyBeginTransaction=!1,G.getDataModel().endTransaction())}}),wj.TextEditInteractor=function(p){bS($3,this,[p]),this.init()}),S3=(p("TextEditInteractor",J,{setUp:function(){$3.superClass.setUp.call(this),this.gv.mp(this.handleGvPropertyChange,this)},teatDown:function(){$3.superClass.teatDown.call(this),this.gv.ump(this.handleGvPropertyChange,this)},handleGvPropertyChange:function(p){this._editTarget&&this.endTextEdit()},init:function(){function p(p){p.stopPropagation()}var v=this,G=this.input=B.createElement("input"),J=G.style,$=(G.text="text",J.border="1px solid #d8d8d8",J.position="absolute",J.padding="2px 3px",J.outline="none",J.marginLeft="-90px",J.marginTop="-16px",J.backgroundColor="rgba(255,255,255, 1)",J.fontSize="14px",J.width="180px",J.height="32px",J.boxShadow="0 0 13px rgba(16,142,233, 0.5)",J.textAlign="center",J.boxSizing="border-box",H0(G,"keyup",function(p){jE(p)&&v.endTextEdit(),iE(p)&&v.endTextEdit(!0)}),H0(G,"focus",function(p){G.select()}),this.textarea=B.createElement("textarea")),S=this.wrap=B.createElement("div");S.appendChild($),(J=$.style).margin=0,J.padding="4px",J.overflow="hidden",J.boxSizing="border-box",J.position="absolute",J.outline="none",J.backgroundColor="transparent",J.resize="none",J.textAlign="center",J.fontSize="14px",J.borderWidth=0,J.width="100%",(J=S.style).boxSizing="border-box",J.margin=0,J.padding=0,J.position="absolute",J.boxShadow="0 0 13px rgba(16,142,233, 0.5)",J.border="1px solid #d8d8d8",J.backgroundColor="rgba(255,255,255, 1)",J.zIndex="10",H0($,"keydown",function(p){(dA()||PA())&&jE(p)?v.endTextEdit():iE(p)?v.endTextEdit(!0):v._editTarget instanceof wI||v.calculateTextareaHeight(String.fromCharCode(p.keyCode))}),H0($,"focus",function(p){$.select()}),H0(G,"mousedown",p),H0(G,"touchstart",p),H0($,"mousedown",p),H0($,"touchstart",p),H0($,"click",p),v.SIZING_STYLE=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"],v.HIDDEN_TEXTAREA_STYLE="visibility:hidden; min-height:0 !important;max-height:none !important;height:0 !important;visibility:hidden !important;overflow:hidden !important;position:absolute !important;z-index:-1000 !important;top:0 !important;right:0 !important",v.handleWindowClick=function(p){var G=v._editingDOM;G&&(G=G.getBoundingClientRect(),p=i(p),AA(G,p)||v.endTextEdit())}},handle_mousedown:function(p){var G,v=this.gv;wA(p)&&!v._editing&&(p=v.getDataAt(p))&&(G=v.getTextEditInfo(p))&&(this._editInfo=G,this._editTarget=p,v._editing=!0,G.isMultiline?this.handleMultilineEdit():this.handleTextEdit())},handleMultilineEdit:function(){var p=this,G=p.gv,v=p._editTarget,J=p.getTargetValue(),$=p.textarea,S=p.wrap,O=this._editInfo;this.hiddenTextarea||this.createHiddenTextarea(),$.value=J=null!==J&&J!==K?J:"",O.font&&($.style.font=O.font),p._editingDOM=$,G.appendHTML(S),this.layoutHTML(S,v),v instanceof wI?$.style.height="100%":($.style.height="auto",this.calculateTextareaHeight()),I0(function(){$.focus(),H0(h,"mousedown",p.handleWindowClick),H0(h,"touchstart",p.handleWindowClick)},10)},handleTextEdit:function(){var p=this,G=p.gv,v=p._editTarget,J=p.getTargetValue(),$=p.input;$.value=J=null!==J&&J!==K?J:"",p._editingDOM=$,G.getView().appendChild($),this.layoutHTML($,v),I0(function(){$.focus(),H0(h,"mousedown",p.handleWindowClick),H0(h,"touchstart",p.handleWindowClick)},10)},layoutHTML:function(p,G){var v,J,$,S,O=this.gv,W=O.getZoom();G instanceof wI?(S=($=O.getDataUI(G))._6I,J=G.getScale(),v=p.style,p.style.left=S.x*W+O.tx()+"px",p.style.top=S.y*W+O.ty()+"px",p.style.width=$._6I.width+"px",p.style.height=$._6I.height+"px",QS(v,"transform","scale("+W*J.x+","+W*J.y+")"),QS(v,"transformOrigin","0px 0px")):G instanceof LI?(J=(S=G.getRect()).width*W,p.style.left=(S.x+S.width/2)*W+O.tx()+"px",p.style.top=(S.y+S.height/2)*W+O.ty()+"px",p.style.width=J+"px",p.style.marginLeft=-J/2+"px"):G instanceof E.Edge&&(S=($=O.getDataUI(G))._6I,p.style.left=(S.x+S.width/2)*W+O.tx()+"px",p.style.top=(S.y+S.height/2)*W+O.ty()+"px")},endTextEdit:function(p){var G=this,v=G._editInfo.isMultiline?G.wrap:G.input,J=G._editInfo.isMultiline?G.textarea:G.input;p||G.setTargetValue(J.value),G.gv.getView().removeChild(v),G.gv._editing=!1,delete G._editingDOM,delete G._editTarget,_0(h,"mousedown",G.handleWindowClick),_0(h,"touchstart",G.handleWindowClick)},setTargetValue:function(p){var G=this._editTarget,v=this._editInfo,J=v.accessType;(v=v.name)&&J||(J="p",v="name"),"p"===J?G[E.Default.setter(v)](p):"a"===J?G.a(v,p):G.s(v,p)},getTargetValue:function(){var p=this._editTarget,G=this._editInfo,v=G.accessType;return(G=G.name)&&v||(v="p",G="name"),"p"===v?p[E.Default.getter(G)]():"a"===v?p.a(G):p.s(G)},createHiddenTextarea:function(){this.hiddenTextarea=B.createElement("textarea"),this.hiddenTextarea.setAttribute("style","margin:0; padding:0; position:absolute; overflowY:scroll; resize:none; box-sizing:border-box;pointer-events: none;opacity:0;"),this.hiddenTextarea.setAttribute("rows","1"),this.gv.getView().appendChild(this.hiddenTextarea)},calculateHTMLStyle:function(p,G){if(G&&this.computedStyleCache)return this.computedStyleCache;var v=h.getComputedStyle(p),p=v.getPropertyValue("box-sizing")||v.getPropertyValue("-moz-box-sizing")||v.getPropertyValue("-webkit-box-sizing"),J=parseFloat(v.getPropertyValue("padding-bottom"))+parseFloat(v.getPropertyValue("padding-top")),$=parseFloat(v.getPropertyValue("border-bottom-width"))+parseFloat(v.getPropertyValue("border-top-width")),J={sizingStyle:this.SIZING_STYLE.map(function(p){return p+":"+v.getPropertyValue(p)}).join(";"),paddingSize:J,borderSize:$,boxSizing:p};return G&&(this.computedStyleCache=J),J},calculateTextareaHeight:function(p){p=p||"";var G=this.textarea,v=this.hiddenTextarea,J=this.wrap,$=(W=this.calculateHTMLStyle(G,!1)).paddingSize,S=W.borderSize,O=W.boxSizing,W=W.sizingStyle,W=(v.setAttribute("style",W+";"+this.HIDDEN_TEXTAREA_STYLE),v.value=G.value+p,v.scrollHeight);"border-box"===O?W+=S:"content-box"===O&&(W-=$),G.style.height=W+"px",J.style.height=Math.max(W,32)+"px",J.style.marginTop=-.5*W+"px"}}),wj.ScrollBarInteractor=function(p){bS(S3,this,[p])}),O3=(p("ScrollBarInteractor",J,{_41o:function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},_40o:function(){return this.gv.getViewRect().width<this.gv.getScrollRect().width},isV:function(p){var G=this.gv.getViewRect();return this._41o()&&(G.x+G.width-this.gv.lp(p).x)*this.gv.getZoom()<vA},isH:function(p){var G=this.gv.getViewRect();return this._40o()&&(G.y+G.height-this.gv.lp(p).y)*this.gv.getZoom()<vA},handle_mousemove:function(p){this.handle_touchmove(p)},handle_touchmove:function(p){var G;!fE&&YA(p)&&this.gv.isScrollBarVisible()&&(G=this.isV(p),p=this.isH(p),(G||p)&&this.gv.showScrollBar(),this.gv._scrolling=G||p)},handleWindowMouseUp:function(p){this.handleWindowTouchEnd(p)},handleWindowTouchEnd:function(p){this._state=this._cp=this._tx=this._ty=this.gv._scrolling=v0,this.fi({kind:"endScroll",event:p})},handle_mousedown:function(p){this.handle_touchstart(p)},handle_touchstart:function(p){var G,v=this;v.gv.setFocus(p),tA(p),v.handle_touchmove(p),1<hA(p)||!v.gv._scrolling||!v.gv.isScrollBarVisible()||(v._cp=i(p),v._tx=v.gv.tx(),v._ty=v.gv.ty(),G=v.isV(p),v._state=G?"vScroll":"hScroll",mA(v,p),v.fi({kind:"beginScroll",event:p}))},handleWindowMouseMove:function(p){this.handleWindowTouchMove(p)},handleWindowTouchMove:function(p){var G=i(p),v=this.gv.getViewRect(),J=this.gv.getScrollRect();"vScroll"===this._state?this.gv.ty(this._ty+(this._cp.y-G.y)*J.height/v.height):"hScroll"===this._state&&this.gv.tx(this._tx+(this._cp.x-G.x)*J.width/v.width),this.fi({kind:"betweenScroll",event:p})}}),wj.TouchInteractor=function(p,G){(G=G||{}).selectable===K&&(G.selectable=!0),G.movable===K&&(G.movable=!0),G.pannable===K&&(G.pannable=!0),G.pinchable===K&&(G.pinchable=!0),G.editable===K&&(G.editable=!0),this.params=G,bS(O3,this,[p])});p("TouchInteractor",J,{ms_edit:1,setUp:function(){O3.superClass.setUp.call(this),u0&&this.params.editable&&this.gv.setEditInteractor(this)},tearDown:function(){O3.superClass.tearDown.call(this),u0&&this.params.editable&&this.gv.setEditInteractor(v0)},clear:function(p){var G=this,v=G.gv;v._moving&&(G.fi({kind:"endMove",event:p}),delete v._moving,v.onMoveEnded(),v.dm().endTransaction()),v._panning&&(G.fi({kind:"endPan",event:p}),delete v._panning,v.onPanEnded()),v._pinching&&(G.fi({kind:"endPinch",event:p}),delete v._pinching,v.onPinchEnded()),v._editing&&(G._46O(p),G._77I=G._node=G._edge=G._shape=G._rect=G._89I=G._index=v._editing=v0),G.pendingClickThrough=G._moving=G._panning=G._pinching=G._editing=G._57I=G._data=G._beginHistory=v0,G.clearDragging()},handle_touchstart:function(p){var G,v,J,$,S,O=this;O.gv._editing||(tA(p),O._57I=v0,O.pendingClickThrough=v0,G=O.params,J=(v=O.gv).sm(),$=v.getDataAt(p),1===(S=hA(p))?wA(p)?v.handleDoubleClick(p,$):(v.handleClick(p,$),$&&(v.handleMouseDown&&v.handleMouseDown(p,$),O._data=$),($=G.selectable?$:v0)&&(J.co($)?$ instanceof hI&&$.isClickThroughEnabled()&&(O.pendingClickThrough=i(p)):J.ss($),G.editable&&v.isEditable($)&&O._79I(p,$,!0)?(O._editing=1,O.startDragging(p)):G.movable&&v.isMovable($)&&(O._moving=1,O.startDragging(p))),$&&(v.isMovable($)||v._39Q($))||(O._57I=i(p),G.pannable&&v.isPannable()&&(O._panning=1,O.startDragging(p),O._translate={x:v.tx(),y:v.ty()}))):!G.pinchable||2!==S||!v.getEditInteractor()&&$&&(J=T(v.getImage($)))&&V(J.scrollable,$,this)||(O._pinching=1,O.startDragging(p),G=v.getView(),S=v.getZoom(),J=G.getBoundingClientRect(),$=p.touches[0],G=p.touches[1],($={x:($.clientX+G.clientX)/2-J.left,y:($.clientY+G.clientY)/2-J.top}).x-=v.tx(),$.y-=v.ty(),$.x/=S,$.y/=S,O._p=$,O._d=B4(p)))},handle_touchend:function(p){var G=this.gv,v=this._57I,J=this._data;v&&(iA(v,i(p))<=1&&!G.getDataAt(p)&&G.sm().cs(),this._57I=v0),J&&G.handleMouseUp&&G.handleMouseUp(p,J),this.pendingClickThrough&&(iA(this.pendingClickThrough,i(p))<=1&&(J=G.getDataAt(p))instanceof hI&&J.isClickThroughEnabled()&&(v=G.getDataAt(p,function(p){return p.getParent()===J&&G.isSelectable(p,!0)}))&&(p.clickThrough=!0,G.sm().ss(v)),this.pendingClickThrough=v0)},handleWindowTouchEnd:function(p){this.clear(p)},handleWindowTouchMove:function(p){var G,v,J=this,$=J.gv,S=hA(p);1===S?(G=i(p),G=_j($,G,J._lastClientPoint),v=iA({x:0,y:0},G),J._editing&&(J._beginHistory||(J._beginHistory=1,$.dm().beginTransaction()),$._editing=1,J._78I(p)),J._moving?!$._moving&&v<N.touchMoveThreshold||(J._beginHistory||(J._beginHistory=1,$.dm().beginTransaction()),J.handleMove(p)):!J._panning||!$._panning&&v<N.touchMoveThreshold||($.setTranslate(J._translate.x+G.x,J._translate.y+G.y),J.fi({kind:$._panning?"betweenPan":"beginPan",event:p}),$._panning=1)):2===S&&J._pinching&&(v=B4(p),$.handlePinch(J._p,v,J._d),J._d=v,J.fi({kind:$._pinching?"betweenPinch":"beginPinch",event:p}),$._pinching=1)},handleMove:function(p){var G=this.gv,v=G.lp(p);G._93O&&G._93O(p,this._data)||(G.moveSelection(v.x-this._lastLogicalPoint.x,v.y-this._lastLogicalPoint.y),this._lastLogicalPoint=v,this.autoScroll(p),this.fi({kind:G._moving?"betweenMove":"beginMove",event:p}),G._moving=1)}});var W3,U=(E=h.ht).graph._editor={Math:E.Math,Guide:{},getStyle:function(p){var G=U.StyleMap;return G&&(G=G[p])!==K?G:U.DefaultStyleMap[p]},setStyle:function(p,G){(U.StyleMap||(U.StyleMap={}))[p]=G},inEdit:function(p){return!0===p._inXEdit},startEdit:function(p){p._inXEdit=!0,U.Inject.doInject(p)},_46O:function(p){p._inXEdit=!1,U.Inject.undoInject(p)},toScreenPosition:function(p,G){var v=p.tx(),J=p.ty(),p=p._zoom;return new U.Math.Vector2(G.x*p+v,G.y*p+J)},checkHit:function(p,G,v){return p.distanceTo(G)<v},toWorldPosition:function(p,G){var v=p.tx(),J=p.ty(),p=p._zoom;return{x:(G.x-v)/p,y:(G.y-J)/p}},setAntialias:function(p,G){for(var v,J=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","msImageSmoothingEnabled"],$=0,S=J.length;$<S&&!((v=J[$])in p);$++);p[v],p[v]=G},getTargetCornersOnScreen:function(G,p){if(!p)return null;var v=[];if(BS(p,G))var J=[{x:(J=pj(G,p)).x,y:J.y},{x:J.x+J.width,y:J.y},{x:J.x+J.width,y:J.y+J.height},{x:J.x,y:J.y+J.height}];else{if(!p.getCorners)return null;J=p.getCorners()}return J.forEach(function(p){p=U.toScreenPosition(G,p),v.push(p.x,p.y)}),v},log:function(){},updateTipInfo:function(p,G,v){W3=v?((p=E.Default.getLogicalPoint(p,G._canvas)).x+=U.Icons.TipShiftX,p.y+=U.Icons.TipShiftY,{helperPos:p,text:v,size:v.length}):v0},drawTip:function(p,G){W3&&U.Icons.DrawIcon(G,p,U.Icons.TipHelper,W3)}},l3=U.Inject={_modules:[],registAsModule:function(v,J){var p,$={},G={};for(p in v){var S=J.prototype[p];$[p]=S}v.getBackup=function(p){return $[p]},v.getBackups=function(){return $},G.doInject=function(p){for(var G in v)"getBackup"!==G&&(J.prototype[G]=v[G])},G.undoInject=function(p){for(var G in v)"getBackup"!==G&&(J.prototype[G]=$[G])},l3._modules.push(G)},doInject:function(p){for(var G=l3._modules,v=0,J=G.length;v<J;v++)G[v].doInject(p)},undoInject:function(p){for(var G=l3._modules,v=0,J=G.length;v<J;v++)G[v].undoInject(p)}},t3=J=E.graph.EditInteractor=function(p){var G=this,v=B.createElement("canvas");v.className="editCanvas",v.style.position="absolute",G._uuid=E.Math.generateUUID(),G._styleMap={},G._canvas=v,G._context=v.getContext("2d"),J.superClass.constructor.call(G,p),this._editDetail=!1,U.setAntialias(G._context,!1),G._subModules=G.initSubModule(),G._gridGuide=new U.Guide.Grid(G),G._rectGuide=new U.Guide.Rect(G),G._hoverGuide=new U.Guide.Hover(G)};E.Default.def(J,E.graph.Interactor,{ms_edit:1,ms_fire:1}),d.defineProperties(J.prototype,{editDetail:{get:function(){return!!this._editDetail},set:function(p){var G=this._editDetail;G!==p&&(this._editDetail=p,this.gv._editing=p,this.fp("editDetail",G,p),this.fp("pointsEditingMode",G,p),this.fi({kind:p?"beginEditPoints":"endEditPoints"}))}},gvEditing:{get:function(){return this.gv._editing},set:function(p){this._editDetail&&!p||(this.gv._editing=p)||(this.editDetail=!1)}},editing:{get:function(){return this._editing},set:function(p){this._editing=p,this.gvEditing=p}},editingModule:{get:function(){return this._editMod}},pointsEditingMode:{get:function(){return this.editDetail},set:function(p){this.editDetail!==p&&(p?this._tryEnterEditDetailMode():this._tryQuitEditDetailMode())}},gridEnabled:{get:function(){return!!this._gridEnabled&&(this.gv,!0)},set:function(p){p!==this._gridEnabled&&(this._gridEnabled=p,this._42())}},alignmentGuideEnabled:{get:function(){return this._agEnabled},set:function(p){p!==this._agEnabled&&(this._agEnabled=p,this._42())}},gridGuide:{get:function(){return this._gridGuide}},rectGuide:{get:function(){return this._rectGuide}},hoverGuide:{get:function(){return this._hoverGuide}}}),J.prototype.initSubModule=function(){return[new U.Anchor(this),new U.RotateX(this),new U.MoveDummy(this),new U.Rect(this),new U.Curve(this),new U.MoveHelper(this)]},J.prototype.getSubModule=function(p){for(var G,v=this._subModules,J=0,$=v.length;J<$;J++)if((G=v[J]).catalog===p)return G},J.prototype.invokeSubModule=function(p,G){for(var v,J,$=this._subModules,S=Array.prototype.slice.call(arguments,2),O=0,W=$.length;O<W;O++)if((J=(v=$[O])[p])&&J.apply(v,S)!=K&&G)return v},J.prototype.invokeSubModuleInverse=function(p,G){var v=this._subModules;if(v)for(var J,$,S=Array.prototype.slice.call(arguments,2),O=v.length-1;0<=O;O--)if(($=(J=v[O])[p])&&$.apply(J,S)!=K&&G)return J},J.prototype.setUp=function(){U.log("setUp");var p=this.gv,G=p.getView(),v=this._canvas;J.superClass.setUp.call(this),p.setEditInteractor(this),p._79O?G.insertBefore(v,p._79O):G.appendChild(v),U.startEdit(p),this.invokeSubModule("setUp"),p.dm().mm(this._onDataModelChanged,this),p.dm().md(this._onDataPropertyChanged,this)},J.prototype.tearDown=function(){U.log("tearDown");var p=this,G=p.gv,v=G.getView();p._resetCustomCursorStyle(),J.superClass.tearDown.call(p),G.dm().umm(p._onDataModelChanged,p),G.dm().umd(p._onDataPropertyChanged,p),G.setEditInteractor(null),v.removeChild(p._canvas),p._drawTimer&&(E0(p._drawTimer),p._drawTimer=null),U._46O(G),p.invokeSubModule("tearDown")},J.prototype._onDataModelChanged=function(p){("clear"===p.kind||"remove"===p.kind&&this.editDetail&&p.data===this.getSubModule("Curve").target)&&(this.editDetail=!1,this._42())},J.prototype._onDataPropertyChanged=function(p){var G,v;this.editDetail&&(G=this.getSubModule("Curve"),(v=p.data)!==G.target||v._writing||G._handleDataChanged(p))},J.prototype.clear=function(){U.log("clear")},J.prototype.redraw=function(){this._42()},J.prototype._42=function(){var p=this;p._drawTimer||(p._drawTimer=I0(function(){p._drawTimer=null,p.drawImpl()},0))},J.prototype.drawImpl=function(){for(var W in{_42:!0})break;return function(){var p=this._canvas,G=this.gv,v=G.getWidth(),J=G.getHeight(),$=this._context,S=E.Default.getInternal(),O=N.devicePixelRatio,S=(p.width===v&&p.height===J||S.setCanvas(p,v,J,O),$.clearRect(0,0,p.width,p.height),this._getValidSelection());$.save(),$.scale(O,O),this._gridGuide._42(),this.invokeSubModuleInverse(W,!1,$,G,S),this._rectGuide._42(),this._hoverGuide._42(),$.restore()}}(),J.prototype._getValidSelection=function(){var G=this.gv,p=G.sm().getSelection(),v=[];return p.each(function(p){G.isVisible(p)&&G.isEditable(p)&&v.push(p)}),v},J.prototype.handle_touchmove=function(p){return this.handle_mousemove(p)},J.prototype.handle_mousemove=function(p){if(!E.Default.isDragging()&&(this.editDetail||!PE()&&!sA(p))&&!this.gv._externalEditing){if(this.gvEditing=!1,this._checkEdit(p))this.gvEditing=!0;else{if(!this.getStyle("hoverGuideVisible"))return;this.hoverData=this.gv.getDataAt(p)}this._42()}},J.prototype.handle_touchstart=function(p){return this.handle_mousedown(p)},J.prototype.handle_mousedown=function(p){tA(p);var G=this;if((G.editDetail||!PE()&&!sA(p))&&!G.gv._externalEditing){if(wA(p)&&!p.clickThrough){if(G.editDetail){if(G._tryQuitEditDetailMode(p))return}else if(G._tryEnterEditDetailMode())return;G.gv.dm().beginTransaction();var v=G.invokeSubModule("handleDoubleClick",!0,p);if(G.gv.dm().endTransaction(),v)return}(v=G._checkEdit(p))&&(G._downPosition=G._getLogicalPoint(p),G.gv.dm().beginTransaction(),v.startEdit(G,p),G.editing=!0)}},J.prototype._checkEdit=function(p){var G=this.gv,v=this._getLogicalPoint(p),G=this.invokeSubModule("check",!0,G,p,v)||null;return this._editMod=G},J.prototype.handleWindowTouchMove=function(p){return this.handleWindowMouseMove(p)},J.prototype.handleWindowMouseMove=function(p){var G=this._downPosition;if(G){if(this._getLogicalPoint(p).distanceTo(G)<this.getStyle("moveSensitivity"))return;delete this._downPosition}(G=this._editMod)&&G.handleEdit(this.gv,p),this.redraw()},J.prototype._getLogicalPoint=function(p){return p=E.Default.getLogicalPoint(p,this._canvas),new U.Math.Vector2(p)},J.prototype.handleWindowTouchEnd=function(p){return this.handleWindowMouseUp(p)},J.prototype.handleWindowMouseUp=function(){for(var G in{_46O:!0})break;return function(p){this.editing=!1,this.setCursor("default"),this.invokeSubModule(G,!1,p),this._42(),this.gv.dm().endTransaction()}}(),J.prototype.handle_mousewheel=function(p){tA(p),this.invokeSubModule("preHandleScroll",!0)||this.gv.handleScroll(p,p.wheelDelta)},J.prototype.handleDelete=function(){var p;if(!this.editDetail)return this.gv.dm().beginTransaction(),p=this.invokeSubModule("handleNormalStateDelete",!0),this.gv.dm().endTransaction(),void(p||this.gv.removeSelection());this.gv.dm().beginTransaction(),this.invokeSubModule("handleDelete",!0),this.gv.dm().endTransaction(),this._42()},J.prototype.handle_keydown=function(p){var G,v=this;return(p.metaKey||p.ctrlKey)&&v._42(),PE(p)&&!v.editing?(v.gvEditing=!1,v.setCursor("default"),void v._42()):(G=jE(p),v.editDetail?((G||iE(p))&&(v.editDetail=!1,v._42()),v.gv.dm().beginTransaction(),v.invokeSubModule("handle_keydown",!0,p),void v.gv.dm().endTransaction()):(v.gv.dm().beginTransaction(),v.invokeSubModule("handleNormalStateKeyDown",!0,p),v.gv.dm().endTransaction(),void(G&&v._tryEnterEditDetailMode())))},J.prototype.handle_keyup=function(p){this.gv.dm().beginTransaction(),this.invokeSubModule("handle_keyup",!0,p),this.gv.dm().endTransaction()},J.prototype._tryEnterEditDetailMode=function(){if(!this.editDetail&&this.invokeSubModule("canEnterEditDetailMode",!0)&&1===this._getValidSelection().length)return this.editDetail=!0,this._42(),!0},J.prototype._tryQuitEditDetailMode=function(p){return!(!this.editDetail||p&&!this.invokeSubModule("canQuitEditDetailMode",!0,p)||(this.editDetail=!1,this._42(),0))},J.prototype.setStyle=function(p,G,v){v?U.setStyle(p,G):this._styleMap[p]=G,"baseColor"===p&&(f3=G),this.fp("styleChanged",null,{key:p,value:G,base:v}),this._42()},J.prototype.getStyle=function(p,G){var v=this._styleMap[p];return v!==K?v:U.getStyle(p)},J.prototype.setCursor=function(p){this._resetCustomCursorStyle(),E.graph.EditInteractor.superClass.setCursor.call(this,p)},J.prototype._drawHostGuide=function(p){var G=this._context,v=this.gv,J=(U.Icons.DrawIcon(this,G,U.Icons.NodeHoverGuide,p.corners),p.host);if(J){var $=v.getAttachPoints(J);if($&&$.length)for(var S=0,O=$.length;S<O;S++){var W=$[S],W=Lj(v,J,0,W.offsetX||0,W.offsetY||0,W.x,W.y);(W=U.toScreenPosition(v,W)).isAttach=p.attach===S,U.Icons.DrawIcon(this,G,U.Icons.AttachPoint,W)}}},J.prototype._resetCustomCursorStyle=function(){var p;this._customStyle&&((p=this.gv.getView()).classList&&p.classList.remove&&p.classList.remove(this._customStyle),this._customStyle=null)},J.prototype._setRotateCursor=function(p){var p=(this._cursorFactory||(this._cursorFactory=new U.CursorFactory(this))).getRotateCursor(p),G=this.gv.getView();this._resetCustomCursorStyle(),this._customStyle=p,G.classList&&G.classList.add&&G.classList.add(p)};((S=U.Group=function(p){this._entities=p,this._64O=0,this._position={x:0,y:0},this._scale={x:1,y:1},this._anchor={x:.5,y:.5},this._anchor2={x:.5,y:.5}}).prototype={}).constructor=S;var z3=null,Z3=null;S.findOrCreateGroup=function(p,G){return Z3===G&&z3&&z3.checkIsMe(p)?z3:(Z3=G,(G=new U.Group(p)).getKeyOb()?z3=G:void 0)},S.prototype.checkIsMe=function(p){var G=this._entities;if(G.length!==p.length)return!1;for(var v={},J=p.length,$=0;$<J;$++)v[p[$]._id]=!0;for($=0;$<J;$++)if(!v[G[$]._id])return!1;return!0},S.prototype.getRotation=function(){return this._64O},S.prototype.getPosition=function(){return this._position},S.prototype.getAnchor=function(){return this._anchor},S.prototype.getWidth=function(){return this._width},S.prototype.getScale=function(){return this._scale},S.prototype.getSize=function(){return{width:this._width,height:this._height}},S.prototype.getHeight=function(){return this._height},S.prototype.getKeyOb=function(){for(var p=this._entities,G=p.length-1;0<=G;G--){var v=p[G];if(this.isNode(v))return v}},S.prototype.getAnchor2=function(){var p=this.rotateCenter;if(p)return p;if(!(p=this.getKeyOb()))return this._anchor;var G=this._anchor2;return p.getMatrix().tf({x:p.getWidth()*(G.x-p.getAnchor().x),y:p.getHeight()*(G.y-p.getAnchor().y)})},S.prototype.setAnchor2=function(p,G){var v=this.getKeyOb();v&&(G="number"==typeof p?{x:p,y:G}:p,p=v.getMatrix().tfi(G),this._anchor2={x:v.getAnchor().x+p.x/v.getWidth(),y:v.getAnchor().y+p.y/v.getHeight()})},S.prototype.setRotation=function(p){},S.prototype.beginRotate=function(p){this.rotateCenter=p.pos,this.rotateMode=p.groupRotateMode},S.prototype.endRotate=function(){delete this.rotateCenter,delete this.rotateMode},S.prototype.addRotation=function(p,G,v){return"batch"===G?this._addRotationInBatchMode(p,v):"block"===G?this._addRotationInBlockMode(p,v):void 0},S.prototype._addRotationInBlockMode=function(J,$){var S=this,O=S.rotateCenter||S.getPosition();S._entities.forEach(function(p){var G,v;!S.isNode(p)||$&&!$(p)||((G=p.getMatrix()).translate(-O.x,-O.y),G.rotate(J),G.translate(O.x,O.y),v=Math.sign(p.getScale().x),p.setRotation(P0(G.b*v,G.a*v)),p.setPosition(G.tx,G.ty))})},S.prototype._addRotationInBatchMode=function($,S){var O=this,W=O._anchor2;O._entities.forEach(function(p){var G,v,J;!O.isNode(p)||S&&!S(p)||(G=p.getAnchor(),G=(J=p.getMatrix()).tf({x:p.getWidth()*(W.x-G.x),y:p.getHeight()*(W.y-G.y)}),(v=new U.Math.Matrix2d).set(J.a,J.b,J.c,J.d,J.tx,J.ty),v.translate(-G.x,-G.y),v.rotate($),v.translate(G.x,G.y),J=Math.sign(p.getScale().x),p.setRotation(P0(v.b*J,v.a*J)),p.setPosition(v.tx,v.ty))})},S.prototype.setPosition=function(p){for(var G,v,J=this._position,$=p.x-J.x,S=p.y-J.y,O=this._entities,W=0,l=O.length;W<l;W++)G=O[W],k(G)&&(v=G.getPosition(),G.setPosition(v.x+$,v.y+S));this._position=p},S.prototype.setScale=function(p,G){var v=p/this._scale.x,J=G/this._scale.y;this._adjustChildScaleOrSize(v,J,"size"),this._scale={x:p,y:G}},S.prototype.getRect=function(){var p=this._position,G=this._width,v=this._height;return{x:p.x-G/2,y:p.y-v/2,width:G,height:v}},S.prototype.setSize=function(p,G){var p=Math.max(1,p),G=Math.max(1,G),v=p/this._width,J=G/this._height;this._adjustChildScaleOrSize(v,J,"size"),this._width=p,this._height=G},S.prototype._adjustChildScaleOrSize=function(p,G,v){for(var J,$=this._position,S=this._entities,O=new U.Math.Matrix2d,W=0,l=S.length;W<l;W++){var t,z,Z,B,f,X,q,g=S[W];this.isNode(g)&&(t=g.getPosition(),z=g.getRotation(),Z=g.getWidth(),B=g.getHeight(),X=(f=g.getScale()).x*Z,q=f.y*B,O.identity().scale(X,q).rotate(z).translate(t.x,t.y).translate(-$.x,-$.y).rotate(-this._64O),z=P0(O.b*Math.sign(X),O.a*Math.sign(X)),O.scale(p,G),q=Math.cos(z),t=Math.sin(z),X=Math.abs(q)<.001?(J=O.b/t,-O.c/t):(J=O.a/q,O.d/q),"scale"===v?g.setScale(J/Z,X/B):"size"===v&&(z=J/f.x,t=X/f.y,g.setScale(cS(J)*Math.abs(f.x),cS(X)*Math.abs(f.y)),g.setSize(Math.max(.1,Math.abs(z)),Math.max(.1,Math.abs(t)))),O.rotate(this._64O).translate($.x,$.y),g.setPosition(O.tx,O.ty))}},S.prototype.getMatrix=function(){var p=this._position,G=E.Default.getInternal(),v=this._scale;return new G.Mat(this._64O,p.x,p.y,v.x,v.y)},S.prototype.toGlobal=function(p){return this.getMatrix().tf(p)},S.prototype.getCorners=function(){var p=this._width,G=this._height,v=-p*(J=this._anchor).x,J=-G*J.y,$=this.getMatrix();return[$.tf(v,J),$.tf(v,J+G),$.tf(v+p,J+G),$.tf(v+p,J)]},S.prototype.calcInfo=function(){for(var p,G,v=[],J=this._entities,$=this._64O,S=0,O=J.length;S<O;S++)G=J[S],this.isNode(G)&&G.getCorners&&v.push.apply(v,G.getCorners());if(v.length){for(var W=Math.cos(-$),l=Math.sin(-$),t=1/0,z=-1/0,Z=1/0,B=-1/0,S=0,O=v.length;S<O;S++)f=(p=v[S]).x,X=p.y,p.x=W*f-l*X,p.y=l*f+W*X,t=Math.min(t,p.x),z=Math.max(z,p.x),Z=Math.min(Z,p.y),B=Math.max(B,p.y);this._width=(z-t)/this._scale.x,this._height=(B-Z)/this._scale.y;var W=Math.cos($),l=Math.sin($),f=t+(z-t)*($=this._anchor).x,X=Z+(B-Z)*$.y;this._position={x:W*f-l*X,y:l*f+W*X}}},S.prototype.isNode=function(p){return!(!k(p)||BS(p)&&p.size())},S.prototype._42=function(p,G,v){var J,$,S,O,W,l=this._entities;for("batch"===this.rotateMode&&(W=this.getKeyOb()),J=0,$=l.length;J<$;J++)S=l[J],this.isNode(S)&&(O=S.getRect(),O={min:U.toScreenPosition(v,{x:O.x,y:O.y}),max:U.toScreenPosition(v,{x:O.x+O.width,y:O.y+O.height})},S===W&&(O.isKeyOb=!0),U.Icons.DrawIcon(p,G,U.Icons.GroupSubEntityRect,O))},((i0=U.CurveActiving=function(p,G){for(var v in this._curve=p,this._interactor=p._interactor,this.silent=!0,G)this[v]=G[v];delete this.silent}).prototype={}).constructor=i0,d.defineProperties(i0.prototype,{point:{get:function(){return this._point},set:function(p){this._point=p,this.editingCtrl||this.silent||this._firePointChange()}},pairs:{get:function(){return this._pairs},set:function(p){this._pairs=p,this.editingCtrl&&!this.silent&&this._firePointChange()}}}),i0.prototype._firePointChange=function(){var p,G,v=this.getCurrentEditingPoint(),J=this._interactor;v?(G=this._curve.target)&&(G=U.getDataMatrix(G).invert(),p=v.e,(v=G.apply(U.toWorldPosition(J.gv,v))).e=p,(G=this._lastFirePoint)&&Math.abs(v.x-G.x)<1e-5&&Math.abs(v.y-G.y)<1e-5&&(v.e==K&&G.e==K||Math.abs(v.e-G.e)<1e-5)||(this._lastFirePoint=v,J.fi({kind:"selectPoint",x:v.x,y:v.y,e:v.e}))):J.fi({kind:"selectPoint"})},i0.prototype.dispose=function(){this._interactor.fi({kind:"selectPoint"})},i0.prototype.getCurrentEditingPoint=function(){var p=this.editingCtrl;if(p){var G=this.pairs;if(G=(G=G&&G[p.pairId])&&G[p.type])return G}return this._point},(((p=U.CursorFactory=function(p){this._interactor=p,this._rotateCursorStyles={}}).prototype={}).constructor=p).prototype.getRotateCursor=function(p){p<0&&(p+=2*Math.PI);var G=(v=this._interactor).getStyle("rotateCursorSize"),v=v.getStyle("rotateCursorRound"),p=Math.round(p/Math.PI*180/v),J=this._rotateCursorStyles,$="htCustomRotateStyle_"+G+"_"+v+"_"+(p=360<=p*v?0:p);return J[$]||(this._produceRotateCursor($,G,v,p),J[$]=!0),$},p.prototype._produceRotateCursor=function(p,G,v,J){this._interactor;var $=($=this._canvas)||(this._canvas=B.createElement("canvas")),S=N.devicePixelRatio,O=($.width=$.height=G*S,$.style.width=$.style.height=G+" px",$.getContext("2d"));U.setAntialias(O,!1),O.scale(S,S);var W=(W=Math.round(G/2))+" "+W+",auto !important;",J=Math.PI/180*J*v;O.clearRect(0,0,G,G),O.save(),O.scale(G/32,G/32),O.translate(16,15),O.rotate(J+Math.PI/2),O.beginPath(),O.moveTo(-8,0),O.lineTo(-8,4),O.lineTo(-4,4),O.moveTo(8,0),O.lineTo(8,4),O.lineTo(4,4),O.moveTo(-8,4),O.quadraticCurveTo(0,-6,8,4),O.restore(),O.lineCap="round",O.lineJoin="miter",O.strokeStyle="white",O.lineWidth=4,O.stroke(),O.strokeStyle="black",O.lineWidth=2,O.stroke(),J="cursor:url("+(v=JSON.stringify($.toDataURL()))+")"+W,1!==S&&(J=J+("cursor:url(data:image/svg+xml;base64,"+btoa('<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+G+'px" height="'+G+'px"><image xlink:href='+v+' width="'+G+'" height="'+G+'"/></svg>'))+")"+W+"cursor:-webkit-image-set(url("+v+")"+S+"x,url("+v+")1x)"+W),(O=B.createElement("style")).textContent="body."+p+" *, ."+p+"{"+J+"}",B.head.appendChild(O)},((G=U.Guide.Grid=function(p){this._interactor=p,this._alignmentGuideId=0,this._xAlignmentGuide=[],this._yAlignmentGuide=[]}).prototype={}).constructor=G,d.defineProperties(G.prototype,{gridBlockSize:{get:function(){return this._gridBlockSize||this._interactor.getStyle("gridBlockSize")},set:function(p){this._gridBlockSize=p,this._interactor._42()}},gridThickLinesEvery:{get:function(){return this._gridThickLinesEvery||this._interactor.getStyle("gridThickLinesEvery")},set:function(p){this._gridThickLinesEvery=p,this._interactor._42()}},gridEnabled:{get:function(){return this._interactor.gridEnabled&&this.isValidGrid()}}}),G.prototype._42=function(){var p=this._interactor;this.gridEnabled&&this.drawGrid(),p.alignmentGuideEnabled&&this.drawAlignmentGuide()},G.prototype.makeMatrix=function(){var p=this._interactor.getStyle("gridAngle"),G=this._interactor.getStyle("gridRotation"),v=new U.Math.Matrix2d,J=Math.sin(p),p=Math.cos(p);return v.set(1,0,p,J,0,0),v.rotate(G),v},G.prototype.isValidGrid=function(){var p=Math.PI,G=this._interactor;return!(G.gv._zoom<G.getStyle("gridZoomThreshold"))&&(G=G.getStyle("gridAngle"),!((G=Math.abs(G%p/p*180))<1-1e-8||179.00000001<G))},G.prototype.drawAlignmentGuide=function(){var p=this._interactor,G=p.gv,v=p._canvas,J=p._context,$=v.width,S=v.height,O=G.tx(),W=G.ty(),l=G._zoom;J.beginPath(),J.strokeStyle=p.getStyle("gridAlignmentGuideColor"),J.lineWidth=1,this._xAlignmentGuide.forEach(function(p){p=p.p*l+O,J.moveTo(p,0),J.lineTo(p,S)}),this._yAlignmentGuide.forEach(function(p){p=p.p*l+W,J.moveTo(0,p),J.lineTo($,p)}),J.stroke()},G.prototype.drawGrid=function(){var p,G,v,J=this._interactor,$=this.gridBlockSize,S=this.gridThickLinesEvery,O=J.getStyle("gridThickColor"),W=J.getStyle("gridLightColor"),l=J.gv,t=J._canvas,z=J._context,J=t.width,t=t.height,Z=this.makeMatrix(),B=Z.applyInverse(U.toWorldPosition(l,{x:0,y:0})),f=Z.applyInverse(U.toWorldPosition(l,{x:J,y:0})),X=Z.applyInverse(U.toWorldPosition(l,{x:0,y:t})),J=Z.applyInverse(U.toWorldPosition(l,{x:J,y:t})),q=Math.min(B.x,f.x,X.x,J.x),g=Math.max(B.x,f.x,X.x,J.x),M=Math.min(B.y,f.y,X.y,J.y),L=Math.max(B.y,f.y,X.y,J.y),t=Math.ceil(q/$),H=Math.floor(g/$),B=Math.ceil(M/$),_=Math.floor(L/$);function b(p,G,v,J){p=U.toScreenPosition(l,Z.apply({x:p,y:G})),G=U.toScreenPosition(l,Z.apply({x:v,y:J})),z.moveTo(p.x,p.y),z.lineTo(G.x,G.y)}for(l.tx(),l.ty(),l._zoom,z.save(),z.lineWidth=1,z.beginPath(),z.strokeStyle=O,v=Math.ceil(t/S)*S;v<=H;v+=S)b(p=v*$,M,p,L);for(v=Math.ceil(B/S)*S;v<=_;v+=S)b(q,G=v*$,g,G);for(z.stroke(),z.beginPath(),z.strokeStyle=W,v=t;v<=H;v++)v%S!=0&&b(p=v*$,M,p,L);for(v=B;v<=_;v++)v%S!=0&&b(q,G=v*$,g,G);z.stroke(),z.restore()},G.prototype.getAlignmentGuides=function(){return{x:this._xAlignmentGuide,y:this._yAlignmentGuide}},G.prototype.addAlignmentGuide=function(p,G,v){var J,p="x"===p?this._xAlignmentGuide:this._yAlignmentGuide,G={p:G,id:v=v||++this._alignmentGuideId};return p.length?(J=this._findClosestAlignmentGuide(G.p,p)).dis<0?p.splice(J.index+1,0,G):p.splice(J.index,0,G):p.push(G),this._interactor._42(),v},G.prototype.findClosest=function(p,G,v){var J=this._interactor,$=J.gv,S=1/0,O=1/0,W=(p=v?U.toWorldPosition($,p):p).x,l=p.y;if(this.gridEnabled&&(z=this.gridBlockSize,p=(t=this.makeMatrix()).applyInverse(p),S=(p=t.apply({x:Math.round(p.x/z)*z,y:Math.round(p.y/z)*z})).x-W,O=p.y-l,t=!0),J.alignmentGuideEnabled&&(z=this._findClosestAlignmentGuide(W,this._xAlignmentGuide).dis,p=this._findClosestAlignmentGuide(l,this._yAlignmentGuide).dis,Math.abs(z)<Math.abs(S)&&(S=z,t=!0),Math.abs(p)<Math.abs(O)&&(O=p,t=!0)),t){var t=!1,W=$._zoom,l=J.getStyle("smartGuideThreshold")/W,z={};if(Math.abs(S)<l&&"y"!==G&&(z.x=v?S*W:S,t=!0),Math.abs(O)<l&&"x"!==G&&(z.y=v?O*W:O,t=!0),t)return z}},G.prototype._findClosestAlignmentGuide=function(p,G){if(!G.length)return{dis:1/0};for(var v,J=0,$=G.length-1;1<$-J;)G[v=Math.floor((J+$)/2)].p<p?J=v:$=v;var S=G[J].p-p,O=G[$].p-p;return Math.abs(S)<=Math.abs(O)?{line:G[J],dis:S,index:J}:{line:G[$],dis:O,index:$}},G.prototype.removeAllAlignmentGuide=function(p){"y"!==p&&(this._xAlignmentGuide=[]),"x"!==p&&(this._yAlignmentGuide=[]),this._interactor._42()},G.prototype.removeAlignmentGuide=function(p){for(var G,v,J,$=this._xAlignmentGuide,S=0;S<2;S++)for(v=($=(G=0)===S?this._xAlignmentGuide:this._yAlignmentGuide).length;G<v;G++)if((J=$[G]).id===p)return $.splice(G,1),this._interactor._42(),{axis:0===S?"x":"y",position:J.p};return!1},G.prototype.adjustAlignmentGuide=function(p,G){var v=this.removeAlignmentGuide(p);return!!v&&(this.addAlignmentGuide(v.axis,G,p),!0)},(((S=U.Guide.Rect=function(p){this._interactor=p}).prototype={}).constructor=S).prototype.gatherRects=function(){var J,$,S,O,W=this._interactor.gv,l=[],t=[],p={x:l,y:t},z={},G=W.getDataModel(),v=G.a("width"),Z=G.a("height");v&&Z&&($=J=0,S=v,O=Z,l.push({node:G,type:0,p:J},{node:G,type:1,p:J+S/2},{node:G,type:2,p:J+S}),t.push({node:G,type:0,p:$},{node:G,type:1,p:$+O/2},{node:G,type:2,p:$+O}),z[G._id||0]={x:J,y:$,width:S,height:O}),G.each(function(G){var v,p;k(G)&&!W.isSelected(G)&&W.isVisible(G)&&W.isValidGuideLineSource(G)&&(v=!1,W.sm().getSelection().each(function(p){v||(G.isHostOn(p)||G.isDescendantOf(p))&&(v=!0)}),v||(p=G.getRect(),J=p.x,$=p.y,S=p.width,O=p.height,l.push({node:G,type:0,p:J},{node:G,type:1,p:J+S/2},{node:G,type:2,p:J+S}),t.push({node:G,type:0,p:$},{node:G,type:1,p:$+O/2},{node:G,type:2,p:$+O}),z[G._id]=p))}),l.sort(function(p,G){return p.p-G.p}),t.sort(function(p,G){return p.p-G.p}),this._grid=p,this._87I=z},S.prototype.gatherLines=function(p,G,v){var J,$,S,O,W,l,t,z,Z,B=[this.findClosest({x:p.x,y:p.y},G),this.findClosest({x:p.x+p.w/2,y:p.y+p.h/2},G),this.findClosest({x:p.x+p.w,y:p.y+p.h},G)],f={},X=this._87I;for(v=v||255,this._guideLine=[],J=0;J<2;J++)for(f={},t=0===J?(O="y",(l=p.x)+p.w):(O="x",(l=p.y)+p.h),$=0;$<3;$++)(W=B[$])&&isFinite(W[O])&&v&1<<3*J+$&&(f[Z=(W=W[O+"Line"]).node._id||0]||(f[Z]=!0,Z=X[Z],Z="y"===O?(z=Z.x,Z.x+Z.width):(z=Z.y,Z.y+Z.height),S=W.p,this._guideLine.push({type:O,a:l,b:t,c:z,d:Z,p:S,center:1===W.type})))},S.prototype._binarySearchClosest=function(p,G){if(!G.length)return{dis:1/0};for(var v,J=0,$=G.length-1;1<$-J;)G[v=Math.floor((J+$)/2)].p<p?J=v:$=v;var S=G[J].p-p,O=G[$].p-p;return Math.abs(S)<=Math.abs(O)?{line:G[J],dis:S}:{line:G[$],dis:O}},S.prototype.findClosest=function(p,G,v){var J,$=(l=this._interactor).gv,S=this._grid,O=(v&&(p=U.toWorldPosition($,p)),this._binarySearchClosest(p.x,S.x)),p=this._binarySearchClosest(p.y,S.y),S=O.dis,W=p.dis,$=$._zoom,l=l.getStyle("smartGuideThreshold")/$,t={};if(Math.abs(S)<l&&"y"!==G&&(t.x=v?S*$:S,t.xLine=O.line,J=!0),Math.abs(W)<l&&"x"!==G&&(t.y=v?W*$:W,t.yLine=p.line,J=!0),J)return t},S.prototype._42=function(){var p=this._guideLine;if(p&&!E.Default.isCtrlDown()){var G=this._interactor;if(G.getStyle("guideLineVisible"))for(var v,J,$,S,O,W,l,t,z,Z,B,f,X,q=G.gv,g=G._context,M=q.tx(),L=q.ty(),H=q._zoom,_=G.getStyle("guideLineTextSpacing"),b=0,n=p.length;b<n;b++)O=(v=p[b]).type,W=v.p,l=v.a,t=v.b,z=v.c,Z=v.d,B=Math.min(l,z),f=Math.max(t,Z),W="x"===O?($=B*H+L,S=J=W*H+M,f*H+L):(J=B*H+M,S=f*H+M,$=W*H+L),U.Icons.DrawIcon(G,g,U.Icons.MoveLineGuide,{rect:[J,$,S,W],center:v.center}),l<=Z&&z<=t||(B=Z<l?Z:t,f=Z<l?l:z,"x"===O?(v.center2center||(S=J-=_),$=B*H+L,W=f*H+L,X=U.Icons.MoveLineGuideDistanceV):"y"===O&&(v.center2center||(W=$-=_),J=B*H+M,S=f*H+M,X=U.Icons.MoveLineGuideDistanceH),U.Icons.DrawIcon(G,g,X,{x0:J,y0:$,x1:S,y1:W,dis:f-B}))}},S.prototype.clear=function(){this._guideLine=null};((i0=U.Guide.Hover=function(p){this._interactor=p}).prototype={}).constructor=i0,d.defineProperties(i0.prototype,{}),i0.prototype._42=function(){var p,G,v,J=this._interactor;J.getStyle("hoverGuideVisible")&&!J.gvEditing&&(p=J.hoverData,v=J.gv,!k(p)||v.isSelected(p)?J.hoverData=null:(p=pj(v,p),G=U.toScreenPosition(v,{x:p.x,y:p.y}),v=U.toScreenPosition(v,{x:p.x+p.width,y:p.y+p.height}),U.Icons.DrawIcon(J,J._context,U.Icons.HoverDataRect,{min:G,max:v,color:J.getStyle("hoverGuideColor")||J.getStyle("baseColor"),borderWidth:J.getStyle("hoverGuideBorderWidth")||1,borderPattern:J.getStyle("hoverGuideBorderPattern")||[1,4]})))},U.DefaultStyleMap={baseColor:"rgb(51,153,255)",pointSize:[24,9],checkSize:7,rotateCheckSize:10,moveSensitivity:10,moveDummyThreshold:32,moveDummyPosition:[0,0,-16,-16],moveDummyLineExtraShift:[-32,0],moveDummySensitivity:16,keepAspectRatio:!1,rotateRound:Math.PI/2,shiftRotateRound:Math.PI/12,rotateSensitivity:Math.PI/60,rotateAsClock:!1,rotateTipVisible:!0,shiftLineRotateRound:Math.PI/4,anchorMovable:!0,anchorVisible:!0,anchorHideThreshold:25,anchorOutsideVisibleThreshold:.25,anchorRound:.25,anchorSensitivity:.02,smartGuideThreshold:8,curveIntersectSize:5,curvePointIntersectSize:8,edgeHostDetectPerFrame:!0,edgeHostEdgeMaxDistance:12,edgeHostEdgeHighlighColor:"#5d5d5d",edgeHostPointHighlighColor:"red",edgeHostHighlighPeriod:1500,edgeElevationEditable:!1,attachThreshold:25,guideLineVisible:!0,guideLineTextSpacing:0,hoverGuideVisible:!1,hoverGuideColor:null,gridBlockSize:40,gridThickLinesEvery:10,gridThickColor:"#5d5d5d",gridLightColor:"#d0d0d0",gridZoomThreshold:.25,gridAlignmentGuideColor:"#ff0000",gridAngle:Math.PI/2,gridRotation:0,groupRotateModeDefault:"block",groupRotateModeKey:["ctrlKey","metaKey"],rotateCursorSize:32,rotateCursorRound:45,tipTextColor:"#ffffff",tipBackground:"#333333",curveHighlightColor:"#30599e",rectPointBackground:"white",rectPointBorderColor:"#666666",rectPointShadowColor:"rgba(0,0,0,0.35)",shapeCtrlPointBackground:"white",shapeCtrlPointBorderColor:null,shapeCtrlPointHighlightBorder:null,shapeHighlighPointBackground:"#30599e",curveElevationVisible:!0,curveElevationIntersectSize:8,curveElevationGuideShift:[20,0],curveTipVisible:!0,connectGuideVisible:!0,connectGuideShift:[1,.25,8,0],connectGuideIntersectSize:8,connectGuideGarbageIntersectsize:25,connectGuideGarbageShift:[1,1,-48,-48]};var $=U.Icons={},B3=null,f3=U.DefaultStyleMap.baseColor,X3="rgb(255,204,153)",q3=(E.Default.setImage("Icons.RectPoint",{width:6,height:6,comps:[{type:"rect",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return f3}},rect:[0,0,6,6]}]}),$.GroupSubEntityRect={comps:[{type:"shape",points:{func:function(){if(!(G=$.GroupSubEntityRect.data))return[];var p=G.min,G=G.max;return[p.x,p.y,p.x,G.y,G.x,G.y,G.x,p.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return $.GroupSubEntityRect.data.isKeyOb,f3}}}]},$.HoverDataRect={comps:[{type:"shape",points:{func:function(){if(!(G=$.HoverDataRect.data))return[];var p=G.min,G=G.max;return p.x-=4,p.y-=4,G.x+=4,G.y+=4,[p.x,p.y,p.x,G.y,G.x,G.y,G.x,p.y]}},segments:[1,2,2,2,5],background:null,borderWidth:{func:function(){return $.HoverDataRect.data.borderWidth}},borderColor:{func:function(){return $.HoverDataRect.data.color}},borderCap:"butt",borderPattern:{func:function(){return $.HoverDataRect.data.borderPattern}}}]},$.Line={comps:[{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[$.Line.data.P1.x,$.Line.data.P1.y],6,6]}}},{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[$.Line.data.P2.x,$.Line.data.P2.y],6,6]}}}]},$.NodeHoverGuide={comps:[{type:"shape",points:{func:function(){return $.NodeHoverGuide.data}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#3399FF"}]},$.Rect={comps:[{type:"shape",points:{func:function(){if(!(J=$.Rect.data))return[];var p=J.LT,G=J.LB,v=J.RB,J=J.RT;return[p.x,p.y,G.x,G.y,v.x,v.y,J.x,J.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return f3}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return $.Rect.data.rotation}},rect:{func:function(){return[[$.Rect.data.LT.x,$.Rect.data.LT.y],6,6]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return $.Rect.data.rotation}},rect:{func:function(){return[[$.Rect.data.LB.x,$.Rect.data.LB.y],6,6]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return $.Rect.data.rotation}},rect:{func:function(){return[[$.Rect.data.RB.x,$.Rect.data.RB.y],6,6]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return $.Rect.data.rotation}},rect:{func:function(){return[[$.Rect.data.RT.x,$.Rect.data.RT.y],6,6]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return $.Rect.data.rotation}},visible:{func:function(){return!!$.Rect.data.L}},rect:{func:function(){return[[$.Rect.data.L.x,$.Rect.data.L.y],6,6]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return $.Rect.data.rotation}},visible:{func:function(){return!!$.Rect.data.R}},rect:{func:function(){return[[$.Rect.data.R.x,$.Rect.data.R.y],6,6]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return $.Rect.data.rotation}},visible:{func:function(){return!!$.Rect.data.T}},rect:{func:function(){return[[$.Rect.data.T.x,$.Rect.data.T.y],6,6]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return $.Rect.data.rotation}},visible:{func:function(){return!!$.Rect.data.B}},rect:{func:function(){return[[$.Rect.data.B.x,$.Rect.data.B.y],6,6]}}}]},E.Default.setImage("Icons.Anchor",{width:12,height:12,comps:[{type:"shape",borderWidth:1,borderColor:{func:function(){return f3}},borderCap:"round",shadowColor:"#1ABC9C",points:[.50928,6,11.49072,6,6,6,6,.50928,6,11.49072]},{type:"circle",borderWidth:1,borderColor:{func:function(){return f3}},shadowColor:"#1ABC9C",rect:[2.84391,2.84391,6.53697,6.53697]}]}),$.Anchor={comps:[{type:"image",name:"Icons.Anchor",rect:{func:function(){return[[$.Anchor.data.POS.x,$.Anchor.data.POS.y],16,16]}}}]},$.TipShiftX=12,$.TipShiftY=12,[8,28]);$.TipHelper={comps:[{type:"roundRect",rect:{func:function(){return[$.TipHelper.data.helperPos.x,$.TipHelper.data.helperPos.y,q3[0]*$.TipHelper.data.size,q3[1]]}},background:{func:function(){return B3.getStyle("tipBackground")}},opacity:.6},{type:"text",text:{func:function(){return $.TipHelper.data.text}},rect:{func:function(){return[$.TipHelper.data.helperPos.x,$.TipHelper.data.helperPos.y,q3[0]*$.TipHelper.data.size,q3[1]]}},color:{func:function(){return B3.getStyle("tipTextColor")}},font:"bold 12px Arial",align:"center"}]},$.ShapePoint={comps:[{type:"circle",visible:{func:function(){return!!$.ShapePoint.data.dynamicVisible}},rect:{func:function(){var p=$.ShapePoint.data.point,G=$.ShapePoint.data.size||7;return[p,G+10,G+10]}},background:{func:function(){var p=Date.now(),G=$.ShapePoint.data.dynamicPeriod||1500;return"rgba(27,124,22,"+.5*Math.sin(p%G/G*Math.PI)+")"}},borderWidth:0},{type:"circle",rect:{func:function(){var p=$.ShapePoint.data.point,G=$.ShapePoint.data.size||7;return[p,G,G]}},background:{func:function(){return $.ShapePoint.data.isEnd?"rgba(27,124,222,0.7)":"#ffffff"}},borderWidth:1,borderColor:{func:function(){return $.ShapePoint.data.color||f3}}},{type:"rect",visible:{func:function(){return!!$.ShapePoint.data.dynamicVisible}},background:"red",borderWidth:0,rotation:Math.PI/4,borderColor:{func:function(){return f3}},rect:{func:function(){return[$.ShapePoint.data.point,5,5]}}}]},$.ShapeBgCurve={comps:[{type:"shape",visible:{func:function(){return!!$.ShapeBgCurve.data.dynamicVisible}},points:{func:function(){return $.ShapeBgCurve.data.P}},segments:{func:function(){return $.ShapeBgCurve.data.S}},background:null,borderWidth:6,borderColor:{func:function(){var p=Date.now(),G=$.ShapeBgCurve.data.dynamicPeriod||1500;return"rgba(27,124,22,"+.3*Math.sin(p%G/G*Math.PI)+")"}}},{type:"shape",points:{func:function(){return $.ShapeBgCurve.data.P}},segments:{func:function(){return $.ShapeBgCurve.data.S}},background:null,borderWidth:1,borderColor:{func:function(){return $.ShapeBgCurve.data.color||f3}}}]},$.ShapeHighlighPoint={comps:[{type:"circle",rect:{func:function(){var p=$.ShapeHighlighPoint.data;return[[p.x,p.y],8,8]}},background:{func:function(){return B3.getStyle("shapeHighlighPointBackground")}},borderWidth:0}]},$.ShapeHighlighRealPoint={comps:[{type:"circle",rect:{func:function(){var p=$.ShapeHighlighRealPoint.data;return[[p.x,p.y],10,10]}},background:"#ffffff",borderWidth:2,borderColor:{func:function(){return f3}}}]},$.ShapeHighlighCtrlPoint={comps:[{type:"shape",points:{func:function(){var p=$.ShapeHighlighCtrlPoint.data,G=p.x;return[G-4,(p=p.y)-4,G-4,p+4,G+4,p+4,G+4,p-4]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return B3.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return B3.getStyle("shapeCtrlPointBorderColor")||f3}}}]},$.ShapeHighlightCurve={comps:[{type:"shape",points:{func:function(){return $.ShapeHighlightCurve.data}},segments:[1,4],background:null,borderWidth:3,borderColor:{func:function(){return B3.getStyle("curveHighlightColor")}}}]},$.ShapeGuideLine={comps:[{type:"shape",points:{func:function(){return $.ShapeGuideLine.data}},background:null,borderWidth:1,borderColor:"rgb(255,204,153)"}]},$.MoveLineGuide={comps:[{type:"shape",points:{func:function(){return $.MoveLineGuide.data.rect}},background:null,borderWidth:1,borderColor:{func:function(){return $.MoveLineGuide.data.center?"rgb(183,232,135)":X3}}}]},$.MoveLineGuideDistanceH={comps:[{type:"shape",points:{func:function(){var p=$.MoveLineGuideDistanceH.data,G=p.x0;return[G,(p=p.y0)-5,G,p+5]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:X3},{type:"shape",points:{func:function(){var p=$.MoveLineGuideDistanceH.data,G=p.x1;return[G,(p=p.y1)-5,G,p+5]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:X3},{type:"text",text:{func:function(){return Math.round($.MoveLineGuideDistanceH.data.dis)}},rect:{func:function(){var p=$.MoveLineGuideDistanceH.data;return[[(p.x0+p.x1)/2,p.y0-10],20,20]}},color:X3,font:"12px Arial",align:"center"}]},$.MoveLineGuideDistanceV={comps:[{type:"shape",points:{func:function(){var p=$.MoveLineGuideDistanceV.data,G=p.x0;return[G-5,p=p.y0,G+5,p]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:X3},{type:"shape",points:{func:function(){var p=$.MoveLineGuideDistanceV.data,G=p.x1;return[G-5,p=p.y1,G+5,p]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:X3},{type:"text",text:{func:function(){return Math.round($.MoveLineGuideDistanceV.data.dis)}},rect:{func:function(){var p=$.MoveLineGuideDistanceV.data;return[[p.x0-10,(p.y0+p.y1)/2],20,20]}},color:X3,font:"12px Arial",align:"center"}]},E.Default.setImage("Icons.EdgeElevationGuideImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[.5,.5,15,15]},{type:"shape",borderWidth:2,borderColor:"rgb(44,44,44)",borderCap:"round",points:[4,8,8,4,12,8,8,4,8,13],segments:[1,2,2,1,2]}]}),$.EdgeElevationGuide={comps:[{type:"image",name:"Icons.EdgeElevationGuideImage",rect:{func:function(){var p=(G=$.EdgeElevationGuide.data).x,G=G.y,v=B3.getStyle("curveElevationIntersectSize"),J=B3.getStyle("curveElevationGuideShift");return[(p+=J[0])-v,(G+=J[1])-v,2*v,2*v]}}}]},E.Default.setImage("Icons.ConnectGuideBgImage",{width:12,height:12,comps:[{type:"shape",background:"#3399ff",fillRule:"evenodd",shadowColor:"#1ABC9C",rotation:3.14159,points:[6.00001,11.99999,6.00001,11.99999,2.6863,11.99999,1e-5,9.30695,1e-5,5.99999,1e-5,5.99999,1e-5,2.68628,2.69305,-1e-5,6.00001,-1e-5,12.00001,-1e-5,11.99998,12.00001,6.00001,11.99999],segments:[1,2,4,2,4,2,2,2]}]}),E.Default.setImage("Icons.ConnectGuideHeaderImage",{width:12,height:12,comps:[{type:"oval",background:"#3399FF",borderColor:"#3399FF",shadowColor:"#1ABC9C",rect:[0,0,12,12]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[4.76,2.56,8.2,5.98,4.76,9.44]}]}),$.ConnectGuide={comps:[{type:"image",name:"Icons.ConnectGuideBgImage",rotation:{func:function(){return $.ConnectGuide.data.rotation}},rect:{func:function(){var p=$.ConnectGuide.data.connect,G=(p.x,p.y,B3.getStyle("connectGuideIntersectSize"));return[[p.x,p.y],2*G,2*G]}}},{type:"image",name:"Icons.ConnectGuideHeaderImage",rect:{func:function(){var p=$.ConnectGuide.data.cursorPos||$.ConnectGuide.data.connect,G=B3.getStyle("connectGuideIntersectSize");return[[p.x,p.y],2*G-2,2*G-2]}}},{type:"shape",background:null,borderColor:"#3399ff",borderWidth:2,segments:[1,4],points:{func:function(){var p=$.ConnectGuide.data.connect,G=$.ConnectGuide.data.cursorPos||p;return[p.x,p.y,p.x+.5*(G.x-p.x),p.y,G.x+.5*(p.x-G.x),G.y,G.x,G.y]}}}]},E.Default.setImage("Icons.ConnectGuideGarbageImage",{width:48,height:48,comps:[{type:"oval",background:"rgba(0,0,0,0.1)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,48,48]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[19.84721,19.69091,19.84721,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[24.10371,19.69091,24.10371,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[28.15279,19.69091,28.15279,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[11.23055,15.22377,36.76945,15.189,19.12302,15.17121,20.94722,11.5228,26.41985,11.5228,28.24406,15.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[15.48702,15.22377,17.02595,21.25344]}]}),E.Default.setImage("Icons.ConnectGuideDeletingImage",{width:56,height:56,comps:[{type:"oval",background:"rgba(232,0,0,0.75)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,56,56]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[22.67939,27.69091,22.67939,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[26.93588,27.69091,26.93588,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[30.98497,27.69091,30.98497,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",anchorX:0,anchorY:1,rotation:5.65062,points:[14.06272,23.22377,39.60163,23.189,21.9552,23.17121,23.7794,19.5228,29.25203,19.5228,31.07623,23.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[18.3192,23.22377,17.02595,21.25344]}]}),$.ConnectGuideGarbage={comps:[{type:"image",name:{func:function(){return $.ConnectGuideGarbage.data.hover?"Icons.ConnectGuideDeletingImage":"Icons.ConnectGuideGarbageImage"}},rect:{func:function(){var p=$.ConnectGuideGarbage.data,G=B3.getStyle("connectGuideGarbageIntersectsize");return p.hover&&(G+=5),[[p.x,p.y],2*G,2*G]}}}]},$.ShapeActivingCtrl={comps:[{type:"shape",visible:{func:function(){return!!$.ShapeActivingCtrl.data.c1}},points:{func:function(){var p=$.ShapeActivingCtrl.data;return[p.point.x,p.point.y,p.c1.x,p.c1.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return f3}}},{type:"shape",visible:{func:function(){return!!$.ShapeActivingCtrl.data.c2}},points:{func:function(){var p=$.ShapeActivingCtrl.data;return[p.point.x,p.point.y,p.c2.x,p.c2.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return f3}}},{type:"shape",visible:{func:function(){return!!$.ShapeActivingCtrl.data.c1}},points:{func:function(){var p=(G=$.ShapeActivingCtrl.data.c1).x,G=G.y,v=3;return"c1"===$.ShapeActivingCtrl.data.hl&&(v+=.5),[p-v,G-v,p-v,G+v,p+v,G+v,p+v,G-v]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return B3.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c1"===$.ShapeActivingCtrl.data.hl?B3.getStyle("shapeCtrlPointHighlightBorder")||f3:B3.getStyle("shapeCtrlPointBorderColor")||f3}}},{type:"shape",visible:{func:function(){return!!$.ShapeActivingCtrl.data.c2}},points:{func:function(){var p=(G=$.ShapeActivingCtrl.data.c2).x,G=G.y,v=3;return"c2"===$.ShapeActivingCtrl.data.hl&&(v+=.5),[p-v,G-v,p-v,G+v,p+v,G+v,p+v,G-v]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return B3.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c2"===$.ShapeActivingCtrl.data.hl?B3.getStyle("shapeCtrlPointHighlightBorder")||f3:B3.getStyle("shapeCtrlPointBorderColor")||f3}}}]},$.RoundPoint={comps:[{type:"circle",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return f3}},rect:{func:function(){return[[$.RoundPoint.data.x,$.RoundPoint.data.y],6,6]}}}]},$.AttachPoint={comps:[{type:"rect",background:{func:function(){return $.AttachPoint.data.isAttach?"rgb(51,153,255)":"rgb(247,247,247)"}},borderWidth:1,rotation:Math.PI/4,borderColor:{func:function(){return f3}},rect:{func:function(){var p=$.AttachPoint.data.isAttach?10:6;return[[$.AttachPoint.data.x,$.AttachPoint.data.y],p,p]}}}]},$.SimpleRect={comps:[{type:"rect",background:null,borderWidth:{func:function(){return $.SimpleRect.data.borderWidth||1}},borderColor:{func:function(){return $.SimpleRect.data.color||f3}},rect:{func:function(){var p=$.SimpleRect.data;return[p.x,p.y,p.width,p.height]}}}]},E.Default.setImage("Icons.MoveDummyImage",{width:32,height:32,boundExtend:12,attachStyle:"close",comps:[{type:"oval",background:"rgb(255,255,255)",borderColor:"#979797",shadow:!0,shadowColor:"rgba(0,0,0,0.25)",shadowOffsetX:0,rect:[0,0,32,32]},{type:"shape",background:"rgb(51,153,255)",pixelPerfect:!0,points:[8.65079,11.90713,9.05502,11.46921,9.70629,11.46921,10.11052,11.90713,10.51476,12.28891,10.51476,12.92895,10.11052,13.34441,8.49359,14.97258,12.2889,14.97258,12.85034,14.97258,13.29949,15.42172,13.29949,15.99439,13.29949,16.57828,12.85034,17.0162,12.2889,17.0162,8.49359,17.0162,10.11052,18.6556,10.51476,19.0486,10.51476,19.7111,10.11052,20.09288,9.70629,20.50834,9.05502,20.50834,8.65079,20.09288,5.32709,16.76917,5.28217,16.71303,4.87794,16.32002,4.87794,15.67998,5.28217,15.26452,8.65079,11.90713,8.65079,11.90713,8.65079,11.90713,13.3444,10.09931,13.3444,10.09931,12.94017,10.50354,12.2889,10.50354,11.88467,10.09931,11.48043,9.69507,11.48043,9.0438,11.88467,8.63957,15.27574,5.25973,15.66874,4.86672,16.32001,4.86672,16.73547,5.25973,16.76917,5.31586,20.10409,8.63957,20.50832,9.0438,20.50832,9.68385,20.10409,10.09931,19.69986,10.49231,19.07105,10.50354,18.64436,10.09931,17.02742,8.45991,17.02742,12.26646,17.02742,12.83912,16.55581,13.31072,15.99438,13.31072,15.43295,13.31072,14.98379,12.83912,14.98379,12.26646,14.96134,8.45991,13.3444,10.09931,13.3444,10.09931,13.3444,10.09931,21.90069,13.33318,21.90069,13.33318,21.49646,12.91771,21.49646,12.27768,21.90069,11.89591,22.31615,11.45798,22.94497,11.45798,23.36043,11.89591,26.72904,15.2533,27.12205,15.66876,27.12205,16.3088,26.72904,16.7018,26.6729,16.75794,23.36043,20.08165,22.94497,20.49711,22.31615,20.49711,21.90069,20.08165,21.49646,19.69987,21.49646,19.03737,21.90069,18.64437,23.51763,17.00498,19.72231,17.00498,19.14965,17.00498,18.71173,16.56705,18.71173,15.98316,18.71173,15.41049,19.14965,14.96135,19.72231,14.96135,23.51763,14.96135,21.90069,13.33318,21.90069,13.33318,21.90069,13.33318,11.88467,23.32675,11.88467,23.32675,11.48043,22.94498,11.48043,22.27125,11.88467,21.88948,12.2889,21.48523,12.94017,21.48523,13.3444,21.88948,14.96134,23.52887,14.98379,19.7111,14.98379,19.14966,15.43295,18.67805,15.99438,18.67805,16.55581,18.67805,17.02742,19.14966,17.02742,19.7111,17.02742,23.52887,18.64436,21.88948,19.07105,21.48523,19.69986,21.48523,20.10409,21.88948,20.50832,22.27125,20.50832,22.94498,20.10409,23.32675,16.76917,26.65045,16.73547,26.72905,16.32001,27.13329,15.66874,27.13329,15.27574,26.72905,11.88467,23.32675,11.88467,23.32675,11.88467,23.32675],segments:[1,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2]}]}),$.MoveDummy={comps:[{type:"image",name:"Icons.MoveDummyImage",rect:{func:function(){var p=$.MoveDummy.data;return[[p.pos.x,p.pos.y],2*p.size,2*p.size]}}}]},U.Icons.DrawIcon=function(p,G,v,J){v.width=v.height=1e4,v.data=J,B3=p,E.Default.drawImage(G,v,0,0,1e4,1e4),B3=K},U.Icons.MapPoints=function(p,G){for(var v=0,J=p.length;v<J;v++)p[v]/=G},U.roundTo=function(p,G,v){var J=Math.abs(p%G);return J<v||G-J<v?G*Math.round(p/G):p},U.toFixed=function(p){return Math.round(100*p)/100},U.getDataMatrix=function(p){var G,v;return p instanceof E.Shape?(G=new E.Math.Matrix2d,v=p.getPosition(),G.translate(-v.x,-v.y).scale(p.getScale().x,p.getScale().y).rotate(p.getRotation()).translate(v.x,v.y),G):p.getMatrix?p.getMatrix():new E.Math.Matrix2d},(((p=U.Math.Curve=function(){this._curves=[]}).prototype={}).constructor=p).prototype.createFromHtShape=function(G,p,v){p instanceof E.List&&(p=p.toArray());for(var J,$,S,O,W=null,l=null,t=0,z=U.Math.Vector2,Z=U.Math.CubicBezier,B=function(p){return new z(G[p],G[p+1],v?v[p/2]:K)},f=0,X=p.length;f<X;f++){switch($=null,p[f]){case 1:W=l=B(t),t+=2;break;case 2:J=B(t),t+=2,$=new Z(l,l.clone(),J.clone(),J),l=J;break;case 3:S=B(t),J=B(t+2),t+=4,$=new Z(l,S.clone().sub(l).multiplyScalar(2/3).add(l),S.clone().sub(J).multiplyScalar(2/3).add(J),J),l=J;break;case 4:S=B(t),O=B(t+2),J=B(t+4),t+=6,$=new Z(l,S,O,J),l=J;break;case 5:if(!W)break;$=new Z(l,l.clone(),W.clone(),W),W=l=null}$&&($._index=this._curves.length,this._curves.push($))}},p.prototype.checkPoint=function(p,G){for(var v,J,$,S=this._curves,O=0,W=S.length;O<W;O++)if(($=(J=S[O]).intersectRect(p,G,G)).length)return v=0,$.forEach(function(p){v+=p.t}),v/=$.length,(p=J.getPointAt(v)).t=v,{bezier:J,intersection:p}},p.prototype.insertKnot=function(p,G){G=p.insertKnot(G),this._curves.splice(p._index,1,G[0],G[1])},p.prototype._isCloseEnough=function(p,G){return Math.abs(p.x-G.x)<1e-6&&Math.abs(p.y-G.y)<1e-6},p.prototype._isSamePoint=function(p,G){return p===G},p.prototype.moveRealPoint=function(J,$){var S=this,p=S._curves,O=$.clone().sub(J);p.forEach(function(p){var G=p._p1,v=(p._p2,p._p3,p._p4);S._isSamePoint(G,J)&&(p._p2.add(O),p._p1=$),S._isSamePoint(v,J)&&(p._p3.add(O),p._p4=$)})},p.prototype.moveCtrlDueToRealPointMovement=function(J,G){function $(p){p.add(G),p.e&&G.e&&(p.e+=G.e)}var S=this;S._curves.forEach(function(p){var G=p._p1,v=(p._p2,p._p3,p._p4);S._isSamePoint(G,J)&&$(p._p2),S._isSamePoint(v,J)&&$(p._p3)})},p.prototype.moveCtrlPoint=function(p,v,J){var $,G,S=p[J];S&&(S.e!==K&&(v.e=S.e),G=($=this)._curves,v.clone().sub(S),G.forEach(function(p){var G;"c2"===J?G="_p2":"c1"===J&&(G="_p3"),$._isSamePoint(p[G],S)&&(p[G]=v)}),p[J]=v)},p.prototype.deleteRealPoint=function(p,G){for(var v,J,$,S,O=this._curves,W={},l=[],t=U.Math.CubicBezier,z=0,Z=O.length;z<Z;z++)J=(v=O[z])._p1,$=v._p2,v._p3,S=v._p4,!W[z]&&this._isSamePoint(J,p)||(this._isSamePoint(S,p)?z+1<Z&&this._isSamePoint(O[z+1]._p1,p)&&(G||l.push(new t(J,$,O[z+1]._p3,O[z+1]._p4))):l.push(v));this._curves=l},p.prototype.findPairs=function(p,G){for(var v,J,$,S,O=this._curves,W={},l=[],t=0,z=O.length;t<z;t++)v=($=O[t])._p1,S=$._p2,J=$._p3,$=$._p4,!W[t]&&this._isSamePoint(v,p)&&(G?l.push({point:v,r2:$}):l.push({point:v,c2:S})),this._isSamePoint($,p)&&(S=G?{point:$,r1:v}:{point:$,c1:J},t+1<z&&this._isSamePoint(O[t+1]._p1,p)&&(G?S.r2=O[t+1]._p4:S.c2=O[t+1]._p2,W[t+1]=!0),l.push(S));return l},p.prototype.toHtShape=function(){var $=this,p=$._curves,S=[],O=[],W={x:1/0,y:1/0};return p.forEach(function(p){var G=p._p1,v=p._p2,J=p._p3,p=p._p4;if($._isCloseEnough(G,W)||(S.push(1),O.push(G.clone())),W=p,$._isCloseEnough(G,v)&&$._isCloseEnough(J,p))return S.push(2),void O.push(p.clone());S.push(4),O.push(v.clone(),J.clone(),p.clone())}),{segments:S,points:O}};(G=U.Math.CubicBezier=function(p,G,v,J){this._id=U.Math.CubicBezier._globalId++,this._p1=p,this._p2=G,this._p3=v,this._p4=J})._globalId=1,((G.prototype={}).constructor=G).prototype.toString=function(){return this._id},G.prototype.intersectRect=function(p,G,v){var G=G/2,v=v/2,J=p.x,p=p.y,$=new(S=U.Math.Vector2)(-G+J,-v+p),G=new S(G+J,v+p),J=new S(G.x,$.y),v=new S($.x,G.y),p=this.intersectLine($,J),S=this.intersectLine(J,G),J=this.intersectLine(G,v),G=this.intersectLine(v,$);return p.concat(S).concat(J).concat(G)},G.prototype.intersectLine=function(p,G){var v=p.clone().min(G),J=p.clone().max(G),$=this._p1,S=this._p2,O=this._p3,W=this._p4,l=$.clone().multiplyScalar(-1),t=S.clone().multiplyScalar(3),z=O.clone().multiplyScalar(-3),W=l.add(t).add(z).add(W);l=$.clone().multiplyScalar(3),t=S.clone().multiplyScalar(-6),z=O.clone().multiplyScalar(3),O=l.add(t).add(z),l=$.clone().multiplyScalar(-3),t=S.clone().multiplyScalar(3);for(var z=l.add(t),S=$.clone(),l=new U.Math.Vector2(p.y-G.y,G.x-p.x),t=p.x*G.y-G.x*p.y,Z=this.getRoots(l.dot(W),l.dot(O),l.dot(z),l.dot(S)+t),B=new Array,f=0,X=Z.length;f<X;f++){var q,g=Z[f];g<0||1<g||((q=this.getPointAt(g)).t=g,p.x==G.x?v.y<=q.y&&q.y<=J.y&&B.push(q):p.y==G.y?v.x<=q.x&&q.x<=J.x&&B.push(q):q.x>=v.x&&q.y>=v.y&&q.x<=J.x&&q.y<=J.y&&B.push(q))}return B},G.prototype.solveTForPoint=function(p){for(var G=this._p1.x-p.x,v=this._p2.x-p.x,J=this._p3.x-p.x,$=this._p4.x-p.x,S=this.getRoots($-3*J+3*v-G,3*J-6*v+3*G,3*v-3*G,G),O=K,W=1/0,l=0,t=S.length;l<t;l++){var z,Z=S[l];Z<0||1<Z||((z=this.getPointAt(Z)).t=Z,(Z=Math.abs(z.y-p.y))<W&&(W=Z,O=z))}return O},G.prototype.getPointAt=function(p){var G=this._p1,v=this._p2,J=this._p3,$=this._p4,G=G.clone().lerp(v,p),v=v.clone().lerp(J,p),J=J.clone().lerp($,p),$=G.lerp(v,p),G=v.lerp(J,p);return $.lerp(G,p)},G.prototype.getPointByPercentage=function(p){var G=this.length*p,v=this._cacheLength,J=v.length;if(0==G)return v[0].point;if(1<=p)return v[J-1].point;for(var $=0;$<J;$++){var S,O=v[$];if(!(O.len<G))return S=v[$-1],O.point.clone().sub(S.point).setLength(G-S.len).add(S.point)}},G.prototype.getTByPercentage=function(p){var G=this.length*p,v=this._cacheLength,J=v.length;if(0==G||p<=0)return v[0].t;if(1<=p)return v[J-1].t;for(var $=0;$<J;$++){var S,O=v[$];if(!(O.len<G))return(G-(S=v[$-1]).len)/(O.len-S.len)*(O.t-S.t)+S.t}},G.prototype.getRoots=function(p,G,v,J){var $,S,O,W,l=new Array,t=(Math.abs(p)<1e-6&&(0<(t=($=v/(O=G))*$-J/O*4)?(S=Math.sqrt(t),l.push(.5*(-$+S)),l.push(.5*(-$-S))):0==t&&l.push(.5*-$)),(G/=p)/3),p=($=(2*G*G*G-9*(v/=p)*G+27*(J/=p))/27)*$/4+(O=(3*v-G*G)/3)*O*O/27,J=$/2;return 0<(p=Math.abs(p)<=1e-6?0:p)?(v=0<=(W=-J+(S=Math.sqrt(p)))?Math.pow(W,1/3):-Math.pow(-W,1/3),0<=(W=-J-S)?v+=Math.pow(W,1/3):v-=Math.pow(-W,1/3),l.push(v-t)):p<0?(G=Math.sqrt(-O/3),$=Math.atan2(Math.sqrt(-p),-J)/3,S=Math.cos($),v=Math.sin($),O=Math.sqrt(3),l.push(2*G*S-t),l.push(-G*(S+O*v)-t),l.push(-G*(S-O*v)-t)):(W=0<=J?-Math.pow(J,1/3):Math.pow(-J,1/3),l.push(2*W-t),l.push(-W-t)),l},G.prototype._70I=function(){return this._p1.distanceToSquared(this._p2)<1e-10&&this._p3.distanceToSquared(this._p4)<1e-10},G.prototype.insertKnot=function(p){var G=this._p1,v=this._p2,J=this._p3,$=this._p4,S=G.clone().lerp(v,p),v=v.clone().lerp(J,p),J=J.clone().lerp($,p),O=S.clone().lerp(v,p),v=v.clone().lerp(J,p),W=O.clone().lerp(v,p);return this._70I()?(G.clone().lerp($,p),[new U.Math.CubicBezier(G,G.clone(),W.clone(),W),new U.Math.CubicBezier(W,W.clone(),$.clone(),$)]):[new U.Math.CubicBezier(G,S,O,W),new U.Math.CubicBezier(W,v,J,$)]},d.defineProperties(G.prototype,{length:{get:function(){if(!(p=this._cacheLength))for(var p=this._cacheLength=[],G=this._p1,v=0,J=0;v<=1;){var $=this.getPointAt(v+=.001);J+=$.clone().sub(G).length(),p.push({len:J,t:v,point:(G=$).clone()})}return p[p.length-1].len}},p1:{get:function(){return this._p1},set:function(p){this._p1=p,this._cacheLength=K}},p2:{get:function(){return this._p2},set:function(p){this._p2=p,this._cacheLength=K}},p3:{get:function(){return this._p3},set:function(p){this._p3=p,this._cacheLength=K}},p4:{get:function(){return this._p4},set:function(p){this._p4=p,this._cacheLength=K}}});var g3,M3,L3,H3,xI=E.Default.getInternal().ui().EdgeUI,_3={_47O:function(p){var G=_3.getBackups()._47O;U.inEdit(this.gv)||G.call(this,p)}},yI=(U.Inject.registAsModule(_3,xI),E.Default.getInternal().ui().NodeUI),b3={_47O:function(p){var G=b3.getBackups()._47O;U.inEdit(this.gv)||G.call(this,p)},getSelectWidth:function(){var p=this.gv,G=this._data;return p.isEditable(G)&&U.inEdit(p)?0:b3.getBackup("getSelectWidth").call(this)}},n3=(U.Inject.registAsModule(b3,yI),E.graph.GraphView),D3={_editPointSize:(i0=E.Default.isTouchable,U.getStyle("pointSize")[i0?0:1]),isPointEditable:function(p){if(U.inEdit(this))return!this._pointEditableFunc||this._pointEditableFunc(p);D3.getBackup("isPointEditable").call(this,p)},isEditable:function(p){var G=D3.getBackup("isEditable"),G=p instanceof U.Group||G.call(this,p);return U.inEdit(this)&&p instanceof E.Edge?!!p.s("2d.editable")&&(!(G=this.getEditableFunc())||G(p)):G},_42:function(p,G){D3.getBackups()._42.call(this,p,G),U.inEdit(this)&&this.getEditInteractor().drawImpl()}},KI=(U.Inject.registAsModule(D3,n3),E.Default.getInternal().ui().ShapeUI),Y3={_47O:function(p){var G=Y3.getBackups()._47O;U.inEdit(this.gv)||G.call(this,p)}},G3=(U.Inject.registAsModule(Y3,KI),E.graph.DefaultInteractor),s3={handle_mousewheel:function(p){var G=s3.getBackup("handle_mousewheel");U.inEdit(this.gv)||G.call(this,p)}},J3=(U.Inject.registAsModule(s3,G3),E.graph.MoveInteractor),c3={_calcShift:function(p,G){var v=c3.getBackup("_calcShift"),J=this.gv;return U.inEdit(J)&&J.getEditInteractor().getSubModule("Move").calcShift(p,G,this)||v.call(this,p,G)},clear:function(p){c3.getBackup("clear").call(this,p);var G=this.gv;U.inEdit(G)&&G.getEditInteractor().getSubModule("Move").clear(p)}};U.Inject.registAsModule(c3,J3),(((S=U.Rect=function(p){this.catalog="Rect",this._interactor=p}).prototype={}).constructor=S).prototype.gatherInfo=function(p,G){var v;return 1===G.length?(v=G[0])instanceof E.Shape&&v._70I()?this.gatherLine(p,v):!BS(v,p)&&this.gatherSingleTarget(p,v):1<G.length&&this.gatherMultiTargets(p,G)},S.prototype.gatherSingleTarget=function(p,G){if(G.getCorners){var v,J,$=this.info,S=(this.target=G,v=this.screenInfo={},G.getCorners());for(J in $.LT=new U.Math.Vector2(S[0]),$.LB=new U.Math.Vector2(S[1]),$.RB=new U.Math.Vector2(S[2]),$.RT=new U.Math.Vector2(S[3]),$.T=$.LT.clone().add($.RT).divideScalar(2),$.B=$.LB.clone().add($.RB).divideScalar(2),$.L=$.LT.clone().add($.LB).divideScalar(2),$.R=$.RT.clone().add($.RB).divideScalar(2),$)v[J]=U.toScreenPosition(p,$[J]);var O=this._interactor.getStyle("checkSize");return v.rotLT=(S=function(p,G,v){return G=G.clone().sub(p).setLength(-O),v=v.clone().sub(p).setLength(-O),G.add(v).add(p)})(v.LT,v.RT,v.LB),v.rotLB=S(v.LB,v.LT,v.RB),v.rotRB=S(v.RB,v.LB,v.RT),v.rotRT=S(v.RT,v.LT,v.RB),v.rotT=v.rotLT.clone().add(v.rotRT).divideScalar(2),v.rotB=v.rotLB.clone().add(v.rotRB).divideScalar(2),v.rotL=v.rotLT.clone().add(v.rotLB).divideScalar(2),v.rotR=v.rotRT.clone().add(v.rotRB).divideScalar(2),v.rotation=G.getRotation(),this.gatherConnectInfo(),!0}},S.prototype.gatherConnectInfo=function(){var p,G,v=this.target,J=this._interactor,$=this.screenInfo,S=J.gv;S.isConnectActionVisible(v)&&J.getStyle("connectGuideVisible")&&(p=(p=v.s?v.s("connectGuideShift"):p)||J.getStyle("connectGuideShift"),J=v.getAnchor(),G=v.getSize(),v=v.toGlobal({x:G.width*(p[0]-J.x),y:G.height*(p[1]-J.y)}),v=U.toScreenPosition(S,v),$.P1?v.add($.P2.clone().sub($.P1).setLength(p[2])):(v.add($.RT.clone().sub($.LT).setLength(p[2])),v.add($.LB.clone().sub($.LT).setLength(p[3]))),$.connect=v)},S.prototype.gatherMultiTargets=function(p,G){return!!(G=U.Group.findOrCreateGroup(G,this._interactor._uuid))&&(this.editing&&"rotate"!==this.editing.mode||G.calcInfo(),this.gatherSingleTarget(p,G))},S.prototype.gatherLine=function(p,G){this.target=G;var v=this.screenInfo={},J=G.getPoints(),G=U.getDataMatrix(G);return v.P1=U.toScreenPosition(p,G.apply(J.get(0))),v.P2=U.toScreenPosition(p,G.apply(J.get(1))),this.gatherConnectInfo(),!0},S.ResizeKeys=["LT","RB","LB","RT","L","R","B","T"],S.ResizeDirection=[{x:-1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}],S.RotateKeys=["rotLT","rotRB","rotLB","rotRT","rotL","rotR","rotB","rotT"],S.prototype.check=function(p,G,v){if(E.Default.isLeftButton(G)){var J=this;if(J.editing=null,J.tipInfo=null,J.screenInfo){var $=J.target,S=p.isEditable($),O=J.screenInfo;if(S&&O.connect)if(t=J._checkConnect(v))return t;if(O.P1)return J._checkLine(v);var W,l,t,z=null,Z=(t=J._interactor).getStyle("checkSize");if(S&&p.isRectEditable($))for(f=0;f<U.Rect.ResizeKeys.length;f++)if(l=U.Rect.ResizeKeys[f],U.checkHit(v,O[l],Z)){z=l,W="resize";break}if(!z&&S&&p.isRotationEditable($)&&!t.getStyle("rotateAsClock"))for(var B=t.getStyle("rotateCheckSize"),f=0;f<U.Rect.RotateKeys.length;f++)if(l=U.Rect.RotateKeys[f],U.checkHit(v,O[l],B)){z=l,W="rotate";break}if(z){if("rotate"===W){if(S=p.lp(G),$ instanceof U.Group){for(var X=t.getStyle("groupRotateModeKey"),q=!1,g=0,M=(X="string"==typeof X?[X]:X).length;g<M;g++)if(G[X[g]]){q=!0;break}var p=t.getStyle("groupRotateModeDefault"),L=q?"batch"===p?"block":"batch":p}p="batch"===L?$.getAnchor2():$.getPosition(),S=Math.atan2(S.y-p.y,S.x-p.x),t._setRotateCursor(S),J.editing={mode:W,key:z,pos:p,flipY:$.getScale().y<0,rotation:$.getRotation(),hitRot:S},L&&(J.editing.groupRotateMode=L)}else{var p=U.Rect.ResizeKeys.indexOf(z),S=U.Rect.ResizeDirection[p],L=Math.cos($.getRotation()),p=Math.sin($.getRotation()),H=S.x*Math.sign($.getScale().x),S=S.y*Math.sign($.getScale().y),L=Math.atan2(-p*H-L*S,L*H-p*S),H=(Math.round(L/(Math.PI/4))+8)%8,p=(this._interactor.setCursor(["ew-resize","nesw-resize","ns-resize","nwse-resize","ew-resize","nesw-resize","ns-resize","nwse-resize"][H]),$.getWidth()),S=$.getHeight(),L=$.getAnchor();J.editing={mode:W,key:z,rect:{x:-p*L.x,y:-S*L.y,width:p,height:S},anchor:L,matrix:$.getMatrix()}}return z}t.setCursor("default")}}},S.prototype._checkLine=function(p){this.screenInfo;var G,v=this._interactor.getStyle("checkSize");if(U.checkHit(p,this.screenInfo.P1,v))G="P1";else{if(!U.checkHit(p,this.screenInfo.P2,v))return void this._interactor.setCursor("default");G="P2"}return this.editing={mode:"line",key:G},G},S.prototype._checkConnect=function(p){var G,v,J=this.screenInfo,$=this._interactor,S=$.getStyle("connectGuideIntersectSize"),J=J.connect,O=p.x,W=J.x;if(O<W&&W-O<S&&Math.abs(J.y-p.y)<S||W<=O&&U.checkHit(p,J,S))return G=N.getConnectAction($.gv),this.editing={mode:"connect"},G&&G.delete&&(this.target instanceof U.Group?(v=!0,$.gv.sm().getSelection().each(function(p){G.delete.visible.call(null,$.gv,p)||(v=!1)}),this.editing.hasDeleteAction=v):G.delete.visible.call(null,$.gv,this.target)&&(this.editing.hasDeleteAction=!0)),$.setCursor("default"),"connect"},S.prototype._fireEditEvent=function(p,G){var v=this._interactor,J=this.editing;J&&(J="rotate"===(J=J.mode)?"Rotation":"connect"===J?"Connection":"resize"===J?"Rect":J[0].toUpperCase()+J.slice(1),v.fi({kind:p+"Edit"+J,event:G}))},S.prototype.startEdit=function(p,G){p.startDragging(G),this._interactor.fi({kind:"prepareEdit",event:G});var v,J=this.editing,$=this.target;if(J){if(this._fireEditEvent("begin",G),J.started=!0,"rotate"===J.mode)return J.groupRotateMode&&$.beginRotate(J),void p._42();"connect"===J.mode?J.hasDeleteAction&&(G=p.gv,v=this._interactor.getStyle("connectGuideGarbageShift"),J.garbageInfo={x:G.getWidth()*v[0]+v[2],y:G.getHeight()*v[1]+v[3],size:this._interactor.getStyle("connectGuideGarbageIntersectsize")},p._42()):("line"===J.mode||$&&0===$.getRotation())&&(this._inSmartGuide=!0,this._interactor.rectGuide.gatherRects())}},S.prototype._46O=function(p){var G,v,J=this,$=J.editing,S=J.target;if($){if("connect"===$.mode&&!$.canceled&&!$.deleted)try{$.garbageInfo&&$.garbageInfo.hover?N.doDeleteConnectionAction(J._interactor.gv,S):N.doConnectAction(J._interactor.gv,S,$.target)}catch(p){console.error(p)}v=$.freezeFlag,G=J.editing.groupRotateMode,J._fireEditEvent("end",p),J.editing=null}J.tipInfo=null,J._inSmartGuide&&(J._interactor.rectGuide.clear(),J._inSmartGuide=!1),G&&S&&S.endRotate(),S instanceof E.Block&&(v===K?delete S._freezeSyncFromChildren:S._freezeSyncFromChildren=v,S.updateFromChildren())},S.prototype.handleNormalStateDelete=function(){var p=this.editing;if(p&&"connect"===p.mode&&!p.canceled&&!p.deleted){if(p.garbageInfo){try{N.doDeleteConnectionAction(this._interactor.gv,this.target)}catch(p){console.error(p)}p.garbageInfo=null}return p.cursorPos=null,p.targetCorners=null,p.deleted=!0,this._interactor._42(),!0}},S.prototype.handleNormalStateKeyDown=function(p){var G=this.editing;if(G&&"connect"===G.mode&&!G.canceled&&!G.deleted)return E.Default.isEsc(p)?(G.cursorPos=null,G.targetCorners=null,G.canceled=!0,this._interactor._42(),!0):void 0},S.prototype.handleEdit=function(G,p){var v=this,J=v.editing;if(J){var $,S,O=v.target,W=J.key,l=J.mode,t=G.lp(p),z=v._interactor;if("connect"===l)return J.canceled?void 0:J.deleted?void 0:(J.cursorPos=z._getLogicalPoint(p),(L=J.garbageInfo)&&U.checkHit(J.cursorPos,L,L.size)?(L.hover=!0,J.target=null,J.targetCorners=null):(L&&(L.hover=!1),J.target=G.getDataAt(t,function(p){return!!G.isSelectable(p)&&!!k(p)})||null,J.targetCorners=U.getTargetCornersOnScreen(G,J.target)),void z._42());if("rotate"===l){L=J.pos,L=Math.atan2(t.y-L.y,t.x-L.x),H=J.groupRotateMode?L-J.hitRot:(M=L-J.hitRot,J.rotation+M),(H%=2*Math.PI)<0&&(H+=2*Math.PI),E.Default.isCtrlDown(p)||(X=dA(p)?(Z=z.getStyle("shiftRotateRound"))/2:(Z=z.getStyle("rotateRound"),z.getStyle("rotateSensitivity")),H=U.roundTo(H,Z,X)),J.groupRotateMode?0!=(M=H-(J.lastRotation||0))&&(O.addRotation(M,J.groupRotateMode,function(p){return G.isRotationEditable(p)}),J.lastRotation=H):O.setRotation(H),z._setRotateCursor(L),H>Math.PI&&(H-=2*Math.PI);var Z=(H/Math.PI*180).toFixed(2)+"°"}else if("resize"===l){var B,f,X=J.rect,q=X.x,g=X.y,M=X.width,L=X.height,H=J.anchor,_=J.matrix,b=O.s&&O.s("keepAspectRatio")||z.getStyle("keepAspectRatio"),n=(dA(p)&&(b=!b),v._unionPointMode1),D=v._unionPointMode2,D=(!v._inSmartGuide||E.Default.isCtrlDown(p)||b||("L"===W||"R"===W?B="x":"T"!==W&&"B"!==W||(B="y"),v._adsorbedToClosest(t,B),S=!0),Y=_.tfi(t),"LT"===W?(X=n(Y,{x:q+M,y:g+L},M,L,b),f=9):"T"===W?(X=D({x:q,y:Y.y},{x:q+M,y:g+L},M,L,b,"v"),f=1):"RT"===W?(X=n(Y,{x:q,y:g+L},M,L,b),f=33):"L"===W?(X=D({x:Y.x,y:g},{x:q+M,y:g+L},M,L,b,"h"),f=8):"R"===W?(X=D({x:q,y:g},{x:Y.x,y:g+L},M,L,b,"h"),f=32):"LB"===W?(X=n(Y,{x:q+M,y:g},M,L,b),f=12):"B"===W?(X=D({x:q,y:g},{x:q+M,y:Y.y},M,L,b,"v"),f=4):"RB"===W&&(X=n(Y,{x:q,y:g},M,L,b),f=36),_.tf(X.x+X.width*H.x,X.y+X.height*H.y));O instanceof E.Block&&(J.hasOwnProperty("freezeFlag")||(J.freezeFlag=O._freezeSyncFromChildren,O._freezeSyncFromChildren=!0)),O.setPosition(D),O.setSize(X.width,X.height),S&&($=O.getRect(),z.rectGuide.gatherLines({node:O,x:$.x,y:$.y,w:$.width,h:$.height},B,f)),Z=Math.round(X.width)+" * "+Math.round(X.height)}else if("line"===l){if(dA(p)){var n=O.getPoints(),Y="P1"===W?n.get(1):n.get(0),s=t.x-Y.x,c=t.y-Y.y,h=z.getStyle("shiftLineRotateRound"),w=v._shiftDirList;if(!w||v._shiftRotateRound!==h){v._shiftRotateRound=h,v._shiftDirList=w=[];for(var d=0;d<Math.PI;d+=h)w.push({x:O0(d),y:S0(d)})}for(var P,j=0,i=0,r=w.length;i<r;i++){var e=w[i],A=e.x*s+e.y*c;Math.abs(A)>Math.abs(j)&&(j=A,P=e)}t={x:Y.x+P.x*j,y:Y.y+P.y*j},z.rectGuide.clear()}else v._inSmartGuide&&!E.Default.isCtrlDown(p)&&(v._adsorbedToClosest(t),S=!0);M=U.getDataMatrix(O).applyInverse(t),O.setPoint("P1"===W?0:1,M,!0),b=(L=O.getPoints()).get(0),_=L.get(1),q=b.x-_.x,g=b.y-_.y,Z=" "+Math.round(Math.sqrt(q*q+g*g))+" ",S&&($=O.getRect(),z.rectGuide.gatherLines({node:O,x:$.x,y:$.y,w:$.width,h:$.height}))}Z&&((H=E.Default.getLogicalPoint(p,z._canvas)).x+=U.Icons.TipShiftX,H.y+=U.Icons.TipShiftY,v.tipInfo={helperPos:H,text:Z,size:Z.length}),v._fireEditEvent("between",p)}},S.prototype._unionPointMode1=function(p,G,v,J,$){var S;return $&&v&&J&&($=p.x-G.x,S=p.y-G.y,Math.abs($*J)<Math.abs(S*v)?(S=Math.sign(S)*Math.abs($*J/v),p.y=G.y+S):($=Math.sign($)*Math.abs(S*v/J),p.x=G.x+$)),E.Default.unionPoint(p,G)},S.prototype._unionPointMode2=function(p,G,v,J,$,S){var O,p=E.Default.unionPoint(p,G);return $&&v&&J&&("v"===S?(O=p.x+p.width/2,p.width=v*p.height/J,p.x=O-p.width/2):(O=p.y+p.height/2,p.height=J*p.width/v,p.y=O-p.height/2)),p},S.prototype._adsorbedToClosest=function(p,G){var v=(J=this._interactor).rectGuide.findClosest(p,G),J=J.gridGuide.findClosest(p,G),G=1/0,$=1/0;v&&(isFinite(v.x)&&(G=v.x),isFinite(v.y)&&($=v.y)),J&&(isFinite(J.x)&&Math.abs(J.x)<Math.abs(G)&&(G=J.x),isFinite(J.y)&&Math.abs(J.y)<Math.abs($)&&($=J.y)),isFinite(G)&&(p.x+=G),isFinite($)&&(p.y+=$)},S.prototype._42=function(p,G,v){var J=this,$=(J.info={},J.screenInfo=null,J._interactor);if(!$.editDetail&&J.gatherInfo(G,v)){var S=J.editing,v=S?S.groupRotateMode:null,O=J.screenInfo;if("block"!==v||!S||!S.started){if(O.P1?U.Icons.DrawIcon($,p,U.Icons.Line,O):U.Icons.DrawIcon($,p,U.Icons.Rect,O),O.connect&&(U.Icons.DrawIcon($,p,U.Icons.ConnectGuide,{rotation:O.rotation,connect:O.connect,cursorPos:S?S.cursorPos:null}),S)){if(S.targetCorners){for(var W={x:1/0,y:1/0},l={x:-1/0,y:-1/0},t=0,z=S.targetCorners.length;t<z;t+=2)W.x=Math.min(W.x,S.targetCorners[t]),l.x=Math.max(l.x,S.targetCorners[t]),W.y=Math.min(W.y,S.targetCorners[t+1]),l.y=Math.max(l.y,S.targetCorners[t+1]);U.Icons.DrawIcon($,p,U.Icons.HoverDataRect,{min:W,max:l,color:$.getStyle("hoverGuideColor")||$.getStyle("baseColor")})}S.garbageInfo&&U.Icons.DrawIcon($,p,U.Icons.ConnectGuideGarbage,S.garbageInfo)}$.getStyle("rotateTipVisible")&&J.tipInfo&&U.Icons.DrawIcon($,p,U.Icons.TipHelper,J.tipInfo)}J.target instanceof U.Group&&J.target._42($,p,G)}},(((G=U.Anchor=function(p){this.catalog="Anchor",this._interactor=p}).prototype={}).constructor=G).prototype.gatherInfo=function(p,G){if(1!==G.length)return 1<G.length&&this.gatherMultiTargets(p,G);var v=G[0];return v.getAnchor&&!(v instanceof E.Shape&&v._70I()||BS(v,p))?this.gatherSingleTarget(p,G[0]):void 0},G.prototype.gatherSingleTarget=function(p,G){return this.info.POS=G.getPosition(),this.screenInfo.POS=U.toScreenPosition(p,this.info.POS),this.target=G,!0},G.prototype.gatherMultiTargets=function(p,G){return!!(G=U.Group.findOrCreateGroup(G,this._interactor._uuid))&&(this.screenInfo.POS=U.toScreenPosition(p,G.getAnchor2()),this.target=G,!0)},G.prototype.isVisible=function(){var p=this._interactor;if(!1===p.getStyle("anchorVisible"))return!1;var G=this.target;if(G){if(this.editing)return!0;var v=G.getAnchor(),J=p.getStyle("anchorOutsideVisibleThreshold");if(v.x<-J||v.x>1+J||v.y<-J||v.y>1+J)return!0;if(v=G.getSize(),J=G.getScale(),Math.min(Math.abs(v.width*J.x),Math.abs(v.height*J.y))*p.gv._zoom<p.getStyle("anchorHideThreshold"))return!1}return!0},G.prototype.check=function(p,G,v){if(E.Default.isLeftButton(G)&&(G=this._interactor,this.isVisible()&&!1!==G.getStyle("anchorMovable"))){this.editing=null,this.tipInfo=null;var J=this.target;if(J&&p.isAnchorEditable(J)&&p.isEditable(J)&&this.screenInfo&&(p=this.screenInfo.POS)&&U.checkHit(v,new U.Math.Vector2(p),G.getStyle("checkSize")))return J instanceof U.Group?this.editing={}:(v=J.getWidth(),p=J.getHeight(),G=J.getAnchor(),this.editing={rect:{x:-v*G.x,y:-p*G.y,width:v,height:p},anchor:G,matrix:J.getMatrix()}),!0}},G.prototype.startEdit=function(p,G){p.startDragging(G),p.fi({kind:"beginEditAnchor",event:G})},G.prototype._46O=function(p){this.editing&&(this.editing=null,this._interactor.fi({kind:"endEditAnchor",event:p})),this.tipInfo=null},G.prototype.handleEdit=function(p,G){var v=this.target;if(v&&($=this.editing)){var p=p.lp(G),J=this._interactor;if(v instanceof U.Group)return v.setAnchor2(p),void J._42();var p=$.matrix.tfi(p),$=$.rect,S=(p.x-$.x)/$.width,p=(p.y-$.y)/$.height;E.Default.isCtrlDown(G)||($=J.getStyle("anchorRound"),O=J.getStyle("anchorSensitivity"),S=U.roundTo(S,$,O),p=U.roundTo(p,$,O)),v.setAnchor(S,p,!0);($=E.Default.getLogicalPoint(G,J._canvas)).x+=U.Icons.TipShiftX,$.y+=U.Icons.TipShiftY;var O=S.toFixed(2)+", "+p.toFixed(2);this.tipInfo={helperPos:$,text:O,size:O.length},J.fi({kind:"betweenEditAnchor",event:G})}},G.prototype._42=function(p,G,v){this.info={},this.screenInfo={};var J=this._interactor;J.editDetail||this.gatherInfo(G,v)&&this.isVisible()&&(U.Icons.DrawIcon(J,p,U.Icons.Anchor,this.screenInfo),this.tipInfo&&U.Icons.DrawIcon(J,p,U.Icons.TipHelper,this.tipInfo))},(((i0=U.MoveDummy=function(p){this.catalog="MoveDummy",this._interactor=p}).prototype={}).constructor=i0).prototype.gatherInfo=function(p,G){var v=this._interactor.getSubModule("Rect");if(v&&(l=v.screenInfo)){var J=this._interactor;if(this.getMovableTarget(v.target)&&!1!==(v=J.getStyle("moveDummyThreshold"))){var $=l.LT||l.P1,S=l.RT||l.P2,O=l.LB||$;if($){var W,l=l.P1,t=Math.min($.distanceTo(O),$.distanceTo(S));if(!(!0!==v&&v<t))return v=J.getStyle("moveDummyPosition"),t=S.clone().sub($),S=O.clone().sub($),O=v[2],W=v[3],(l=l&&J.getStyle("moveDummyLineExtraShift"))&&(O+=l[0],W+=l[1]),l=$.clone().add(t.clone().multiplyScalar(v[0])).add(t.setLength(O)).add(S.clone().multiplyScalar(v[1])).add(S.setLength(W)),this.screenInfo.pos=l,this.screenInfo.size=J.getStyle("moveDummySensitivity"),!0}}}},i0.prototype.getMovableTarget=function(p){var G=this._interactor.gv;if(k(p)){if(G.isMovable(p))return p}else if(p instanceof U.Group)for(var v=p._entities,J=v.length-1;0<=J;J--){var $=v[J];if(k($)&&G.isMovable($))return $}return null},i0.prototype.getMoveInteractor=function(){for(var p,G=this._interactor.gv.getInteractors(),v=0,J=G.length;v<J;v++)if((p=G.get(v))instanceof J3)return p},i0.prototype.startEdit=function(p,G){p.startDragging(G);var v,J=this.getMoveInteractor();J&&(v=this.selectedTarget,(p=p.gv)._moving=1,J._data=v,p.handleMouseDown&&p.handleMouseDown(G,v))},i0.prototype._46O=function(p){var G=this.getMoveInteractor();G&&(G.handleWindowMouseUp(p),this.selectedTarget=null)},i0.prototype.handleEdit=function(p,G){var v=this.getMoveInteractor();v&&v.handleWindowMouseMove(G)},i0.prototype.check=function(p,G,v){if(this.selectedTarget=null,E.Default.isLeftButton(G)&&!p._scrolling&&!PE()&&this.screenInfo&&(G=this.screenInfo.pos)&&!(v.distanceTo(G)>this.screenInfo.size))return p=this._interactor,this.selectedTarget=this.getMovableTarget(p.getSubModule("Rect").target),p.setCursor("default"),!0},i0.prototype._42=function(p,G,v){this.screenInfo={};var J=this._interactor;J.editDetail||!this.gatherInfo(G,v)||J.editing&&!this.selectedTarget||U.Icons.DrawIcon(J,p,U.Icons.MoveDummy,this.screenInfo)},(((S=U.RotateX=function(p){this.catalog="RotateX",this._interactor=p}).prototype={}).constructor=S).prototype.gatherInfo=function(p,G){var v;return 1===G.length?!((v=G[0])instanceof E.Shape&&v._70I()||BS(v,p))&&this.gatherSingleTarget(p,v):1<G.length&&this.gatherMultiTargets(p,G)},S.prototype.gatherSingleTarget=(g3=new E.Math.Vector2,M3=new E.Math.Vector2,L3=new E.Math.Vector2,H3=new E.Math.Vector2,function(p,G){var v,J;if(G.getCorners)return J=G.getCorners(),v=G.getPosition(),g3.copy(J[0]),L3.copy(J[1]),H3.copy(J[3]),M3.copy(g3).add(H3).divideScalar(2).add(g3.sub(L3).setLength(15/p.getZoom())),J=Math.max(TM(v,J[0]),TM(v,J[1]),TM(v,J[2]),TM(v,J[3])),this.info.POS=M3.clone(),this.screenInfo.POS=U.toScreenPosition(p,this.info.POS),this.screenInfo.LEN=Math.sqrt(J)*p.getZoom()+15,this.screenInfo.CENTER=U.toScreenPosition(p,v),this.target=G,!0}),S.prototype.gatherMultiTargets=function(p,G){return!!(G=U.Group.findOrCreateGroup(G,this._interactor._uuid))&&this.gatherSingleTarget(p,G)},S.prototype.isVisible=function(){var p=this._interactor;if(!p.getStyle("rotateAsClock"))return!1;var G=this.target;return!G||!(!(p=p.gv).isEditable(G)||!p.isRotationEditable(G))},S.prototype.check=function(p,G,v){return((p=this._checkImpl(p,G,v))||this._clockPainted)&&this._interactor._42(),p},S.prototype._checkImpl=function(p,G,v){if(E.Default.isLeftButton(G)){var J=this;if(J.editing=null,J.tipInfo=null,J.screenInfo&&($=J.screenInfo.POS)&&J.isVisible()){var $,S=J._interactor;if(U.checkHit(v,$,S.getStyle("checkSize")))return v=J.target,$=p.lp(G),p=v.getPosition(),G=Math.atan2($.y-p.y,$.x-p.x),S._setRotateCursor(G),J.editing={pos:p,rotation:v.getRotation(),hitRot:G,groupRotateMode:"block",screenInfo:{CENTER:J.screenInfo.CENTER,LEN:J.screenInfo.LEN}},!0}}},S.prototype.startEdit=function(p,G){p.startDragging(G),p.fi({kind:"beginEditRotation",event:G}),this.target instanceof U.Group&&this.target.beginRotate(this.editing)},S.prototype._46O=function(p){this.editing&&(this.editing=null,this._interactor.fi({kind:"endEditRotation",event:p})),this.target instanceof U.Group&&this.target.endRotate(),this.tipInfo=null},S.prototype.handleEdit=function(G,p){var v,J,$,S,O,W,l,t,z=this.editing;z&&(v=this.target,$=G.lp(p),J=this._interactor,O=z.pos,$=Math.atan2($.y-O.y,$.x-O.x),W=(O=v instanceof U.Group)?$-z.hitRot:(S=$-z.hitRot,z.rotation+S),(W%=2*Math.PI)<0&&(W+=2*Math.PI),E.Default.isCtrlDown(p)||(t=dA(p)?(l=J.getStyle("shiftRotateRound"))/2:(l=J.getStyle("rotateRound"),J.getStyle("rotateSensitivity")),W=U.roundTo(W,l,t)),O?0!=(S=W-(z.lastRotation||0))&&(v.addRotation(S,z.groupRotateMode,function(p){return G.isRotationEditable(p)}),z.lastRotation=W):v.setRotation(W),J._setRotateCursor($),W>Math.PI&&(W-=2*Math.PI),l=(W/Math.PI*180).toFixed(2)+"°",(t=E.Default.getLogicalPoint(p,J._canvas)).x+=U.Icons.TipShiftX,t.y+=U.Icons.TipShiftY,this.tipInfo={helperPos:t,text:l,size:l.length},J.fi({kind:"betweenEditRotation",event:p}))},S.prototype._42=function(p,G,v){var J=this,$=(J._clockPainted=!1,J.info={},J.screenInfo={},J._interactor);$.editDetail||J.gatherInfo(G,v)&&J.isVisible()&&(U.Icons.DrawIcon($,p,U.Icons.RoundPoint,J.screenInfo.POS),$.getStyle("rotateTipVisible")&&J.tipInfo&&U.Icons.DrawIcon($,p,U.Icons.TipHelper,J.tipInfo),J.editing&&J.drawClock(p))},S.prototype.drawClock=function(p){p.save(),this._clockPainted=!0;var G,v,J,$,S,O=this.editing||{},W=O.screenInfo||this.screenInfo,l=W.LEN,t=l+8,z=l+18;p.save(),p.translate(W.CENTER.x,W.CENTER.y),p.beginPath(),p.strokeStyle="rgb(150, 150, 150)";for(var Z=0;Z<360;Z++)G=Z*Math.PI/180,Z%5==0&&(v=S0(G)*l,J=O0(G)*l,$=S0(G)*t,S=O0(G)*t,p.moveTo(v,J),p.lineTo($,S)),Z%45==0&&(v=S0(G)*l,J=O0(G)*l,$=S0(G)*z,S=O0(G)*z,p.moveTo(v,J),p.lineTo($,S));p.stroke(),p.rotate(-w0),W=O.lastRotation||this.target.getRotation(),p.beginPath(),p.fillStyle="rgba(255, 0, 0, 0.1)",p.strokeStyle="rgb(157, 157, 157)",p.moveTo(0,0),p.arc(0,0,z,0,W,!1),p.fill(),p.beginPath(),p.moveTo(0+z,0),p.arc(0,0,z,0,W,!1),p.stroke(),p.restore()},((p=U.Curve=function(p){this.catalog="Curve",this._interactor=p}).prototype={}).constructor=p,d.defineProperties(p.prototype,{activing:{get:function(){return this._activing},set:function(p){p?(this._activing=new U.CurveActiving(this,p),this.gatherSingleTarget(this._interactor.gv,this.target)):((p=this._activing)&&p.dispose(),this._activing=null)}}}),p.PointType={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3},p.prototype.setUp=function(){var p=this._interactor;p&&p.gv.mp(this._onGraphviewPropertyChanged,this)},p.prototype._onGraphviewPropertyChanged=function(p){"zoom"!==p.property&&"translateX"!==p.property&&"translateY"!==p.property||this._handleDataChanged()},p.prototype.tearDown=function(){var p=this._interactor;p&&p.gv.ump(this._onGraphviewPropertyChanged,this)},p.prototype.canEnterEditDetailMode=function(){var p=hj(this._interactor);if(p)return this.target=p},p.prototype.canQuitEditDetailMode=function(p){var G=this._interactor._getLogicalPoint(p);if(!this._checkEditRealPoint(G))return this._interactor.gv.getDataAt(p)!==this.target||void 0},p.prototype.preHandleScroll=function(p){var G=this.editing;if(G&&G.inEdit)return!0},p.prototype.getCurrentSelectintStatus=function(){var v=this;if(v.activing&&!v.activing.selections){if(v.activing.status!=K)return v.activing.status;var p=function(p){var G=v.activing.status;v.activing.status=p,v._interactor.fp("shapePointStatus",G,p)},G=U.Curve.PointType,J=v.activing.point,$=v.activing.pairs;if(!$||1!==$.length)return p(G.Mirrored);var S=($=$[0]).c1&&$.c1.isNearEnough(J),O=$.c2&&$.c2.isNearEnough(J);return $.c1&&$.c2?S&&O?p(G.Straight):S||O?p(G.Asymmetric):(S=$.c1.clone().sub(J),O=$.c2.clone().sub(J),1e-5<Math.abs(S.x*O.y-S.y*O.x)||0<S.x*O.x?p(G.Disconnected):1e-5<Math.abs(S.length()-O.length())?p(G.Asymmetric):p(G.Mirrored)):p(S||O?G.Straight:G.Disconnected)}},p.prototype.handle_keydown=function(p){var G;this._interactor.editDetail&&(G=U.Curve.PointType,"1"===p.key?this._setCurrentSelectionStatus(G.Straight):"2"===p.key?this._setCurrentSelectionStatus(G.Mirrored):"3"===p.key?this._setCurrentSelectionStatus(G.Disconnected):"4"===p.key&&this._setCurrentSelectionStatus(G.Asymmetric))},p.prototype.setCurrentSelectionStatus=function(p){var G=this._interactor;G&&((G=G.gv).dm().beginTransaction(),this._setCurrentSelectionStatus(p),G.dm().endTransaction())},p.prototype._setCurrentSelectionStatus=function(p){var G=this,v=G.activing;if(v){var J=G.getCurrentSelectintStatus();if(null!==J&&J!==p){v.status=p;var $=G.activing.point;if((S=G.activing.pairs)&&1===S.length){var S=S[0],O=G.screenInfo.curve,W=U.Curve.PointType,l=G._interactor,t=function(){G._writeToHt(),l.fp("shapePointStatus",J,p),G.check(l.gv,null,new U.Math.Vector2(l._lastLogicalPoint))};if(p===W.Straight)return O.moveCtrlPoint(S,$,"c1"),O.moveCtrlPoint(S,$,"c2"),void t();if(J===W.Straight)return Z=(z=O.findPairs($,!0)[0]).r1||$,z=(z.r2||$).clone().sub(Z).multiplyScalar(.25),O.moveCtrlPoint(S,$.clone().sub(z),"c1"),O.moveCtrlPoint(S,$.clone().add(z),"c2"),void t();var z,Z=S.c1,B=S.c2;if(Z&&B){if(p===W.Mirrored)return O.moveCtrlPoint(S,$.clone().multiplyScalar(2).sub(B),"c1"),void t();if(p===W.Asymmetric&&J===W.Disconnected)return W=Z.clone().sub($).length(),z=$.clone().sub(B).setLength(W).add($),O.moveCtrlPoint(S,z,"c1"),void t()}v._firePointChange(),l.fp("shapePointStatus",J,p),G.check(l.gv,null,new U.Math.Vector2(l._lastLogicalPoint))}}}},p.prototype._handleDataChanged=(h3="s:edge.points,s:edge.segments,points,segments,shape,position,rotation,scale".split(","),function(p){this.screenInfo&&this.target&&(p&&h3.indexOf(p.property)<0||(p=this._interactor,this.gatherSingleTarget(p.gv,this.target,!0),this.check(p.gv,null,new U.Math.Vector2(p._lastLogicalPoint)),p._42()))}),p.prototype.gatherSingleTarget=function(G,p,v){var J,$,S,O,W=this,l=(W.screenInfo&&W.screenInfo.curve&&(J=W.screenInfo.curve._curves),W.editing),t=l?W.screenInfo:W.screenInfo={},z=p instanceof E.Edge,Z=z?(O=p.s("edge.segments"),p.s("edge.points")||new E.List):(O=p._58O,p._59O),B=(t.S=O,t.P=[]),f=U.getDataMatrix(p);if(p instanceof E.Polyline||p instanceof E.Edge&&W._interactor.getStyle("edgeElevationEditable")?($=p.getElevation&&p.getElevation()||0,t.E=[]):(S=!1,Z.each(function(p){p.e!==K&&(S=!0)}),S&&(t.E=[])),Z.each(function(p){t.E&&t.E.push(p.e!=K?p.e:$),p=f.apply(p),p=U.toScreenPosition(G,p),B.push(p.x,p.y)}),z&&(O=B.length,Z=U.toScreenPosition(G,p._lastSourcePoint||(O?{x:B[0],y:B[1]}:{x:0,y:0})),z=U.toScreenPosition(G,p._lastTargetPoint||(O?{x:B[O-2],y:B[O-1]}:{x:0,y:0})),B.splice(0,0,Z.x,Z.y),B.push(z.x,z.y),t.E&&((O=p.getSourceAgent())instanceof E.Edge?t.E.splice(0,0,p.s("edge.source.offset.elevation")):t.E.splice(0,0,((p.s("edge.source.anchor.elevation")||.5)-.5)*O.getTall()*O.getScaleTall()+O.getElevation()+p.s("edge.source.offset.elevation")),(Z=p.getTargetAgent())instanceof E.Edge?t.E.push(p.s("edge.target.offset.elevation")):t.E.push(((p.s("edge.target.anchor.elevation")||.5)-.5)*Z.getTall()*Z.getScaleTall()+Z.getElevation()+p.s("edge.target.offset.elevation")))),!t.S||!t.S.size()){t.S=new E.List,t.S.add(1);for(var X=0;X<B.length/2-1;X++)t.S.add(2)}l&&!v||W.convertToCubicBezier(J),!W.activing||!v&&W.editing&&"realPoint"!==W.editing.type||(z=t.curve.findPairs(W.activing.point),W.activing.pairs=z)},p.prototype._convertToNewPoint=function(p,G,v,J){for(var $,S=0,O=G.length;S<O;S++){if(($=G[S])._p1.isNearEnough(p)&&(!J||J.indexOf($._p1)<0))return $._p1;if($._p4.isNearEnough(p)&&(!J||J.indexOf($._p4)<0))return $._p4}if(v)for(S=0,O=Math.min(v.length,O);S<O;S++){if(($=v[S])._p1===p&&(!J||J.indexOf(G[S]._p1)<0))return G[S]._p1;if($._p4===p&&(!J||J.indexOf(G[S]._p4)<0))return G[S]._p4}},p.prototype.convertToCubicBezier=function(G){var v,J,$,S,O,W=this,p=new U.Math.Curve,l=W.screenInfo;p.createFromHtShape(l.P,l.S,l.E),l.curve=p,W.activing&&(v=p._curves,l=W.activing.point,J=W._convertToNewPoint(l,v,G),$=[],J&&(W.activing.point=J,$.push(J)),W.activing.selections&&(S=-1,(O=W.activing.selections).forEach(function(p){S++,(J=W._convertToNewPoint(p,v,G,$))&&(O[S]=J,$.push(J))})))},p.prototype.check=function(p,G,v){if(!G||YA(G)||sA(G)){var J=this;if(J._interactor.setCursor("default"),J.editing=null,J.highlight=null,J.tipInfo=null,J.edgeEditResult=null,J.screenInfo)return PE()||G&&sA(G)||J._checkEditCtrlPoint(v)||J._checkEditRealPoint(v)||J._checkEditElevation(v)||(G=J.screenInfo.curve.checkPoint(v,J._interactor.getStyle("curveIntersectSize")))&&((v=J.highlight={type:"insertKnot"}).bezier=G.bezier,v.point=G.intersection),J._interactor._42(),!0}},p.prototype.getAdjacentBeziers=function(p){var G=this.screenInfo;if(G)for(var v,J=G.curve._curves,$=[],S=K,O=0,W=J.length;O<W;O++)if(v=J[O],S===K)v._p4.isNearEnough(p)&&($.push(v),S=O);else{if(v._p1.isNearEnough(p))return $.push(v),$;v._p4.isNearEnough(p)&&($[0]=v,S=O)}},p.prototype.roundCorner=function(p){var G,v,J,$,S;this.activing&&this.screenInfo&&(G=this.screenInfo.curve._curves,v=(J=(S=this.getAdjacentBeziers(this.activing.point))[1])._index,J=J.insertKnot(J.getTByPercentage(p/J.length))[1],J=(G[v]=J).p1,$=(S=S[0])._index,S=S.insertKnot(S.getTByPercentage(1-p/S.length))[0],p=(G[$]=S).p4,$=this.activing.point,S=new U.Math.CubicBezier(p,$.clone().sub(p).multiplyScalar(2/3).add(p),$.clone().sub(J).multiplyScalar(2/3).add(J),J),G.splice(v,0,S),this._writeToHt(),this.activing=null,this._interactor._42())},p.prototype._checkEditRealPoint=function(p){var G,v,J,$,S,O,W=this.screenInfo.curve._curves,l=this._interactor.getStyle("curvePointIntersectSize"),t=1/0;for(l*=l,J=0,$=W.length;J<$;J++)S=(G=W[J])._p1,(O=p.distanceToSquared(S))<t&&(t=O,v=S),S=G._p4,(O=p.distanceToSquared(S))<t&&(t=O,v=S);return!(l<t)&&((l=this.highlight={type:"changeRealPoint"}).point=v,this.editing={type:"realPoint",point:v,shiftGuide:{point:v.clone(),dir:"x",limit:0}},this._interactor.setCursor("crosshair"),!0)},p.prototype._checkEditElevation=function(p){if(!this._interactor.getStyle("curveElevationVisible"))return!1;if(this.target instanceof E.Edge&&!this._interactor.getStyle("edgeElevationEditable"))return!1;var G=this.activing;if(!G)return!1;if(!(G=G.getCurrentEditingPoint()))return!1;var v=this._interactor,J=v.getStyle("curveElevationGuideShift");return(v=v.getStyle("curveElevationIntersectSize"))*v<p.distanceToSquared({x:G.x+J[0],y:G.y+J[1]})?void 0:(this.highlight={type:"elevation"},v=new U.Math.Vector2(p.x,p.y,G.e),this.editing={type:"elevation",startPoint:v},this._interactor.setCursor("crosshair"),!0)},p.prototype._checkEditCtrlPoint=function(p){var G=this;if(G.activing&&!G.activing.selections&&(l=G.getCurrentSelectintStatus())!==U.Curve.PointType.Straight){var v=G.activing.pairs;if(v){var J,$,S,O,W,l=G._interactor.getStyle("curvePointIntersectSize");l*=l;for(var t,z,Z=1/0,B=0,f=v.length;B<f;B++)for(O=v[B],z=0;z<2;z++)O[W=0===z?"c1":"c2"]&&(t=p.distanceToSquared(O[W]))<Z&&(Z=t,J=O,$=B,S=W);return l<Z?!1:(G.activing.hlpair=J,G.activing.hltype=S,(l=G.highlight={type:"changeCtrlPoint"}).point=J[S],G.editing={type:"ctrlPoint",pair:J,pairId:$,ctrlType:S,direction:J[S].clone().sub(G.activing.point).normalize()},G._interactor.setCursor("crosshair"),!0)}}},p.prototype.startEdit=function(p,G){p.startDragging(G);var v,J,$,S,O=this;O.highlight&&"insertKnot"===O.highlight.type&&(O.insertKnot(),O.gatherSingleTarget(O._interactor.gv,O.target),O.activing=null,O._checkEditRealPoint(O._interactor._getLogicalPoint(G)));(l=O._activing)&&("ctrlPoint"===(W=O.editing?O.editing.type:null)?l.editingCtrl={pairId:O.editing.pairId,type:l.hltype}:"realPoint"===W&&(l.editingCtrl=!1));var W=O.highlight,l=E.Default.isCtrlDown(G);if(!W||PE()||sA(G))return!(v=O._interactor.gv).setFocus(G)||v._scrolling?void 0:void(l?O._multiSelect={startPoint:v.lp(G)}:v.isPannable()&&(YA(G)||sA(G))&&(O._pan={tx:v.tx(),ty:v.ty()},p.fi({kind:"beginPan",event:G})));"changeRealPoint"===W.type&&(v=O.activing?O.activing.point:null,J=O.activing?O.activing.selections:null,l&&O.activing?v===W.point?(J?(O.activing={point:J[0]},1<J.length&&(J.splice(0,1),O.activing.selections=J)):O.activing=null,O.editing=null):J&&0<=($=J.indexOf(W.point))?(1<J.length?J.splice($,1):delete O.activing.selections,O.editing=null):J?(J.push(v),O.activing={point:W.point,selections:J}):O.activing={point:W.point,selections:[v]}:J?v!==W.point&&(0<=($=J.indexOf(W.point))?(J.splice($,1,v),O.activing={point:W.point,selections:J}):O.activing={point:W.point}):(v===W.point&&(S=O.activing.status),O.activing={point:W.point},S&&(O.activing.status=S)),p.fi({kind:"beginEditPoint",event:G}))},p.prototype.insertKnot=function(){var p=this.highlight;this.screenInfo.curve.insertKnot(p.bezier,p.point.t),this._writeToHt()},p.prototype._writeToHt=function(){var p,G,v,J=(S=this.screenInfo.curve.toHtShape()).points,$=[],S=S.segments,O=this._interactor.gv,W=(O.dm().beginTransaction(),this.target),l=W instanceof E.Edge,t=U.getDataMatrix(W).invert();(W instanceof E.Polyline||l&&this._interactor.getStyle("edgeElevationEditable"))&&(v=W.getElevation&&W.getElevation()||0);for(var z=0,Z=J.length;z<Z;z++)p=J[z],G=U.toWorldPosition(O,p),G=t.apply(G),isFinite(p.e)&&p.e!==v&&(G.e=p.e),$.push(G);W._writing=!0,l?(W.s("edge.type","points"),W.setStyle("edge.segments",S),W.setStyle("edge.points",$.slice(1,$.length-1)),W.setStyle("edge.source.offset.x",0),W.setStyle("edge.source.offset.y",0),W.setStyle("edge.target.offset.x",0),W.setStyle("edge.target.offset.y",0),l=this._nextChangeEdgeHost,delete this._nextChangeEdgeHost,l&&("source"===l.type?W.setSource(l.host):W.setTarget(l.host)),this._writeEdgeHostAnchor("source",$[0]),this._writeEdgeHostAnchor("target",$[$.length-1])):$.length?(W.setSegments(S),W.setPoints($,!0)):W.removeFromDataModel(),O.dm().endTransaction(),delete W._writing},p.prototype._writeEdgeHostAnchor=function(p,G){var v=this.target,J=this._calcHostAnchor(v,p,G);J.index!==K?(v.setStyle("edge."+p+".index",J.index),v.setStyle("edge."+p+".percent",K),v.setStyle("edge."+p+".anchor.x",K),v.setStyle("edge."+p+".anchor.y",K),v.setStyle("edge."+p+".anchor.elevation",K),v.setStyle("edge."+p+".offset.elevation",G.e)):J.percent!==K?(v.setStyle("edge."+p+".percent",J.percent),v.setStyle("edge."+p+".index",K),v.setStyle("edge."+p+".anchor.x",K),v.setStyle("edge."+p+".anchor.y",K),v.setStyle("edge."+p+".anchor.elevation",K),v.setStyle("edge."+p+".offset.elevation",G.e)):(v.s("edge."+p+".anchor.x",J.x),v.s("edge."+p+".anchor.y",J.y),v.s("edge."+p+".anchor.elevation",J.e),J.offsetX||J.offsetY||J.offsetElevation?(v.s("edge."+p+".offset.x",J.offsetX),v.s("edge."+p+".offset.y",J.offsetY),v.s("edge."+p+".offset.elevation",J.offsetElevation)):(v.s("edge."+p+".offset.x",0),v.s("edge."+p+".offset.y",0),v.s("edge."+p+".offset.elevation",0)))},p.prototype._calcHostAnchor=function(p,G,v,J){J=J||("source"===G?p.getSource():p.getTarget());var $=this._interactor.gv;if(S=$.calculateAttachPoint(J,v))return S.info;if(zS(J))return $.calculateEdgePosition(J,v);var S=J.getRotation(),O=J.getAnchor(),W=(BS(J,$)&&(S=0),J.getElevation()),l=J.getTall()*J.getScaleTall(),W=((v.e||0)-p.s("edge."+G+".offset.elevation")-W)/l+.5,p=J.getScale();return S||p.x<0||p.y<0?(G=J.getMatrix().tfi(v),l=J.getSize(),{x:G.x/l.width+O.x,y:G.y/l.height+O.y,e:W}):(S=pj($,J),{x:(v.x-S.x)/S.width,y:(v.y-S.y)/S.height,e:W})},p.prototype._handlePanning=function(p){var G,v,J,$,S=this._pan;S&&(S.started=!0,v=(G=this._interactor).gv,J=G._lastClientPoint,$=i(p),$=_j(v,$,J),v.setTranslate(S.tx+$.x,S.ty+$.y),this.gatherSingleTarget(G.gv,this.target),G._42(),G.fi({kind:"betweenPan",event:p}))},p.prototype.handleEdit=function(p,G){var v,J,$,S,O,W,l,t,z,Z,B,f,X,q,g,M,L,H,_=this,b=_.editing;if(_._pan)_._handlePanning(G);else{if(_._multiSelect)return _._multiSelect.endPoint=p.lp(G),void _._interactor.redraw();b&&(b.inEdit=!0,J=_._interactor._getLogicalPoint(G),q=E.Default.isCtrlDown(G),t=E.Default.isShiftDown(G),g=b.type,v=_.activing,_._guideInfo=null,"ctrlPoint"===g&&t?(z=_.editing.direction.clone(),B=v.point,X=z.dot(J.clone().sub(B)),J=z.setLength(X).add(B)):"ctrlPoint"!==g&&"realPoint"!==g||("realPoint"===g&&t&&($=(t=_.editing.shiftGuide).point,f=Math.abs(J.x-$.x),(M=Math.abs(J.y-$.y))<f&&f>t.limit&&"y"===t.dir&&(t.dir="x"),f<M&&M>t.limit&&"x"===t.dir&&(t.dir="y"),"x"===(z=t.dir)?(J.y=$.y,t.limit=Math.max(t.limit,f)):"y"===z&&(J.x=$.x,t.limit=Math.max(t.limit,M))),q||((f=_._isEditEdgeSourceTarget())&&(Z=J.clone()),t=_._guidingToEdit(J,z),L=M=1/0,(g="realPoint"===g?_._interactor.gridGuide.findClosest(J,z,!0):null)&&(g.x&&(M=g.x),g.y&&(L=g.y)),z=!1,t&&(t.xList&&(Math.abs(t.x)<=Math.abs(M)?(z=!0,M=t.x):delete t.xList),t.yList&&(Math.abs(t.y)<=Math.abs(L)?(z=!0,L=t.y):delete t.yList),z&&(_._guideInfo=t)),isFinite(M)&&(J.x+=M),isFinite(L)&&(J.y+=L),z&&(t.v=J),f&&(g=z?J.clone():null,J.copy(Z),(M=_._editEdgeSourceTarget(f,J,q,g))&&(H=(_.edgeEditResult=M).tipText,M.isFixed&&(_._guideInfo=null))))),S=_.screenInfo.curve,"realPoint"===b.type?((B=b.point).e!==K&&(J.e=B.e),S.moveRealPoint(B,J),b.point=J,_.highlight.point=J,L=v.status,O=v.selections,_.activing={point:J,status:L},O&&(W=J.clone().sub(B),l=0,O.forEach(function(p){var G=p.clone().add(W);S.moveRealPoint(p,G),O[l++]=G}),_.activing.selections=O)):"ctrlPoint"===b.type?(t=v.pairs[b.pairId],S.moveCtrlPoint(t,J,b.ctrlType),((z=v.status)===(Z=U.Curve.PointType).Mirrored||z===Z.Asymmetric)&&t.c1&&t.c2&&(B=new U.Math.Vector2(v.point),f="c1"===b.ctrlType?"c2":"c1",z===U.Curve.PointType.Mirrored?S.moveCtrlPoint(t,B.clone().multiplyScalar(2).sub(J),f):z===Z.Asymmetric&&(X=t[f].clone().sub(B).length(),q=B.clone().sub(t[b.ctrlType]).setLength(X).add(B),isNaN(q.x)||S.moveCtrlPoint(t,q,f))),v._firePointChange()):"elevation"===b.type&&(g=($=b.startPoint).e+($.y-J.y)/p._zoom,_._setCurrentPointImpl("e",g),v._firePointChange(),H="E: "+U.toFixed(g)),(M=E.Default.getLogicalPoint(G,_._interactor._canvas)).x+=U.Icons.TipShiftX,M.y+=U.Icons.TipShiftY,H||(L=U.toWorldPosition(p,J),H=U.toFixed(L.x)+", "+U.toFixed(L.y)),_.tipInfo={helperPos:M,text:H,size:H.length},_._writeToHt(),_._interactor.fi({kind:"betweenEditPoint",event:G}))}},p.prototype._setCurrentPointImpl=function(p,G){var v=this._activing;if(!v)return!1;var J=this.target;if(!J)return!1;var $=v.getCurrentEditingPoint();if(!$)return!1;var S,O,W,l,t,z,Z=v.editingCtrl;return Z||(S=$.clone()),"e"===p?$.e=G:("x"===p||"y"===p?(O=v._lastFirePoint,O="x"===p?{x:G,y:O?O.y:0}:{x:O?O.x:0,y:G}):"object"==typeof p?(O=p).e!==K&&($.e=p.e):(O={x:p,y:G},arguments[2]!==K&&($.e=arguments[2])),p=U.getDataMatrix(J),O=U.toScreenPosition(this._interactor.gv,p.apply(O)),$.x=O.x,$.y=O.y),Z||(W=S.multiplyScalar(-1).add($),$S($.e)&&$S(S.e)&&(W.e=$.e-S.e),(l=this.screenInfo.curve).moveCtrlDueToRealPointMovement($,W),(t=v.selections)&&(z=0,t.forEach(function(p){var G=p.clone().add(W);isFinite(W.e)&&(G.e=(isFinite(p.e)?p.e:J.getElevation()||0)+W.e),l.moveRealPoint(p,G),t[z++]=G}),v.selections=t)),!0},p.prototype.setCurrentPoint=function(p,G){return!!this._setCurrentPointImpl(p,G)&&(this._writeToHt(),!0)},p.prototype._isEditEdgeSourceTarget=function(){if(!(this.target instanceof E.Edge))return!1;var p=this.editing.point,G=this.screenInfo.curve._curves;return p===G[0]._p1?"source":p===G[G.length-1]._p4&&"target"},p.prototype._editEdgeSourceTarget=function(G,p,v,J){var $,S,O,W,l,t,z,Z,B,f=this,X=f.target;if(O="source"===G?X.getSource():X.getTarget())return $=f._interactor.gv,l=U.toWorldPosition($,p),(t=(t=(S=f._calcHostAnchor(X,G,l,O)).index!==K||S.percent!==K?S.distance*$.getZoom()>f._interactor.getStyle("edgeHostEdgeMaxDistance"):!!f._interactor.getStyle("edgeHostDetectPerFrame")||S.x<0||1<S.x||S.y<0||1<S.y)&&$.getDataAt(l,function(p){return!!$.isSelectable(p)&&!!$.isSourceTargetEditable(X,p,G)&&!!X.canSetSourceTarget(p,G)}))&&(z=f._calcHostAnchor(X,G,l,t),f._nextChangeEdgeHost={type:G,host:O=t},S=z),t=!1,v||S.x===K?S.percent===K&&S.index===K||(t=!0,W=S.point):(z=f._interactor.getStyle("anchorRound"),v=f._interactor.getStyle("anchorSensitivity"),(Z=$.calculateAttachPoint(O,l))?(S=Z.info,t=!0):((S=J?f._calcHostAnchor(X,G,U.toWorldPosition($,J),O):S).x=U.roundTo(S.x,z,v),S.y=U.roundTo(S.y,z,v)),W=Lj($,O,0,S.offsetX||0,S.offsetY||0,S.x,S.y)),W&&(l=U.toScreenPosition($,W),p.x=l.x,p.y=l.y),f._edgeHostGuideInfo={corners:U.getTargetCornersOnScreen($,O),attach:Z?Z.index:-1,host:O},S.percent!==K?B="percent: "+S.percent.toFixed(2):S.index!==K?B="index: "+S.index:(B=S.x.toFixed(2)+", "+S.y.toFixed(2),(S.offsetX||S.offsetY)&&(B+=" offset: "+S.offsetX.toFixed(2)+", "+S.offsetY.toFixed(2))),{host:O,anchor:S,tipText:B,isFixed:t}},p.prototype._guidingToEdit=function(p,G){if(X=this.screenInfo.curve){var v,J,$,S,O,W,l,t,z=X._curves,Z=1/0,B=1/0,f=[];for(this.editing&&"realPoint"===this.editing.type&&(t=this.editing.point),O=0,W=2*z.length;O<W;O++)l=z[Math.floor(O/2)][O%2?"_p4":"_p1"],0<=f.indexOf(l)||(f.push(l),t&&t===l||($=l.x-p.x,S=l.y-p.y,Math.abs($)<Math.abs(Z)?(Z=$,v=[l]):$===Z&&v.push(l),Math.abs(S)<Math.abs(B)?(B=S,J=[l]):S===B&&J.push(l)));var X=this._interactor.getStyle("smartGuideThreshold");if((Math.abs(Z)>X||"y"===G)&&(v=null),(Math.abs(B)>X||"x"===G)&&(J=null),(v||J)&&(X=!1,G={},v&&(X=!0,G.xList=v,G.x=Z),J&&(X=!0,G.yList=J,G.y=B),X))return G}},p.prototype._46O=function(p){var G=this;G.editing&&(G.editing=null,G._interactor.fi({kind:"endEditPoint",event:p})),G._guideInfo=null,G._edgeHostGuideInfo=null,G._pan&&(G._pan=null,G._interactor.fi({kind:"endPan",event:p})),G._multiSelect&&(G._handleMultiSelect(G._multiSelect,p),G._multiSelect=null),G.tipInfo=null,G.edgeEditResult=null},p.prototype._handleMultiSelect=function(p,G){if(p.startPoint&&p.endPoint){for(var v,J,$,S,O=this._interactor,W=O.gv,l=U.toScreenPosition(W,p.startPoint),W=U.toScreenPosition(W,p.endPoint),t=E.Default.unionPoint(l,W),z=this.screenInfo.curve._curves,Z=[],B=function(p){p.x>=t.x&&p.y>=t.y&&p.x<=t.x+t.width&&p.y<=t.y+t.height&&Z.indexOf(p)<0&&Z.push(p)},f=0,X=z.length;f<X;f++)B(($=z[f])._p1),B($._p4);if(Z.length){var q=(p=this.activing||{}).selections||[],g=(p.point&&q.push(p.point),E.Default.isShiftDown(G)),M=G.altKey;if(M&&!g)for(S=Z,Z=[],f=0,X=S.length;f<X;f++)v=S[f],0<=(J=q.indexOf(v))&&Z.push(v);for(f=0,X=q.length;f<X;f++)v=q[f],0<=(J=Z.indexOf(v))?g&&!M||(Z[J]=K):Z.push(v);for(S=Z,Z=[],f=0,X=S.length;f<X;f++)S[f]&&Z.push(S[f]);0===(X=Z.length)?this.activing=null:1===X?this.activing={point:Z[0]}:(v=Z[X-1],this.activing={point:v,selections:Z.splice(0,X-1)}),O.redraw()}}},p.prototype._canDeletePoint=function(p,G){if(!(this.target instanceof E.Edge))return!0;var v=p._curves[0],p=p._curves[p._curves.length-1];return v._p1!==G&&p._p4!==G},p.prototype.handleDelete=function(){var G,v,J=this;J.activing&&J.screenInfo&&(G=E.Default.isShiftDown(),v=J.screenInfo.curve,J._canDeletePoint(v,J.activing.point)&&v.deleteRealPoint(J.activing.point,G),J.activing.selections&&J.activing.selections.forEach(function(p){J._canDeletePoint(v,p)&&v.deleteRealPoint(p,G)}),J.activing=null,delete J.editing,delete J.tipInfo,delete J.edgeEditResult,delete J._pan,delete J._multiSelect,J._writeToHt(),J._interactor.fp("deleteShapePoint",!1,!0))},p.prototype.handleDoubleClick=function(p){var G,p=this._interactor._getLogicalPoint(p);if(this.screenInfo&&this._checkEditRealPoint(p))return p=(p=this.getCurrentSelectintStatus())===(G=U.Curve.PointType).Mirrored?G.Straight:G.Mirrored,this._setCurrentSelectionStatus(p),this._interactor._42(),!0},p.prototype._drawHighlight=function(p){var G,v,J=this.highlight;J&&(v=J.bezier,G=this._interactor,v&&U.Icons.DrawIcon(G,p,U.Icons.ShapeHighlightCurve,[v._p1.x,v._p1.y,v._p2.x,v._p2.y,v._p3.x,v._p3.y,v._p4.x,v._p4.y]),(v=J.point)&&"insertKnot"===J.type&&U.Icons.DrawIcon(G,p,U.Icons.ShapeHighlighPoint,v))},p.prototype._drawGuide=function(p){var G=this._guideInfo;if(G)for(var v,J,$,S=G.v,O=0;O<2;O++)if($=0===O?G.xList:G.yList)for(v=0,J=$.length;v<J;v++)U.Icons.DrawIcon(this._interactor,p,U.Icons.ShapeGuideLine,[S.x,S.y,$[v].x,$[v].y])},p.prototype._drawCurrentPoint=function(G){if(this.activing){var p=this.activing,v=this.getCurrentSelectintStatus(),J=this._interactor;if(v!==U.Curve.PointType.Straight){var $=p.pairs,S=(p.hlpair,p.hltype,p.selections),O=p.editingCtrl;if($&&!S)for(var W,l=0,t=$.length;l<t;l++)W=$[l],O&&l===O.pairId&&W[O.type]?U.Icons.DrawIcon(J,G,U.Icons.ShapeActivingCtrl,{point:W.point,c1:W.c1,c2:W.c2,hl:O.type}):U.Icons.DrawIcon(J,G,U.Icons.ShapeActivingCtrl,W)}U.Icons.DrawIcon(J,G,U.Icons.ShapeHighlighRealPoint,this.activing.point),S&&S.forEach(function(p){U.Icons.DrawIcon(J,G,U.Icons.ShapeHighlighRealPoint,p)})}},p.prototype.clear=function(){this.editing=null,this._guideInfo=null,this.activing=null,this.highlight=null},p.prototype._42=function(G){var p=this,v=(p.info={},p.editing||(p.screenInfo=null),p._interactor);if(v.editDetail){var J,$,S=v.gv;if(!p.target||!S.isSelected(p.target)||!S.isVisible(p.target))return v.editDetail=!1,void p.clear();p.gatherSingleTarget(S,p.target),U.Icons.DrawIcon(v,G,U.Icons.ShapeBgCurve,p.screenInfo),p._interactor.getStyle("curveElevationVisible")&&(p.target instanceof E.Polyline||p.target instanceof E.Edge&&p._interactor.getStyle("edgeElevationEditable"))&&p.activing&&(J=p.activing.getCurrentEditingPoint())&&"string"!=typeof J.e&&U.Icons.DrawIcon(v,G,U.Icons.EdgeElevationGuide,J),p._drawHighlight(G),p._drawCurrentPoint(G),p._getRealPoint().forEach(function(p){U.Icons.DrawIcon(v,G,U.Icons.ShapePoint,p)}),p._drawGuide(G),p.tipInfo&&p._interactor.getStyle("curveTipVisible")&&U.Icons.DrawIcon(v,G,U.Icons.TipHelper,p.tipInfo),p._edgeHostGuideInfo&&v._drawHostGuide(p._edgeHostGuideInfo),p.edgeEditResult&&p._drawEdgeHostHighlight(G,p.edgeEditResult.host,p.edgeEditResult.anchor),p._multiSelect&&p._multiSelect.endPoint&&((J=E.Default.unionPoint(U.toScreenPosition(S,p._multiSelect.startPoint),U.toScreenPosition(S,p._multiSelect.endPoint))).color=S.getRectSelectBorderColor(),G.save(),G.setTransform(1,0,0,1,0,0),S=N.devicePixelRatio,$=J.borderWidth=Math.round(S),$/=2,J.x=Math.round(J.x*S)+$,J.y=Math.round(J.y*S)+$,J.width=Math.round(J.width*S),J.height=Math.round(J.height*S),U.Icons.DrawIcon(v,G,U.Icons.SimpleRect,J),G.restore())}else p.clear()},p.prototype._drawEdgeHostHighlight=function(p,G,v){this.drawEdgeHostHighlight(p,G,v),this._interactor.redraw()},p.prototype.drawEdgeHostHighlight=function(p,G,v){if(zS(G)){for(var J,$,S=this._interactor,O=S.gv,G=O.getDataUI(G),W=ij(G),l=[],t=0,z=W.points.length;t<z;t++)$=U.toScreenPosition(O,W.points.get(t)),l.push($.x,$.y);W.segments&&(J=W.segments.toArray());for(var Z=S.getStyle("edgeHostHighlighPeriod"),B=S.getStyle("edgeHostEdgeHighlighColor"),f=(U.Icons.DrawIcon(S,p,U.Icons.ShapeBgCurve,{P:l,S:J,color:B,dynamicVisible:v.index===K,dynamicPeriod:Z}),B=S.getStyle("edgeHostPointHighlighColor"),Ej(G)),t=0,z=f.length;t<z;t++){var X=f[t],X=U.toScreenPosition(O,X);U.Icons.DrawIcon(S,p,U.Icons.ShapePoint,{point:{x:X.x,y:X.y},color:B,size:12,dynamicVisible:t===v.index,dynamicPeriod:Z})}}},p.prototype._getRealPoint=function(){var v,p=this.screenInfo,J=p.P,$=p.S,S=-1,O=[],W=-1,l=$.length;return $.each(function(p){W++;var G=1;if(3===p)G=2;else if(4===p)G=3;else if(5===p)return;S+=G,v=l<=W+1||1===$.get(W+1),O.push({point:{x:J[2*S],y:J[2*S+1]},segmentIndex:W,pointIndex:S,isEnd:v})}),O},p.prototype.getEditingPointsInfo=function(p){var G=this,v=G.activing;if(!v)return!1;var J=v.point;if(!J)return!1;var $=this._getRealPoint(),S=[{screen:J}];v.selections&&v.selections.forEach(function(p){S.push({screen:p})});var O,W,l=$.length;return S.forEach(function(p){for(O=0;O<l;O++)if(W=$[O],p.screen.isNearEnough(W.point)){p.segmentIndex=W.segmentIndex,p.pointIndex=W.pointIndex,p.point=G.target.getPoints().get(W.pointIndex);break}}),p&&S.sort(function(p,G){return p.segmentIndex-G.segmentIndex}),S};(((G=U.MoveHelper=function(p){this.catalog="Move",this._interactor=p}).prototype={}).constructor=G).prototype.calcShift=function(p,G,v){var J,$=this,S=$._interactor.gv,O=S.lp(G);if("beginMove"===p&&$._gatherGridInfo(v._lastLogicalPoint||O),p=$._target){if(v=p.downPosition){var W=$._interactor.getStyle("moveSensitivity")/S._zoom;if(v.distanceTo(O)<W)return{x:0,y:0};delete p.downPosition}E.Default.isShiftDown(G)&&(O=$._dealShiftDown(O),J=p.shiftGuide.dir);var l,v=p.rawPos={x:p.pos.x+O.x-p.lp.x,y:p.pos.y+O.y-p.lp.y};if(E.Default.isCtrlDown(G))return l=$._calcShiftByAddon(),$._target.node instanceof U.Group&&((z=$._target.node)._position.x+=l.x,z._position.y+=l.y),l;if(W=$._interactor.rectGuide,p.node instanceof E.Data&&p.node.s("2d.attachable")&&(O=$._calcAttachNodeShift(p.node,v),W.clear(),O))return O;for(var t,z,Z=p.x+v.x,B=p.y+v.y,G={x:Z,y:B},O={x:Z+p.w/2,y:B+p.h/2},f={x:Z+p.w,y:B+p.h},X=$._interactor.gridGuide,q=[W.findClosest(G,J),W.findClosest(O,J),W.findClosest(f,J),X.findClosest(G,J),X.findClosest(O,J),X.findClosest(f,J)],g=1/0,M=1/0,L=0,H=q.length;L<H;L++)(t=q[L])&&(Z=t.x,B=t.y,isFinite(Z)&&Math.abs(Z)<Math.abs(g)&&(g=Z),isFinite(B)&&Math.abs(B)<Math.abs(M)&&(M=B));return isFinite(g)||(g=0),isFinite(M)||(M=0),l=$._calcShiftByAddon(g,M),$._target.node instanceof U.Group&&((z=$._target.node)._position.x+=l.x,z._position.y+=l.y),W=p.node,BS(W,S)||$._interactor.rectGuide.gatherLines({node:W,x:p.x+(v.x+g),y:p.y+(v.y+M),w:p.w,h:p.h},J),l}},G.prototype._calcShiftByAddon=function(p,G){var v=(J=this._target).rawPos,J=J.node.getPosition();return{x:v.x-J.x+(p=p||0),y:v.y-J.y+(G=G||0)}},G.prototype._dealShiftDown=function(p){var G=this._target.shiftGuide,v=this._target.lp,J=Math.abs(p.x-v.x),$=Math.abs(p.y-v.y),S=($<J&&J>G.limit&&"y"===G.dir&&(G.dir="x"),J<$&&$>G.limit&&"x"===G.dir&&(G.dir="y"),G.dir);return"x"===S?(p.y=v.y,G.limit=Math.max(G.limit,J)):"y"===S&&(p.x=v.x,G.limit=Math.max(G.limit,$)),p},G.prototype._isAttachableLineShape=function(p){if(!p.getSegments)return!1;var G=p.getSegments();if(!G)return!0;for(var v=1,J=(G=G instanceof E.List?G.getArray():G).length;v<J;v++)if(2!==G[v])return!1;return!0},G.prototype._calcAttachNodeShift=(w3=new H,d3=new H,P3=new H,j3=new H,function(p,G){var v=this._interactor.gv,J=p.getHost(),$=v.getDataAt(G,function(p){return!!p.s("2d.hostable")});if($&&J!==$&&p.setHost($),!$)return this._edgeHostGuideInfo=null,p.setHost(null);var S,O,J=this._edgeHostGuideInfo={corners:U.getTargetCornersOnScreen(v,$),host:$,attach:-1};if(!this._isAttachableLineShape($))return(S=v.calculateAttachPoint($,G))?(O=S.point,J.attach=S.index,this._calcShiftByAddon(O.x-G.x,O.y-G.y)):void 0;for(var W,l,t,z,Z,B,f=$.getPoints(),X=f.size(),q=$.getPointsMatrix2d(),g=1/0,M=0;M<X&&(M!==X-1||$.isClosePath());M++)0!==M?d3.copy(P3):q.apply(f.get(M),d3),q.apply(M===X-1?f.get(0):f.get(M+1),P3),w3.copy(G).sub(d3),j3.copy(P3).sub(d3),W=j3.length(),j3.divideScalar(W),(l=w3.dot(j3))<0?l=0:W<l&&(l=W),j3.multiplyScalar(l).add(d3),(t=w3.copy(G).sub(j3).lengthSq())<g&&(g=t,B=M,z=l,Z=W);return Math.sqrt(g)*v.getZoom()>this._interactor.getStyle("attachThreshold")?(p.s({"attach.index":-1}),void p.setHost(null)):(p.s("attach.offset.opposite")&&(z=Z-z),p.s({"attach.index":B,"attach.offset":p.s("attach.offset.relative")?z/Z:z}),{x:0,y:0})}),G.prototype._gatherGridInfo=function(p){var G,v,J=this._interactor;if(($=J._getValidSelection()).length){if(1===$.length){if(!(G=$[0]).getRect)return void(this._target=null)}else if(!(G=U.Group.findOrCreateGroup($,J._uuid)))return void(this._target=null)}else{var $=J.gv.sm().getSelection();if($.length&&!(G=$.get(0)).getRect)return void(this._target=null)}G&&($=G.getPosition(),v=G.getRect(),this._target={node:G,x:v.x-$.x,y:v.y-$.y,w:v.width,h:v.height,lp:{x:p.x,y:p.y},pos:{x:$.x,y:$.y},shiftGuide:{dir:"x",limit:0},downPosition:new U.Math.Vector2(p)},J.rectGuide.gatherRects())},G.prototype.clear=function(){this._edgeHostGuideInfo=null,this._interactor.rectGuide.clear(),this._interactor._42()},G.prototype._42=function(){var p=this._edgeHostGuideInfo;p&&this._interactor._drawHostGuide(p)};var h3,w3,d3,P3,j3,i3,r3,e3,A3,k3,I3,E3,y3,x3,R3,N3,m3,K3,a3,u3,T3,V3,o3,U3,F3,C3,Q3,pe,Ge,ve,Je,$e,Se,Oe,We,le,te,ze,Ze,Be,fe,Xe,qe,ge,Me,Le,He,_e,be,ne,De,Ye,se,ce,he,we,de,Pe,je,ie,re,ee,Ae,ke,Ie,Ee,ye,xe,Re,Ne,me,Ke,ae,ue,Te,Ve,oe,Ue,Fe,Ce,Qe,ps,Gs,vs,Js,$s,Ss,Os,Ws,ls,ts,zs,Zs,Bs,fs,Xs,qs,gs,Ms,Ls,Hs,_s,bs,ns,Ds,w=d.freeze({DEPTH_BUFFER_BIT:256,STENCIL_BUFFER_BIT:1024,COLOR_BUFFER_BIT:16384,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA_SATURATE:776,FUNC_ADD:32774,BLEND_EQUATION:32777,BLEND_EQUATION_RGB:32777,BLEND_EQUATION_ALPHA:34877,FUNC_SUBTRACT:32778,FUNC_REVERSE_SUBTRACT:32779,BLEND_DST_RGB:32968,BLEND_SRC_RGB:32969,BLEND_DST_ALPHA:32970,BLEND_SRC_ALPHA:32971,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,BLEND_COLOR:32773,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,ARRAY_BUFFER_BINDING:34964,ELEMENT_ARRAY_BUFFER_BINDING:34965,STREAM_DRAW:35040,STATIC_DRAW:35044,DYNAMIC_DRAW:35048,BUFFER_SIZE:34660,BUFFER_USAGE:34661,CURRENT_VERTEX_ATTRIB:34342,FRONT:1028,BACK:1029,FRONT_AND_BACK:1032,CULL_FACE:2884,BLEND:3042,DITHER:3024,STENCIL_TEST:2960,DEPTH_TEST:2929,SCISSOR_TEST:3089,POLYGON_OFFSET_FILL:32823,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_COVERAGE:32928,NO_ERROR:0,INVALID_ENUM:1280,INVALID_VALUE:1281,INVALID_OPERATION:1282,OUT_OF_MEMORY:1285,CW:2304,CCW:2305,LINE_WIDTH:2849,ALIASED_POINT_SIZE_RANGE:33901,ALIASED_LINE_WIDTH_RANGE:33902,CULL_FACE_MODE:2885,FRONT_FACE:2886,DEPTH_RANGE:2928,DEPTH_WRITEMASK:2930,DEPTH_CLEAR_VALUE:2931,DEPTH_FUNC:2932,STENCIL_CLEAR_VALUE:2961,STENCIL_FUNC:2962,STENCIL_FAIL:2964,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STENCIL_BACK_FUNC:34816,STENCIL_BACK_FAIL:34817,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,VIEWPORT:2978,SCISSOR_BOX:3088,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,UNPACK_ALIGNMENT:3317,PACK_ALIGNMENT:3333,MAX_TEXTURE_SIZE:3379,MAX_VIEWPORT_DIMS:3386,SUBPIXEL_BITS:3408,RED_BITS:3410,GREEN_BITS:3411,BLUE_BITS:3412,ALPHA_BITS:3413,DEPTH_BITS:3414,STENCIL_BITS:3415,POLYGON_OFFSET_UNITS:10752,POLYGON_OFFSET_FACTOR:32824,TEXTURE_BINDING_2D:32873,SAMPLE_BUFFERS:32936,SAMPLES:32937,SAMPLE_COVERAGE_VALUE:32938,SAMPLE_COVERAGE_INVERT:32939,COMPRESSED_TEXTURE_FORMATS:34467,DONT_CARE:4352,FASTEST:4353,NICEST:4354,GENERATE_MIPMAP_HINT:33170,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DEPTH_COMPONENT:6402,ALPHA:6406,RGB:6407,RGBA:6408,LUMINANCE:6409,LUMINANCE_ALPHA:6410,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,FRAGMENT_SHADER:35632,VERTEX_SHADER:35633,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VARYING_VECTORS:36348,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_FRAGMENT_UNIFORM_VECTORS:36349,SHADER_TYPE:35663,DELETE_STATUS:35712,LINK_STATUS:35714,VALIDATE_STATUS:35715,ATTACHED_SHADERS:35717,ACTIVE_UNIFORMS:35718,ACTIVE_ATTRIBUTES:35721,SHADING_LANGUAGE_VERSION:35724,CURRENT_PROGRAM:35725,NEVER:512,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,NOTEQUAL:517,GEQUAL:518,ALWAYS:519,KEEP:7680,REPLACE:7681,INCR:7682,DECR:7683,INVERT:5386,INCR_WRAP:34055,DECR_WRAP:34056,VENDOR:7936,RENDERER:7937,VERSION:7938,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TEXTURE_2D:3553,TEXTURE:5890,TEXTURE_CUBE_MAP:34067,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,MAX_CUBE_MAP_TEXTURE_SIZE:34076,TEXTURE0:33984,TEXTURE1:33985,TEXTURE2:33986,TEXTURE3:33987,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE30:34014,TEXTURE31:34015,ACTIVE_TEXTURE:34016,REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,IMPLEMENTATION_COLOR_READ_TYPE:35738,IMPLEMENTATION_COLOR_READ_FORMAT:35739,COMPILE_STATUS:35713,LOW_FLOAT:36336,MEDIUM_FLOAT:36337,HIGH_FLOAT:36338,LOW_INT:36339,MEDIUM_INT:36340,HIGH_INT:36341,FRAMEBUFFER:36160,RENDERBUFFER:36161,RGBA4:32854,RGB5_A1:32855,RGB565:36194,DEPTH_COMPONENT16:33189,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,DEPTH_STENCIL:34041,RENDERBUFFER_WIDTH:36162,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_STENCIL_SIZE:36181,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,COLOR_ATTACHMENT0:36064,DEPTH_ATTACHMENT:36096,STENCIL_ATTACHMENT:36128,DEPTH_STENCIL_ATTACHMENT:33306,NONE:0,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_UNSUPPORTED:36061,FRAMEBUFFER_BINDING:36006,RENDERBUFFER_BINDING:36007,MAX_RENDERBUFFER_SIZE:34024,INVALID_FRAMEBUFFER_OPERATION:1286,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,CONTEXT_LOST_WEBGL:37442,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,BROWSER_DEFAULT_WEBGL:37444,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,HALF_FLOAT_OES:36193,DOUBLE:5130,READ_BUFFER:3074,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_ROWS:3315,UNPACK_SKIP_PIXELS:3316,PACK_ROW_LENGTH:3330,PACK_SKIP_ROWS:3331,PACK_SKIP_PIXELS:3332,COLOR:6144,DEPTH:6145,STENCIL:6146,RED:6403,RGB8:32849,RGBA8:32856,RGB10_A2:32857,TEXTURE_BINDING_3D:32874,UNPACK_SKIP_IMAGES:32877,UNPACK_IMAGE_HEIGHT:32878,TEXTURE_3D:32879,TEXTURE_WRAP_R:32882,MAX_3D_TEXTURE_SIZE:32883,UNSIGNED_INT_2_10_10_10_REV:33640,MAX_ELEMENTS_VERTICES:33e3,MAX_ELEMENTS_INDICES:33001,TEXTURE_MIN_LOD:33082,TEXTURE_MAX_LOD:33083,TEXTURE_BASE_LEVEL:33084,TEXTURE_MAX_LEVEL:33085,MIN:32775,MAX:32776,DEPTH_COMPONENT24:33190,MAX_TEXTURE_LOD_BIAS:34045,TEXTURE_COMPARE_MODE:34892,TEXTURE_COMPARE_FUNC:34893,CURRENT_QUERY:34917,QUERY_RESULT:34918,QUERY_RESULT_AVAILABLE:34919,STREAM_READ:35041,STREAM_COPY:35042,STATIC_READ:35045,STATIC_COPY:35046,DYNAMIC_READ:35049,DYNAMIC_COPY:35050,MAX_DRAW_BUFFERS:34852,DRAW_BUFFER0:34853,DRAW_BUFFER1:34854,DRAW_BUFFER2:34855,DRAW_BUFFER3:34856,DRAW_BUFFER4:34857,DRAW_BUFFER5:34858,DRAW_BUFFER6:34859,DRAW_BUFFER7:34860,DRAW_BUFFER8:34861,DRAW_BUFFER9:34862,DRAW_BUFFER10:34863,DRAW_BUFFER11:34864,DRAW_BUFFER12:34865,DRAW_BUFFER13:34866,DRAW_BUFFER14:34867,DRAW_BUFFER15:34868,MAX_FRAGMENT_UNIFORM_COMPONENTS:35657,MAX_VERTEX_UNIFORM_COMPONENTS:35658,SAMPLER_3D:35679,SAMPLER_2D_SHADOW:35682,FRAGMENT_SHADER_DERIVATIVE_HINT:35723,PIXEL_PACK_BUFFER:35051,PIXEL_UNPACK_BUFFER:35052,PIXEL_PACK_BUFFER_BINDING:35053,PIXEL_UNPACK_BUFFER_BINDING:35055,FLOAT_MAT2x3:35685,FLOAT_MAT2x4:35686,FLOAT_MAT3x2:35687,FLOAT_MAT3x4:35688,FLOAT_MAT4x2:35689,FLOAT_MAT4x3:35690,SRGB:35904,SRGB8:35905,SRGB8_ALPHA8:35907,COMPARE_REF_TO_TEXTURE:34894,RGBA32F:34836,RGB32F:34837,RGBA16F:34842,RGB16F:34843,VERTEX_ATTRIB_ARRAY_INTEGER:35069,MAX_ARRAY_TEXTURE_LAYERS:35071,MIN_PROGRAM_TEXEL_OFFSET:35076,MAX_PROGRAM_TEXEL_OFFSET:35077,MAX_VARYING_COMPONENTS:35659,TEXTURE_2D_ARRAY:35866,TEXTURE_BINDING_2D_ARRAY:35869,R11F_G11F_B10F:35898,UNSIGNED_INT_10F_11F_11F_REV:35899,RGB9_E5:35901,UNSIGNED_INT_5_9_9_9_REV:35902,TRANSFORM_FEEDBACK_BUFFER_MODE:35967,MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS:35968,TRANSFORM_FEEDBACK_VARYINGS:35971,TRANSFORM_FEEDBACK_BUFFER_START:35972,TRANSFORM_FEEDBACK_BUFFER_SIZE:35973,TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN:35976,RASTERIZER_DISCARD:35977,MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS:35978,MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS:35979,INTERLEAVED_ATTRIBS:35980,SEPARATE_ATTRIBS:35981,TRANSFORM_FEEDBACK_BUFFER:35982,TRANSFORM_FEEDBACK_BUFFER_BINDING:35983,RGBA32UI:36208,RGB32UI:36209,RGBA16UI:36214,RGB16UI:36215,RGBA8UI:36220,RGB8UI:36221,RGBA32I:36226,RGB32I:36227,RGBA16I:36232,RGB16I:36233,RGBA8I:36238,RGB8I:36239,RED_INTEGER:36244,RGB_INTEGER:36248,RGBA_INTEGER:36249,SAMPLER_2D_ARRAY:36289,SAMPLER_2D_ARRAY_SHADOW:36292,SAMPLER_CUBE_SHADOW:36293,UNSIGNED_INT_VEC2:36294,UNSIGNED_INT_VEC3:36295,UNSIGNED_INT_VEC4:36296,INT_SAMPLER_2D:36298,INT_SAMPLER_3D:36299,INT_SAMPLER_CUBE:36300,INT_SAMPLER_2D_ARRAY:36303,UNSIGNED_INT_SAMPLER_2D:36306,UNSIGNED_INT_SAMPLER_3D:36307,UNSIGNED_INT_SAMPLER_CUBE:36308,UNSIGNED_INT_SAMPLER_2D_ARRAY:36311,DEPTH_COMPONENT32F:36012,DEPTH32F_STENCIL8:36013,FLOAT_32_UNSIGNED_INT_24_8_REV:36269,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE:33297,FRAMEBUFFER_ATTACHMENT_RED_SIZE:33298,FRAMEBUFFER_ATTACHMENT_GREEN_SIZE:33299,FRAMEBUFFER_ATTACHMENT_BLUE_SIZE:33300,FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE:33301,FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE:33302,FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE:33303,FRAMEBUFFER_DEFAULT:33304,UNSIGNED_INT_24_8:34042,DEPTH24_STENCIL8:35056,UNSIGNED_NORMALIZED:35863,DRAW_FRAMEBUFFER_BINDING:36006,READ_FRAMEBUFFER:36008,DRAW_FRAMEBUFFER:36009,READ_FRAMEBUFFER_BINDING:36010,RENDERBUFFER_SAMPLES:36011,FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER:36052,MAX_COLOR_ATTACHMENTS:36063,COLOR_ATTACHMENT1:36065,COLOR_ATTACHMENT2:36066,COLOR_ATTACHMENT3:36067,COLOR_ATTACHMENT4:36068,COLOR_ATTACHMENT5:36069,COLOR_ATTACHMENT6:36070,COLOR_ATTACHMENT7:36071,COLOR_ATTACHMENT8:36072,COLOR_ATTACHMENT9:36073,COLOR_ATTACHMENT10:36074,COLOR_ATTACHMENT11:36075,COLOR_ATTACHMENT12:36076,COLOR_ATTACHMENT13:36077,COLOR_ATTACHMENT14:36078,COLOR_ATTACHMENT15:36079,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:36182,MAX_SAMPLES:36183,HALF_FLOAT:5131,RG:33319,RG_INTEGER:33320,R8:33321,RG8:33323,R16F:33325,R32F:33326,RG16F:33327,RG32F:33328,R8I:33329,R8UI:33330,R16I:33331,R16UI:33332,R32I:33333,R32UI:33334,RG8I:33335,RG8UI:33336,RG16I:33337,RG16UI:33338,RG32I:33339,RG32UI:33340,VERTEX_ARRAY_BINDING:34229,R8_SNORM:36756,RG8_SNORM:36757,RGB8_SNORM:36758,RGBA8_SNORM:36759,SIGNED_NORMALIZED:36764,COPY_READ_BUFFER:36662,COPY_WRITE_BUFFER:36663,COPY_READ_BUFFER_BINDING:36662,COPY_WRITE_BUFFER_BINDING:36663,UNIFORM_BUFFER:35345,UNIFORM_BUFFER_BINDING:35368,UNIFORM_BUFFER_START:35369,UNIFORM_BUFFER_SIZE:35370,MAX_VERTEX_UNIFORM_BLOCKS:35371,MAX_FRAGMENT_UNIFORM_BLOCKS:35373,MAX_COMBINED_UNIFORM_BLOCKS:35374,MAX_UNIFORM_BUFFER_BINDINGS:35375,MAX_UNIFORM_BLOCK_SIZE:35376,MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS:35377,MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS:35379,UNIFORM_BUFFER_OFFSET_ALIGNMENT:35380,ACTIVE_UNIFORM_BLOCKS:35382,UNIFORM_TYPE:35383,UNIFORM_SIZE:35384,UNIFORM_BLOCK_INDEX:35386,UNIFORM_OFFSET:35387,UNIFORM_ARRAY_STRIDE:35388,UNIFORM_MATRIX_STRIDE:35389,UNIFORM_IS_ROW_MAJOR:35390,UNIFORM_BLOCK_BINDING:35391,UNIFORM_BLOCK_DATA_SIZE:35392,UNIFORM_BLOCK_ACTIVE_UNIFORMS:35394,UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES:35395,UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER:35396,UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER:35398,INVALID_INDEX:4294967295,MAX_VERTEX_OUTPUT_COMPONENTS:37154,MAX_FRAGMENT_INPUT_COMPONENTS:37157,MAX_SERVER_WAIT_TIMEOUT:37137,OBJECT_TYPE:37138,SYNC_CONDITION:37139,SYNC_STATUS:37140,SYNC_FLAGS:37141,SYNC_FENCE:37142,SYNC_GPU_COMMANDS_COMPLETE:37143,UNSIGNALED:37144,SIGNALED:37145,ALREADY_SIGNALED:37146,TIMEOUT_EXPIRED:37147,CONDITION_SATISFIED:37148,WAIT_FAILED:37149,SYNC_FLUSH_COMMANDS_BIT:1,VERTEX_ATTRIB_ARRAY_DIVISOR:35070,ANY_SAMPLES_PASSED:35887,ANY_SAMPLES_PASSED_CONSERVATIVE:36202,SAMPLER_BINDING:35097,RGB10_A2UI:36975,INT_2_10_10_10_REV:36255,TRANSFORM_FEEDBACK:36386,TRANSFORM_FEEDBACK_PAUSED:36387,TRANSFORM_FEEDBACK_ACTIVE:36388,TRANSFORM_FEEDBACK_BINDING:36389,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_SRGB8_ETC2:37493,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37494,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37495,COMPRESSED_RGBA8_ETC2_EAC:37496,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37497,TEXTURE_IMMUTABLE_FORMAT:37167,MAX_ELEMENT_INDEX:36203,TEXTURE_IMMUTABLE_LEVELS:33503,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047}),Ys=(i3="undefined"!=typeof WebGL2RenderingContext,r3={aliasedLineWidthRange:w.ALIASED_LINE_WIDTH_RANGE,aliasedPointSizeRange:w.ALIASED_POINT_SIZE_RANGE,maxCombinedTextureImageUnits:w.MAX_COMBINED_TEXTURE_IMAGE_UNITS,maxCubeMapTextureSize:w.MAX_CUBE_MAP_TEXTURE_SIZE,maxFragmentUniformVectors:w.MAX_FRAGMENT_UNIFORM_VECTORS,maxRenderBufferSize:w.MAX_RENDERBUFFER_SIZE,maxTextureImageUnits:w.MAX_TEXTURE_IMAGE_UNITS,maxTextureSize:w.MAX_TEXTURE_SIZE,maxVaryingVectors:w.MAX_VARYING_VECTORS,maxVertexAttribs:w.MAX_VERTEX_ATTRIBS,maxVertexTextureImageUnits:w.MAX_VERTEX_TEXTURE_IMAGE_UNITS,maxVertexUniformVectors:w.MAX_VERTEX_UNIFORM_VECTORS,maxViewportDIMs:w.MAX_VIEWPORT_DIMS},e3={max3DTextureSize:w.MAX_3D_TEXTURE_SIZE,maxArrayTextureLayers:w.MAX_ARRAY_TEXTURE_LAYERS,maxColorAttachments:w.MAX_COLOR_ATTACHMENTS,maxCombinedFragmentUniformComponents:w.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS,maxCombinedUniformBlocks:w.MAX_COMBINED_UNIFORM_BLOCKS,maxCombinedVertexUniformComponents:w.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS,maxDrawBuffers:w.MAX_DRAW_BUFFERS,maxElementIndex:w.MAX_ELEMENT_INDEX,maxElementsIndices:w.MAX_ELEMENTS_INDICES,maxElementsVertices:w.MAX_ELEMENTS_VERTICES,maxFragmentInpuComponents:w.MAX_FRAGMENT_INPUT_COMPONENTS,maxFragmentUniformBlocks:w.MAX_FRAGMENT_UNIFORM_BLOCKS,maxFragmentUniformComponents:w.MAX_FRAGMENT_UNIFORM_COMPONENTS,maxProgramTexelOffset:w.MAX_PROGRAM_TEXEL_OFFSET,maxSamples:w.MAX_SAMPLES,maxTextureLODBias:w.MAX_TEXTURE_LOD_BIAS,maxTransformFeedbackInterleavedComponents:w.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS,maxTransformFeedbackSeparateAttribs:w.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS,maxTransformFeedbackSeparateComponents:w.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS,maxUniformBlockSize:w.MAX_UNIFORM_BLOCK_SIZE,maxUniformBufferBindings:w.MAX_UNIFORM_BUFFER_BINDINGS,maxVaryingComponents:w.MAX_VARYING_COMPONENTS,maxVertexOutputComponents:w.MAX_VERTEX_OUTPUT_COMPONENTS,maxVertexUniformBlocks:w.MAX_VERTEX_UNIFORM_BLOCKS,maxVertexUniformComponents:w.MAX_VERTEX_UNIFORM_COMPONENTS,minProgramTexelOffset:w.MIN_PROGRAM_TEXEL_OFFSET},{for:function(p){var G=p._info;return G||(p._info=G=function(J,p){(p=p==K?{}:p).version=i3&&(J instanceof WebGL2RenderingContext||"[object WebGL2RenderingContext]"===d.prototype.toString.call(J))?2:1,p.extensions=function(){for(var p={},G=J.getSupportedExtensions(),v=G.length;v--;)p[G[v]]=function(p,G){var v=K;return function(){return v=v||p.getExtension(G)}}(J,G[v]);return p}();for(var G=d.keys(r3),v=0,$=G.length;v<$;++v)p[S=G[v]]=J.getParameter(r3[S]);if(1<p.version)for(var S,v=0,$=(G=d.keys(e3)).length;v<$;++v)p[S=G[v]]=J.getParameter(e3[S]);return p}(p,G)),G}}),ss=(A3="undefined"!=typeof Float32Array&&new Float32Array(4),i0={viewport:{def:[0,0,NaN,NaN],getter:function(p){return p.getParameter(p.VIEWPORT)},setter:function(p,G){var v=G[2]!=G[2]?p.drawingBufferWidth-G[0]:G[2],J=G[3]!=G[3]?p.drawingBufferHeight-G[1]:G[3];p.viewport(G[0],G[1],v,J)}},dither:{def:!1,getter:function(p){return p.isEnabled(p.DITHER)},setter:function(p,G){G?p.enable(p.DITHER):p.disable(p.DITHER)}},rasterizerDiscard:{def:!1,getter:function(p){return 1<Ys.for(p).version&&p.isEnabled(p.RASTERIZER_DISCARD)},setter:function(p,G){1!==Ys.for(p).version&&(G?p.enable(p.RASTERIZER_DISCARD):p.disable(p.RASTERIZER_DISCARD))}},lineWidth:{def:1,getter:function(p){return p.lineWidth?p.getParameter(p.LINE_WIDTH):1},setter:function(p,G){p.lineWidth&&p.lineWidth(G)}},color:{clear:{def:[0,0,0,0],getter:function(p){return p.getParameter(p.COLOR_CLEAR_VALUE)},setter:function(p,G){p.clearColor(G[0],G[1],G[2],G[3])},parse:oM},mask:{def:[!0,!0,!0,!0],getter:function(p){return p.getParameter(p.COLOR_WRITEMASK)},setter:function(p,G){p.colorMask(G[0],G[1],G[2],G[3])}}},blend:{enabled:{def:!1,getter:function(p){return p.isEnabled(p.BLEND)},setter:function(p,G){G?p.enable(p.BLEND):p.disable(p.BLEND)}},color:{def:[0,0,0,0],getter:function(p){return p.getParameter(p.BLEND_COLOR)},setter:function(p,G){p.blendColor(G[0],G[1],G[2],G[3])},parse:oM},equation:{def:[w.FUNC_ADD,w.FUNC_ADD],getter:function(p){return[p.getParameter(p.BLEND_EQUATION_RGB),p.getParameter(p.BLEND_EQUATION_ALPHA)]},setter:function(p,G){p.blendEquationSeparate(G[0],G[1])},parse:function(p){var G=p.length;return 1<G?p:(A3[1]=A3[0]=1===G?p[0]:p,A3)}},func:{def:[w.ONE,w.ZERO,w.ONE,w.ZERO],getter:function(p){return[p.getParameter(p.BLEND_SRC_RGB),p.getParameter(p.BLEND_DST_RGB),p.getParameter(p.BLEND_SRC_ALPHA),p.getParameter(p.BLEND_DST_ALPHA)]},setter:function(p,G){p.blendFuncSeparate(G[0],G[1],G[2],G[3])},parse:function(p){return 3<p.length?p:(A3[2]=A3[0]=p[0],A3[3]=A3[1]=p[1],A3)}}},cullFace:{enabled:{def:!1,getter:function(p){return p.isEnabled(p.CULL_FACE)},setter:function(p,G){G?p.enable(p.CULL_FACE):p.disable(p.CULL_FACE)}},mode:{def:w.BACK,getter:function(p){return p.getParameter(p.CULL_FACE_MODE)},setter:function(p,G){p.cullFace(G)}},frontFace:{def:w.CCW,getter:function(p){return p.getParameter(p.FRONT_FACE)},setter:function(p,G){p.frontFace(G)}}},scissor:{enabled:{def:!1,getter:function(p){return p.isEnabled(p.SCISSOR_TEST)},setter:function(p,G){G?p.enable(p.SCISSOR_TEST):p.disable(p.SCISSOR_TEST)}},box:{def:[0,0,NaN,NaN],getter:function(p){return p.getParameter(p.SCISSOR_BOX)},setter:function(p,G){var v=G[2]!=G[2]?p.drawingBufferWidth-G[0]:G[2],J=G[3]!=G[3]?p.drawingBufferHeight-G[1]:G[3];p.scissor(G[0],G[1],v,J)}}},depth:{enabled:{def:!1,getter:function(p){return p.isEnabled(p.DEPTH_TEST)},setter:function(p,G){G?p.enable(p.DEPTH_TEST):p.disable(p.DEPTH_TEST)}},clear:{def:1,getter:function(p){return p.getParameter(p.DEPTH_CLEAR_VALUE)},setter:function(p,G){p.clearDepth(G)}},mask:{def:!0,getter:function(p){return p.getParameter(p.DEPTH_WRITEMASK)},setter:function(p,G){p.depthMask(G)}},range:{def:[-1,1],getter:function(p){return p.getParameter(p.DEPTH_RANGE)},setter:function(p,G){p.depthRange(G[0],G[1])}},func:{def:w.LESS,getter:function(p){return p.getParameter(p.DEPTH_FUNC)},setter:function(p,G){p.depthFunc(G)}}},stencil:{enabled:{def:!1,getter:function(p){return p.isEnabled(p.STENCIL_TEST)},setter:function(p,G){G?p.enable(p.STENCIL_TEST):p.disable(p.STENCIL_TEST)}},clear:{def:0,getter:function(p){return p.getParameter(p.STENCIL_CLEAR_VALUE)},setter:function(p,G){p.clearStencil(G)}},frontMask:{def:255,getter:function(p){return p.getParameter(p.STENCIL_WRITEMASK)},setter:function(p,G){p.stencilMaskSeparate(p.FRONT,G)}},frontOp:{def:[w.KEEP,w.KEEP,w.KEEP],getter:function(p){return[p.getParameter(p.STENCIL_FAIL),p.getParameter(p.STENCIL_PASS_DEPTH_FAIL),p.getParameter(p.STENCIL_PASS_DEPTH_PASS)]},setter:function(p,G){p.stencilOpSeparate(p.FRONT,G[0],G[1],G[2])}},frontFunc:{def:[w.ALWAYS,0,255],getter:function(p){return[p.getParameter(p.STENCIL_FUNC),p.getParameter(p.STENCIL_REF),p.getParameter(p.STENCIL_VALUE_MASK)]},setter:function(p,G){p.stencilFuncSeparate(p.FRONT,G[0],G[1],G[2])}},backMask:{def:255,getter:function(p){return p.getParameter(p.STENCIL_BACK_WRITEMASK)},setter:function(p,G){p.stencilMaskSeparate(p.BACK,G)}},backOp:{def:[w.KEEP,w.KEEP,w.KEEP],getter:function(p){return[p.getParameter(p.STENCIL_BACK_FAIL),p.getParameter(p.STENCIL_BACK_PASS_DEPTH_FAIL),p.getParameter(p.STENCIL_BACK_PASS_DEPTH_PASS)]},setter:function(p,G){p.stencilOpSeparate(p.BACK,G[0],G[1],G[2])}},backFunc:{def:[w.ALWAYS,0,255],getter:function(p){return[p.getParameter(p.STENCIL_BACK_FUNC),p.getParameter(p.STENCIL_BACK_REF),p.getParameter(p.STENCIL_BACK_VALUE_MASK)]},setter:function(p,G){p.stencilFuncSeparate(p.BACK,G[0],G[1],G[2])}}},hint:{generateMipmap:{def:w.DONT_CARE,getter:function(p){return p.getParameter(p.GENERATE_MIPMAP_HINT)},setter:function(p,G){p.hint(p.GENERATE_MIPMAP_HINT,G)}},fragmentShaderDerivative:{def:w.DONT_CARE,getter:function(p){var G=Ys.for(p);return 1!==G.version||G.extensions.OES_standard_derivatives?p.getParameter(w.FRAGMENT_SHADER_DERIVATIVE_HINT):w.DONT_CARE},setter:function(p,G){var v=Ys.for(p);(1<v.version||v.extensions.OES_standard_derivatives)&&p.hint(w.FRAGMENT_SHADER_DERIVATIVE_HINT,G)}}},pixelStore:{packAlignment:VM(4,w.PACK_ALIGNMENT,!1),unpackAlignment:VM(4,w.UNPACK_ALIGNMENT,!1),unpackFlipY:VM(!1,w.UNPACK_FLIP_Y_WEBGL,!1),unpackPremultiplyAlpha:VM(!1,w.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),unpackColorspaceConversion:VM(w.BROWSER_DEFAULT_WEBGL,w.UNPACK_COLORSPACE_CONVERSION_WEBGL,!1),packRowLength:VM(0,w.PACK_ROW_LENGTH,!0),packSkipPixels:VM(0,w.PACK_SKIP_PIXELS,!0),packSkipRows:VM(0,w.PACK_SKIP_ROWS,!0),unpackRowLength:VM(0,w.UNPACK_ROW_LENGTH,!0),unpackImageHeight:VM(0,w.UNPACK_IMAGE_HEIGHT,!0),unpackSkipPixels:VM(0,w.UNPACK_SKIP_PIXELS,!0),unpackSkipRows:VM(0,w.UNPACK_SKIP_ROWS,!0),unpackSkipImages:VM(0,w.UNPACK_SKIP_IMAGES,!0)},polygonOffset:{enabled:{def:!1,getter:function(p){return p.isEnabled(p.POLYGON_OFFSET_FILL)},setter:function(p,G){G?p.enable(p.POLYGON_OFFSET_FILL):p.disable(p.POLYGON_OFFSET_FILL)}},value:{def:[0,0],getter:function(p){return[p.getParameter(p.POLYGON_OFFSET_FACTOR),p.getParameter(p.POLYGON_OFFSET_UNITS)]},setter:function(p,G){p.polygonOffset(G[0],G[1])}}},sampleCoverage:{enabled:{def:!1,getter:function(p){return p.isEnabled(p.SAMPLE_COVERAGE)},setter:function(p,G){G?p.enable(p.SAMPLE_COVERAGE):p.disable(p.SAMPLE_COVERAGE)}},alpha:{def:!1,getter:function(p){return p.isEnabled(p.SAMPLE_ALPHA_TO_COVERAGE)},setter:function(p,G){G?p.enable(p.SAMPLE_ALPHA_TO_COVERAGE):p.disable(p.SAMPLE_ALPHA_TO_COVERAGE)}},value:{def:[1,!1],getter:function(p){return[p.getParameter(p.SAMPLE_COVERAGE_VALUE),p.getParameter(p.SAMPLE_COVERAGE_INVERT)]},setter:function(p,G){p.sampleCoverage(G[0],G[1])}}}},i0=Rm.create(i0,function(p){return"def"in p}),FM.prototype.reset=function(){for(var p=this._struct.children,G=p.length;G--;){var v=p[G],J=v.name;v.isLeaf?this[J]=v.desc.def:this._branches[J].reset()}},FM.prototype.save=function(p){p==K&&(p={});for(var G=this._struct.children,v=G.length;v--;){var J=G[v],$=J.name;J.isLeaf?p[$]=UM(this._record[$]):((J=p[$])==K&&(p[$]=J={}),this._branches[$].save(J))}return p},FM.prototype.sync=function(p,G){for(var v=this._struct.children,J=v.length;J--;){var $=v[J],S=$.name;$.isLeaf?!G&&this._leafSync[S]||(p?this._record[S]=$.desc.getter(this.gl):$.desc.setter(this.gl,this._record[S]),this._leafSync[S]=!0):this._branches[S].sync(p,G)}},FM.prototype.syncLoss=function(){for(var p=this._struct.children,G=p.length;G--;){var v=p[G];v.isLeaf?this._leafSync[v.name]=!1:this._branches[v.name].syncLoss()}},FM.prototype.apply=function(p){for(var G=this._struct.children,v=G.length;v--;){var J=G[v],$=J.name;$ in p&&(J.isLeaf?this[$]=p[$]:this._branches[$].apply(p[$]))}},FM.prototype.append=function(p){var G,v=this._struct.childMap;for(G in p){var J=v[G];J&&(J.isLeaf?this[G]=p[G]:this._branches[G].append(p[G]))}},k3=function W($){var l=[];function p(p,G){FM.call(this,$,p,G);for(var v=l.length;v--;){var J=l[v];this._branches[J._name]=new J._type(p,this._record[J._name])}}return jM(p,FM),$.forEach(function(p,G){var v,J,$=p.name,S=iM(p.desc.def),O=S&&p.desc.def.length;p.isLeaf?(v=p.desc.setter,J=p.desc.parse,d.defineProperty(G,$,{configurable:!1,enumerable:!0,get:function(){return this._record[$]},set:S?function(p){J&&(p=J(p)),!function(p,G){for(var v=O,J=!1;v--;)p[v]!==G[v]&&(p[v]=G[v],J=!0);return J}(this._record[$],p)&&this._leafSync[$]||(v(this.gl,this._record[$]),this._leafSync[$]=!0)}:function(p){this._record[$]===p&&this._leafSync[$]||(v(this.gl,p),this._record[$]=p,this._leafSync[$]=!0)}})):(l.push({_name:$,_type:W(p)}),d.defineProperty(G,$,{configurable:!1,enumerable:!0,get:function(){return this._branches[$]},set:function(p){this._branches[$].apply(p)}}))},p.prototype),p}(i0),function(){var l=[];if("function"==typeof Float32Array)for(var p=1;p<17;++p)l[p]=new Float32Array(p);function t(p,G,v,J){if(p)if(p.length!=K)for($=0;$<J;++$)G[v+$]=p[$];else p.toArray&&p.toArray(G,v);else for(var $=0;$<J;++$)G[v+$]=0}function v(p,G,v){var J=p[0];if(J<=0||0<J)return p;var $=G*v,S=l[$];if(S==K&&(l[$]=S=new Float32Array($)),0!==G){t(J,S,0,v);for(var O=1,W=0;O!==G;++O)t(p[O],S,W+=v,v)}return S}function G(p,G){p.uniform1iv(this.addr,G)}function J(p,G){p.uniform2iv(this.addr,G)}function $(p,G){p.uniform3iv(this.addr,G)}function S(p,G){p.uniform4iv(this.addr,G)}var O=[0,1],W=[];function z(p,G,v){W[p]=[G,v]}z(w.FLOAT,function(p,G){p.uniform1f(this.addr,G)},function(p,G){p.uniform1fv(this.addr,G)}),z(w.FLOAT_VEC2,function(p,G){var v;G.x!=K?p.uniform2f(this.addr,G.x,G.y):((v=l[2]).set(G,0),p.uniform2fv(this.addr,v))},function(p,G){p.uniform2fv(this.addr,v(G,this.size,2))}),z(w.FLOAT_VEC3,function(p,G){var v;G.x!=K?p.uniform3f(this.addr,G.x,G.y,G.z):G.r!=K?p.uniform3f(this.addr,G.r,G.g,G.b):G.red!=K?p.uniform3f(this.addr,G.red,G.green,G.blue):((v=l[3]).set(G,0),p.uniform3fv(this.addr,v))},function(p,G){p.uniform3fv(this.addr,v(G,this.size,3))}),z(w.FLOAT_VEC4,function(p,G){var v;(G="string"==typeof G?yE(G):G).x!=K?p.uniform4f(this.addr,G.x,G.y,G.z,G.w):G.r!=K?p.uniform4f(this.addr,G.r,G.g,G.b,G.a):G.red!=K?p.uniform4f(this.addr,G.red,G.green,G.blue,G.alpha):((v=l[4]).set(G,0),p.uniform4fv(this.addr,v))},function(p,G){p.uniform4fv(this.addr,v(G,this.size,4))}),z(w.INT,function(p,G){p.uniform1i(this.addr,G)},G),z(w.INT_VEC2,J,J),z(w.INT_VEC3,$,$),z(w.INT_VEC4,S,S),z(w.BOOL,function(p,G){p.uniform1i(this.addr,O[G?1:0])},G),z(w.BOOL_VEC2,J,J),z(w.BOOL_VEC3,$,$),z(w.BOOL_VEC4,S,S),z(w.FLOAT_MAT2,function(p,G){var v=l[4];v.set(G,0),p.uniformMatrix2fv(this.addr,!1,v)},function(p,G){p.uniformMatrix2fv(this.addr,!1,v(G,this.size,4))}),z(w.FLOAT_MAT3,function(p,G){var v=l[9];v.set(G,0),p.uniformMatrix3fv(this.addr,!1,v)},function(p,G){p.uniformMatrix3fv(this.addr,!1,v(G,this.size,9))}),z(w.FLOAT_MAT4,function(p,G){var v=l[16];v.set(G,0),p.uniformMatrix4fv(this.addr,!1,v)},function(p,G){p.uniformMatrix4fv(this.addr,!1,v(G,this.size,16))}),z(w.SAMPLER_2D,function(p,G){p.uniform1i(this.addr,this.slots[0]),p.activeTexture(p.TEXTURE0+this.slots[0]),p.bindTexture(p.TEXTURE_2D,G||p._emptyTexture)},function(p,G){p.uniform1iv(this.addr,this.slots);for(var v=this.slots.length;v--;)p.activeTexture(p.TEXTURE0+this.slots[v]),p.bindTexture(p.TEXTURE_2D,G[v]||p._emptyTexture)}),z(w.SAMPLER_CUBE,function(p,G){p.uniform1i(this.addr,this.slots[0]),p.activeTexture(p.TEXTURE0+this.slots[0]),p.bindTexture(p.TEXTURE_CUBE_MAP,G||p._emptyCubeTexture)},function(p,G){p.uniform1iv(this.addr,this.slots);for(var v=this.slots.length;v--;)p.activeTexture(p.TEXTURE0+this.slots[v]),p.bindTexture(p.TEXTURE_CUBE_MAP,G[v]||p._emptyCubeTexture)});var L=/([\w\d_]+)(\])?(\[|\.)?/g;function H(p,G,v,J,$){this.name=p,this.addr=G,this.size=J?v.size:0,this.activeInfo=v,this.setter=W[v.type][J?1:0],this.slots=function(p,G,v){switch(p.type){case 35678:case 35680:if("uSampler"===v)return[0];if("uBlendSampler"===v)return[1];for(var J=p.size,$=new Int32Array(J),S=0;S<J;++S)$[S]=G.usedTextureSlot++;return $}return K}(v,$,p),xm(this)}function _(p,G,v){this.gl=G,this._program=v,this._leaves={},this._branches={},this._struct=p}function Z(p,G){for(var v=p.getProgramParameter(G,p.ACTIVE_UNIFORMS),J={},$={usedTextureSlot:2};v--;){var S=p.getActiveUniform(G,v),O=S.name,W=(g=f=q=t=void 0,S),l=p.getUniformLocation(G,O),t=J,z=$,Z=W.name,B=Z.length;for(L.lastIndex=0;;){var f=L.exec(Z),X=L.lastIndex,q=f[1],g="]"===f[2];if(g&&(q|=0),(f=f[3])===K||"["===f&&X+2===B){t[q]=new H(q,l,W,f!==K,z);break}(g=t[q])==K&&(t[q]=g={}),t=g}}var M=function $(S){var O=[];function p(p,G){_.call(this,S,p,G);for(var v=O.length;v--;){var J=O[v];this._branches[J._name]=new J._type(p,G)}this.uuid=sh.generateUUID()}return jM(p,_),S.forEach(function(p,G){var v,J=p.name;p.isLeaf?(v=rM("d.setter(this.gl, v);",["v"],["d"],[p.desc]),d.defineProperty(G,J,{configurable:!1,enumerable:!0,get:function(){return v},set:v})):(O.push({_name:J,_type:$(p)}),d.defineProperty(G,J,{configurable:!1,enumerable:!0,get:function(){return this._branches[J]},set:function(p){this._branches[J].apply(p)}}))},p.prototype),p}(Rm.create(J,function(p){return"addr"in p}));return d.defineProperty(M.prototype,"textureCount",{configurable:!1,enumerable:!1,writable:!1,value:$.usedTextureSlot}),new M(p,G)}return _.prototype.apply=function(p){for(var G=this._struct.children,v=G.length;v--;){var J=G[v],$=J.name;$ in p&&(J.isLeaf?this[$]=p[$]:this._branches[$].apply(p[$]))}},_.prototype.append=function(p){var G,v=this._struct.childMap;for(G in p){var J=v[G];J&&(J.isLeaf?this[G]=p[G]:this._branches[G].append(p[G]))}},function(p,G){var v=G._uniforms;return v||(G._uniforms=v=Z(p,G)),v}}()),cs=function(){for(var $=[],p=1;p<17;++p)$[p]=new pm(p);function t(p,G,v,J){for(var $=v?1:0,S=G.addr,O=p._divisorState,W=0;W<J;W++)(O[S+W]||0)!==$&&(O[S+W]=$,p.vertexAttribDivisor(S+W,$))}var J=[],z="undefined"!=typeof WebGLBuffer&&WebGLBuffer.prototype;function G(p,O,W,l){J[p]=function(p,G,v,J,$,S){this.addr==K||this.addr<0||(G==K||!1===G?l(p,this.addr):ym(G)===z?W(this,p,G,v,J,$,S):(l(p,this.addr),O(this,p,G)))}}function v(p,G){p.disableVertexAttribArray(G)}function W(p,G,v){this.name=p,this.addr=G,this.activeInfo=v,this.setter=J[v.type],xm(this)}function l(p,G,v){this.gl=G,this.program=v,this._branches={},this._struct=p}return G(w.FLOAT,function(p,G,v){G.vertexAttrib1f(p.addr,v)},function(p,G,v,J,$,S,O){G.bindBuffer(G.ARRAY_BUFFER,v);var W=p.addr;G.enableVertexAttribArray(W),t(G,p,v.instanced,1),G.vertexAttribPointer(W,1,J||G.FLOAT,!!$,S||0,O||0),G.bindBuffer(G.ARRAY_BUFFER,null)},v),G(w.FLOAT_VEC2,function(p,G,v){var J;v.x!=K?G.vertexAttrib2f(p.addr,v.x,v.y):((J=$[2]).set(v,0),G.vertexAttrib2fv(p.addr,J))},function(p,G,v,J,$,S,O){G.bindBuffer(G.ARRAY_BUFFER,v);var W=p.addr;G.enableVertexAttribArray(W),t(G,p,v.instanced,1),G.vertexAttribPointer(W,2,J||G.FLOAT,!!$,S||0,O||0),G.bindBuffer(G.ARRAY_BUFFER,null)},v),G(w.FLOAT_VEC3,function(p,G,v){var J;v.x!=K?G.vertexAttrib3f(p.addr,v.x,v.y,v.z):v.r!=K?G.vertexAttrib3f(p.addr,v.r,v.g,v.b):v.red!=K?G.vertexAttrib3f(p.addr,v.red,v.green,v.blue):((J=$[3]).set(v,0),G.vertexAttrib3fv(p.addr,J))},function(p,G,v,J,$,S,O){G.bindBuffer(G.ARRAY_BUFFER,v);var W=p.addr;G.enableVertexAttribArray(W),t(G,p,v.instanced,1),G.vertexAttribPointer(W,3,J||G.FLOAT,!!$,S||0,O||0),G.bindBuffer(G.ARRAY_BUFFER,null)},v),G(w.FLOAT_VEC4,function(p,G,v){var J;(v="string"==typeof v?yE(v):v).x!=K?G.vertexAttrib4f(p.addr,v.x,v.y,v.z,v.w):v.r!=K?G.vertexAttrib4f(p.addr,v.r,v.g,v.b,v.a):v.red!=K?G.vertexAttrib4f(p.addr,v.red,v.green,v.blue,v.alpha):((J=$[4]).set(v,0),G.vertexAttrib4fv(p.addr,J))},function(p,G,v,J,$,S,O){G.bindBuffer(G.ARRAY_BUFFER,v);var W=p.addr;G.enableVertexAttribArray(W),t(G,p,v.instanced,1),G.vertexAttribPointer(W,4,J||G.FLOAT,!!$,S||0,O||0),G.bindBuffer(G.ARRAY_BUFFER,null)},v),G(w.FLOAT_MAT2,function(p,G,v){v=v.el||v;for(var J=0,$=0;J<2;++J)G.vertexAttrib2f(p.addr,v[$++],v[$++])},function(p,G,v,J,$,S,O){var S=S||16,O=O||0,W=p.addr;G.bindBuffer(G.ARRAY_BUFFER,v),G.enableVertexAttribArray(W),G.vertexAttribPointer(W,2,J||G.FLOAT,!!$,S,O),G.enableVertexAttribArray(W+1),G.vertexAttribPointer(W+1,2,J||G.FLOAT,!!$,S,O+8),t(G,p,v.instanced,2),G.bindBuffer(G.ARRAY_BUFFER,null)},function(p,G){p.disableVertexAttribArray(G),p.disableVertexAttribArray(G+1)}),G(w.FLOAT_MAT3,function(p,G,v){v=v.el||v;for(var J=0,$=0;J<3;++J)G.vertexAttrib3f(p.addr,v[$++],v[$++],v[$++])},function(p,G,v,J,$,S,O){var S=S||36,O=O||0,W=p.addr;G.bindBuffer(G.ARRAY_BUFFER,v);for(var l=0;l<3;l++)G.enableVertexAttribArray(W+l),G.vertexAttribPointer(W+l,3,J||G.FLOAT,!!$,S,O+12*l);t(G,p,v.instanced,3),G.bindBuffer(G.ARRAY_BUFFER,null)},function(p,G){p.disableVertexAttribArray(G),p.disableVertexAttribArray(G+1),p.disableVertexAttribArray(G+2)}),G(w.FLOAT_MAT4,function(p,G,v){v=v.el||v;for(var J=0,$=0;J<4;++J)G.vertexAttrib4f(p.addr,v[$++],v[$++],v[$++],v[$++])},function(p,G,v,J,$,S,O){var S=S||64,O=O||0,W=p.addr;G.bindBuffer(G.ARRAY_BUFFER,v);for(var l=0;l<4;l++)G.enableVertexAttribArray(W+l),G.vertexAttribPointer(W+l,4,J||G.FLOAT,!!$,S,O+16*l);t(G,p,v.instanced,4),G.bindBuffer(G.ARRAY_BUFFER,null)},function(p,G){p.disableVertexAttribArray(G),p.disableVertexAttribArray(G+1),p.disableVertexAttribArray(G+2),p.disableVertexAttribArray(G+3)}),l.prototype.disable=function(){for(var p=this._struct.children,G=p.length;G--;){var v=p[G],J=v.name;v.isLeaf?this[J]=K:this._branches[J].disable()}},l.prototype.apply=function(p){for(var G=this._struct.children,v=G.length;v--;){var J=G[v],$=J.name;$ in p&&(J.isLeaf?this[$]=p[$]:this._branches[$].apply(p[$]))}},l.prototype.append=function(p){var G,v=this._struct.childMap;for(G in p){var J=v[G];J&&(J.isLeaf?this[G]=p[G]:this._branches[G].append(p[G]))}},function(p,G){var v=G._attribs;return v||(G._attribs=v=function(p,G){for(var v=p.getProgramParameter(G,p.ACTIVE_ATTRIBUTES),J={};v--;){var $=p.getActiveAttrib(G,v),S=$.name,O=p.getAttribLocation(G,S);J[S]=new W(S,O,$)}return new(function $(S){var O=[];function p(p,G){l.call(this,S,p,G);for(var v=O.length;v--;){var J=O[v];this._branches[J._name]=new J._type(p,G)}}return jM(p,l),S.forEach(function(p,G){var v,J=p.name;p.isLeaf?(v=rM("d.setter(this.gl, v);",["v"],["d"],[p.desc]),d.defineProperty(G,J,{configurable:!1,enumerable:!0,get:function(){return v},set:v})):(O.push({_name:J,_type:$(p)}),d.defineProperty(G,J,{configurable:!1,enumerable:!0,get:function(){return this._branches[J]},set:function(p){this._branches[J].apply(p)}}))},p.prototype),p}(Rm.create(J,function(p){return"addr"in p})))(p,G)}(p,G)),v}}(),r=function(p){var G;d.defineProperties(this,{gl:{configurable:!1,enumerable:!1,value:p,writable:!1},glState:{configurable:!1,enumerable:!1,value:((G=(p=p)._state)||(p._state=G=new k3(p)),G),writable:!1}}),this._currProgram=K,this._currUniforms=K,this._currAttribs=K,this._sync=!0},hs=(d.defineProperties(r.prototype,{program:{configurable:!1,enumerable:!1,get:function(){return this._currProgram},set:function(p){this._sync&&p===this._currProgram||(this.gl.useProgram(p),this._currProgram=p,this._currUniforms=ss(this.gl,p),this._currAttribs=cs(this.gl,p),this._sync=!0)}},uniforms:{configurable:!1,enumerable:!1,get:function(){return this._currProgram&&!this._sync&&(this.gl.useProgram(this._currProgram),this._sync=!0),this._currUniforms},set:function(p){this._currUniforms&&(this._currProgram&&!this._sync&&(this.gl.useProgram(this._currProgram),this._sync=!0),this._currUniforms.apply(p))}},attribs:{configurable:!1,enumerable:!1,get:function(){return this._currProgram&&!this._sync&&(this.gl.useProgram(this._currProgram),this._sync=!0),this._currAttribs},set:function(p){this._currUniforms&&(this._currProgram&&!this._sync&&(this.gl.useProgram(this._currProgram),this._sync=!0),this._currAttribs.apply(p))}}}),r.prototype.useProgram=function(p){this._sync&&p===this._currProgram||(this.gl.useProgram(p),this._currProgram=p,this._currUniforms=ss(this.gl,p),this._currAttribs=cs(this.gl,p),this._sync=!0)},r.prototype.directState=function(){return this.glState},r.prototype.directUniforms=function(){return this._currUniforms},r.prototype.directAttribs=function(){return this._currAttribs},r.prototype.syncLoss=function(){this._sync=!1,this.glState.syncLoss()},r.for=function(p){var G=p._renderState;return G||(p._renderState=G=new r(p)),G},"light.color"),ws=4294967295,ds=0,Ps={},js=[],is=0,rs=function(p){var G;if(p=N.convertShape3dModelName(p),OS(p)){if(p.modelType){if(p.uuid){if(G=Yi[p.uuid])return G}else p.uuid=E.Math.generateUUID();return G!==K||Ap&&Ap[p.uuid]||yp(p.uuid,p),K}return p}return G=Yi[p],p&&G===K&&ii.test(p)&&(Ap&&Ap[p]||Ep(p,p)),G},es=function(p,G){p.frameStack?p.frameStack.push(G):p.frameStack=[G],p.bindFramebuffer(p.FRAMEBUFFER,G)},As=function(p){var G=p.frameStack;if(G){if(G.pop(),G.length)return void p.bindFramebuffer(p.FRAMEBUFFER,G[G.length-1]);p.frameStack=null}p.bindFramebuffer(p.FRAMEBUFFER,null)},ks=(MS(N,{graph3dViewAttributes:v0,graph3dViewFirstPersonMode:!1,graph3dViewMouseRoamable:!0,graph3dViewMoveStep:15,graph3dViewRotateStep:j/60,graph3dViewSortable:!1,graph3dViewBlockSelectable:!0,graph3dViewEditHelperDisabled:!1,graph3dViewPannable:!0,graph3dViewRotatable:!0,graph3dViewWalkable:!0,graph3dViewResettable:!0,graph3dViewZoomable:!0,graph3dViewRectSelectable:!0,graph3dViewRectSelectBackground:Cl,graph3dViewGridVisible:!1,graph3dViewGridSize:50,graph3dViewGridGap:50,graph3dViewGridColor:[.4,.75,.85,1],graph3dViewRotateMaxPhi:j,graph3dViewRotateMinPhi:0,graph3dViewShadowDisabled:!0,graph3dViewShadowQuality:"high",graph3dViewShadowIntensity:.3,graph3dViewShadowBias:-.005,graph3dViewShadowRadius:.1,graph3dViewShadowType:"hard",graph3dViewShadowDegreeX:30,graph3dViewShadowDegreeZ:-10,graph3dViewOriginAxisVisible:!1,graph3dViewCenterAxisVisible:!1,graph3dViewAxisXColor:[1,0,0,1],graph3dViewAxisYColor:[0,1,0,1],graph3dViewAxisZColor:[0,0,1,1],graph3dViewEditSizeColor:[1,1,0,1],graph3dViewOrtho:!1,graph3dViewOrthoWidth:2e3,graph3dViewSyncEyeWithOrthoWidth:!1,graph3dViewFovy:j/4,graph3dViewNear:10,graph3dViewFar:1e4,graph3dViewEye:[0,300,1e3],graph3dViewCenter:[0,0,0],graph3dViewUp:[0,1,-1e-7],graph3dViewDataNumWarningLine:1e4,graph3dViewHeadlightDirection:"camera",graph3dViewHeadlightRange:0,graph3dViewHeadlightGroup:0,graph3dViewHeadlightColor:[1,1,1,1],graph3dViewHeadlightIntensity:1,graph3dViewHeadlightDisabled:!1,graph3dViewHeadlightAmbientIntensity:.7,graph3dViewFogDisabled:!0,graph3dViewFogMode:"linear",graph3dViewFogDensity:5e-4,graph3dViewFogColor:"white",graph3dViewFogNear:1,graph3dViewFogFar:2e3,graph3dViewPickerResolution:.5,graph3dViewDashDisabled:!0,graph3dViewUvClipEnabled:!1,graph3dViewBatchBlendDisabled:!0,graph3dViewBatchBrightnessDisabled:!0,graph3dViewBatchColorDisabled:!1,graph3dViewBatchInstancedDisabled:!0,graph3dViewFlowBlendMode:"addRGB",graph3dViewEnvmapType:"legacy",graph3dMaxVectorCacheTime:50,graph3dEnvmapCapabilityRequire:8,setShape3dModel:function(p,G){JS(G)&&ii.test(G)?Ep(p,G):OS(G)&&G.modelType?yp(p,G):G===K?delete Yi[p]:Yi[p]=G},getShape3dModel:rs,convertShape3dModelName:function(p){return p},getShape3dModelMap:function(){return Yi},getCachedShape3dModelMap:function(){return si},createMatrix:function(p,G){for(var v=(p=lS(p)?p:[p]).length-1;0<=v;v--){var J=p[v];G=qm(J.mat,J.s3,J.r3,J.rotationMode,J.t3,G)}return G},transformVec:lm,glBindFrame:es,glUnbindFrame:As,createBoxModel:function(){return{vs:Kp,ns:Tp,uv:up,is:ap}},createRoundRectModel:function(p,G){return Sn.roundRect(p,G)},createStarModel:function(p,G){return Sn.star(p,G)},createRectModel:function(p,G){return Sn.rect(p,G)},createTriangleModel:function(p,G){return Sn.triangle(p,G)},createRightTriangleModel:function(p,G){return Sn.rightTriangle(p,G)},createParallelogramModel:function(p,G){return Sn.parallelogram(p,G)},createTrapezoidModel:function(p,G){return Sn.trapezoid(p,G)},createSmoothSphereModel:function(p,G,v,J,$,S,O){return xj(new BI(p,G,v,J,$,S,O))},createSphereModel:function(p,G,v,J,$,S,O){return p?Fp(p,G,v,J,$,S,O):N.createSmoothSphereModel()},createSmoothConeModel:function(p,G,v,J,$){return vn(p,G,v,J,$)},createConeModel:function(p,G,v,J,$,S,O,W){return p?Jn(p,G,v,J,$,S,O,W):vn(S)},createSmoothCylinderModel:function(p,G,v,J,$,S,O,W){return xj(new ZI(p,G,v,J,$,S,O,W))},createCylinderModel:function(p,G,v,J,$,S,O,W){return p?Gn(p,G,v,J,$,S,O,W):pn(S,O)},createSmoothTorusModel:function(p,G,v,J,$,S){return xj(new fI(p,G,v,J,$,S))},createTorusModel:function(p,G,v,J,$,S,O,W){return p?Qp(p,G,v,J,$,S,O,W):Cp(S,O)},createExtrusionModel:function(p,G,v,J,$,S,O,W){return $n(p,G,v,J,$,S,O,W)},createSmoothRingModel:function(p,G,v,J,$,S){for(var O=[],W=0;W<p.length-1;W+=2)O.push({x:p[W],y:p[W+1]});for(p=aE(O,G,v)[0],O=[],W=0;W<p.length;W++){var l=p[W];O.push(new a(l.x,0,l.y))}return xj(new gI(O,S,J,$))},createTextGeometry:function(p,G){var v=xj(new MI(p,G));if(G.cube)for(var G=(p=function(p){for(var G,v,J,$,S,O,W=lS(p)?p:[p],l=1/0,t=1/0,z=1/0,Z=-1/0,B=-1/0,f=-1/0,X=["vs","top_vs","bottom_vs"],q=0,g=W.length;q<g;q++)for(O=W[q],G=0,v=X.length;G<v;G++)if(S=O[X[G]])for(J=0,$=S.length;J<$;J+=3)l=$0(l,S[J]),t=$0(t,S[J+1]),z=$0(z,S[J+2]),Z=J0(Z,S[J]),B=J0(B,S[J+1]),f=J0(f,S[J+2]);return p.boundingBox={min:{x:l,y:t,z:z},max:{x:Z,y:B,z:f}}}(v)).min,p=p.max,J=G.x,$=G.y,S=G.z,O=p.x-J||1,W=p.y-$||1,l=p.z-S||1,t=["vs","top_vs","bottom_vs"],z=0,Z=t.length;z<Z;z++){var B=v[t[z]];if(B)for(var f=0,X=B.length;f<X;f+=3)B[f]=(B[f]-J)/O-.5,B[f+1]=(B[f+1]-$)/W-.5,B[f+2]=(B[f+2]-S)/l-.5}return v},loadFontFace:function(p,J){N.xhrLoad(p,function(G){if(!G)return J();var v;try{v=JSON.parse(G)}catch(p){v=JSON.parse(G.substring(65,G.length-2))}JI.loadFace(v),J&&J(v.familyName.toLowerCase())},J?null:{sync:!0})},getShaderErrorLog:function(){return js.join("\n")},createRingModel:function(p,k,I,G,v,J,$,S,O,W){for(var l=[],t=0;t<p.length-1;t+=2)l.push({x:p[t],y:p[t+1]});J=J||N.shapeSide,$=$||0,S=S||J;var z,Z,B,f,X,q,g,M,L,H,_,b,n,D,Y,s,c,h=[],w=[],d=O?[]:v0,P=O?[]:v0,j=W?[]:v0,i=W?[]:v0,r=G?[]:v0,E=G?[]:v0,y=v?[]:v0,x=v?[]:v0,p=aE(l,k,I),R=AS(p),e=0,A=2*Math.PI/J;return p.forEach(function(p){if(1<(B=p.length)){if(f=p[0],G)for(q=f.x,M=f.y,t=$;t<S;t++)n=(_=t+1)*A,D=S0(b=t*A),Y=O0(b),s=S0(n),c=O0(n),r.push(D*q,M,-Y*q,s*q,M,-c*q,0,M,0),E.push(.5-.5*D,.5-.5*Y,.5-.5*s,.5-.5*c,.5,.5);for(H=0;H<B;H++){for(X=p[H],q=f.x,g=X.x,M=f.y,L=X.y,z=e/R,e+=iA(f,X),Z=e/R,t=$;t<S;t++)n=(_=t+1)*A,D=S0(b=t*A),Y=O0(b),s=S0(n),c=O0(n),h.push(D*g,L,-Y*g,s*g,L,-c*g,D*q,M,-Y*q,s*g,L,-c*g,s*q,M,-c*q,D*q,M,-Y*q),w.push(t/J,Z,_/J,Z,t/J,z,_/J,Z,_/J,z,t/J,z),O&&t===$&&(d.push(0,M,0,0,L,0,D*g,L,-Y*g,D*g,L,-Y*g,D*q,M,-Y*q,0,M,0),P.push(0,.5-M,0,.5-L,2*g,.5-L,2*g,.5-L,2*q,.5-M,0,.5-M)),W&&_===S&&(j.push(0,M,0,s*g,L,-c*g,0,L,0,s*g,L,-c*g,0,M,0,s*q,M,-c*q),i.push(1,.5-M,1-2*g,.5-L,1,.5-L,1-2*g,.5-L,1,.5-M,1-2*q,.5-M));f=X}if(v)for(q=f.x,M=f.y,t=$;t<S;t++)n=(_=t+1)*A,D=S0(b=t*A),Y=O0(b),s=S0(n),c=O0(n),y.push(s*q,M,-c*q,D*q,M,-Y*q,0,M,0),x.push(.5-.5*s,.5+.5*c,.5-.5*D,.5+.5*Y,.5,.5)}}),{vs:h,uv:w,bottom_vs:y,bottom_uv:x,top_vs:r,top_uv:E,from_vs:d,from_uv:P,to_vs:j,to_uv:i}}},!0),MS(F,{"3d.move.mode":K,"3d.selectable":!0,"3d.visible":!0,"3d.movable":!0,"3d.editable":!0,"3d.clip.direction":null,"3d.clip.percentage":1,"3d.reflectable":!0,"shape.border.gradient.color":K,"edge.gradient.color":K,"edge.source.t3":K,"edge.target.t3":K,"light.type":"point","light.group":0,"light.center":[0,0,0],"light.color":[1,1,1,1],"light.disabled":!1,"light.angle":j/4,"light.range":0,"light.exponent":1,"light.intensity":1,"light.mask":ws,"headlight.ambientIntensity":K,"wf.visible":!1,"wf.width":1,"wf.fog":!0,"wf.color":r4,"wf.short":!1,"wf.mat":K,"wf.boundingBox":!1,"wf.geometry":!1,"wf.loadQuadWireframe":!1,"wf.combineTriangle":!0,batch:K,"transparent.mask":!1,brightness:K,"select.brightness":.7,"repeat.uv.length":K,"shadow.cast":!0,"shadow.receive":!0,"3d.clipbox":K,"3d.clipbox.mask":ws,"3d.clipbox.group":0,"3d.clipbox.shape":"cube","effect.flow":!1,"effect.flow.gradient":"spread.horizontal","effect.flow.uvshape":"rect","effect.flow.size":512,"effect.flow.group":0,"effect.flow.intensity":1,"effect.flow.blend":K,"effect.flow.mask":ws,bloom:!1,envmap:0,"envmap.probe":0,roughness:0,renderTextureSamples:4,alphaTest:.4,autorotate:!1,fixSizeOnScreen:!1,"texture.cache":!1,"hide.overlapping.group":K,"vector.dynamic":!1,"vector.dynamic.maxsize":2048,"texture.scale":1,"geometry.cache":!1,"highlight.mode":!1,"highlight.type":"hard","highlight.visible":!0,"highlight.width":.8,"highlight.color":"rgba(190, 210, 250, 1)","highlight.glow":.8,"highlight.strength":2,"color.empty":[0,0,0,0],"label.face":U0,"label.t3":K,"label.r3":K,"label.texture.scale":2,"label.rotationMode":k4,"label.light":!1,"label.blend":K,"label.reverse.flip":!1,"label.reverse.color":n4,"label.reverse.cull":!1,"label.transparent":!1,"label.autorotate":!1,"label2.face":U0,"label2.t3":K,"label2.r3":K,"label2.texture.scale":2,"label2.rotationMode":k4,"label2.light":!1,"label2.blend":K,"label2.reverse.flip":!1,"label2.reverse.color":n4,"label2.reverse.cull":!1,"label2.transparent":!1,"label2.autorotate":!1,"note.face":U0,"note.t3":K,"note.r3":K,"note.texture.scale":2,"note.rotationMode":k4,"note.light":!1,"note.blend":K,"note.reverse.flip":!1,"note.reverse.color":n4,"note.reverse.cull":!1,"note.transparent":!1,"note.autorotate":!1,"note2.face":U0,"note2.t3":K,"note2.r3":K,"note2.texture.scale":2,"note2.rotationMode":k4,"note2.light":!1,"note2.blend":K,"note2.reverse.flip":!1,"note2.reverse.color":n4,"note2.reverse.cull":!1,"note2.transparent":!1,"note2.autorotate":!1,"part.boundingBox":!1,shape3d:K,"shape3d.color":v,"shape3d.top.color":K,"shape3d.bottom.color":K,"shape3d.from.color":K,"shape3d.to.color":K,"shape3d.image":K,"shape3d.image.projection":K,"shape3d.top.image":K,"shape3d.bottom.image":K,"shape3d.from.image":K,"shape3d.to.image":K,"shape3d.light":!0,"shape3d.side":0,"shape3d.side.from":K,"shape3d.side.to":K,"shape3d.smooth":K,"shape3d.visible":!0,"shape3d.from.visible":!0,"shape3d.to.visible":!0,"shape3d.top.visible":!0,"shape3d.bottom.visible":!0,"shape3d.torus.radius":.17,"shape3d.resolution":0,"shape3d.blend":K,"shape3d.opacity":K,"shape3d.reverse.flip":!1,"shape3d.reverse.color":n4,"shape3d.reverse.cull":!1,"shape3d.transparent":!1,"shape3d.uv.offset":K,"shape3d.uv.scale":K,"shape3d.uv.rotation":K,"shape3d.uv.anchor":K,"shape3d.uv.union":K,"shape3d.top.uv.offset":K,"shape3d.top.uv.scale":K,"shape3d.top.uv.rotation":K,"shape3d.top.uv.anchor":K,"shape3d.bottom.uv.offset":K,"shape3d.bottom.uv.scale":K,"shape3d.bottom.uv.rotation":K,"shape3d.bottom.uv.anchor":K,"shape3d.from.uv.offset":K,"shape3d.from.uv.scale":K,"shape3d.from.uv.rotation":K,"shape3d.from.uv.anchor":K,"shape3d.to.uv.offset":K,"shape3d.to.uv.scale":K,"shape3d.to.uv.rotation":K,"shape3d.to.uv.anchor":K,"shape3d.top.cap":K,"shape3d.bottom.cap":K,"shape3d.start.angle":0,"shape3d.sweep.angle":W0,"shape3d.point.epsilon":1e-6,"shape3d.discard.selectable":!0,"shape3d.top.discard.selectable":!0,"shape3d.bottom.discard.selectable":!0,"shape3d.from.discard.selectable":!0,"shape3d.to.discard.selectable":!0,"shape3d.scaleable":!0,"shape3d.reflector":!1,"shape3d.reflector.color":"rgb(128,128,128)","shape3d.reflector.blur":0,"shape3d.reflector.blur.iterations":1,"shape3d.reflector.background":null,"shape3d.reflector.clip":.003,"shape3d.reflector.shadow":"scene","camera.type":"perspective","camera.aspect":1,"camera.fovy":K,"camera.ortho.width":K,"camera.near":K,"camera.far":K,"camera.background":0,"camera.renderSky":!0,"camera.renderAxis":!1,"camera.renderGrid":!1,"camera.renderEdit":!1,"camera.onlySky":!1,"texture.mipmap.max":K,"texture.filter":K,"texture.filter.min":K,"texture.filter.mag":K,"texture.wrap":K,"points.image":"rect","points.color":"white","points.transparent":!1,"points.size":20,"points.opacity":1,"points.uv.scale":[1,1],"points.uv.offset":[0,0],"points.discard.selectable":!1,"all.light":!0,"all.visible":!0,"all.color":v,"all.image":K,"all.blend":K,"all.opacity":K,"all.reverse.flip":!1,"all.reverse.color":n4,"all.reverse.cull":!1,"all.transparent":!1,"all.uv":K,"all.uv.offset":K,"all.uv.scale":K,"all.uv.rotation":K,"all.uv.anchor":K,"all.uv.union":K,"all.discard.selectable":!0,mat:K,"left.mat":K,"right.mat":K,"top.mat":K,"bottom.mat":K,"front.mat":K,"back.mat":K,"edge.source.anchor.elevation":K,"edge.target.anchor.elevation":K,"edge.source.offset.elevation":0,"edge.target.offset.elevation":0},!0),!1),Is=[0,0,0,0],Es=function(p){return p instanceof Tn},ys=function(p){return[p.x,p.e||0,p.y]},xs=function(p,G,v){for(var J=(G=yE(G||0))[0],$=G[1],S=G[2];v--;)p.push(J,$,S)},Rs=function(p,G,v){for(var J=(G=yE(G||0))[0],$=G[1],S=G[2],O=G[3];v--;)p.push(J,$,S,O)},Ns=function(p,G,v){if(G)for(var J,$,S,O=G[0],W=G[1],l=G[2],t=G[4],z=G[5],Z=G[6],B=G[8],f=G[9],X=G[10],q=G[12],g=G[13],M=G[14],L=v.length,H=0,H=0;H<L;H+=3)J=v[H],$=v[H+1],S=v[H+2],p.push(O*J+t*$+B*S+q,W*J+z*$+f*S+g,l*J+Z*$+X*S+M);else qS(p,v);return p},ms=function(p,G,v){var J=G.s("light.intensity"),$=(O=yE(G.s(hs)))[0],S=O[1],O=O[2],J=(1!==J&&($*=J,S*=J,O*=J),G.s("light.disabled"));p.push($,S,O,J?1:0),v.c.push($,S,O),v.g.push(J?-1:G.s("light.group")),v.e.push(J?1:0)},Ks=function(p,G,v,J){if((J=J===K?p._headlightAmbientIntensity:J)!==p._lastHeadlightAmbientIntensity&&(G.uHeadlightAmbientIntensity=p._lastHeadlightAmbientIntensity=J),v!==p._lastLightMask&&(p._lastLightMask=v,J=p._lastLightUploadInfo)){for(var $,S=J.g,O=J.e,W=S.length,l=new Array(W),t=!1,z=0;z<W;z++)$=S[z],(l[z]=!($<0||32<=$)&&v&1<<$?0:1)!==O[z]&&(t=!0);if(t){J.e=O=l;var Z,B=J.c,J=(G.uHeadlightColor=[B[0],B[1],B[2],O[0]],p._59O),f=p._spots,p=p._dirs,X=3,q=1;if(W=J.length){for(z=0,Z=[];z<W;z++)Z.push(B[X++],B[X++],B[X++],O[q++]);G.uPointColor=Z}if(W=f.length){for(z=0,Z=[];z<W;z++)Z.push(B[X++],B[X++],B[X++],O[q++]);G.uSpotColor=Z}if(W=p.length){for(z=0,Z=[];z<W;z++)Z.push(B[X++],B[X++],B[X++],O[q++]);G.uDirColor=Z}}}},as=function(p,G){return Math.max(p.getRotateMinPhi()+FA,Math.min(p.getRotateMaxPhi()-FA,G))},us=function(){return.05+j0()/2},Ts=function(p,G,v,J){var $=p.getEye(),p=(p.isOrtho()?((S=Gm(p.getCenter(),$))[0]+=J[0],S[1]+=J[1],S[2]+=J[2]):S=$,G),$=v,G=J,v=S,J=Jm(p,$),S=Gm(v,G,!0),p=Jm(S,$);return I(p)<FA?v0:(v=(J-Jm(G,$))/p,[G[0]+S[0]*v,G[1]+S[1]*v,G[2]+S[2]*v])},Vs=function(p,G){return{x:2*p.x-G.x,y:2*p.y-G.y}},os=function(p,G,v,J){if(!p)return S=P0(G.y-v.y,v.x-G.x),{x:G.x+J*O0(S),y:G.y+J*S0(S)};if(!v)return S=P0(p.y-G.y,G.x-p.x),{x:G.x+J*O0(S),y:G.y+J*S0(S)};var $,S,O,W,l=Gm([p.x,p.y,0],[G.x,G.y,0],!0),t=Gm([v.x,v.y,0],[G.x,G.y,0],!0),z=-(l[0]+t[0])/2,Z=-(l[1]+t[1])/2,B=Y0(z*z+Z*Z);return B<FA?(S=P0(p.y-G.y,G.x-p.x),{x:G.x+J*O0(S),y:G.y+J*S0(S)}):($=p.x-G.x,p=p.y-G.y,O=v.x-G.x,W=v.y-G.y,$=Y0($*$+p*p),p=Y0(O*O+W*W),S=s0(Jm(l,t))/2,O=0<l[1]*t[0]-l[0]*t[1]?-1:1,z/=B,Z/=B,W=J/O0(S),l=J0($,p)/S0(S),B=Math.min(W,l),t={x:G.x+O*B*z,y:G.y+O*B*Z},v.b&&W>p/S0(S)&&(t.adjust=!0),t)},Us=function(p){var G=p[0],v=p[1],J=p[2],$=p[3],S=p[4],O=p[5],W=p[6],l=p[7],t=p[8],z=p[9],Z=p[10],B=p[11],f=p[12],X=p[13],q=p[14],g=p[15],M=G*O-v*S,L=G*W-J*S,H=G*l-$*S,_=v*W-J*O,b=v*l-$*O,n=J*l-$*W,D=t*X-z*f,Y=t*q-Z*f,s=t*g-B*f,c=z*q-Z*X,h=z*g-B*X,w=Z*g-B*q,d=M*w-L*h+H*c+_*s-b*Y+n*D;if(!d)return v0;p[0]=(O*w-W*h+l*c)*(d=1/d),p[1]=(J*h-v*w-$*c)*d,p[2]=(X*n-q*b+g*_)*d,p[3]=(Z*b-z*n-B*_)*d,p[4]=(W*s-S*w-l*Y)*d,p[5]=(G*w-J*s+$*Y)*d,p[6]=(q*H-f*n-g*L)*d,p[7]=(t*n-Z*H+B*L)*d,p[8]=(S*h-O*s+l*D)*d,p[9]=(v*s-G*h-$*D)*d,p[10]=(f*b-X*H+g*M)*d,p[11]=(z*H-t*b-B*M)*d,p[12]=(O*Y-S*c-W*D)*d,p[13]=(G*c-v*Y+J*D)*d,p[14]=(X*L-f*_-q*M)*d,p[15]=(t*_-z*L+Z*M)*d},Fs=function(p,G){var v,J;G&&(v=G[0],J=G[1],G=G[2],p[12]=p[0]*v+p[4]*J+p[8]*G+p[12],p[13]=p[1]*v+p[5]*J+p[9]*G+p[13],p[14]=p[2]*v+p[6]*J+p[10]*G+p[14],p[15]=p[3]*v+p[7]*J+p[11]*G+p[15])},Cs=function(p,G){var v,J;G&&(v=G[0],J=G[1],G=G[2],p[0]=p[0]*v,p[1]=p[1]*v,p[2]=p[2]*v,p[3]=p[3]*v,p[4]=p[4]*J,p[5]=p[5]*J,p[6]=p[6]*J,p[7]=p[7]*J,p[8]=p[8]*G,p[9]=p[9]*G,p[10]=p[10]*G,p[11]=p[11]*G)},Qs=function(p,G,v){var J=G[0],$=G[1],S=G[2],O=G[3],W=G[4],l=G[5],t=G[6],z=G[7],Z=G[8],B=G[9],f=G[10],X=G[11],q=G[12],g=G[13],M=G[14],G=G[15],L=v[0],H=v[1],_=v[2],b=v[3];return p[0]=L*J+H*W+_*Z+b*q,p[1]=L*$+H*l+_*B+b*g,p[2]=L*S+H*t+_*f+b*M,p[3]=L*O+H*z+_*X+b*G,L=v[4],H=v[5],_=v[6],b=v[7],p[4]=L*J+H*W+_*Z+b*q,p[5]=L*$+H*l+_*B+b*g,p[6]=L*S+H*t+_*f+b*M,p[7]=L*O+H*z+_*X+b*G,L=v[8],H=v[9],_=v[10],b=v[11],p[8]=L*J+H*W+_*Z+b*q,p[9]=L*$+H*l+_*B+b*g,p[10]=L*S+H*t+_*f+b*M,p[11]=L*O+H*z+_*X+b*G,L=v[12],H=v[13],_=v[14],b=v[15],p[12]=L*J+H*W+_*Z+b*q,p[13]=L*$+H*l+_*B+b*g,p[14]=L*S+H*t+_*f+b*M,p[15]=L*O+H*z+_*X+b*G,p},pZ=function(p,G,v,J){var $,S,O,W,l=G[0],t=G[1],G=G[2],z=J[0],Z=J[1],J=J[2],B=v[0],f=v[1],v=v[2];return I(l-B)<FA&&I(t-f)<FA&&I(G-v)<FA?Wm(p):(W=1/Y0((B=l-B)*B+(f=t-f)*f+(v=G-v)*v),(W=Y0(($=Z*(v*=W)-J*(f*=W))*$+(J=J*(B*=W)-z*v)*J+(z=z*f-Z*B)*z))?($*=W=1/W,J*=W,z*=W):z=J=$=0,(W=Y0((Z=f*z-v*J)*Z+(S=v*$-B*z)*S+(O=B*J-f*$)*O))?(Z*=W=1/W,S*=W,O*=W):O=S=Z=0,p[0]=$,p[1]=Z,p[2]=B,p[3]=0,p[4]=J,p[5]=S,p[6]=f,p[7]=0,p[8]=z,p[9]=O,p[10]=v,p[11]=0,p[12]=-($*l+J*t+z*G),p[13]=-(Z*l+S*t+O*G),p[14]=-(B*l+f*t+v*G),p[15]=1,p)},GZ=function(p,G,v,J,$){var G=1/d0(G/2),S=1/(J-$);return p[0]=G/v,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=G,p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[10]=($+J)*S,p[11]=-1,p[12]=0,p[13]=0,p[14]=2*$*J*S,p[15]=0,p},vZ=function(p,G,v,J,$,S,O){var W=1/(G-v),l=1/(J-$),t=1/(S-O);return p[0]=-2*W,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=-2*l,p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[10]=2*t,p[11]=0,p[12]=(G+v)*W,p[13]=($+J)*l,p[14]=(O+S)*t,p[15]=1,p},JZ=function(p,G){var v=G[0],J=G[1],$=G[2],S=(S=v*v+J*J+$*$+(G=G[3])*G)?1/S:0;return p[0]=-v*S,p[1]=-J*S,p[2]=-$*S,p[3]=G*S,p},$Z=function(p,G){var v=G[0]+G[5]+G[10],J=0;return 0<v?(J=2*Math.sqrt(v+1),p[3]=.25*J,p[0]=(G[6]-G[9])/J,p[1]=(G[8]-G[2])/J,p[2]=(G[1]-G[4])/J):G[0]>G[5]&G[0]>G[10]?(J=2*Math.sqrt(1+G[0]-G[5]-G[10]),p[3]=(G[6]-G[9])/J,p[0]=.25*J,p[1]=(G[1]+G[4])/J,p[2]=(G[8]+G[2])/J):G[5]>G[10]?(J=2*Math.sqrt(1+G[5]-G[0]-G[10]),p[3]=(G[8]-G[2])/J,p[0]=(G[1]+G[4])/J,p[1]=.25*J,p[2]=(G[6]+G[9])/J):(J=2*Math.sqrt(1+G[10]-G[0]-G[5]),p[3]=(G[1]-G[4])/J,p[0]=(G[8]+G[2])/J,p[1]=(G[6]+G[9])/J,p[2]=.25*J),p},SZ=function(p,G,v){var J=G[0],$=G[1],S=G[2],O=S+S,W=J*(z=J+J),l=J*(Z=$+$),J=J*O,t=$*Z,$=$*O,z=(G=G[3])*z,Z=G*Z,G=G*O;return p[0]=1-(t+(S=S*O)),p[1]=l+G,p[2]=J-Z,p[3]=0,p[4]=l-G,p[5]=1-(W+S),p[6]=$+z,p[7]=0,p[8]=J+Z,p[9]=$-z,p[10]=1-(W+t),p[11]=0,p[12]=v[0],p[13]=v[1],p[14]=v[2],p[15]=1,p},OZ=function(p,G){if(p.isVREnabled()){var v=p.vr.getViewMatrix(G);if(v)return v}return p._camera?p._camera.getViewMatrix(G):pZ(G||$m(),p._eye,p._center,p._up)},WZ=function(p,G){if(p.isVREnabled()&&(J=p.vr.getProjectMatrix()))return J;if(p._camera)return p._camera.getProjectMatrix();if(!G&&p._computedProjectMatrix)return Om(p._computedProjectMatrix);var v,J=p.getAspect(),G=p._near,$=p._far,S=$m();return p._ortho?(v=p._orthoWidth/2,vZ(S,-v,v,-(v/=J),v,G,$)):GZ(S,p._fovy,J,G,$),S},lZ=function(p,G){if(!p)return v0;var v=[],J=0,$=p.length,S=$/3;if(G){for(;J<$;J++)v[J]=0;for(J=0;J<G.length;J+=3){var O=[],W=[];(t=[])[0]=p[3*G[J+1]+0]-p[3*G[J]+0],t[1]=p[3*G[J+1]+1]-p[3*G[J]+1],t[2]=p[3*G[J+1]+2]-p[3*G[J]+2],O[0]=p[3*G[J+2]+0]-p[3*G[J+1]+0],O[1]=p[3*G[J+2]+1]-p[3*G[J+1]+1],O[2]=p[3*G[J+2]+2]-p[3*G[J+1]+2],W[0]=t[1]*O[2]-t[2]*O[1],W[1]=t[2]*O[0]-t[0]*O[2],W[2]=t[0]*O[1]-t[1]*O[0];for(var l=0;l<3;l++)v[3*G[J+l]+0]+=W[0],v[3*G[J+l]+1]+=W[1],v[3*G[J+l]+2]+=W[2]}}else for(J=0;J<S;J+=3){var t,O=[],W=[];for((t=[])[0]=p[3*(J+1)+0]-p[3*J+0],t[1]=p[3*(J+1)+1]-p[3*J+1],t[2]=p[3*(J+1)+2]-p[3*J+2],O[0]=p[3*(J+2)+0]-p[3*(J+1)+0],O[1]=p[3*(J+2)+1]-p[3*(J+1)+1],O[2]=p[3*(J+2)+2]-p[3*(J+1)+2],W[0]=t[1]*O[2]-t[2]*O[1],W[1]=t[2]*O[0]-t[0]*O[2],W[2]=t[0]*O[1]-t[1]*O[0],l=0;l<3;l++)v[3*(J+l)+0]=W[0],v[3*(J+l)+1]=W[1],v[3*(J+l)+2]=W[2]}for(J=0;J<$;J+=3){var z=[],Z=(z[0]=v[J+0],z[1]=v[J+1],z[2]=v[J+2],Y0(z[0]*z[0]+z[1]*z[1]+z[2]*z[2]));0===Z&&(Z=FA),z[0]=z[0]/Z,z[1]=z[1]/Z,z[2]=z[2]/Z,v[J+0]=z[0],v[J+1]=z[1],v[J+2]=z[2]}return new pm(v)},tZ=function(p,G,v,J){var $,S,O,W,l,t,z;return v=v||p.createTexture(),G&&($=p.TEXTURE_2D,S=p.REPEAT,O=p.CLAMP_TO_EDGE,W=p.TEXTURE_MIN_FILTER,l=(J=J||Ai).minFilter||J.filter||p.LINEAR,t=J.magFilter||J.filter||p.LINEAR,p.activeTexture(p.TEXTURE0),XZ(p,v),p.pixelStorei(p.UNPACK_FLIP_Y_WEBGL,!1),p.pixelStorei(p.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),p.texImage2D($,0,p.RGBA,p.RGBA,p.UNSIGNED_BYTE,G),qZ(p,p.TEXTURE_MAG_FILTER,t),t=G.naturalWidth||G.width,z=G.naturalHeight||G.height,sh.isPOT(t)&&sh.isPOT(z)&&!J.clampToEdge&&!G.clampToEdge?(qZ(p,p.TEXTURE_WRAP_S,S),qZ(p,p.TEXTURE_WRAP_T,S),qZ(p,W,l===p.NEAREST?p.NEAREST_MIPMAP_NEAREST:p.LINEAR_MIPMAP_LINEAR),J.mipmapMaxLevel!==K&&qZ(p,p.TEXTURE_MAX_LEVEL,J.mipmapMaxLevel),p.generateMipmap($)):(qZ(p,p.TEXTURE_WRAP_S,O),qZ(p,p.TEXTURE_WRAP_T,O),qZ(p,W,l)),XZ(p,v0)),v},zZ=function(p,G,v){return v=new Uint8Array(v||4),G=G||p.createTexture(),p.activeTexture(p.TEXTURE0),XZ(p,G),qZ(p,p.TEXTURE_MIN_FILTER,p.LINEAR),p.texImage2D(p.TEXTURE_2D,0,p.RGBA,1,1,0,p.RGBA,p.UNSIGNED_BYTE,v),G},ZZ=function(p){p._26I&&p._prg&&(p._26I.deleteProgram(p._prg),p._prg=v0)},BZ=(K3=/(uniform\s+sampler2D\s+\w+)\[([\S\d]+)\];/g,a3=/#UNROLL_LOOP_START\s+for\s*\(\s*int\s+i\s*=\s*([\S\d]+)\s*;\s*i\s*<\s*([\S\d]+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#UNROLL_LOOP_END/g,u3=/^\d+$/,function(p,G,v,J){return v=p.createShader(v),p.shaderSource(v,(N3={},J=(m3=J=J).replace(K3,QM).replace(a3,pr),N3=m3=null,J)),p.compileShader(v),p.attachShader(G,v),v}),fZ=function(p){return p.createBuffer()},XZ=function(p,G){p.bindTexture(p.TEXTURE_2D,G||p._emptyTexture)},qZ=function(p,G,v){p.texParameteri(p.TEXTURE_2D,G,v)},gZ=function(p,G){(p=r.for(p).directState()).polygonOffset.enabled=!0,p.polygonOffset.value=G},MZ=function(p){r.for(p).directState().polygonOffset.enabled=!1},LZ=function(p,G){G&&(r.for(p).directState().color.clear=yE(G))},HZ=function(p,G,v){if(v!==G._lastClipboxEnabled){var J=p._boxClipperGroups,$=p._boxClipperShape,S=J?J.length:0,O=new Array(S);if(v)for(var W=0;W<S;W++)O[W]=v&1<<J[W]?$[W]:0;G._lastClipboxEnabled=v,G.uClipperShape=O}},_Z=HZ,bZ=function(p){var G=(p=r.for(p)).directUniforms(),p=p.directAttribs();G.uFix=!0,p.aNormal=!1},nZ=function(p){r.for(p).directUniforms().uFix=!1},DZ=function(p,G,v,J,$,S,O,W){var l=(t=r.for(p)).directState(),t=t.directUniforms();p._picking||(v?(t.uBlend=!0,t.uBlendColor=v):t.uBlend=!1,t.uLight=t.uFog=J==v0||J,$S($)&&1!==$&&(t.uPartOpacity=$),t.uReverseFlip=S!=v0&&S,t.uFixPickReverseColor=O||n4),l.cullFace.enabled=!!W},YZ=function(p,G){p._picking||(r.for(p).directUniforms().uPartOpacity=1)},sZ=(x3=new E.Math.Matrix2d,R3=[1,0,0,0,1,0,0,0,0],function(p,G,v,J,$,S,O,W,l,t,z){var Z=(B=r.for(p)).directUniforms(),B=B.directAttribs();if(!v)return Z.uSampler=p._emptyTexture,void(Z.uBlendSampler=p._emptyBlendTexture);Z.uTexture=!0,Z.uDiscardSelectable=!SS(J)||J,B.aUv=iZ(p,$,S,v0,2),z?(Z.uBlendTexture=!0,Z.uBlendSampler=z):(Z.uBlendTexture=!1,Z.uBlendSampler=p._emptyBlendTexture),Z.uSampler=v,Z.uUvMatrix=O||W||l||t?CZ(l,O,W,t,x3).toArray9():R3}),cZ=function(p,G,v){var J=($=r.for(p)).directUniforms(),$=$.directAttribs();p.activeTexture(p.TEXTURE0),XZ(p,v0),p.activeTexture(p.TEXTURE1),XZ(p,v0),v&&($.aUv=!1,J.uTexture=!1,J.uSampler=p._emptyTexture,J.uBlendTexture=!1,J.uBlendSampler=p._emptyBlendTexture)},hZ=function(p,G,v,J,$,S){var O=(W=r.for(p)).directUniforms(),W=W.directAttribs();!v||R0||m0||p.lineWidth(v),J&&!p._picking&&(O.uFixPickReverseColor=J),$&&(W.aPosition=iZ(p,$,S,v0))},wZ=function(p,G,v,J,$){I3&&(J=p[I3]),$?p.drawArraysInstanced(J==v0?p.TRIANGLES:J,G,v,$):p.drawArrays(J==v0?p.TRIANGLES:J,G,v),(G=p._renderInfo)&&(G.calls++,$&&(v*=$),G.vertices+=v,J!=v0&&J!==p.TRIANGLES||(G.faces+=v/3),J===p.LINES&&(G.lines+=v/2),J===p.POINTS&&(G.points+=v))},dZ=function(p,G,v,J,$,S){I3&&(J=p[I3]),S?p.drawElementsInstanced(J==v0?p.TRIANGLES:J,v,$==v0?p.UNSIGNED_SHORT:$,G==v0?0:2*G,S):p.drawElements(J==v0?p.TRIANGLES:J,v,$==v0?p.UNSIGNED_SHORT:$,G==v0?0:2*G),($=p._renderInfo)&&($.calls++,S&&(v*=S),$.vertices+=v,J!=v0&&J!==p.TRIANGLES||($.faces+=v/3),J===p.LINES&&($.lines+=v/2),J===p.POINTS&&($.points+=v))},PZ=function(p,G,v,J,$){var S=p.ARRAY_BUFFER;return p.bindBuffer(S,G),v&&p.bufferData(S,v,p.STATIC_DRAW),G},jZ=function(p,G,v,J,$){return(G=iZ(p,G,v,J,$)).instanced=!0,G},iZ=function(p,G,v,J,$){return v?AZ(p,p.ARRAY_BUFFER,G,v):PZ(p,G,v)},rZ=function(p,G,v){var J=p.ELEMENT_ARRAY_BUFFER;p.bindBuffer(J,G),v&&p.bufferData(J,v,p.STATIC_DRAW)},eZ=function(p,G,v){AZ(p,p.ELEMENT_ARRAY_BUFFER,G,v)},AZ=function(p,G,v,J){var $=J._bufId||(J._bufId=E.Math.generateIncreasingID()),S=p._bufPool;return(v=S[$])&&v._buf?p.bindBuffer(G,v._buf):(v=S[$]={_buf:fZ(p)},p.bindBuffer(G,v._buf),p.bufferData(G,J,p.STATIC_DRAW)),v._fid=p._renderInfo.frame,v._buf},kZ=function(p,G){G!=v0&&0<=G&&p.disableVertexAttribArray(G)},IZ=function(p,G){var v=p.getGL(),v=r.for(v).directUniforms();p._7O=p._8O.pop(),G&&(v.uMVMatrix=p._7O,p._6O=G,v.uNMatrix=G)},EZ=function(p,G){var v,J,$,S,O,W;return(v=G=G||$m())[0]=p[0],v[1]=p[1],v[2]=p[2],v[3]=p[3],v[4]=p[4],v[5]=p[5],v[6]=p[6],v[7]=p[7],v[8]=p[8],v[9]=p[9],v[10]=p[10],v[11]=p[11],v[12]=p[12],v[13]=p[13],v[14]=p[14],v[15]=p[15],Us(G),p=(v=G)[1],J=v[2],$=v[3],S=v[6],O=v[7],W=v[11],v[1]=v[4],v[2]=v[8],v[3]=v[12],v[4]=p,v[6]=v[9],v[7]=v[13],v[8]=J,v[9]=S,v[11]=v[14],v[12]=$,v[13]=O,v[14]=W,G},yZ=function(p,G){var v=p.getGL(),J=p._7O,v=r.for(v).directUniforms();G?(p._8O.push(Om(J)),v.uMMatrix=G,Qs(J,J,G),p._7O=J):v.uMMatrix=Sm,v.uMVMatrix=J,v.uNMatrix=EZ(J,p._6O)},xZ={body:0,label:1,label2:2,note:3,note2:4,symbol:5},RZ=function(p,G,v,J,$,S){var O,W=v?((v=J._pickId)||(v=J._pickId=G._pickIdUsed,G._pickIdUsed+=10),null!=(W=xZ[$])?O=v+W:(O=(v=(v=J._pickExtraPartMap)||(J._pickExtraPartMap={}))[$])||(O=v[$]=G._pickIdUsed++),G[O]||(G[O]={data:J.data,part:$}),Wk(O)):Is;return S||(r.for(p).directUniforms().uFixPickReverseColor=W),W},NZ=RZ,mZ=function(p,G,v){var J,$="target"===(v="target"!==v?"source":v)?G.getTargetAgent():G.getSourceAgent(),v="edge."+v+".";if(k($))return L=G.s(v+"anchor.x"),O=G.s(v+"anchor.elevation"),g=G.s(v+"anchor.y"),J=Xm($,p.getMat($)),H=$.getAnchor3d(),(L=lm([(L===K?.5:L)-H.x,(O===K?.5:O)-H.y,(g===K?.5:g)-H.z],J))[1]+=G.s(v+"offset.elevation"),L;var S=G.s(v+"index"),O=p.getData3dUI($);if(!O.info||!O.info.list)return!1;if(0<=S){for(var W,l,t,z=(M=O.info._lastPointsSegments).points,Z=M.segments,B=-1,f=-1,X=0,q=(Z||z).length;X<q;X++){if(3===(l=Z?Z.get(X):1))t=2;else if(4===l)t=3;else{if(5===l)continue;t=1}if(B+=t,++f===S){W=z.get(B);break}}return[(W=W||z.get(z.length-1)).x,(W.e||0)+G.s(v+"offset.elevation"),W.y]}var g=G.s(v+"percent")||.5,g=Math.max(0,Math.min(g,1));if(!O||!O.getCache)return!1;var M,L,H=O.getCache(),q=H[H.length-1].length;return[(L=(M=p.getLineOffset($,g*q)).point).x,L.y+G.s(v+"offset.elevation"),L.z]},KZ=(y3={center:function(p,G,v,J,$){var S=-G[1]/2,S={x:-G[0]/2,y:S,width:G[0],height:G[1]};return[(G=b4(p,S,v)).x+J,-G.y-$,N.getPosition3dGap()]},front:function(p,G,v,J,$){var S=-G[1]/2,S={x:-G[0]/2,y:S,width:G[0],height:G[1]};return[(p=b4(p,S,v)).x+J,-p.y-$,G[2]/2+N.getPosition3dGap()]},back:function(p,G,v,J,$){var S={x:-G[0]/2,y:-G[1]/2,width:G[0],height:G[1]};return[-(p=b4(p,S,v)).x-J,-p.y-$,-G[2]/2-N.getPosition3dGap()]},left:function(p,G,v,J,$){var S=-G[1]/2,S={x:-G[2]/2,y:S,width:G[2],height:G[1]},p=b4(p,S,v);return[-G[0]/2-N.getPosition3dGap(),-p.y-$,p.x+J]},right:function(p,G,v,J,$){var S={x:-G[2]/2,y:-G[1]/2,width:G[2],height:G[1]},p=b4(p,S,v);return[G[0]/2+N.getPosition3dGap(),-p.y-$,-p.x-J]},top:function(p,G,v,J,$){var S={x:-G[0]/2,y:-G[2]/2,width:G[0],height:G[2]};return[(p=b4(p,S,v)).x+J,G[1]/2+N.getPosition3dGap(),p.y+$]},bottom:function(p,G,v,J,$){var S=-G[2]/2,S={x:-G[0]/2,y:S,width:G[0],height:G[2]};return[(p=b4(p,S,v)).x+J,-G[1]/2-N.getPosition3dGap(),-p.y-$]}},function(p,G,v,J,$,S){return y3[J](p,G,v,$||0,S||0)}),aZ=function(p,G,v,J,$,S,O,W,l,t){return $&&(G[0]+=$[0],G[1]+=$[1],G[2]+=$[2]),Fs(p,v),W?($=$m(),DI($,l,t),lm(G,$),Fs(p,G),p.auto=W,p.pos=lm([0,0,0],p),S&&(v=p.mat2=$m(),DI(v,S,O))):(DI(p,l,t),Fs(p,G),J===C0?Bm(p,-w0):J===Q0?Bm(p,w0):J===pJ?Zm(p,-w0):J===GJ?Zm(p,w0):J===F0&&Bm(p,j),DI(p,S,O)),p},uZ=function(p,G){var v,J,$=G.auto,S=G.mat2,p=p.gv;$?(v=$m(),J=[0,0,0,0],$="string"==typeof $?[($.indexOf("x")<0?p._eye:p._center)[0],($.indexOf("y")<0?p._eye:p._center)[1],($.indexOf("z")<0?p._eye:p._center)[2]]:p._eye,$Z(J,pZ($m(),$,p._center,p._up)),SZ(v,JZ(J,J),G.pos),S&&Qs(v,v,S),yZ(p,v)):yZ(p,G)},TZ=function(p,G,v,J,$){var S=p.s,O=p.gv,W=O.getGL(),l=O._prg,t=O._buffer,z=O._1O,Z=r.for(W).directAttribs();tZ(W,AE,z),uZ(p,v),DZ(W,0,S(G+".blend"),S(G+".light"),S(G+".opacity"),S(G+".reverse.flip"),S(G+".reverse.color"),S(G+".reverse.cull")),sZ(W,l,z,$,t.uv,Rp),Z.aPosition=iZ(W,t.vs,J,v0),Z.aNormal=iZ(W,t.ns,Np,v0),eZ(W,t.is,mp),dZ(W,0,mp.length),cZ(W,0,z),YZ(W),IZ(O)},VZ=function(p,G,v){var J=p.gv,$=p.data,p=p[G]={blend:J.getBodyColor($)||J.getFaceBlend($,G),light:J.getFaceLight($,G),color:J.getFaceColor($,G),opacity:J.getFaceOpacity($,G),transparent:J.getFaceTransparent($,G),reverseFlip:J.getFaceReverseFlip($,G),reverseColor:J.getFaceReverseColor($,G),reverseCull:J.getFaceReverseCull($,G),texture:J.getFaceImage($,G),blendTexture:J.getFaceBlendImage($,G),discardSelectable:J.getFaceDiscardSelectable($,G)};return"csg"!==G&&(p.uv=J.getFaceUv($,G)||v&&v[G+"Uv"],p.uvScale=J.getFaceUvScale($,G)||v&&v[G+"UvScale"],p.uvOffset=J.getFaceUvOffset($,G)||v&&v[G+"UvOffset"],p.uvRotation=J.getFaceUvRotation($,G)||v&&v[G+"uvRotation"],p.uvAnchor=J.getFaceUvAnchor($,G)||v&&v[G+"uvAnchor"],(v=J.getFaceMat($,G))&&(J=Xm($,v),$.appendAnchorMatrix3d(J),p.mat=J)),p},oZ=function(p,G,v,J,$){var S,O,W,l=p[J];l&&$(l.transparent)&&($=p.data,S=(p=p.gv)._buffer,J=p.getTexture(l.texture,$,J),$=p.getTexture(l.blendTexture,$),O=(W=r.for(G)).directUniforms(),W=W.directAttribs(),sZ(G,v,J,l.discardSelectable,S.uv,l.tuv,l.uvOffset,l.uvScale,l.uvRotation,l.uvAnchor,$),DZ(G,0,l.blend,l.light,l.opacity,l.reverseFlip,l.reverseColor,l.reverseCull),l.cs&&!p._batchColorDisabled?(O.uBatchColor=!0,W.aBatchColor=iZ(G,S.batchColor,l.cs,v.aBatchColor,4)):O.uDiffuse=l.color||F["color.empty"],W.aPosition=iZ(G,S.vs,l.vs,v0),W.aNormal=iZ(G,S.ns,l.ns,v0),wZ(G,0,l.vs.length/3),l.cs&&!p._batchColorDisabled&&(O.uBatchColor=!1,kZ(G,v.aBatchColor)),YZ(G),cZ(G,0,J))},UZ=function(p,G,v){lS(p)?p.forEach(function(p){UZ(p,G,v)}):JS(p)?UZ(fn(G,p),G,v):OS(p)&&p.shape3d?UZ(p.shape3d,G,v):v.push(p)},FZ=function(){for(var p=arguments.length,G=[],v=0;v<p;v++)G[v]=arguments[v];js[is]="Time : "+(new Date).toLocaleString()+", Info :"+G.join(", "),is=(is+1)%50,console.error("Failed to create shader.")},CZ=(E3=new sh.Matrix2d,function(p,G,v,J,$){return($=$||E3).identity(),J&&$.translate(-J[0],-J[1]),v&&$.scale(v[0],v[1]),p&&$.rotate(p),J&&$.translate(J[0],J[1]),G&&$.translate(G[0],G[1]),$}),QZ=function(p,G,v,J,$,S){for(var O,W,l,t,z,Z,B,f,X,q=[J-G,$-v],g=p?p.length:0,M=0;M<g;M++){for(W=2,l=(O=p[M])[0],t=O[1];W+1<O.length;){if(z=O[W],Z=O[W+1],wS(G,v,J,$,l,t,z,Z,!0)){f=iA(B=[z-l,Z-t]),B[0]/=f,B[1]/=f,f=Jm(q,B),X=[B[0]*(f=0<f?S:-S),B[1]*f];break}l=z,t=Z,W+=2}if(X)break}if(X)for(J=G+X[0],$=v+X[1],M=0;M<g;M++)for(W=2,l=(O=p[M])[0],t=O[1];W+1<O.length;){if(z=O[W],Z=O[W+1],wS(G,v,J,$,l,t,z,Z,!0))return[0,0];l=z,t=Z,W+=2}return X||[J-G,$-v]},pp=function(p){return"nearest"===p?w.NEAREST:"linear"===p?w.LINEAR:p},Gp=E.graph3d={WebGLConstants:w},S=function(p,G,v){oA("ht.graph3d."+p,G,v)},vp="!~!<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!\vgjeof$\v!~!<6/1!,!*{/mbdpMwVxpmg!,!z/mbdpMwVxpmg!-y/mbdpMwVxpmg)3dfw!>!^j]wVxpmg!<{zy/*enspgtobsu!+!yjsubNNv!+!^j]yjsubNxpmg)!>!mbdpMwVxpmg!|!*,,j!<UDFKCP`XPMG`YBN!=!j!<1!>!j!uoj)!spg!<mbdpMwVxpmg!4dfw!\v1!?!UDFKCP`XPMG`YBN!gj$\v!\vgjeof$\v!<enspgtobsu!+!yjsubNNv!+!yjsubNxpebit!>!esppDxpebit!\vQBNXPEBIT`FTV!gfegj$\v!\vgjeof$\v!~!<fdobutjEfojMb!>!fdobutjEfojMw!|!*itbEv)!gj!\vITBE!gfegj$\v!\vgjeof$\v!~!<ttfouihjsCidubCb!>!ttfouihjsCidubCw!|!*ttfouihjsCidubCv)!gj!\vTTFOUIHJSCIDUBC!gfegj$\v!\vgjeof$\v!~!<eofmCidubCb!>!eofmCidubCw!|!*eofmCidubCv)!gj!\vEOFMCIDUBC!gfegj$\v!\vgjeof$\v!~!<spmpDidubCb!>!spmpDidubCw!|!*spmpDidubCv)!gj!\vSPMPDIDUBC!gfegj$\v!\vgjeof$\v!~!<**1/2!-wVb)4dfw!+!yjsubNwVv)3dfw!>!wVw!|!*fsvuyfUv)!gj!\vftmf$\v!<*y/wVb!-**1/2!-wVb)4dfw!+!yjsubNwVv)3dfw)4dfw!>!wVw!\vQJMD`WV!gfegj$\v!<*enspgtobsu)4dfw!>!opjujtpQw!\vgjeof$\v!~!\v1!>>!SFQQJMD`YPC`YBN!gj$\v!<*enspgtobsu!+!yjsubNNv)4dfw!>!emspXw!<*yfusfw)4dfw!>!yfusfWw!\vgjeof$\v!<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw!\vftmf$\v!<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw!ftmf!~!<**1/2!-mbnspOw!+!n)5dfw!+!yjsubNOv)4dfw!>!mbnspOw!<**^3]n!-^3]n)upe!-*^2]n!-^2]n)upe!-*^1]n!-^1]n)upe)4dfw!0!mbnspOb!>!mbnspOw!<*!efdobutoJyjsubNb!)4ubn!>!n!4ubn!|!*fdobutoJftVv)!gj!\vFDOBUTOJIDUBC!gfegj$\v!\vgjeof$\v!|!*ldjQva)!gj!\v1!>>!SFQQJMD`YPC`YBN!gj$\v!<enspgtobsu!+!yjsubNWNv!>!yfusfw!5dfw!\vgjeof$\v!~!<enspgtobsu!+!efdobutoJyjsubNb!>!enspgtobsu!|!*fdobutoJftVv)!gj!\vFDOBUTOJIDUBC!gfegj$\v!<*1/2!-opjujtpQb)5dfw!>!enspgtobsu!5dfw!|!*ejpw)ojbn!ejpw!\vgjeof$\v!<^UDFKCP`XPMG`YBN]wVxpmg!3dfw!hojzsbw!<^UDFKCP`XPMG`YBN]yjsubNxpmg!5ubn!nspgjov!\v1!?!UDFKCP`XPMG`YBN!gj$\v!\vgjeof$\v!<esppDxpebit!5dfw!hojzsbw!<yjsubNxpebit!5ubn!nspgjov!\vQBNXPEBIT`FTV!gfegj$\v!\vgjeof$\v!<fdobutjEfojMw!ubpmg!hojzsbw!<fdobutjEfojMb!ubpmg!fuvcjsuub!<itbEv!mppc!nspgjov!\vITBE!gfegj$\v!\vgjeof$\v!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov!<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov!<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!\v1!?!UPQT`YBN!gj$\v!\vgjeof$\v!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov!<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!\v1!?!UOJPQ`YBN!gj$\v!\vgjeof$\v!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov!<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!\v1!?!SJE`YBN!gj$\v!\vgjeof$\v!<eofmCidubCw!4dfw!hojzsbw!<eofmCidubCb!4dfw!fuvcjsuub!<eofmCidubCv!mppc!nspgjov!\vEOFMCIDUBC!gfegj$\v!\vgjeof$\v!<ttfouihjsCidubCw!ubpmg!hojzsbw!<ttfouihjsCidubCb!ubpmg!fuvcjsuub!<ttfouihjsCidubCv!mppc!nspgjov!\vTTFOUIHJSCIDUBC!gfegj$\v!\vgjeof$\v!<spmpDidubCw!5dfw!hojzsbw!<spmpDidubCb!5dfw!fuvcjsuub!<spmpDidubCv!mppc!nspgjov!\vSPMPDIDUBC!gfegj$\v!<opjujtpQw!4dfw!hojzsbw!<emspXw!4dfw!hojzsbw!<yfusfWw!4dfw!hojzsbw!<mbnspOw!4dfw!hojzsbw!<yjGv!mppc!nspgjov!<ldjQv!mppc!nspgjov!<yjsubNxfjWv!5ubn!nspgjov!<yjsubNOv!5ubn!nspgjov!<yjsubNQv!5ubn!nspgjov!<yjsubNNv!5ubn!nspgjov!<yjsubNWNv!5ubn!nspgjov!<opjujtpQb!4dfw!fuvcjsuub!\vgjeof$\v!~!<*{zy/**1/1!-sje)5dfw!+!yjsubn))f{jmbnspo!osvufs!|!*yjsubn!5ubn!oj!-sje!4dfw!oj!)opjudfsjEnspgtobsu!4dfw!<efdobutoJyjsubNb!5ubn!fuvcjsuub!<fdobutoJftVv!mppc!nspgjov!\vFDOBUTOJIDUBC!gfegj$\v!<mbnspOb!4dfw!fuvcjsuub!\vgjeof$\v!<wVw!3dfw!hojzsbw!\vftmf$\v!<wVw!4dfw!hojzsbw!\vQJMD`WV!gfegj$\v!<wVb!3dfw!fuvcjsuub!<yjsubNwVv!4ubn!nspgjov!<fsvuyfUeofmCv!mppc!nspgjov!<fsvuyfUv!mppc!nspgjov!\vYJGFSQ$\v!^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",Jp="!~!~!<eJ!>!spmpDhbsG`mh!~!<spmpDsfmqnbTwv!>+!eJ!<*zy/wVw!-sfmqnbTeofmCv)E3fsvuyfu!>!spmpDsfmqnbTwv!5dfw!|!*fsvuyfUeofmCv)!gj!\vgjeof$\v!~!<ttfouihjsCidubCw!>+!chs/eJ!|*ttfouihjsCidubCv)gj!\vTTFOUIHJSCIDUBC!gfegj$\v!~!<ttfouihjsCv!>+!chs/eJ!|*1/2!>a!ttfouihjsCv)gj!\vgjeof$\v!~!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ!\vgjeof$\v!<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg!\vftmf$\v!<*iuqfe!+!iuqfe!+!zujtofEhpGv!+!zujtofEhpGv!.)qyf!.!1/2!>!spudbGhpg!ubpmg!\v3QYF`HPG!gfegj$\v!<{/yfusfWw.!>!iuqfe!ubpmg!|!*hpGv)!gj!\vHPG!gfegj$\v!~!~!<zujdbqPusbQv!>+!b/eJ!|*1/2!>a!zujdbqPusbQv)gj!~!\vgjeof$\v!~!<zujwjudfmgfSv!+!{zy/spmpDwof!>,!chs/eJ!\vgjeof$\v!<*spmpDwof)sbfojMpUmfyfUqbNwof!>!spmpDwof!<**{z/dfWudfmgfs!-y/dfWudfmgfs)4dfw!-qbNwoFv)fcvDfsvuyfu!>!spmpDwof!5dfw!\vftmf$\v!<**ttfoihvps!-*{z/dfWudfmgfs!-y/dfWudfmgfs.)4dfw!-qbNwoFv)WVfcvDfsvuyfu)CHStpUsbfojM!>!spmpDwof!5dfw!\vWV`FCVD`FQZU`QBNWOF!gfegj$\v!\vgjeof$\v!<*mbnspOemspx!-yfusfWpUbsfnbd)udfmgfs!>!dfWudfmgfs!4dfw!\vftmf$\v!<***mbnspOemspx!-yfusfWpUbsfnbd)udfmgfs!-ubvRqbnwoFv)spudfWfubups)f{jmbnspo!>!dfWudfmgfs!4dfw!\vFUBUPS`QBNWOF!gfegj$\v!<*yjsubNxfjWv!-O)opjudfsjEnspgtobsUftsfwoj!>!mbnspOemspx!4dfw!<*opjujtpQbsfnbDv!.!emspXw)f{jmbnspo!>!yfusfWpUbsfnbd!4dfw!|*qbNwoFftVv)!gj!\vQBNWOF`FTV!gfegj$\v!\vgjeof$\v!~!~!~!~!<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ!<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt!|*^j]fmhoBupqTv!?!udfggFupqt)gj!<*mbnspOm!-^j]opjudfsjEupqTv)upe!>!udfggFupqt!ubpmg!<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw!|*1/1!?!fhobSm)!gj!~!<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm!|*1/1!?!^j]fhobSupqTv)!gj!<1/2!>!fhobSm!ubpmg!<^j]opjujtpQupqTv!.!yfusfWw!>!spudfWm!4dfw!|*1/1!>>!x/^j]spmpDupqTv)gj!|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!\v1!?!UPQT`YBN!gj$\v!\vgjeof$\v!~!~!~!<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ!|*1/1!?!fhobSm)!gj!~!<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm!|*1/1!?!^j]fhobSuojpQv)!gj!<1/2!>!fhobSm!ubpmg!<^j]opjujtpQuojpQv!.!yfusfWw!>!spudfWm!4dfw!|*1/1!>>!x/^j]spmpDuojpQv)gj!|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!\v1!?!UOJPQ`YBN!gj$\v!\vgjeof$\v!~!~!<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEv)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ!|*1/1!>>!x/^j]spmpDsjEv)gj!|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!\v1!?!SJE`YBN!gj$\v!~!<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ!\vgjeof$\v!~!<fvmbWxpebit!+!zujtofuoJxpebit!.!1/2!>+!nsfUusfcnbm!~!<osvufs!<esbdtje!|!*1/1!>>!fvmbWxpebit!%%!mmvDxpebit)!gj!<*esppDxpebit!-tvjebSxpebit!-tbjCxpebit!-f{jTxpebit!-qbNxpebit)xpebiTufh!.!1/2!>!fvmbWxpebit!ubpmg!|!*fwjfdfSxpebit)!gj!\vQBNXPEBIT`FTV!gfegj$\v!~!<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!>+!nsfUusfcnbm!|*1/1!?!fhobSuihjmebfIv)gj!<*1/1!-zujtofuoJuofjcnBuihjmebfIv!,!*zujtofuoJuofjcnBuihjmebfIv!.!1/2)!+!nsfUusfcnbm)ybn!>!nsfUusfcnbm!<*opjudfsjEuihjmebfIv.!-O)upe!>!nsfUusfcnbm!ftmf!<*M.!-O)upe!>!nsfUusfcnbm!*1/1!>>!{/opjudfsjEuihjmebfIv!%%!1/1!>>!z/opjudfsjEuihjmebfIv!%%!1/1!>>!y/opjudfsjEuihjmebfIv)!gj!<nsfUusfcnbm!ubpmg!|*1/1!>>!x/spmpDuihjmebfIv)gj!\vgjeof$\v!\vEOF`QPPM`MMPSOV$\v!~!\vgjeof$\v!<chs/mfyfUxpmg!>,!chs/eJ!\vftmf$\v!<bchs/mfyfUxpmg!>,!bchs/eJ!\v*!BCHS`EEB`FEPN`EOFMC`XPMG!)efojgfe!gjmf$\v!<bchs/mfyfUxpmg!>!bchs/eJ!\v*!BCHS`FEJSSFWP`FEPN`EOFMC`XPMG!)efojgfe!gjmf$\v!<b/mfyfUxpmg!>!b/eJ!\v*!B`FEJSSFWP`FEPN`EOFMC`XPMG!)efojgfe!gjmf$\v!<chs/mfyfUxpmg!>!chs/eJ!\v*!CHS`FEJSSFWP`FEPN`EOFMC`XPMG!)efojgfe!gjmf$\v!<bchs/mfyfUxpmg!>+!bchs/eJ!\v*!BCHS`ZMQJUMVN`FEPN`EOFMC`XPMG!)efojgfe!gjmf$\v!<chs/mfyfUxpmg!>+!chs/eJ!\v*!CHS`ZMQJUMVN`FEPN`EOFMC`XPMG!)efojgfe!gj$\v!****1/1)3dfw!-^j]wVxpmg)obiUsfubfsh)mmb!%%!***1/2)3dfw!-^j]wVxpmg)obiUttfm)mmb!%%!^j]efmcboFxpmg)!gj!<*^j]wVxpmg!-^J]fsvuyfUxpmg)E3fsvuyfu!>!mfyfUxpmg!|!*,,j!<UDFKCP`XPMG`YBN!=!j!<1>j!uoj)!spg!\vUSBUT`QPPM`MMPSOV$\v!<mfyfUxpmg!5dfw!\v1!?!UDFKCP`XPMG`YBN!gj$\v!|!*uihjMv)!gj!~!\vgjeof$\v!~!<spmpDeofmCv!>+!eJ!|*eofmCv)gj!\vftmf$\v!~!<spmpDeofmCv!>+!eJ!|*eofmCv)gj!ftmf!~!<eofmCidubCw!>+!chs/eJ!|*eofmCidubCv)gj!\vEOFMCIDUBC!gfegj$\v!~!~!<esbdtje!|*1/1!>>!x/eJ)gj!\vgjeof$\v!<ftvggjEv!>!eJ!\vftmf$\v!~!<ftvggjEv!>!eJ!|ftmf~!<spmpDidubCw!>!eJ!|*spmpDidubCv)gj!\vSPMPDIDUBC!gfegj$\v!|!ftmf!~!<spmpDwv!>!eJ!|*fsvuyfUv)gj!|!ftmf!~!<spmpDftsfwfSldjQyjGv!>!eJ!|*qjmGftsfwfSva!%%!ldbCtj)gj!~!<fvsu!>!ldbCtj!<O.!>!O!|*1/1!=!*O!-F)upe)gj!<ftmbg!>!ldbCtj!mppc!<F.!>!M!4dfw!\vgjeof$\v!<*yfusfWw.)f{jmbnspo!>!F!4dfw!\vftmf$\v!<*2!-1!-1)4dfw!>!F!4dfw!\vDJIQBSHPIUSP!gfegj$\v!<*mbnspOw)f{jmbnspo!>!O!4dfw!|!ftmf!~!\vgjeof$\v!~!~!<ftvggjEv!>!eJ!|ftmf!~!<esbdtje!|*1/1!>>!x/ftvggjEv)gj!|!*fdobutjEitbEv!?!*fdobutjEqbHitbEv!-fdobutjEfojMw)epn!%%!itbEv)!gj!\vITBE!gfegj$\v!\vgjeof$\v!<spmpDftsfwfSldjQyjGv!>!eJ!\vftmf$\v!~!<spmpDftsfwfSldjQyjGv!>!eJ!|!ftmf!~!<spmpDidubCw!>!eJ!|*spmpDidubCv)gj!\vSPMPDIDUBC!gfegj$\v!|!*yjGv)!gj!<eJ!5dfw!|!ftmf!~!~!<esbdtje!|!*1/1!>>!b/spmpDhbsG`mh)!gj!\vgjeof$\v!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!\vftmf$\v!~!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!|!ftmf!~!<spmpDidubCw!>!spmpDhbsG`mh!|!*spmpDidubCv)!gj!\vSPMPDIDUBC!gfegj$\v!|!*ldjQv)!gj!~!<osvufs!<*1/2!-1/1!-1/1!-1/1)5dfw!>!spmpDhbsG`mh!|!*uvpldbmc)!gj!\vgjeof$\v!~!~!<osvufs!<esbdtje!|!**6/1!=!*mbdpMw)iuhofm)!>a!^j]sfooJqjmDsfqqjmDv!%%!3!>>!^j]fqbiTsfqqjmDv!}}!***ojNqjmd!-mbdpMw)obiUsfubfsh)mmb!%%!**ybNqjmd!-mbdpMw)obiUttfm)mmb)!>a!^j]sfooJqjmDsfqqjmDv!%%!2!>>!^j]fqbiTsfqqjmDv)!gj!<**1/2!-emspXw)5dfw!+!^j]yjsubNsfqqjmDv)4dfw!>!mbdpMw!|!*,,j!<SFQQJMD`YPC`YBN!=!j!<1!>!j!uoj)!spg!<mbdpMw!4dfw!\v1!?!SFQQJMD`YPC`YBN!gj$\v!~!\vgjeof$\v!~!<esbdtje!|!**sje!-*uofdsfQqjmDv)4dfw)upe!?!*opjujtpQw!-sje)upe)!gj!\vftmf$\v!~!<esbdtje!|!**sje!-*uofdsfQqjmDv)4dfw)upe!?!*opjujtpQqjmd!-sje)upe)!gj!~!<*1/1!-1/1!-{/wVw)4dfw!>!opjujtpQqjmd!<1/2.!>!y/sje!|!*:!=!opjudfsjEqjmDv)!gj!ftmf!~!<*1/1!-1/1!-{/wVw)4dfw!>!opjujtpQqjmd!<1/2!>!y/sje!|!*9!=!opjudfsjEqjmDv)!gj!ftmf!\vQJMD`WV!gfegj$\v!~!<1/2.!>!{/sje!|!*8!=!opjudfsjEqjmDv)!gj!ftmf!~!<1/2!>!{/sje!|!*7!=!opjudfsjEqjmDv)!gj!ftmf!~!<1/2.!>!z/sje!|!*6!=!opjudfsjEqjmDv)!gj!ftmf!~!<1/2!>!z/sje!|!*5!=!opjudfsjEqjmDv)!gj!ftmf!~!<1/2.!>!y/sje!|!*4!=!opjudfsjEqjmDv)!gj!ftmf!~!<1/2!>!y/sje!|!*3!=!opjudfsjEqjmDv)!gj!\vgjeof$\v!<opjujtpQw!>!opjujtpQqjmd!4dfw!\vQJMD`WV!gfegj$\v!<*1/1!-1/1!-1/1)4dfw!>!sje!4dfw!|!*1!?!opjudfsjEqjmDv)!gj!~!~!~!<esbdtje!|!*utfUbiqmBv!>=!b/spmpDwv)!gj!|!ftmf!~!~!<esbdtje!|!*1/1!>>!b/spmpDwv)!gj!|!*uofsbqtobsUv)!gj!\vgjeof$\v!<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv!\vftmf$\v!<*zy/wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv!\vQJMD`WV!gfegj$\v!|!**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)!gj!<spmpDwv!5dfw!|!*ejpw)ojbn!ejpw!<uvpldbmc!mppc!nspgjov!\vgjeof$\v!<^UDFKCP`XPMG`YBN]wVxpmg!3dfw!hojzsbw!<^UDFKCP`XPMG`YBN]efmcboFxpmg!mppc!nspgjov!<^UDFKCP`XPMG`YBN]fsvuyfUxpmg!E3sfmqnbt!nspgjov!\v1!?!UDFKCP`XPMG`YBN!gj$\v!\vgjeof$\v!\vgjeof$\v!~!~!<*1/2!-*Gqjn!-2spmpd!-1spmpd)yjn)5dfw!osvufs!<*1/2!,!uoJqjn!-sjEfmqnbt!-qbNwof)WVfcvDsbfojmjc!>!2spmpd!4dfw!|!ftmf!~!<*1/2!-1spmpd)5dfw!osvufs!|!*1/1!>>!Gqjn)!gj!<*uoJqjn!-sjEfmqnbt!-qbNwof)WVfcvDsbfojmjc!>!1spmpd!4dfw!<*qjn)sppmg!>!uoJqjn!ubpmg!<*qjn)udbsg!>!Gqjn!ubpmg!<*mfwfMqjNybn`WVfcvd!-1n!-*ttfoihvps)qjNpUttfoihvps)qnbmd!>!qjn!ubpmg!|!*ttfoihvps!ubpmg!-sjEfmqnbt!4dfw!-qbNwof!E3sfmqnbt)WVfcvDfsvuyfu!5dfw!~!<qjn!osvufs!~!<*ttfoihvps!+!72/2)3hpm!+!1/3!.!>!qjn!|!ftmf!~!<6n!,!*7s!.!6s)!0!*6n!.!7n)!+!*ttfoihvps!.!6s)!>!qjn!|!*7s!>?!ttfoihvps)!gj!ftmf!~!<5n!,!*6s!.!5s)!0!*5n!.!6n)!+!*ttfoihvps!.!5s)!>!qjn!|!*6s!>?!ttfoihvps)!gj!ftmf!~!<2n!,!*5s!.!2s)!0!*2n!.!5n)!+!*ttfoihvps!.!2s)!>!qjn!|!*5s!>?!ttfoihvps)!gj!ftmf!~!<1n!,!*2s!.!1s)!0!*1n!.!2n)!+!*ttfoihvps!.!1s)!>!qjn!|!*2s!>?!ttfoihvps)!gj!<1/1!>!qjn!ubpmg!|!*ttfoihvps!ubpmg)qjNpUttfoihvps!ubpmg!\v1/5!7n!fojgfe$\v!\v9411/1!7w!fojgfe$\v!\v23/1!7s!fojgfe$\v!\v1/4!6n!fojgfe$\v!\v721/1!6w!fojgfe$\v!\v614/1!6s!fojgfe$\v!\v1/3!5n!fojgfe$\v!\v751/1!5w!fojgfe$\v!\v5/1!5s!fojgfe$\v!\v1/2!.!2n!fojgfe$\v!\v783/1!2w!fojgfe$\v!\v9/1!2s!fojgfe$\v!\v1/3!.!1n!fojgfe$\v!\v:44/1!1w!fojgfe$\v!\v1/2!1s!fojgfe$\v!~!<*z/g!-nc!-nu)yjn!osvufs!<*y/g!-sc!-mc)yjn!>!nc!4dfw!<*y/g!-su!-mu)yjn!>!nu!4dfw!<chs/**wv!-qbNwof)E3fsvuyfu)sbfojMpUmfyfUqbNwof!>!mc!4dfw!<f{jTmfyfu!>.!y/wv!<chs/**wv!-qbNwof)E3fsvuyfu)sbfojMpUmfyfUqbNwof!>!sc!4dfw!<f{jTmfyfu!>,!z/wv!<chs/**wv!-qbNwof)E3fsvuyfu)sbfojMpUmfyfUqbNwof!>!su!4dfw!<f{jTmfyfu!>,!y/wv!<chs/**wv!-qbNwof)E3fsvuyfu)sbfojMpUmfyfUqbNwof!>!mu!4dfw!<f{jTmfyfu!>+!wv!<*f{jTfdbg!+!1/3!.!f{jTfmjUybn`WVfcvd!-1/1)ybn!+!1/4!>,!y/wv!<f{jTfmjUojn`WVfcvd!+!1/3!+!uoJsfumjg!>,!z/wv!~!<f{jTfmjUybn`WVfcvd!+!1/3!>,!z/wv!|!*mfwfMqjNybn`WVfcvd!=!uoJqjn)!gj!<f{jTfdbg!+!fdbg!>,!y/wv!~!<1/4!>.!fdbg!<f{jTfdbg!>,!z/wv!|!*1/3!?!fdbg)!gj!<g!.!6/1!>,!wv!<*wv)udbsg!>!g!3dfw!<*1/2!.!f{jTfdbg)!+!*fdbg!-opjudfsje)WVufh!>!wv!3dfw!<*f{jTfmjUybn`WVfcvd!+!1/4)!0!1/2!>!f{jTmfyfu!ubpmg!<*uoJqjn)3qyf!>!f{jTfdbg!ubpmg!<*mfwfMqjNojn`WVfcvd!-uoJqjn)ybn!>!uoJqjn!<*1/1!-uoJqjn!.!mfwfMqjNojn`WVfcvd)ybn!>!uoJsfumjg!ubpmg!<*opjudfsje)fdbGufh!>!fdbg!ubpmg!|!*uoJqjn!ubpmg!-opjudfsje!4dfw!-qbNwof!E3sfmqnbt)WVfcvDsbfojmjc!4dfw!~!<*1/2!,!wv)!+!6/1!osvufs!~!<*{/opjudfsje)tcb!0!*z/opjudfsje!-y/opjudfsje)3dfw!>!wv!|!ftmf!~!<*z/opjudfsje)tcb!0!*{/opjudfsje!-y/opjudfsje!.)3dfw!>!wv!|!*1/5!>>!fdbg)!gj!ftmf!~!<*y/opjudfsje)tcb!0!*z/opjudfsje!-{/opjudfsje!.)3dfw!>!wv!|!*1/4!>>!fdbg)!gj!ftmf!~!<*{/opjudfsje)tcb!0!*z/opjudfsje!-y/opjudfsje!.)3dfw!>!wv!|!*1/3!>>!fdbg)!gj!ftmf!~!<*z/opjudfsje)tcb!0!*{/opjudfsje!.!-y/opjudfsje!.)3dfw!>!wv!|!*1/2!>>!fdbg)!gj!ftmf!~!<*y/opjudfsje)tcb!0!*z/opjudfsje!-{/opjudfsje)3dfw!>!wv!|!*1/1!>>!fdbg)!gj!<wv!3dfw!|!*fdbg!ubpmg!-opjudfsje!4dfw)WVufh!3dfw!~!<fdbg!osvufs!~!<1/5!;!1/2!@!1/1!?!z/opjudfsje!>!fdbg!ftmf!<1/6!;!1/3!@!1/1!?!{/opjudfsje!>!fdbg!*z/opjudfsjEtcb!?!{/opjudfsjEtcb)!gj!|!ftmf!~!<1/5!;!1/2!@!1/1!?!z/opjudfsje!>!fdbg!ftmf!<1/4!;!1/1!@!1/1!?!y/opjudfsje!>!fdbg!*z/opjudfsjEtcb!?!y/opjudfsjEtcb)!gj!|!*{/opjudfsjEtcb!?!y/opjudfsjEtcb)!gj!<1/2!.!>!fdbg!ubpmg!<*opjudfsje)tcb!>!opjudfsjEtcb!4dfw!|!*opjudfsje!4dfw)fdbGufh!ubpmg!\v1/72!f{jTfmjUojn`WVfcvd!fojgfe$\v!\v1/763!f{jTfmjUybn`WVfcvd!fojgfe$\v!\v1/5!mfwfMqjNojn`WVfcvd!fojgfe$\v!\v1/9!mfwfMqjNybn`WVfcvd!fojgfe$\v!\vWV`FCVD`FQZU`QBNWOF!gfegj$\v!~!<*{zy/*yjsubn!+!*1/1!-sje)5dfw))f{jmbnspo!osvufs!|!*yjsubn!5ubn!oj!-sje!4dfw!oj)opjudfsjEnspgtobsUftsfwoj!4dfw!\vgjeof$\v!~!<*x/fvmbw!-**SPUDBG`BNNBH)4dfw!-{zy/fvmbw)xpq)5dfw!osvufs!|!*fvmbw!5dfw)sbfojMpUmfyfUqbNwof!5dfw!\vftmf$\v!~<*!b/fvmbw!-*!*!*!*!9142411/1!)4dfw!-chs/fvmbw!)mbvrFobiUttfm!)4dfw!-3:/32!+!chs/fvmbw!-*!661/1!)4dfw!.!661/2!+!*!*!77725/1!)4dfw!-chs/fvmbw!)xpq!)yjn!)5dfw!osvufs!|!*!fvmbw!5dfw!oj!)CHStpUsbfojM!5dfw!~!<*b/fvmbw!-****65151/1)4dfw!-chs/fvmbw)mbvrFobiUttfm)4dfw!-9194::4881/1!+!chs/fvmbw!-**5/3)4dfw!-*5218342361/1)4dfw!,!79:387985:/1!+!chs/fvmbw)xpq)yjn)5dfw!osvufs!|!*fvmbw!5dfw)sbfojMpUmfyfUqbNwof!5dfw!\vWV`FCVD`FQZU`QBNWOF!gfegj$\v!\vgjeof$\v!~!<{zy/*!*x/ubvr!-{/ubvr.!-z/ubvr.!-y/ubvr.)5dfw!-wr!)ubvRumvn!osvufs!<*!*1/1!-dfw)5dfw!-ubvr!)ubvRumvn!>!wr!5dfw!|!*!dfw!4dfw!-ubvr!5dfw!)spudfWfubups!4dfw!~!<*!{/3r!+!{/2r!.!z/3r!+!z/2r!.!y/3r!+!y/2r!.!x/3r!+!x/2r!-z/3r!+!y/2r!.!y/3r!+!z/2r!,!x/3r!+!{/2r!,!{/3r!+!x/2r!-y/3r!+!{/2r!.!{/3r!+!y/2r!,!x/3r!+!z/2r!,!z/3r!+!x/2r!-{/3r!+!z/2r!.!z/3r!+!{/2r!,!x/3r!+!y/2r!,!y/3r!+!x/2r)5dfw!osvufs!|!*3r!5dfw!-2r!5dfw)ubvRumvn!5dfw!<ubvRqbnwoFv!5dfw!nspgjov!\vFUBUPS`QBNWOF!gfegj$\v!<1/3!>!SPUDBG`BNNBH!ubpmg!utopd!\vQBNWOF`FTV!gfegj$\v!\vgjeof$\v!~!\vgjeof$\v!<*qe!-*z/f{jTmfyfu!-E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!osvufs!\vftmf$\v!<*1/:!0!1/2)!+!*!*qe!-*z/f{jTmfyfu!-yyz/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*qe!-*z/f{jTmfyfu!-yyy/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*qe!-*z/f{jTmfyfu!-zyz/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*qe!-*z/f{jTmfyfu!-zyy/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*qe!-*z/f{jTmfyfu!-E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*qe!-*z/f{jTmfyfu!-yzz/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*qe!-*z/f{jTmfyfu!-yzy/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*qe!-*z/f{jTmfyfu!-zzz/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*qe!-*z/f{jTmfyfu!-zzy/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!)!osvufs!<z/f{jTmfyfu!+!tvjebSxpebit!+!*2!-2!.)3dfw!>!uftggp!3dfw!\v*UGPT`GDQ`FQZU`QBNXPEBIT)efojgfe!}}!*GDQ`FQZU`QBNXPEBIT)efojgfe!gj$\v!<*opjujtpQpUuihjm)f{jmbnspo!>!E4ec!4dfw!<tbjCxpebit!>,!qe!<*sbfObsfnbDxpebit!.!sbGbsfnbDxpebit)!0!*sbfObsfnbDxpebit!.!*opjujtpQpUuihjm)iuhofm)!>!qe!ubpmg!<{zy/esppDxpebit!>!opjujtpQpUuihjm!4dfw!<**1/3!-1/5)3dfw!+!f{jTqbNxpebit)!0!*1/2)3dfw!>!f{jTmfyfu!3dfw!|!*sbGbsfnbDxpebit!ubpmg!-sbfObsfnbDxpebit!ubpmg!-esppDxpebit!5dfw!-tvjebSxpebit!ubpmg!-tbjCxpebit!ubpmg!-f{jTqbNxpebit!3dfw!-qbNxpebit!E3sfmqnbt)xpebiTuojpQufh!ubpmg!~!<*68/1!-684/1)3dfw!,!sbobmq!+!*63/1!-632/1)3dfw!osvufs!~!<1/3!.!Zohjt!+!{/w!>!z/sbobmq!<1/3!,!Zohjt!+!1/3!,!y/w!>!y/sbobmq!<*z/w)ohjt!>!Zohjt!ubpmg!|!*foPutpnmb!>?!z/Wtcb)!gj!ftmf!~!<Yohjt!+!1/3!,!Yohjt!+!{/w!>!y/sbobmq!<*y/w)ohjt!>!Yohjt!ubpmg!|!*foPutpnmb!>?!y/Wtcb)!gj!ftmf!~!<y/w!.!1/5!>!y/sbobmq!*1/1!?!{/w)!gj!|!*foPutpnmb!>?!{/Wtcb)!gj!<mfyfUButpnmb!.!1/2!>!foPutpnmb!ubpmg!<Zf{jTmfyfu!+!6/2!>!mfyfUButpnmb!ubpmg!<zy/w!>!sbobmq!3dfw!<*Zf{jTmfyfu!+!1/3!.!1/2)!+!fcvDpUfmbdt!>+!w!<fcvDpUfmbdt!>+!Wtcb!<**{/Wtcb!-z/Wtcb)ybn!-y/Wtcb)ybn!0!1/2!>!fcvDpUfmbdt!ubpmg!<*w)tcb!>!Wtcb!4dfw!|!*Zf{jTmfyfu!ubpmg!-w!4dfw)WVpUfcvd!3dfw!~!<xpebit!osvufs!~!\vgjeof$\v!<*{/esppDxpebit!-zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!>!xpebit!\vftmf$\v!<*1/:!0!1/2)!+!*!*{/esppDxpebit!-*2ze!-2ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!,!*{/esppDxpebit!-*2ze!-1/1)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!,!*{/esppDxpebit!-*2ze!-1ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!,!*{/esppDxpebit!-*1/1!-2ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!,!*{/esppDxpebit!-zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!,!*{/esppDxpebit!-*1/1!-1ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!,!*{/esppDxpebit!-*1ze!-2ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!,!*{/esppDxpebit!-*1ze!-1/1)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!,!*{/esppDxpebit!-*1ze!-1ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!)!>!xpebit!<tvjebSxpebit!+!z/f{jTmfyfu!,!>!2ze!ubpmg!<tvjebSxpebit!+!y/f{jTmfyfu!,!>!2ye!ubpmg!<tvjebSxpebit!+!z/f{jTmfyfu!.!>!1ze!ubpmg!<tvjebSxpebit!+!y/f{jTmfyfu!.!>!1ye!ubpmg!<f{jTqbNxpebit!0!*1/2)3dfw!>!f{jTmfyfu!3dfw!\v*UGPT`GDQ`FQZU`QBNXPEBIT)efojgfe!gjmf$\v!<*1/:!0!1/2)!+!*!*{/esppDxpebit!-*2ze!-2ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*{/esppDxpebit!-*2ze!-1/1)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*{/esppDxpebit!-*2ze!-1ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*{/esppDxpebit!-*1/1!-2ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*{/esppDxpebit!-zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*{/esppDxpebit!-*1/1!-1ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*{/esppDxpebit!-*1ze!-2ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*{/esppDxpebit!-*1ze!-1/1)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*{/esppDxpebit!-*1ze!-1ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!)!>!xpebit!<tvjebSxpebit!+!z/f{jTmfyfu!,!>!2ze!ubpmg!<tvjebSxpebit!+!y/f{jTmfyfu!,!>!2ye!ubpmg!<tvjebSxpebit!+!z/f{jTmfyfu!.!>!1ze!ubpmg!<tvjebSxpebit!+!y/f{jTmfyfu!.!>!1ye!ubpmg!<f{jTqbNxpebit!0!*1/2)3dfw!>!f{jTmfyfu!3dfw!\v*GDQ`FQZU`QBNXPEBIT)efojgfe!gj$\v!|!*utfUnvutvsg)!gj!<*dfWutfUnvutvsg)mmb!>!utfUnvutvsg!mppc!<*1/2!>=!{/esppDxpebit!-nvutvsGoj)3dfwc!>!dfWutfUnvutvsg!3dfwc!<*dfWnvutvsGoj)mmb!>!nvutvsGoj!mppc!<*1/2!>=!z/esppDxpebit!-1/1!>?!z/esppDxpebit!-1/2!>=!y/esppDxpebit!-1/1!>?!y/esppDxpebit)!5dfwc!>!dfWnvutvsGoj!5dfwc!<*::::::/1!-{/esppDxpebit)ojn!>!{/esppDxpebit!<tbjCxpebit!>,!{/esppDxpebit!<x/esppDxpebit!>0!{zy/esppDxpebit!<1/2!>!xpebit!ubpmg!|!*esppDxpebit!5dfw!-tvjebSxpebit!ubpmg!-tbjCxpebit!ubpmg!-f{jTqbNxpebit!3dfw!-qbNxpebit!E3sfmqnbt)xpebiTufh!ubpmg!~!<d!osvufs!<*y/g!-c!-b)yjn!>!d!ubpmg!<*z/g!-us!-cs)yjn!>!c!ubpmg!<*z/g!-um!-cm)yjn!>!b!ubpmg!<*6/1!,!f{jt!+!wv)udbsg!>!g!3dfw!<*fsbqnpd!-zz/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe)fsbqnpDE3fsvuyfu!>!us!ubpmg!<*fsbqnpd!-yz/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe)fsbqnpDE3fsvuyfu!>!cs!ubpmg!<*fsbqnpd!-zy/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe)fsbqnpDE3fsvuyfu!>!um!ubpmg!<*fsbqnpd!-yy/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe)fsbqnpDE3fsvuyfu!>!cm!ubpmg!<f{jt!0!*6/1!,!f{jt!+!wv)sppmg!>!WVejpsuofd!3dfw!<f{jt!0!*1/2)3dfw!>!f{jTmfyfu!3dfw!<*1/2!-1/1)3dfw!>!uftggp!3dfw!utopd!|!*fsbqnpd!ubpmg!-wv!3dfw!-f{jt!3dfw!-tiuqfe!E3sfmqnbt)qsfMxpebiTE3fsvuyfu!ubpmg!~!<***wv!-tiuqfe)E3fsvuyfu)iuqfEpUBCHSldbqov!-fsbqnpd)qfut!osvufs!|!*fsbqnpd!ubpmg!-wv!3dfw!-tiuqfe!E3sfmqnbt)fsbqnpDE3fsvuyfu!ubpmg!~!<*tspudbGldbqoV!-w)upe!osvufs!|!*w!5dfw!oj!utopd)iuqfEpUBCHSldbqov!ubpmg!<*/2!-tspudbGldbQ)5dfw!0!fmbdtoxpEldbqoV!>!tspudbGldbqoV!5dfw!utopd!<*/763!-/763!+!/763!-/763!+!/763!+!/763)4dfw!>!tspudbGldbQ!4dfw!utopd!</763!0!/663!>!fmbdtoxpEldbqoV!ubpmg!utopd!</663!0!/763!>!fmbdtqVldbQ!ubpmg!utopd!<esppDxpebit!5dfw!hojzsbw!<fwjfdfSxpebit!mppc!nspgjov!<tvjebSxpebit!ubpmg!nspgjov!<tbjCxpebit!ubpmg!nspgjov!<zujtofuoJxpebit!ubpmg!nspgjov!<f{jTxpebit!3dfw!nspgjov!<qbNxpebit!E3sfmqnbt!nspgjov!<mmvDxpebit!mppc!nspgjov!\vQBNXPEBIT`FTV!gfegj$\v!\vgjeof$\v!<fdobutjEfojMw!ubpmg!hojzsbw!<fdobutjEqbHitbEv!ubpmg!nspgjov!<fdobutjEitbEv!ubpmg!nspgjov!<itbEv!mppc!nspgjov!\vITBE!gfegj$\v!\vgjeof$\v!\vgjeof$\v!<sbGhpGv!ubpmg!nspgjov!<sbfOhpGv!ubpmg!nspgjov!\vftmf$\v!<zujtofEhpGv!ubpmg!nspgjov!\v3QYF`HPG!gfegj$\v!<hpGv!mppc!nspgjov!<spmpDhpGv!5dfw!nspgjov!\vHPG!gfegj$\v!\vgjeof$\v!<*6/1!-6/1!-6/1)4dfw!>!ybNqjmd!4dfw!utopd!<*6/1.!-6/1.!-6/1.)4dfw!>!ojNqjmd!4dfw!utopd!<^SFQQJMD`YPC`YBN]yjsubNsfqqjmDv!5ubn!nspgjov!<^SFQQJMD`YPC`YBN]sfooJqjmDsfqqjmDv!mppc!nspgjov!<^SFQQJMD`YPC`YBN]fqbiTsfqqjmDv!uoj!nspgjov!\v1!?!SFQQJMD`YPC`YBN!gj$\v!\vgjeof$\v!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov!<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov!<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov!<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov!<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov!<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!\v1!?!UPQT`YBN!gj$\v!\vgjeof$\v!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov!<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov!<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!\v1!?!UOJPQ`YBN!gj$\v!\vgjeof$\v!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov!<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!\v1!?!SJE`YBN!gj$\v!\vgjeof$\v!<eofmCidubCw!4dfw!hojzsbw!<eofmCidubCv!mppc!nspgjov!\vEOFMCIDUBC!gfegj$\v!\vgjeof$\v!<ttfouihjsCidubCw!ubpmg!hojzsbw!<ttfouihjsCidubCv!mppc!nspgjov!\vTTFOUIHJSCIDUBC!gfegj$\v!\vgjeof$\v!<spmpDidubCw!5dfw!hojzsbw!<spmpDidubCv!mppc!nspgjov!\vSPMPDIDUBC!gfegj$\v!<opjudfsjEuihjmebfIv!4dfw!nspgjov!<spmpDuihjmebfIv!5dfw!nspgjov!<zujtofuoJuofjcnBuihjmebfIv!ubpmg!nspgjov!<fhobSuihjmebfIv!ubpmg!nspgjov!<emspXw!4dfw!hojzsbw!<opjujtpQbsfnbDv!4dfw!nspgjov!<yjsubNxfjWv!5ubn!nspgjov!\vgjeof$\v!\vgjeof$\v!<qbNwoFv!fcvDsfmqnbt!nspgjov!\vftmf$\v!<ttfoihvps!ubpmg!nspgjov!<qbNwoFv!E3sfmqnbt!nspgjov!\vWV`FCVD`FQZU`QBNWOF!gfegj$\v!<zujwjudfmgfSv!ubpmg!nspgjov!<qbNwoFftVv!mppc!nspgjov!\vQBNWOF`FTV!gfegj$\v!<opjujtpQw!4dfw!hojzsbw!<yfusfWw!4dfw!hojzsbw!<mbnspOw!4dfw!hojzsbw!<ftvggjEv!5dfw!nspgjov!<zujdbqPusbQv!ubpmg!nspgjov!<ttfouihjsCv!ubpmg!nspgjov!<uihjMv!mppc!nspgjov!<spmpDeofmCv!5dfw!nspgjov!<eofmCv!mppc!nspgjov!<uofdsfQqjmDv!ubpmg!nspgjov!<opjudfsjEqjmDv!uoj!nspgjov!<sfmqnbTeofmCv!E3sfmqnbt!nspgjov!<sfmqnbTv!E3sfmqnbt!nspgjov!\vgjeof$\v!<wVw!3dfw!hojzsbw!\vftmf$\v!<wVw!4dfw!hojzsbw!\vQJMD`WV!gfegj$\v!<fsvuyfUeofmCv!mppc!nspgjov!<fsvuyfUv!mppc!nspgjov!<uofsbqtobsUv!mppc!nspgjov!<utfUbiqmBv!ubpmg!nspgjov!<spmpDftsfwfSldjQyjGv!5dfw!nspgjov!<qjmGftsfwfSv!mppc!nspgjov!<ldjQv!mppc!nspgjov!<yjGv!mppc!nspgjov!<fmcbudfmfTesbdtjEv!mppc!nspgjov!\vYJGFSQ$\v!\vgjeof$\v!\vgjeof$\v!<ubpmg!qnvjefn!opjtjdfsq!\vftmf$\v!<ubpmg!qihji!opjtjdfsq!\vIHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$\v!\vTF`MH!gfegj$\v!",$p=(MS(N,{setBatchInfo:function(p,G){Di[p]=G},getBatchInfo:function(p){return Di[p]},getBatchInfoMap:function(){return Di},setBatchInfoMap:function(p){Di=p}},!0),[1,1,1]),Sp=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Op=[1,0,0,0,0,1,0,1,1,1,1,0],Wp=[-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5],lp=[.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5],tp=[.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],zp=[.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5],Zp=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5],Bp=[-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5],fp=function(p,G){p._40Q.each(function(p){p.ivBatch(G)})},Xp=function(p,G,v,J){var $=G[v=v._id];if($){var S=(L=p[l=$.batch]).ds,O=$.index;if(L.invalidate=!0,delete G[v],S.splice(O,1),DS(S))delete p[l];else{for(var v=O,p=$.begin,W=$.size;O<S.length;O++)($=G[S[O]._id]).index--,$.begin-=W;if(L.ms&&L.ms.length)return L.ms.splice(16*v,16),L.ics&&L.ics.splice(4*v,4),void(L.ps&&L.ps.splice(4*v,4));var l=3*p,v=3*W,t=4*p,z=4*W,Z=L.vs,B=L.ps,f=L.uv,X=L.cs,q=L.bs,g=L.rs,M=L.ns,L=L.ls;Z.splice(l,v),B.splice(t,z),f&&f.splice(2*p,2*W),X&&X.splice(t,z),q&&q.splice(l,v),g&&g.splice(p,W),M&&M.splice(l,v),L&&L.splice(p,W)}}},qp=function(p,G,v,J,$){if(!J)return v0;var S,O=G[J];return O||(S=($=$.getBatchInfo(J)||Ai).image?[]:v0,O=G[J]={vs:[],ns:[],uv:S,cs:S||$.color?v0:[],bs:$.blend?[]:v0,ps:[],rs:$.brightness?[]:v0,ds:[],ms:$.instanced?[]:v0,ics:S||$.color||!$.instanced?v0:[]}),O.invalidate=!0,p[v._id]={index:O.ds.length,begin:O.vs.length/3,batch:J},O.ds.push(v),O},gp=function(p,G){return G!=v0&&1!==G?[p[0]*G,p[1]*G,p[2]*G,p[3]]:p},Mp=function(p,G){var v,J,$,S,O,W,l=p.data,t=l.s("wf.combineTriangle");{if(G=G||(l instanceof E.Node&&!(l instanceof E.Shape)?o3=o3||{vs:Kp,is:ap,uv:up}:[p.left,p.front,p.right,p.back,p.top,p.bottom])){if(t)return l=l.s("wf.normEpsilon"),isNaN(l)&&(l=2),t=0|Math.min(3,Math.max(1,isNaN(t)?1:t)),Nj[t-1](G,p,180/(Math.PI*l));if(l=p,X=(t=G)._lineModel)return X;lS(t);var z,Z,B,f=["","top_","bottom_"],X=[],q=[];for(UZ(t,l,q),v=0,J=q.length;v<J;v++)if(W=q[v])for($=0,S=f.length;$<S;$++)if(O=W[f[$]+"vs"])for(var g,M=(g=W[f[$]+"is"])?g.length:O.length/3,L=0;L<M;L+=3)B=g?(z=g[L],Z=g[L+1],g[L+2]):(Z=(z=L)+1,L+2),X.push(O[z*=3],O[z+1],O[z+2],O[Z*=3],O[Z+1],O[Z+2],O[Z],O[Z+1],O[Z+2],O[B*=3],O[1+B],O[2+B],O[B],O[1+B],O[2+B],O[z],O[z+1],O[z+2]);return t._lineModel=X}return K}},Lp=function(p,G,v){var J,$,S=p.getData3dUI(G);if((l=(l=S.shapeModel)||fn(S))||!S.shapeName){if(v.geometry){if(S.wfGeometry?(J=S.wfMatrix,$=S.wfGeometry,S.wfGeometry=K):$=Mp(S,l),!$||0===$.length)return}else $=v.short?Up:op,G.s("wf.boundingBox")&&(l=S.getBoundingBox(!0))&&(l=(new eh).scale(l.max.clone().sub(l.min)).setPosition(l.max.clone().add(l.min).divideScalar(2)).toArray(),$=Ns([],l,$));var O,W,l=p.getBrightness(G),t=G.s("bloom"),z=G.s("3d.reflectable"),Z=yE(v.color||"white"),B=Z[3]<1,f=Math.ceil(v.width)||1,X=G.s("3d.clipbox")?ds:G.s("3d.clipbox.mask"),q=G.s("wf.fog"),g=G.getRenderLayer(),g=(p=p._40Q.get(g)).wireframeIndexMap,p=p.wireframeModelMap,M=G.s("batch"),L=G.s("3d.clip.direction");if(L){if(0===(W=G.s("3d.clip.percentage")))return;O="_"+G._id,W=S._formatClipUniforms(L,W,G)}else O=M?(B?"T":"O")+M:(B?"T":"O")+(t?"_1":"_0")+(z?"1_":"0_")+X+"_"+f+(q?"1_":"0_");(L=(L=p[O])||(p[O]={vs:[],cs:[],ps:[],ds:[],T:B,B:t,clipboxMask:X,reflectable:!!z,W:f,batch:M,fog:q})).invalidate=!0,p=L.vs,B=L.cs,t=L.ds,X=g[G._id]={index:t.length,begin:p.length/3,batch:O},t.push(G),z=J||S.mat,v.geometry&&G instanceof E.Shape&&(N.extractShapeTranslation||N.extractPolylineTranslation||N.extractVerticesTranslation)&&(f=S._vsTranslation)&&z&&(z=(new sh.Matrix4).fromArray(z).multiply(f).toArray()),G instanceof E.Edge||!(!z||!v.geometry&&G instanceof E.Shape)||(z=Xm(G,v.mat),G.appendAnchorMatrix3d(z)),W?(L.mat=Om(z),L.clipDirection=W[0],L.clipPercent=W[1],Ns(p,null,$)):Ns(p,z,$),M=X.size=p.length/3-X.begin,Rs(B,gp(Z,l),M)}},Hp=function(p,G,v,J){if(G){var $=(v=v[G.batch]).ps,S=(v=v.ms&&v.ms.length)?4*G.index:4*G.begin,O=v?1:G.size;if($[S]!==p[0]||$[S+1]!==p[1]||$[S+2]!==p[2]||$[S+3]!==p[3]){for(var W=0;W<O;W++)$[S++]=p[0],$[S++]=p[1],$[S++]=p[2],$[S++]=p[3];$._invalidateThisFrame=!0}}},_p=(T3=new E.Math.Vector3,V3=new E.Math.Vector3,function(p,G){var v=G+["32"],J=p[G],$=p[v];if(J){if((N.extractBatchTranslation||N.extractVerticesTranslation)&&"vs"===G){V3.set(0,0,0);for(var S=J.length,O=0;O<S;O+=3)V3.add(T3.fromArray(J,O));V3.divideScalar(S/3);for(var W=V3.x,l=V3.y,t=V3.z,z=new Array(S),O=0;O<S;O+=3)z[O]=J[O]-W,z[O+1]=J[O+1]-l,z[O+2]=J[O+2]-t;J=z,p.translate=[W,l,t]}$&&$.length===J.length?($.set(J),$._bufId=null):p[v]=new pm(J)}else delete p[v]}),bp=function(p,G,v,J,$,S,O,W){var l,t,z=G instanceof E.Shape,Z=S[0],B=S.length;if(1<B)for(var Z=Om(Z),f=1;f<B;f++)Qs(Z,Z,S[f]);z&&(l=G.p3(),Fs(Z,l)),qS(O.ms,Z),O.ics&&(t=G.s("shape3d.color"))&&Rs(O.ics,t,1),O.vs.length||(t=Om(Sp),z&&Fs(t,vm(l)),np(p,G,v,J,$,[t],O,W))},np=function(G,v,p,J,$,S,O,W){if(lS(p))p.forEach(function(p){np(G,v,p,J,$,S,O,W)});else if(JS(p))np(G,v,fn(J,p),J,$,S,O,W);else if(OS(p)){var l,t=V(p.mat,v,G),z=V(p.s3,v,G),Z=V(p.t3,v,G),B=V(p.r3,v,G);if((z||B||Z||t)&&(l=qm(t,z,B,V(p.rotationMode,v,G),Z),S.push(l)),p.shape3d)np(G,v,p.shape3d,J,$,S,O,p);else{var t=J.s,f=(W=W||Ai,S[0]),X=S.length,z=t("shape3d.color",p.color,W.color);if($=$||t("shape3d.blend",p.blend,W.blend),1<X)for(var f=Om(f),q=1;q<X;q++)Qs(f,f,S[q]);B=f?EZ(f):v0,p.vs&&t(wl,p.visible,W.visible)&&Dp(f,O,p.vs,p.uv,p.is,p.ns,B,$,z),p.top_vs&&t(jl,p.topVisible,W.topVisible)&&Dp(f,O,p.top_vs,p.top_uv,p.top_is,p.top_ns,B,$,t("shape3d.top.color",p.topColor,W.topColor)||z),p.bottom_vs&&t(il,p.bottomVisible,W.bottomVisible)&&Dp(f,O,p.bottom_vs,p.bottom_uv,p.bottom_is,p.bottom_ns,B,$,t("shape3d.bottom.color",p.bottomColor,W.bottomColor)||z),p.from_vs&&t(dl,p.fromVisible,W.fromVisible)&&Dp(f,O,p.from_vs,p.from_uv,p.from_is,p.from_ns,B,$,t("shape3d.from.color",p.fromColor,W.fromColor)||z),p.to_vs&&t(Pl,p.toVisible,W.toVisible)&&Dp(f,O,p.to_vs,p.to_uv,p.to_is,p.to_ns,B,$,t("shape3d.to.color",p.toColor,W.toColor)||z)}l&&S.pop()}},Dp=function(p,G,v,J,$,S,O,W,l){var t=G.cs,z=G.uv,Z=G.bs,B=G.ns,f=G.vs;if(S&&0!==S.length||(S=lZ(v,$)),$)for(var X=$.length,q=0;q<X;q++){var g=$[q],M=3*g;Ns(f,p,[v[M],v[1+M],v[2+M]]),Ns(B,O,[S[M],S[1+M],S[2+M]]),z&&qS(z,[J[2*g],J[2*g+1]])}else X=v.length/3,Ns(f,p,v),Ns(B,O,S),z&&qS(z,J);t&&Rs(t,l,X),Z&&(W?xs(Z,W,X):qS(Z,$p,X))},Yp=function(p,G,v){var J=p.data.p3();G=Om(G),Fs(G,J),qS(v.ms,G),v.vs.length||(G=Om(Sp),Fs(G,vm(J)),sp(p,G,v))},sp=function(p,G,v){dp(p,C0,G,v),dp(p,Q0,G,v),dp(p,U0,G,v),dp(p,F0,G,v),dp(p,pJ,G,v),dp(p,GJ,G,v),dp(p,"csg",G,v)},cp=function(p,G,v,J,$,S){qS(v.ms,$),v.ics&&($=G.s("all.color"))&&Rs(v.ics,$,1),v.vs.length||hp(p,G,v,J,Om(Sp),S)},hp=function(p,G,v,J,$,S){Pp(p,G,v,J,$,S,C0,Wp),Pp(p,G,v,J,$,S,Q0,lp),Pp(p,G,v,J,$,S,pJ,tp),Pp(p,G,v,J,$,S,GJ,zp),Pp(p,G,v,J,$,S,U0,Zp),Pp(p,G,v,J,$,S,F0,Bp)},wp=function(p,G,v,J,$){J?$.instanced?p.gv.batchInstancedModel(p.data,J,p,p.getBodyColor(),[G],v):np(p.gv,p.data,J,p,p.getBodyColor(),[G],v):$.instanced?p.gv.batchInstancedShapeFace(p,G,v):sp(p,G,v)},dp=function(p,G,v,J){if(p=p[G]){var $=p.tuv;if($){var G=p.uvScale,S=p.uvOffset,O=p.uvRotation,W=p.uvAnchor;if(G||S||O)for(var l,t,z=(O=CZ(O,S,G,W)).a,Z=O.b,B=O.c,f=O.d,X=O.tx,q=O.ty,g=$.length,M=0;M<g;M+=2)l=$[M],t=$[M+1],$[M]=z*l+B*t+X,$[M+1]=Z*l+f*t+q}Dp(v,J,p.vs,$,v0,v0,v?EZ(v):v0,p.blend,p.color)}},Pp=function(p,G,v,J,$,S,O,W){var l,t,z,Z,B,f,X,q,g,M,L=v.cs,H=v.uv,_=v.bs,b=v.vs,v=v.ns,n=lZ(W);p.getFaceVisible(G,O)&&((M=p.getFaceMat(G,O))&&($=Xm(G,M),S=EZ($)),Ns(b,$,W),Ns(v,S,n),L&&Rs(L,p.getFaceColor(G,O),6),H&&(M=p.getFaceUv(G,O)||J[O+"Uv"],b=p.getFaceUvScale(G,O)||J[O+"UvScale"],$=p.getFaceUvOffset(G,O)||J[O+"UvOffset"],W=p.getFaceUvRotation(G,O)||J[O+"UvRotation"],v=p.getFaceUvAnchor(G,O)||J[O+"UvAnchor"],S=(M=M?[M[6],M[7],M[0],M[1],M[2],M[3],M[2],M[3],M[4],M[5],M[6],M[7]]:Op)[0],n=M[1],L=M[2],J=M[3],z=M[4],Z=M[5],B=M[6],f=M[7],X=M[8],q=M[9],g=M[10],M=M[11],(b||$||W||v)&&($=(W=CZ(W,$,b,v)).a,b=W.b,v=W.c,l=W.d,n=b*(S=$*S+v*n+(t=W.tx))+l*n+(W=W.ty),J=b*(L=$*L+v*J+t)+l*J+W,Z=b*(z=$*z+v*Z+t)+l*Z+W,f=b*(B=$*B+v*f+t)+l*f+W,q=b*(X=$*X+v*q+t)+l*q+W,M=b*(g=$*g+v*M+t)+l*M+W),H.push(S,n,L,J,z,Z,B,f,X,q,g,M)),_&&((b=p.getBodyColor(G)||p.getFaceBlend(G,O))?xs(_,b,6):qS(_,$p,6)))},jp=function(p,G,v,J){var $,S,O,W,v=p._picking?p.pickColorMap:null,l=p.getGL(),t=(p._prg,p._buffer);if(!nS(G)){for(W in yZ(p,Sp),bZ(l),G){var z,Z,B,f,X,q,g,M,L,H=G[W],_=H.batch?(z=(_=p.getBatchInfo(H.batch)||Ai).wfBloom===K?_.bloom:_.wfBloom,Z=_.wfReflectable===K?_.reflectable:_.wfReflectable,B=_.wfClipboxMask===K?_.clipboxMask:_.wfClipboxMask,_.width):(z=H.B,Z=H.reflectable,B=H.clipboxMask,H.W);J&&!H.T||!J&&H.T||p.isReflecting(l)&&!1===Z||(H.invalidate?(H.invalidate=!1,_p(H,"vs"),_p(H,"cs"),_p(H,"ls"),_p(H,"ps")):v&&H.ps&&H.ps._invalidateThisFrame&&(H.ps._invalidateThisFrame=!1,_p(H,"ps")),f=H.translate,$=H.clipDirection,f||$?(S=$?Om(H.mat):[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],f&&Fs(S,f),O=Om(p._6O),yZ(p,S)):S=null,f=H.vs32,L=v?H.ps32:H.cs32,hZ(l,0,_,v0,t.vs,f),X=(q=r.for(l)).directUniforms(),q=q.directAttribs(),M=H.D,g=!p._dashDisabled&&M,X.uAlphaTest=F.alphaTest,l._blooming&&!z&&(X.blackout=!0),$&&(X.uClipPercent=H.clipPercent,X.uClipDirection=$),_Z(p,X,B===K?ws:B),g&&(X.uDash=!0,X.uDashDistance=M,X.uDashGapDistance=H.G,X.uDiffuse=H.A||F["color.empty"],q.aLineDistance=iZ(l,t.lineDistance,H.ls32,v0,1)),(M=!p._batchColorDisabled)&&L.length?(X.uBatchColor=!0,q.aBatchColor=iZ(l,t.batchColor,L,v0,4)):(X.uBatchColor=!1,q.aBatchColor=!1),(L=!1!==H.fog)||(X.uFog=!1),sZ(l),wZ(l,0,f.length/3,l.LINES),cZ(l),L||(X.uFog=!0),M&&(X.uBatchColor=!1,q.aBatchColor=!1),g&&(X.uDash=!1,q.aLineDistance=!1),l._blooming&&!z&&(X.blackout=!1),S&&($&&(X.uClipDirection=0),IZ(p,O),X.uMMatrix=Sm))}nZ(l),IZ(p)}},ip=function(p){p.invalidate=!1,_p(p,"vs"),_p(p,"ns"),_p(p,"cs"),_p(p,"rs"),_p(p,"ps"),_p(p,"bs"),_p(p,"uv"),_p(p,"ms"),_p(p,"ics")},rp=function(Z,p,G,v,J){var $,S,O,W,G=Z._picking?Z.pickColorMap:null,l=Z.getGL(),t=Z._prg,z=r.for(l),B=z.directUniforms(),f=z.directAttribs(),X=Z._buffer;if(!nS(p)){var q,g=Z._flowObjects.length?Z.flowMap:null,M=Z.drawFilter;for(S in yZ(Z,Sp),p)if(!1!==(O=Z.getBatchInfo(S)||Ai).visible&&!(v&&!O.transparent||!v&&O.transparent||Z.isReflecting(l)&&!1===O.reflectable)){var L=O.renderLayerMask;if(am(J=J==v0?Km:J,L=L==v0?Km:L)&&(L=p[S],G||!O.transparentMask)){if(M){if(!0!==O.highlight)continue;if(q=L.ds){for(var H=!1,_=0,b=q.length;_<b;_++)if(!M(q[_])){H=!0;break}if(!H)continue}}var n,D=v&&!0===O.autoSort&&(Z._33Q||L.invalidate),Y=(L.invalidate?ip(L):G&&L.ps&&L.ps._invalidateThisFrame&&(L.ps._invalidateThisFrame=!1,_p(L,"ps")),L.ms32),s=Y&&Y.length,c=L.vs32,h=G?L.ps32:s?L.ics32:L.cs32,w=L.uv32,d=L.bs32,P=L.rs32,j=c.length/3;D&&((D=function(J,$){var p=J.length/3,G=65535<p,v=Z._glCapabilities.elementTypeUint&&G;if(!v&&G)return null;for(var S=new Array(p),O=p/3,W=new Array(O),l=0;l<O;l++)W[l]=l;W.sort(function(p,G){var p=9*p,v=[(J[p]+J[3+p]+2*J[6+p])/4,(J[1+p]+J[4+p]+2*J[7+p])/4,(J[2+p]+J[5+p]+2*J[8+p])/4],G=[(J[p=9*G]+J[3+p]+2*J[6+p])/4,(J[1+p]+J[4+p]+2*J[7+p])/4,(J[2+p]+J[5+p]+2*J[8+p])/4],p=iA($,v)-iA($,G);return 0<p?-1:p<0?1:0});for(l=0;l<O;l++){var t=3*l,z=3*W[l];S[t]=z,S[1+t]=1+z,S[2+t]=2+z}return{useUint32:v,is:new(v?Uint32Array:CA)(S)}}(c,Z.getEye()))?(L.is=D.is,L.elementTypeUint=D.useUint32):(L.is=null,L.elementTypeUint=null)),j&&((D=L.translate)&&yZ(Z,[1,0,0,0,0,1,0,0,0,0,1,0,D[0],D[1],D[2],1]),O.light,W=Z.getTexture(O.image),DZ(l,0,v0,O.light,O.opacity,O.reverseFlip,O.reverseColor,O.reverseCull),($=O.polygonOffset)&&gZ(l,$),h?Z._batchColorDisabled?(B.uBatchColor=!1,f.aBatchColor=!1):(B.uBatchColor=!0,f.aBatchColor=s?jZ(l,X.instancedBatchColor,h,v0,4):iZ(l,X.batchColor,h,v0,4)):(B.uBatchColor=!1,B.uDiffuse=O.color||F["color.empty"]),n=O.alphaTest,B.uAlphaTest=n===K?F.alphaTest:n,B.shadowReceive=!G&&!1!==O.shadowReceive,_Z(Z,B,O.clipboxMask===K?ws:O.clipboxMask),Ks(Z,B,O.lightMask===K?ws:O.lightMask,O.headlightAmbientIntensity),g&&g.resetFlowUniform(O.effectFlowMask===K?ws:O.effectFlowMask,B),l._blooming&&!O.bloom&&(B.blackout=!0),O.envmap!==K?(B.uUseEnvMap=!0,B.uReflectivity=O.envmap,B.roughness=O.roughness||0,Z._setEnvmapByProbeId(B,O.envmapProbe||0)):(B.uUseEnvMap=!1,B.uReflectivity=0),(n=d&&!Z._batchBlendDisabled)&&(B.uBatchBlend=!0,f.aBatchBlend=iZ(l,X.batchBlend,d,v0)),(d=P&&!Z._batchBrightnessDisabled)&&(B.uBatchBrightness=!0,f.aBatchBrightness=iZ(l,X.batchBrightness,P,v0,1)),w?sZ(l,t,W,O.discardSelectable,X.uv,w,O.uvOffset,O.uvScale,O.uvRotation,O.uvAnchor):sZ(l),f.aPosition=iZ(l,X.vs,c,v0),f.aNormal=iZ(l,X.ns,L.ns32,v0),s&&(B.uUseInstance=!0,f.aMatrixInstanced=jZ(l,X.ms,Y,v0)),L.is?(rZ(l,X.is,L.is),dZ(l,0,j,null,L.elementTypeUint?l.UNSIGNED_INT:null,null,s?L.ms32.length/16:0)):wZ(l,0,j,null,s?L.ms32.length/16:0),w?cZ(l,0,W):cZ(l),h&&!Z._batchColorDisabled&&(B.uBatchColor=!1,f.aBatchColor=!1),n&&(B.uBatchBlend=!1,f.aBatchBlend=!1),d&&(B.uBatchBrightness=!1,f.aBatchBrightness=!1),l._blooming&&!O.bloom&&(B.blackout=!1),s&&(B.uUseInstance=!1,f.aMatrixInstanced=K),$&&MZ(l),YZ(l),D&&(IZ(Z),B.uMMatrix=Sm))}}IZ(Z)}},ep={obj:function(S,O){var p={mat:S.mat,s3:S.s3,r3:S.r3,rotationMode:S.rotationMode,t3:S.t3,cube:S.cube==v0||S.cube,center:S.center==v0||S.center,ignoreMtls:S.ignoreMtls,ignoreTransparent:S.ignoreTransparent,ignoreColor:S.ignoreColor,ignoreImage:S.ignoreImage,ignoreNormal:S.ignoreNormal,prefix:S.prefix,flipY:S.flipY,flipFace:S.flipFace,reverseFlipMtls:S.reverseFlipMtls,finishFunc:function(p,G,v){if(p){var J,G=[];for(J in p){var $=p[J];G.rawS3=$.rawS3,$.center&&(G.center=$.center),G.push($),S.eachModel&&S.eachModel(J,$)}G.json=S,O(G)}else O()}};N.loadObj(S.obj,S.mtl,p)},bin:function(p,J){N.loadBin(p.url,{finishFunc:function(p,G,v){p?J(p):J()}})}},Ap=(N.getModelTypeHandlers=function(){return ep},N.setModelTypeHandler=function(p,G){ep[p]=G},N.getModelTypeHandler=function(p){return ep[p]},N.handleModelLoaded=function(p,G){},N.handleUnfoundModel=function(p,G,v){},v0),kp=v0,Ip=function(p){Ap&&!p._loadingModelView_&&((kp=kp||{})[p._loadingModelView_=fA()]=p)},Ep=function(v,J){var $,p=(Ap=Ap||{})[v];if(p){if(p.url===J)return;p.request.onload=Ii,p.request.onerror=Ii}if(J.indexOf(".bin")===J.length-4)return yp(v,{modelType:"bin",url:J},J);(J=N.beforeLoadURL(J)).data?(p=N.parse(J.data),yp(v,p,J)):($=new kI,Ap[v]={request:$,url:J},$.onload=function(p){var G;200===this.status||0===this.status?(delete Ap[v],G=N.parse($.getResponseText()),yp(v,G,J)):xp(v,N.handleUnfoundModel(v,J)||v0)},$.onerror=function(p){xp(v,N.handleUnfoundModel(v,J)||v0)},(p={}).url=encodeURI(J),p.sync=!1,$.send(p))},yp=function(G,v,J){var p=v.modelType;if(!p)return xp(G,v),void N.handleModelLoaded(G,v);(p=N.getModelTypeHandler(p))?(Ap=Ap||{})[G]||(Ap[G]=!0,p(v,function(p){p?(xp(G,p),N.handleModelLoaded(G,p)):xp(G,N.handleUnfoundModel(G,J,v)||v0)})):xp(G,N.handleUnfoundModel(G,J,v)||v0)},xp=function(p,G){if(delete Ap[p],JS(G)&&ii.test(G))Ep(p,G);else{if(Yi[p]=G,nS(Ap)&&(Ap=v0,kp)){for(var v in kp)(J=kp[v]).invalidateAll&&J.invalidateAll(K,"modelLoaded",p),J.redraw&&J.redraw(),J.iv(),delete J._loadingModelView_;kp=v0}if(G&&kp)for(var v in kp){var J;(J=kp[v]).invalidateAll&&J.invalidateAll(K,"modelLoading",p),J.redraw&&J.redraw(),J.iv()}}},Rp=new pm([0,0,0,1,1,1,1,0]),Np=new pm([0,0,1,0,0,1,0,0,1,0,0,1]),mp=new CA([0,1,2,2,3,0]),Kp=new pm([-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5]),ap=new CA([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),up=new pm([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),Tp=lZ(Kp,ap),Vp=(new pm([-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5]),new CA([0,1,2,3,0,7,5,4,6,7,5,3,2,4,6,1]),[C0,U0,Q0,F0,pJ,GJ]),op=[-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5],Up=[-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4],Fp=function(p,G,v,J,$,S,O){p=p||16,G=G||0,v=v||p;var W,l,t,z,Z,B,f=[],X=[],q=W0/p,g=j/(S=S||16);for(L=0;L<S;L++)for(l=L*g,B=(t=L+1)*g,W=G;W<v;W++)n=W*q,Z=(z=W+1)*q,f.push(.5*O0(l)*S0(n),.5*S0(l),-.5*O0(l)*O0(n),.5*O0(B)*S0(Z),.5*S0(B),-.5*O0(B)*O0(Z),.5*O0(l)*S0(Z),.5*S0(l),-.5*O0(l)*O0(Z),.5*O0(l)*S0(n),.5*S0(l),-.5*O0(l)*O0(n),.5*O0(B)*S0(n),.5*S0(B),-.5*O0(B)*O0(n),.5*O0(B)*S0(Z),.5*S0(B),-.5*O0(B)*O0(Z)),X.push(W/p,L/S,z/p,t/S,z/p,L/S,W/p,L/S,W/p,t/S,z/p,t/S);if(O)for(var M=[],L=0,H=f.length;L<H;L+=3)M.push(2*f[L],2*f[L+1],2*f[L+2]);if(J)for(var _=[],b=[],n=G*q,L=0;L<S;L++)l=L*g,_.push(0,0,0,.5*O0(B=(t=L+1)*g)*S0(n),.5*S0(B),-.5*O0(B)*O0(n),.5*O0(l)*S0(n),.5*S0(l),-.5*O0(l)*O0(n)),b.push(0,.5,G/p,t/S,G/p,L/S);if($){var D=[],Y=[],n=v*q;for(L=0;L<S;L++)B=(t=L+1)*g,D.push(0,0,0,.5*O0(l=L*g)*S0(n),.5*S0(l),-.5*O0(l)*O0(n),.5*O0(B)*S0(n),.5*S0(B),-.5*O0(B)*O0(n)),Y.push(1,.5,v/p,L/S,v/p,t/S)}return J={vs:f,uv:X,from_vs:_,from_uv:b,to_vs:D,to_uv:Y},O&&(J.ns=M),J},Cp=function(p,G,v){(p=p||.17)<0?p=0:.25<p&&(p=.25);for(var J,$,S,O,W,l=[],t=[],z=[],Z=W0/(v=v||18),B=W0/(G=G||12),f=.5-p,X=0;X<=G;X++)for(O=S0($=X*B-j),S=O0($),M=0;M<=v;M++)W=f+p*O,l.push(S0(J=M*Z)*W,S*p,-O0(J)*W),t.push(M/v,1-X/G);for(X=0;X<G;X++)for(var q=X*(v+1),g=(X+1)*(v+1),M=0;M<v;M++)z.push(q+M,g+M+1,g+M,q+M,q+M+1,g+M+1);return{vs:l,uv:t,is:z}},Qp=function(p,G,v,J,$,S,O,W){p=p||18,G=G||0,v=v||p,(S=S||.17)<0?S=0:.25<S&&(S=.25);var l,t,z,Z,B,f,X,q,g,M=[],L=[],H=W0/p,_=W0/(O=O||12),b=.5-S,n=W?[]:K;for(s=0;s<O;s++)for(f=s*_-j,X=(z=s+1)*_-j,l=G;l<v;l++)Z=l*H,B=(t=l+1)*H,q=b+S*S0(f),g=b+S*S0(X),M.push(S0(Z)*q,O0(f)*S,-O0(Z)*q,S0(B)*q,O0(f)*S,-O0(B)*q,S0(B)*g,O0(X)*S,-O0(B)*g,S0(Z)*q,O0(f)*S,-O0(Z)*q,S0(B)*g,O0(X)*S,-O0(B)*g,S0(Z)*g,O0(X)*S,-O0(Z)*g),L.push(l/p,1-s/O,t/p,1-s/O,t/p,1-z/O,l/p,1-s/O,t/p,1-z/O,l/p,1-z/O),W&&n.push(S0(Z)*S0(f),O0(f),-O0(Z)*S0(f),S0(B)*S0(f),O0(f),-O0(B)*S0(f),S0(B)*S0(X),O0(X),-O0(B)*S0(X),S0(Z)*S0(f),O0(f),-O0(Z)*S0(f),S0(B)*S0(X),O0(X),-O0(B)*S0(X),S0(Z)*S0(X),O0(X),-O0(Z)*S0(X));if(J)for(var D=[],Y=[],s=0;s<O;s++)X=(z=s+1)*_-j,Z=G*H,q=b+S*S0(f=s*_-j),g=b+S*S0(X),D.push(S0(Z)*q,O0(f)*S,-O0(Z)*q,S0(Z)*g,O0(X)*S,-O0(Z)*g,S0(Z)*b,0,-O0(Z)*b),Y.push(.5+.5*S0(f),.5-.5*O0(f),.5+.5*S0(X),.5-.5*O0(X),.5,.5);if($)for(var c=[],h=[],s=0;s<O;s++)X=(z=s+1)*_-j,Z=v*H,q=b+S*S0(f=s*_-j),g=b+S*S0(X),c.push(S0(Z)*q,O0(f)*S,-O0(Z)*q,S0(Z)*b,0,-O0(Z)*b,S0(Z)*g,O0(X)*S,-O0(Z)*g),h.push(.5-.5*S0(f),.5-.5*O0(f),.5,.5,.5-.5*S0(X),.5-.5*O0(X));return J={vs:M,uv:L,from_vs:D,from_uv:Y,to_vs:c,to_uv:h},W&&(J.ns=n),J},pn=function(p,G){for(var v,J,$,S,O,W=[],l=[],t=[],z=[],Z=W0/16,B=0;B<=16;B++)S=.5*(J=S0(v=B*Z)),$=O0(v),W.push(S,-.5,O=.5*$,S,.5,O),t.push(J,0,$,J,0,$),l.push(1-B/16,1,1-B/16,0);for(B=0;B<16;B++)z.push(2*B,2*B+1,2*B+3,2*B,2*B+3,2*B+2);if(G){var f=[],X=[],q=[];for(f.push(0,-.5,0),X.push(.5,.5),B=0;B<=16;B++)J=S0(v=B*Z),$=O0(v),f.push(.5*J,-.5,.5*-$),X.push(.5+.5*J,.5+.5*$);for(B=0;B<16;B++)q.push(0,B+2,B+1)}if(p){var g=[],M=[],L=[];for(g.push(0,.5,0),M.push(.5,.5),B=0;B<=16;B++)J=S0(v=B*Z),$=O0(v),g.push(.5*J,.5,.5*-$),M.push(.5+.5*J,.5-.5*$);for(B=0;B<16;B++)L.push(0,B+1,B+2)}return{vs:W,uv:l,is:z,ns:t,bottom_vs:f,bottom_uv:X,bottom_is:q,top_vs:g,top_uv:M,top_is:L}},Gn=function(p,G,v,J,$,S,O,W){p=p||12,v=v||p;for(var l,t,z,Z,B,f,X,q,g,M,L,H,_=[],b=[],n=W0/p,D=G=G||0;D<v;D++)t=(l=D+1)*n,q=.5*S0(X=D*n),g=.5*O0(X),z=.5*S0(t),Z=.5*O0(t),_.push(q,-.5,-g,z,-.5,-Z,q,.5,-g,z,-.5,-Z,z,.5,-Z,q,.5,-g),b.push(D/p,1,l/p,1,D/p,0,l/p,1,l/p,0,D/p,0);if(W)for(var Y=[],D=0,s=_.length;D<s;D+=3)Y.push(2*_[D],0,2*_[D+2]);if(O){var c=[],h=[];for(D=G;D<v;D++)t=n*(D+1),q=S0(X=n*D),g=O0(X),z=S0(t),Z=O0(t),c.push(.5*q,-.5,.5*-g,0,-.5,0,.5*z,-.5,.5*-Z),h.push(.5+.5*q,.5+.5*g,.5,.5,.5+.5*z,.5+.5*Z)}if(S){var w=[],d=[];for(D=G;D<v;D++)t=n*(D+1),q=S0(X=n*D),g=O0(X),z=S0(t),Z=O0(t),w.push(.5*q,.5,.5*-g,.5*z,.5,.5*-Z,0,.5,0),d.push(.5+.5*q,.5-.5*g,.5+.5*z,.5-.5*Z,.5,.5)}return J&&(B=[],f=[],q=.5*S0(X=n*G),g=.5*O0(X),M=G/p,B.push(0,.5,0,0,-.5,0,q,-.5,-g,q,-.5,-g,q,.5,-g,0,.5,0),f.push(0,0,0,1,M,1,M,1,M,0,0,0)),$&&(L=[],H=[],q=.5*S0(X=n*v),g=.5*O0(X),M=v/p,L.push(0,-.5,0,0,.5,0,q,.5,-g,q,.5,-g,q,-.5,-g,0,-.5,0),H.push(1,1,1,0,M,0,M,0,M,1,1,1)),O={vs:_,uv:b,bottom_vs:c,bottom_uv:h,top_vs:w,top_uv:d,from_vs:B,from_uv:f,to_vs:L,to_uv:H},W&&(O.ns=Y),O},vn=function(p,G,v,J,$){v=v||0,$=$==v0?.5:$;for(var S,O,W,l,t,z=[0,.5,.75,.875,.9375],Z=[],B=[],f=[],X=(J=J==v0?W0:J)/(G=G||18),q=0;q<z.length;q++)for(var g=q%2==0?0:.5,M=0;M<=G;M++)O=1-z[q],Z.push(S0(S=(M+g)*X+v)*$*O,z[q]*$*2-$,-O0(S)*$*O),B.push((M+g)/G,O);for(q=0;q<z.length-1;q++)for(var L=q*(G+1),H=(q+1)*(G+1),M=0;M<G;M++)f.push(L+M,H+M+1,H+M,L+M,L+M+1,H+M+1);for(t=Z.length/3-(G+1),M=0;M<G;M++)Z.push(0,$,0),B.push((M+.5)/G,0);for(M=0;M<G;M++)f.push(t+M,t+M+1,t+(G+1)+M);if(p){var _=[],b=[],n=[];for(_.push(0,-$,0),b.push(.5,.5),M=0;M<=G;M++)W=S0(S=M*X+v),l=O0(S),_.push(W*$,-$,-l*$),b.push(.5+.5*W,.5+.5*l);for(M=0;M<G;M++)n.push(0,M+2,M+1)}return{vs:Z,uv:B,is:f,bottom_vs:_,bottom_uv:b,bottom_is:n}},Jn=function(p,G,v,k,I,J,$,S){p=p||16,v=v||p;var O,W,l,t,z,Z,B,f,X,q=[],g=[],M=W0/p,L=G=G||0,H=1/($=$||1),_=new m,b=new m,n=new m,D=new m,Y=new m,s=new m,c=new m;for(S&&(O=[],l=new m,t=new m,z=new m);L<v;L++){var h=L+1,w=M*L,d=M*h;for(_.set(.5*S0(w),-.5,.5*-O0(w)),b.set(.5*S0(d),-.5,.5*-O0(d)),n.set(0,.5,0),S&&(l.set(S0(w),.5,-O0(w)).normalize(),t.set(S0(d),.5,-O0(d)).normalize(),z.copy(l).add(t).normalize()),D.lerpVectors(n,_,H),Y.lerpVectors(n,b,H),q.push(D.x,D.y,D.z,Y.x,Y.y,Y.z,n.x,n.y,n.z),g.push(L/p,H,h/p,H,(L+h)/2/p,0),S&&O.push(l.x,l.y,l.z,t.x,t.y,t.z,z.x,z.y,z.z),W=1;W<$;W++)D.lerpVectors(n,_,H*(W+1)),Y.lerpVectors(n,b,H*(W+1)),s.lerpVectors(n,_,H*W),c.lerpVectors(n,b,H*W),q.push(D.x,D.y,D.z,Y.x,Y.y,Y.z,s.x,s.y,s.z,s.x,s.y,s.z,Y.x,Y.y,Y.z,c.x,c.y,c.z),g.push(L/p,H*(W+1),h/p,H*(W+1),L/p,H*W,L/p,H*W,h/p,H*(W+1),h/p,H*W),S&&O.push(l.x,l.y,l.z,t.x,t.y,t.z,l.x,l.y,l.z,l.x,l.y,l.z,t.x,t.y,t.z,t.x,t.y,t.z)}if(J)for(var P=[],j=[],L=G;L<v;L++){var d=M*(L+1),i=S0(w=M*L),r=O0(w),e=S0(d),A=O0(d);P.push(.5*i,-.5,.5*-r,0,-.5,0,.5*e,-.5,.5*-A),j.push(.5+.5*i,.5+.5*r,.5,.5,.5+.5*e,.5+.5*A)}return k&&(B=[],(Z=[]).push(0,.5,0,0,-.5,0,.5*S0(w=M*G),-.5,.5*-O0(w)),B.push(0,0,0,1,G/p,1)),I&&(X=[],(f=[]).push(0,-.5,0,0,.5,0,.5*S0(w=M*v),-.5,.5*-O0(w)),X.push(1,1,1,0,v/p,1)),J={vs:q,uv:g,bottom_vs:P,bottom_uv:j,from_vs:Z,from_uv:B,to_vs:f,to_uv:X},S&&(J.ns=O),J},$n=function(p,G,v,J,$,S,O,W){for(var l=[],t=0;t<p.length-1;t+=2)l.push({x:p[t],y:p[t+1]});return mj(l,G,v,J,$,S,O,W,!1)},Sn={roundRect:function(p,G){return $n([.5,.4,.5,.442,.471,.471,.442,.5,.4,.5,-.4,.5,-.442,.5,-.471,.471,-.5,.442,-.5,.4,-.5,-.4,-.5,-.442,-.471,-.471,-.442,-.5,-.4,-.5,.4,-.5,.442,-.5,.471,-.471,.5,-.442,.5,-.4,.5,.4],[1,3,3,2,3,3,2,3,3,2,3,3,2],p,G,3)},star:function(p,G){return $n([.193,.079,.333,.5,0,.233,-.333,.5,-.194,.079,-.5,-.167,-.112,-.167,0,-.5,.111,-.167,.5,-.167],[1,2,2,2,2,2,2,2,2,2,5],p,G)},rect:function(p,G){return $n([.5,-.5,.5,.5,-.5,.5,-.5,-.5],[1,2,2,2,5],p,G)},billboard:function(){return{vs:[-.5,.5,0,-.5,-.5,0,.5,.5,0,.5,.5,0,-.5,-.5,0,.5,-.5,0],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]}},plane:function(){return{vs:[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0,.5],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]}},triangle:function(p,G){return $n([0,-.5,.5,.5,-.5,.5],[1,2,2,5],p,G)},rightTriangle:function(p,G){return $n([.5,.5,-.5,.5,-.5,-.5],[1,2,2,5],p,G)},parallelogram:function(p,G){return $n([.5,-.5,.25,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],p,G)},trapezoid:function(p,G){return $n([.25,-.5,.5,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],p,G)}},On={sphere:1,cylinder:1,cone:1,torus:1},Wn={torus:1,sphere:1,cone:1},ln=MS(MA(Sn),{cylinder:1}),tn=MS(MA(Sn),{cylinder:1,cone:1}),zn=function(p,G,v){var J,$=V(p.anchor3d,v,G),S=V(p.mat,v,G),O=V(p.s3,v,G),W=V(p.t3,v,G),l=V(p.r3,v,G),t=O||l||W||S;return($||t)&&(J=Om(G._6O),t=t?qm(S,O,l,V(p.rotationMode,v,G),W):$m(),$&&Fs(t,[.5-$[0],.5-$[1],.5-$[2]]),yZ(G,t)),J},Zn=function(G,v,p,J,$,S,O){var W,l,t,z,Z,B,f,X,q,g,M,L;lS(p)?p.forEach(function(p){Zn(G,v,p,J,$,S,O)}):JS(p)?Zn(G,v,fn(J,p),J,$,S,O):OS(p)&&(p.shape3d?(W=zn(p,G,v),Zn(G,v,p.shape3d,J,$,S,p),W&&IZ(G,W)):(W=G,l=v,t=J.s,z=$,Z=O||Ai,(B=S)&&!B(t("shape3d.transparent",p.transparent,Z.transparent))||(B=zn(p,W,l),Xn(p)&&W.getData3dUI(l).dispatchBoundingBoxChanged(),f=W._26I,X=W._prg,q=W._buffer,g=t("shape3d.color",p.color,Z.color),z=z||t("shape3d.blend",p.blend,Z.blend),M=(p.opacity==v0?Z:p).opacity,M=(L=t("shape3d.opacity"))!=v0&&M!=v0?M*L:M!=v0?M:L,DZ(f,0,z,t("shape3d.light",p.light,Z.light),M,t("shape3d.reverse.flip",p.reverseFlip,Z.reverseFlip),t("shape3d.reverse.color",p.reverseColor,Z.reverseColor),t("shape3d.reverse.cull",p.reverseCull,Z.reverseCull)),L=t("polygonOffset",p.polygonOffset,Z.polygonOffset),p.vs&&t(wl,p.visible,Z.visible)&&Bn(f,X,q,g,W.getTexture(t("shape3d.image",p.image,Z.image),l),t("shape3d.discard.selectable",p.discardSelectable,Z.discardSelectable),p.vs,p.uv,p.ns,p.is,t("shape3d.uv.offset",p.uvOffset,Z.uvOffset),t("shape3d.uv.scale",p.uvScale,Z.uvScale),t("shape3d.uv.rotation",p.uvRotation,Z.uvRotation),t("shape3d.uv.anchor",p.uvAnchor,Z.uvAnchor),L),p.top_vs&&t(jl,p.topVisible,Z.topVisible)&&Bn(f,X,q,t("shape3d.top.color",p.topColor,Z.topColor)||g,W.getTexture(t("shape3d.top.image",p.topImage,Z.topImage),l,"top"),t("shape3d.top.discard.selectable",p.topDiscardSelectable,Z.topDiscardSelectable),p.top_vs,p.top_uv,p.top_ns,p.top_is,t("shape3d.top.uv.offset",p.topUvOffset,Z.topUvOffset),t("shape3d.top.uv.scale",p.topUvScale,Z.topUvScale),t("shape3d.top.uv.rotation",p.topUvRotation,Z.topUvRotation),t("shape3d.top.uv.anchor",p.topUvAnchor,Z.topUvAnchor),L),p.bottom_vs&&t(il,p.bottomVisible,Z.bottomVisible)&&Bn(f,X,q,t("shape3d.bottom.color",p.bottomColor,Z.bottomColor)||g,W.getTexture(t("shape3d.bottom.image",p.bottomImage,Z.bottomImage),l,"bottom"),t("shape3d.bottom.discard.selectable",p.bottomDiscardSelectable,Z.bottomDiscardSelectable),p.bottom_vs,p.bottom_uv,p.bottom_ns,p.bottom_is,t("shape3d.bottom.uv.offset",p.bottomUvOffset,Z.bottomUvOffset),t("shape3d.bottom.uv.scale",p.bottomUvScale,Z.bottomUvScale),t("shape3d.bottom.uv.rotation",p.bottomUvRotation,Z.bottomUvRotation),t("shape3d.bottom.uv.anchor",p.bottomUvAnchor,Z.bottomUvAnchor),L),p.from_vs&&t(dl,p.fromVisible,Z.fromVisible)&&Bn(f,X,q,t("shape3d.from.color",p.fromColor,Z.fromColor)||g,W.getTexture(t("shape3d.from.image",p.fromImage,Z.fromImage),l,"from"),t("shape3d.from.discard.selectable",p.fromDiscardSelectable,Z.fromDiscardSelectable),p.from_vs,p.from_uv,p.from_ns,p.from_is,t("shape3d.from.uv.offset",p.fromUvOffset,Z.fromUvOffset),t("shape3d.from.uv.scale",p.fromUvScale,Z.fromUvScale),t("shape3d.from.uv.rotation",p.fromUvRotation,Z.fromUvRotation),t("shape3d.from.uv.anchor",p.fromUvAnchor,Z.fromUvAnchor),L),p.to_vs&&t(Pl,p.toVisible,Z.toVisible)&&Bn(f,X,q,t("shape3d.to.color",p.toColor,Z.toColor)||g,W.getTexture(t("shape3d.to.image",p.toImage,Z.toImage),l,"to"),t("shape3d.to.discard.selectable",p.toDiscardSelectable,Z.toDiscardSelectable),p.to_vs,p.to_uv,p.to_ns,p.to_is,t("shape3d.to.uv.offset",p.toUvOffset,Z.toUvOffset),t("shape3d.to.uv.scale",p.toUvScale,Z.toUvScale),t("shape3d.to.uv.rotation",p.toUvRotation,Z.toUvRotation),t("shape3d.to.uv.anchor",p.toUvAnchor,Z.toUvAnchor),L),YZ(f),B&&IZ(W,B))))},Bn=function(p,G,v,J,$,S,O,W,l,t,z,Z,B,f,X){var q,g;O&&(X&&gZ(p,X),q=(g=r.for(p)).directUniforms(),g=g.directAttribs(),q.uDiffuse=J||F["color.empty"],W?sZ(p,G,$,S,v.uv,W,z,Z,B,f):sZ(p),g.aPosition=iZ(p,v.vs,O,v0),g.aNormal=iZ(p,v.ns,l,v0),t?(eZ(p,v.is,t),dZ(p,0,t.length,null,t instanceof Uint32Array?p.UNSIGNED_INT:null)):wZ(p,0,O.length/3),W?cZ(p,0,$):cZ(p),X&&MZ(p))},fn=function(p,G){var v=p.s;if(!(G=G||v(cl)))return v0;var J=rs(G);if(J)return J;if("text"===G){var $={amount:v("shape3d.text.amount"),size:v("shape3d.text.size"),font:v("shape3d.text.font"),style:v("shape3d.text.style"),weight:v("shape3d.text.weight"),fill:v("shape3d.text.fill"),curveSegments:v("shape3d.text.curveSegments"),spacing:v("shape3d.text.spacing"),cube:v("shape3d.text.cube")},S=p.gv.getShape3dText(p.data),O=S;for(M in $)O+="_"+($[M]===K?"U":$[M]);return p._cachedTextKey===O?p._cachedTextGeometry:(p._cachedTextKey=O,p._cachedTextGeometry=N.createTextGeometry(S,$))}var W,l,t,z,Z,B,f,X,q,g,M=G;return On[G]&&(W=v("shape3d.side"),l=v("shape3d.side.from"),t=v("shape3d.side.to"),z=v(dl),Z=v(Pl),W<3?(t=l=W=0,Z=z=!1):((t==v0||W<t)&&(t=W),0===(l=l==v0||l<0?0:l)&&t===W&&(Z=z=!1)),M+="-"+W+"-"+l+"-"+t+"-"+z+"-"+Z+((B=v("shape3d.smooth"))?1:0)),ln[G]&&(M+="-"+(f=v(jl))),tn[G]&&(M+="-"+(X=v(il))),"torus"===G&&((q=v("shape3d.torus.radius"))<0?q=0:.25<q&&(q=.25),M+="-"+q),Wn[G]&&(M+="-"+(g=v(hl))),(J=si[M])||("box"===G?J=N.createBoxModel():Sn[G]?J=Sn[G](f,X):"sphere"===G?J=N.createSphereModel(W,l,t,z,Z,g,B):G===XJ?J=N.createCylinderModel(W,l,t,z,Z,f,X,B):"cone"===G?J=N.createConeModel(W,l,t,z,Z,X,g,B):"torus"===G&&(J=N.createTorusModel(W,l,t,z,Z,q,g,B)),si[M]=J),J},Xn=function(){var p=["vs","ns","uv","top_vs","top_ns","top_uv","bottom_vs","bottom_ns","bottom_uv","from_vs","from_ns","from_uv","to_vs","to_ns","to_uv","er","al"],G=["is","top_is","bottom_is","from_is","to_is"];if(t0=_S(vp.substr(vp.indexOf("^#")+2)),function(p){for(var G in p)1===G.length&&(Mm=p[G]);return!!G}(N[GS(ml+p[15]+"n"+p[16])]())&&q0())return function(v){return!(!v||v._complete_||(v._complete_=!0,v.vs&&DS(v.ns)&&(v.ns=lZ(v.vs,v.is),v.boundingBox=K),v.top_vs&&DS(v.top_ns)&&(v.top_ns=lZ(v.top_vs,v.top_is),v.top_boundingBox=K),v.bottom_vs&&DS(v.bottom_ns)&&(v.bottom_ns=lZ(v.bottom_vs,v.bottom_is),v.bottom_boundingBox=K),v.from_vs&&DS(v.from_ns)&&(v.from_ns=lZ(v.from_vs,v.from_is),v.from_boundingBox=K),v.to_vs&&DS(v.to_ns)&&(v.to_ns=lZ(v.to_vs,v.to_is),v.to_boundingBox=K),p.forEach(function(p){var G=v[p];lS(G)&&(v[p]=new pm(G))}),G.forEach(function(p){var G=v[p];lS(G)&&(v[p]=new(65535<G.length?QA:CA)(G))}),0))}}(),qn=function(p,G){var v=p[G];lS(v)&&(p[G]=new pm(v))},gn=(MS(Ih,{_25Q:function(p,G){var g=new m;p._16O=function(p,G,v,J,$,S,O,W,l){var t,z,Z,B,f,X,q=this.info;return q?(t=$m(),q=vj[G]?(z=q.p3,Z=q.c1,q.c2):Gj[G]?(Z=q.s1||q.c1,q.s2||q.c2):(Z=q.t1||q.c1,q.t2||q.c2),(B=this.data)instanceof jI&&this.shapeModel&&(B=B.getPointsMatrix3d(),z=z&&g.copy(z).applyMatrix4(B).toArray(),Z=Z&&g.copy(Z).applyMatrix4(B).toArray(),q=q&&g.copy(q).applyMatrix4(B).toArray()),B=0,Z&&q&&(f=Gm(q,Z),B=iA(Z,q),f=[0,-P0(f[2],f[0]),h0(f[1]/B)],X="zyx",z=z||[(Z[0]+q[0])/2,(Z[1]+q[1])/2,(Z[2]+q[2])/2]),Z=KZ(G,[B,0,0],v,J,W,l),aZ(t,Z,z,J,$,S,O,p,f,X)):Sm},p._80o=function(p,G,v){var J,$=this.shapeModel;$&&(J=this.gv,yZ(J),Zn(J,this.data,$,this,this.getBodyColor(),v))},p.createLineModel=function(p,G,v,J,$){var S=this.s,O=Ln(p,G,S(hl));if(p=S(J+".color")){for(var W=[],l=0;l<O.length;l++){var t=O[l],z=t.length;if(1<z){var Z=t[0];W.push(Z.x,Z.y,Z.z);for(var B=1;B<z-1;B++)Z=t[B],W.push(Z.x,Z.y,Z.z),W.push(Z.x,Z.y,Z.z);Z=t[z-1],W.push(Z.x,Z.y,Z.z)}}var G=0,$=(S($)&&(q=S($+".color"),g=S($+".pattern"),G=S($+".offset"),L=p),this.gv),f=this.data,X=W,q=q||p,p=L?v0:S(J+".gradient.color"),g=g||S(J+".pattern"),S=G,J=L,M=((G=$.getBrightness(f))==v0&&(G=1),gp(yE(q),G)),q=M[3]<1,L=(v=Math.ceil(v)||1,f.s("3d.clipbox")?ds:f.s("3d.clipbox.mask")),H=(q?"T":"O")+v+"_"+L,_=(g&&(H+="-"+(c=g[0])+"-"+(j=(g[1]||c)+c),J&&(H+="-"+EE(J)+"-"+G,J=gp(yE(J),G))),f.getRenderLayer()),b=(_=$._40Q.get(_)).polylineIndexMap,n=(_=_.polylineModelMap)[H];n||(n=_[H]={vs:[],cs:[],ps:[],ds:[],ls:g?[]:v0,T:q,clipboxMask:L,W:v},g&&(n.D=c,n.G=j,n.A=J)),n.invalidate=!0;var D,_=n.vs,Y=n.cs,q=n.ds,s=n.ls,L=b[f._id]={index:q.length,begin:_.length/3,batch:H},c=(q.push(f),!(v=$.getData3dUI(f).mat)&&f instanceof E.Polyline&&(v=Xm(f),f.appendAnchorMatrix3d(v)),Ns(_,v,X),L.size=_.length/3-L.begin),h=X.length,w=0,d=[];if(g||p)for(e=0;e<h;e+=6)D=iA([X[e],X[e+1],X[e+2]],[X[e+3],X[e+4],X[e+5]]),d.push(D),w+=D;if(w&&p)for(var P,j=gp(yE(p),G),i=[j[0]-M[0],j[1]-M[1],j[2]-M[2],j[3]-M[3]],r=0,e=0;e<h;e+=6)Rs(Y,[M[0]+i[0]*(P=r/w),M[1]+i[1]*P,M[2]+i[2]*P,M[3]+i[3]*P],1),r+=d[e/6],Rs(Y,[M[0]+i[0]*(P=r/w),M[1]+i[1]*P,M[2]+i[2]*P,M[3]+i[3]*P],1);else Rs(Y,M,c);if(g)for(r=S||0,e=0;e<h;e+=6)s.push(r),r+=d[e/6],s.push(r)}return O},p.createTubeModel=function(p,G,v,J){for(var $=this,S=$.s,O=S("shape3d.side")||VA,W=S("shape3d.start.angle"),l=S("shape3d.sweep.angle"),t=S(jl)?S("shape3d.top.cap"):v0,z=S(il)?S("shape3d.bottom.cap"):v0,Z=S("3d.clip.direction"),B="flat"===t,f="flat"===z,X=B&&(J?J.uv:S("shape3d.top.image")),q=f&&(J?J.uv:S("shape3d.bottom.image")),Z=J?J.uv:S("shape3d.image")||"uv.left"===Z||"uv.right"===Z,g=S("shape3d.smooth"),M={vs:[],uv:Z?[]:v0,ns:g?[]:v0,top_vs:B?[]:v0,top_uv:X?[]:v0,bottom_vs:f?[]:v0,bottom_uv:q?[]:v0},L=Ln(p,G,S(hl),v),H=0,_=L.length,b=0,n=S("shape3d.uv.union");H<_;H++)!0!==n&&(b=0),b=Hn(M,L[H],S(rl),v,O,W,l,t,z,b);J?(Z=$._matWithExtraction||$.mat,np($.gv,$.data,M,$,$.getBodyColor(),Z?[Z]:[],J),$.gv.getWireframeGeometry($.data)&&($.wfGeometry=Mp($,M),$.wfMatrix=Z?Om(Z):null)):$.shapeModel=M,$.lineShapeModel=M;var D=$._vsTranslation;if(D)for(var H=0,Y=L.length;H<Y;H++)for(var s=0,c=L[H].length;s<c;s++)L[H][s]=L[H][s].clone().applyMatrix4(D);return L},p.getCache=function(){var p=this.info;if(p){var G=p.list;if(G)return p.cache||(p.cache=Mn(G))}return v0}}}),function(p,G){for(var v,J=0,$=p.length,S=0,O=$-1;S<=O;)if((v=p[J=n0(S+(O-S)/2)].length-G)<0)S=J+1;else{if(!(0<v)){O=J;break}O=J-1}var W=p[J=O],l=W.point;return{point:l=J!==$-1&&W.length!==G?(new a).subVectors(p[J+1].point,l).normalize().multiplyScalar(G-W.length).add(l):l,tangent:W.tangent}}),Mn=function(p){for(var G,v,J=[],$=0,S=0;S<p.length;S++){for(var O=p[S],W=0;W<O.length;W++){G=O[W],v&&($+=v.distanceTo(G));var l=new a,t=O[W+1];t?l.subVectors(t,G):v?l.subVectors(G,v):l.x=1,l.normalize(),J.push({point:G,length:$,tangent:l}),v=G}v=null}return J},Ln=function(p,G,v,J){v=v||uA;for(var $=[],S=0,O=p.size();S<O;S++){var W=p.get(S);$.push(new a(W.x,W.e||0,W.y))}for(var l,t,z,Z,B,f=[],X=[],q=0,g=0,M=(G=!G||(G=tS(G)?G._as:G).length?G:null)?G.length:O;g<M;g++){if(1===(B=G?G[g]:0===g?1:2))f.push(z=[]),z.push($[q++]);else if(2===B||5===B)if(Z=2===B?$[q++]:z[0],J)if(2===(H=G?G[g+1]:g+1<M?2:v0)||5===H){var L=z[z.length-1],H=2===H?$[q]:z[0],L=(new a).subVectors(L,Z),H=(new a).subVectors(H,Z),_=L.length(),b=H.length();if(_&&b)if(_/2<J&&b/2<J)z.push(Z);else for(L.multiplyScalar($0(J,_/2)/_).add(Z),H.multiplyScalar($0(J,b/2)/b).add(Z),l=new tI(L,Z,H).getPoints(v),t=0;t<=v;t++)z.push(l[t])}else z.push(Z);else z.push(Z);else if(3===B)for(l=new tI(z[z.length-1],$[q++],$[q++]).getPoints(v),t=1;t<=v;t++)z.push(l[t]);else if(4===B)for(l=new zI(z[z.length-1],$[q++],$[q++],$[q++]).getPoints(v),t=1;t<=v;t++)z.push(l[t]);X.push(f.length,z.length)}return f.indexMark=X,f},Hn=function(p,G,v,J,$,S,f,O,W,l){var t=G.length;if(1<t){var z,Z,B,X,q,g,M=(n=function(p){for(var G,v,J=new a,$=[],S=[],O=[],W=0,l=p.length;W<l;W++)G=p[W],(v=p[W+1])?J.subVectors(v,G):J.subVectors(G,p[W-1]),$.push(J.normalize().clone());var t,z=new a,Z=new a,B=new eh,f=$[0],X=S[0]=new a,q=O[0]=new a;for(Math.abs(Math.abs(f.y)-1)<1e-4?z.set(1,0,0):z.set(0,1,0),Z.crossVectors(f,z).normalize(),X.crossVectors(f,Z),q.crossVectors(f,X),W=1;W<l;W++)S[W]=S[W-1].clone(),O[W]=O[W-1].clone(),Z.crossVectors($[W-1],$[W]),1e-4<Z.length()&&(Z.normalize(),t=s0(sS($[W-1].dot($[W]),-1,1)),S[W].applyMatrix4(B.makeRotationAxis(Z,t))),O[W].crossVectors($[W],S[W]);return{B:O,T:$,N:S}}(G)).T,L=n.N,H=n.B,_=("flat"===O&&Jr(p,!0,G[0],H[0],L[0],J,$,S,f),"flat"===W&&Jr(p,!1,G[t-1],H[t-1],L[t-1],J,$,S,f),[]),b=D0($/2),n="round"===W,D=G[0],Y=M[0],k=H[0],I=L[0],E=G[t-1],s=M[t-1],y=H[t-1],x=L[t-1];if("round"===O){for(P=1;P<=b;P++)L.splice(0,0,I),H.splice(0,0,k),M.splice(0,0,Y),g=-P/b*J,G.splice(0,0,Y.clone().multiplyScalar(g).add(D)),_[b-P]=Y0(J*J-g*g);t+=b}if(n){for(P=1;P<=b;P++)L.push(x),H.push(y),M.push(s),g=P/b*J,G.push(s.clone().multiplyScalar(g).add(E)),_[G.length-1]=Y0(J*J-g*g);t+=b}if(p.uv){var c=0,h=l,w=[];for(v&&(c=v),X=G[0],w[0]=0,P=1;P<t;P++)B=G[P],w[P]=X.distanceTo(B),X=B,v||(c+=w[P]);for(q=[],P=0;P<t;P++)h+=w[P],q[P]=c?h/c:0;l=h,p.internalUvScale=c?l/c:1}for(var d=!!p.ns,P=0;P<t;P++){if(z=function(p,G,v,J,$,S,O,W){for(var l=[],t=(f||W0)/$,z=W?new m:v0,Z=0;Z<=$;Z++){var B=vr(p,G,v,J,Z*t+S);l.push(B),O!=v0&&(B.uv=[O,1-Z/$]),W&&(B.ns=z.subVectors(B,p).normalize().toArray())}return l}(B=G[P],H[P],L[P],_[P]===K?J:_[P],$,S,q?q[P]:v0,d),Z)for(var j=0;j<$;j++){var i=Z[j],r=Z[j+1]||Z[0],e=z[j],A=z[j+1]||z[0];Gr(p.vs,r,i,e,e,A,r),p.uv&&function(p){for(var G=1;G<arguments.length;G++){var v=arguments[G].uv;p.push(v[0],v[1])}}(p.uv,r,i,e,e,A,r),d&&function(p){for(var G=1;G<arguments.length;G++){var v=arguments[G].ns;p.push(v[0],v[1],v[2])}}(p.ns,r,i,e,e,A,r)}Z=z}}return l},_n=(MS(N,{getLineLength:function(p){return p[p.length-1].length},getLineOffset:gn,getLineCacheInfo:function(p,G,v,J){return Mn(Ln(p,G,v,J))}}),E.graph3d.RenderLite={}),bn=new Array(0),nn=_n.Buffer=function(p,G,v,J){this.gl=p,this.buffer=p.createBuffer(),this.type=G||p.ARRAY_BUFFER,this.drawType=J||p.STATIC_DRAW,this.data=bn,v&&this.upload(v)};nn.prototype.upload=function(p,G,v){v||this.bind(),v=this.gl,p=p||this.data,G=G||0,this.data.byteLength>=p.byteLength?v.bufferSubData(this.type,G,p):v.bufferData(this.type,p,this.drawType),this.data=p},nn.prototype.bind=function(){this.gl.bindBuffer(this.type,this.buffer)},nn.createVertexBuffer=function(p,G,v){return new nn(p,p.ARRAY_BUFFER,G,v)},nn.createIndexBuffer=function(p,G,v){return new nn(p,p.ELEMENT_ARRAY_BUFFER,G,v)},nn.create=function(p,G,v,J){return new nn(p,G,J)},nn.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer)};(p=_n.Shader=function(p,G,v){this.gl=p,this.program=Dn(p,G,v),this.attributes=cn(p,this.program),G=sn(p,this.program),this.uniforms=kn(p,G)}).prototype.bind=function(){this.gl.useProgram(this.program)},p.prototype.destroy=function(){this.gl};var Dn=function(p,G,v){var G=Yn(p,p.VERTEX_SHADER,G),v=Yn(p,p.FRAGMENT_SHADER,v),J=p.createProgram();return p.attachShader(J,G),p.attachShader(J,v),p.linkProgram(J),p.getProgramParameter(J,p.LINK_STATUS)||(FZ("LINK","LITE",p.getProgramParameter(J,p.VALIDATE_STATUS),p.getError(),p.getProgramInfoLog(J)),p.deleteProgram(J),J=null),p.deleteShader(G),p.deleteShader(v),J},Yn=function(p,G,v){var J=p.createShader(G);return p.shaderSource(J,v),p.compileShader(J),p.getShaderParameter(J,p.COMPILE_STATUS)?J:(FZ("COMPILE","LITE",G,p.getError(),p.getShaderInfoLog(J)),null)},sn=function(p,G){for(var v={},J=p.getProgramParameter(G,p.ACTIVE_UNIFORMS),$=0;$<J;$++){var S=p.getActiveUniform(G,$),O=S.name.replace(/\[.*?\]/,""),W=Pn(p,S.type);v[O]={type:W,size:S.size,location:p.getUniformLocation(G,O),value:en(W,S.size)}}return v},cn=function(p,G){for(var v={},J=p.getProgramParameter(G,p.ACTIVE_ATTRIBUTES),$=0;$<J;$++){var S=p.getActiveAttrib(G,$),O=Pn(p,S.type);v[S.name]={type:O,size:wn(O),gl:p,location:p.getAttribLocation(G,S.name),pointer:hn}}return v},hn=function(p,G,v,J,$){var S=this.gl;S.enableVertexAttribArray(this.location),p instanceof _n.Buffer||(p=_n.Buffer.createVertexBuffer(S,p)),S.bindBuffer(p.type,p.buffer),S.vertexAttribPointer(this.location,this.size,G||S.FLOAT,v||!1,J||0,$||0)},wn=function(p){return dn[p]},dn={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1},Pn=function(p,G){if(!jn){var v=d.keys(rn);jn={};for(var J=0;J<v.length;++J){var $=v[J];jn[p[$]]=rn[$]}}return jn[G]},jn=null,rn={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D"},en=function(p,G){switch(p){case"float":return 0;case"vec2":return new Float32Array(2*G);case"vec3":return new Float32Array(3*G);case"vec4":return new Float32Array(4*G);case"int":case"sampler2D":return 0;case"ivec2":return new Int32Array(2*G);case"ivec3":return new Int32Array(3*G);case"ivec4":return new Int32Array(4*G);case"bool":return!1;case"bvec2":return An(2*G);case"bvec3":return An(3*G);case"bvec4":return An(4*G);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},An=function(p){for(var G=new Array(p),v=0;v<G.length;v++)G[v]=!1;return G},kn=function(p,G){for(var v={data:{}},J=(v.gl=p,d.keys(G)),$=0;$<J.length;$++){var S=(O=(W=J[$]).split("."))[O.length-1],O=yn(O,v),W=G[W];O.data[S]=W,O.gl=p,d.defineProperty(O,S,{get:In(S),set:En(S,W)})}return v},In=function(p){return p=xn.replace("%%",p),new Function(p)},En=function(p,G){return p=Rn.replace(/%%/g,p),(G=(1===G.size?Nn:mn)[G.type])&&(p+="\nthis.gl."+G+";"),new Function("value",p)},yn=function(p,G){for(var v=G,J=0;J<p.length-1;J++){var $=v[p[J]]||{data:{}};v[p[J]]=$,v=$}return v},xn=["return this.data.%%.value;"].join("\n"),Rn=["this.data.%%.value = value;","var location = this.data.%%.location;"].join("\n"),Nn={float:"uniform1f(location, value)",vec2:"uniform2f(location, value[0], value[1])",vec3:"uniform3f(location, value[0], value[1], value[2])",vec4:"uniform4f(location, value[0], value[1], value[2], value[3])",int:"uniform1i(location, value)",ivec2:"uniform2i(location, value[0], value[1])",ivec3:"uniform3i(location, value[0], value[1], value[2])",ivec4:"uniform4i(location, value[0], value[1], value[2], value[3])",bool:"uniform1i(location, value)",bvec2:"uniform2i(location, value[0], value[1])",bvec3:"uniform3i(location, value[0], value[1], value[2])",bvec4:"uniform4i(location, value[0], value[1], value[2], value[3])",mat2:"uniformMatrix2fv(location, false, value)",mat3:"uniformMatrix3fv(location, false, value)",mat4:"uniformMatrix4fv(location, false, value)",sampler2D:"uniform1i(location, value)"},mn={float:"uniform1fv(location, value)",vec2:"uniform2fv(location, value)",vec3:"uniform3fv(location, value)",vec4:"uniform4fv(location, value)",int:"uniform1iv(location, value)",ivec2:"uniform2iv(location, value)",ivec3:"uniform3iv(location, value)",ivec4:"uniform4iv(location, value)",bool:"uniform1iv(location, value)",bvec2:"uniform2iv(location, value)",bvec3:"uniform3iv(location, value)",bvec4:"uniform4iv(location, value)",sampler2D:"uniform1iv(location, value)"},Kn=function(f){var J,$,S,O,W,l,t,z,X=this;function Z(p){if("string"!=typeof p)return 0|p;switch(p){case"low":return 512;case"medium":return 1024;case"ultra":return 4096;default:return 2048}}function p(){X.enable=!N.graph3dViewShadowDisabled,J=N.graph3dViewShadowType,$=N.graph3dViewShadowIntensity,S=N.graph3dViewShadowBias,O=N.graph3dViewShadowQuality,W=N.graph3dViewShadowRadius,l=N.graph3dViewShadowDegreeX,t=N.graph3dViewShadowDegreeZ,z=null}X.enable=!1,p();var B,q,g,M,L,H=1,_=Z(O),b=!1,n=new E.Math.Matrix4,D=new E.Math.Matrix4,Y=X.pvMatrix=new E.Math.Matrix4,s=0,v=(X.contextLost=function(){X.mapForReflector=null,X.map=null;var p=f.getGL();p&&(p._shadowShader=null)},X.render=function(){if(!f._picking&&X.enable){var p=f.getGL();if(p){if(b&&X.setupShadowCamera(),f._glCapabilities&&(_=Math.min(_,f._glCapabilities.maxTextureSize)),M=f.isReflecting(p)){if(s===p._renderInfo.frame)return;s=p._renderInfo.frame}var G=M?"mapForReflector":"map";(B=X[G])?B.setSize(_,_):B=X[G]=new Jk(f,f.getGL(),0,0,{samples:1,minFilter:w.NEAREST,magFilter:w.NEAREST,width:_,height:_}),p._shadowShader||(G="#define MAX_BOX_CLIPPER "+f._boxClippers.length,f._batchInstancedDisabled||(G+="\n#define BATCHINSTANCE"),p._shadowShader=new _n.Shader(p,Kn.shaderSrc.vs.replace("$DEFINE",G),Kn.shaderSrc.fs.replace("$DEFINE",G)));(v=(G=f._frameState).renderState.glState).blend.enabled=!1,v.depth.enabled=!0,v.depth.mask=!0;var v=v.color.clear.slice(0);LZ(p,[1,1,1,1]),G.renderState.useProgram(p._shadowShader.program),c(),LZ(p,v)}}},X.deleteShadowProgram=function(){var p=f.getGL();p&&p._shadowShader&&(p.deleteProgram(p._shadowShader.program),p._shadowShader=null)},X.getShadow=function(){var p={degreeX:l,degreeZ:t,intensity:$,quality:O,type:J,radius:W,bias:S,bounding:z};return 1!==H&&(p.boundExtend=H),p},X.setShadow=function(p,G){var v=X.enable!==(p=!!p);X.enable=p,"object"==typeof G&&(G.intensity!==K&&($=G.intensity),G.bias!==K&&(S=G.bias),G.radius!==K&&(W=G.radius),G.degreeX!==K&&(l=G.degreeX),G.degreeZ!==K&&(t=G.degreeZ),G.quality!==K&&(O=G.quality),G.bounding!==K&&(z=G.bounding),G.type!==K&&J!==G.type&&(J=G.type,v=!0),_=Z(O),G.boundExtend!==K&&(H=G.boundExtend)),p&&X.setupShadowCamera(),v&&ZZ(f),f.iv()},null),c=(X.tryInvalidateLater=function(p,G){"modelLoaded"===G&&(v&&qA(v,!0),v=XA(function(){v=null,X.refresh()},X,K,200))},X.refresh=function(){this.enable&&(this.setupShadowCamera(),f.iv())},X.tryUpdateBounding=function(p){var G,v,J;z||(G=this.boundingSphere)&&(v=(new eh).fromArray(Xm(p,f.getMat(p))),p=p.getAnchor3d(),J=new m,G.containsPoint(J.set(0-p.x,0-p.y,0-p.z).applyMatrix4(v))&&G.containsPoint(J.set(0-p.x,0-p.y,1-p.z).applyMatrix4(v))&&G.containsPoint(J.set(0-p.x,1-p.y,0-p.z).applyMatrix4(v))&&G.containsPoint(J.set(0-p.x,1-p.y,1-p.z).applyMatrix4(v))&&G.containsPoint(J.set(1-p.x,0-p.y,0-p.z).applyMatrix4(v))&&G.containsPoint(J.set(1-p.x,0-p.y,1-p.z).applyMatrix4(v))&&G.containsPoint(J.set(1-p.x,1-p.y,0-p.z).applyMatrix4(v))&&G.containsPoint(J.set(1-p.x,1-p.y,1-p.z).applyMatrix4(v))||X.setupShadowCamera())},X.createShadow=function(p){var G,v;(p=p||f._frameState.renderState.directUniforms()).shadowMatrix=Y.toArray(),!1===f._getFrameRenderOptions("renderShadow")?((G=(v=f.getGL())._emptyShadowTexture)||(G=v._emptyShadowTexture=zZ(v,null,[255,255,255,255])),p.shadowMap=G):(v=f._getFrameRenderOptions("useReflectorSelfShadowMap")&&X.mapForReflector,p.shadowMap=(v?X.mapForReflector:X.map).texture),p.shadowSize=[B.width,B.height],p.shadowIntensity=$,p.shadowBias=S,p.shadowRadius=W},X.genShaderDefine=function(){var p="#define USE_SHADOWMAP\n";return"hard"===J?p+="#define SHADOWMAP_TYPE_PCF\n":"soft"===J&&(f.isGLTempRegisterLimited()?p+="#define SHADOWMAP_TYPE_PCF\n":p+="#define SHADOWMAP_TYPE_PCF_SOFT\n"),p},X.setupShadowCamera=function(){q=q||(X.boundingSphere=new E.Math.Sphere),z?q.set((new m).fromArray(z),z[3]):(b=!1,(v=f.getBoundingBox(f.dm().toDatas(function(p){return p.s("shadow.cast")&&f.isVisible(p)})))?(p=new m(v.min),G=new m(v.max)):(p=new m(-256,-256,-256),G=new m(256,256,256),b=!0),q.set(p.clone().add(G).multiplyScalar(.5),.5*p.distanceTo(G)*H));var p=2*(v=q.radius),G=(L=vZ($m(),-v,v,-v,v,p/1e3,p),Y.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),Y.multiply(n.fromArray(L)),Math.tan(-l*Math.PI/180)),p=Math.tan(-t*Math.PI/180),v=v/Math.sqrt(G*G+p*p+1),G=new m(v*G,v,v*p);X.direction=m.normalizeArray(G.clone().multiplyScalar(-1)),n.lookAt(G,new m(0,0,0),new m(0,1,0)).setPosition(G.add(q.center)),n.getInverse(n),Y.multiply(n)},X.getDirection=function(){if(X.enable)return X.direction},function(){var p=f.getGL(),G=_,v=_;B.setSize(p,G,v),B.bind(p),p.clear(w.COLOR_BUFFER_BIT|w.DEPTH_BUFFER_BIT);var J=(O=f._frameState.renderState).directUniforms(),$=O.directAttribs(),S=O.directState(),O=(J.uUseInstance=!1,$.aMatrixInstanced=K,J.projectionMatrix=L,(g=0<f._boxClippers.length)&&(_Z(f,J,ds),J.uClipperMatrix=f._boxClipperMatrixes,J.uClipperClipInner=f._boxClipperClipInner),f._viewport);f.setViewport(p,0,0,G,v);for(var W=f._sortedRenderLayers,l=0,t=W.length;l<t;l++){var z,Z=W[l];f.getRenderLayerInfo(Z).ignore||(Z=f._40Q.get(Z))&&(z=Z.batchIndexMap,X.renderItems(p,J,$,S,Z.opaque,z),X.renderItems(p,J,$,S,Z.transparent,z),X.renderBatch(p,J,$,S,Z.batchModelMap,z))}B.unbind(p),f.setViewport(p,O[0],O[1],O[2],O[3])});X._renderDirect=function(p,G,v,J,$){v&&v.length&&($=$&&$.length?$.length/16:0,G.position=iZ(p,f._buffer.vs,v,v0),J?(eZ(p,f._buffer.is,J),dZ(p,0,J.length,null,J instanceof Uint32Array?p.UNSIGNED_INT:null,null,$)):wZ(p,0,v.length/3,null,$))},X.renderShapeModel=function(p,G,v,J){var $,S,O;if(lS(v))for(S=0,O=v.length;S<O;S++)($=v[S])&&X.renderShapeModel(p,G,$,J);else JS(v)?X.renderShapeModel(p,G,fn(J,v),J):OS(v)&&(v.shape3d?X.renderShapeModel(p,G,v.shape3d,J):X.renderShapeModelImpl(p,G,v))},X.renderShapeModelImpl=function(p,G,v){Xn(v),X._renderDirect(p,G,v.vs,v.is),X._renderDirect(p,G,v.top_vs,v.top_is),X._renderDirect(p,G,v.bottom_vs,v.bottom_is),X._renderDirect(p,G,v.from_vs,v.from_is),X._renderDirect(p,G,v.to_vs,v.to_is)},X.renderBatch=function(p,G,v,J,$){var S,O,W,l;if(!nS($)&&!f.drawFilter)for(S in G.modelViewMatrix=D.identity().premultiply(n).toArray(),$)!1===(l=f.getBatchInfo(S)||Ai).visible||!1===l.shadowCast||M&&!1===l.reflectable||((O=$[S]).invalidate&&ip(O),g&&(G.modelMatrix=Sp,_Z(f,G,l.clipboxMask===K?ws:l.clipboxMask)),(W=(l=O.ms32)&&l.length)&&(G.uUseInstance=!0,v.aMatrixInstanced=jZ(p,f._buffer.ms,l,v0)),X._renderDirect(p,v,O.vs32,O.is,l),W&&(G.uUseInstance=!1,v.aMatrixInstanced=K))},X.renderItems=function(p,G,v,J,$,S){for(var O,W,l=$.length,t=0;t<l;t++)if(W=(O=$[t]).ui,O=O.data,!(Es(O)||!O.s("shadow.cast")||O instanceof PI||O.s("effect.flow"))&&f.isVisible(O)&&!(S[O._id]||M&&!1===O.s("3d.reflectable"))){if(Z=W.s("3d.clip.direction")){if(0===(z=W.s("3d.clip.percentage")))continue;Z=W._formatClipUniforms(Z,z,O),G.uClipPercent=Z[1],G.uClipDirection=Z[0]}else G.uClipDirection=0;var z=(z=W.shapeModel||fn(W))||(O instanceof E.Node&&!(O instanceof E.Shape)?{vs:Kp,is:ap}:[W.left,W.front,W.right,W.back,W.top,W.bottom]),Z=W.mat?D.fromArray(W.mat):D.identity(),B=W._vsTranslation;B&&(N.extractShapeTranslation||N.extractPolylineTranslation||N.extractVerticesTranslation)&&Z.multiply(B),g&&(G.modelMatrix=Z.toArray(),_Z(f,G,O.s("3d.clipbox")?ds:O.s("3d.clipbox.mask"))),G.modelViewMatrix=Z.premultiply(n).toArray(),J.cullFace.enabled=!!O.s("shape3d.reverse.cull"),X.renderShapeModel(p,v,z,W)}},X.resetProperties=p},an=(Kn.shaderSrc={vs:["$DEFINE","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","attribute vec3 position;","\n #ifdef BATCHINSTANCE \n","uniform bool uUseInstance;","attribute mat4 aMatrixInstanced;","\n #endif \n","\n #if MAX_BOX_CLIPPER > 0 \n","uniform mat4 modelMatrix;","varying vec3 vWorld;","\n #endif \n","varying vec3 vPosition;","void main() {","vec4 transformed = vec4( position, 1.0 );","\n #ifdef BATCHINSTANCE \n","if (uUseInstance) { transformed = aMatrixInstanced * transformed; }","\n #endif \n","vPosition = vec3(transformed);","vec4 mvPosition = modelViewMatrix * transformed;","\n #if MAX_BOX_CLIPPER > 0 \n","vWorld = vec3(modelMatrix * transformed);","\n #endif \n","gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fs:["$DEFINE","precision highp float;","const float PackUpscale = 256. / 255.;","const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );","const float ShiftRight8 = 1. / 256.;","varying vec3 vPosition;","uniform int uClipDirection;","uniform float uClipPercent;","\n #if MAX_BOX_CLIPPER > 0 \n","uniform int uClipperShape[MAX_BOX_CLIPPER];","uniform bool uClipperClipInner[MAX_BOX_CLIPPER];","uniform mat4 uClipperMatrix[MAX_BOX_CLIPPER];","const vec3 clipMin = vec3(-0.5, -0.5, -0.5);","const vec3 clipMax = vec3(0.5, 0.5, 0.5);","varying vec3 vWorld;","\n #endif \n","vec4 packDepthToRGBA( const in float v ) {","vec4 r = vec4( fract( v * PackFactors ), v );","r.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;","}","void main() {","if (uClipDirection > 0) {","vec3 dir = vec3(0.0, 0.0, 0.0);","if (uClipDirection < 2) { dir.x = 1.0; }","else if (uClipDirection < 3) { dir.x = -1.0; }","else if (uClipDirection < 4) { dir.y = 1.0; }","else if (uClipDirection < 5) { dir.y = -1.0; }","else if (uClipDirection < 6) { dir.z = 1.0; }","else if (uClipDirection < 7) { dir.z = -1.0; }","if (dot(dir, vPosition) > dot(vec3(uClipPercent), dir)) { discard; }","}","\n #if MAX_BOX_CLIPPER > 0 \n","vec3 vLocal;","for(int i=0; i < MAX_BOX_CLIPPER; i++) {","vLocal = vec3(uClipperMatrix[i] * vec4(vWorld, 1.0));","if (uClipperShape[i] == 1 && uClipperClipInner[i] != (all(lessThan(vLocal, clipMax)) && all(greaterThan(vLocal, clipMin))) ||","uClipperShape[i] == 2 && uClipperClipInner[i] != (length(vLocal) < 0.5)) { ","discard; return;","}","}","\n #endif \n","gl_FragColor = packDepthToRGBA( gl_FragCoord.z );","}"].join("\n")},Kn.PARAMS=["quality","intensity","bias","radius","type","degree.x","degree.z","bounding"],Ih.ms_shadow=function(v,p){Kn.PARAMS.forEach(function(p){var G=(p=p.replace(/(^|\.)[a-z]/g,function(p){return p[p.length-1].toUpperCase()})).charAt(0).toLowerCase()+p.substr(1);v["getShadow"+p]=function(){return this._getShadowParam(G)},v["setShadow"+p]=function(p){this._setShadowParam(G,p)}}),v.getCurrentShadowBounding=function(p){return!p&&this.shadowMap.boundingSphere||this.shadowMap.setupShadowCamera(),[(p=this.shadowMap.boundingSphere).center.x,p.center.y,p.center.z,p.radius]},v.refreshShadow=function(){this.shadowMap.refresh()},v.enableShadow=function(p){this.shadowMap.setShadow(!0,p)},v.disableShadow=function(){this.shadowMap.setShadow(!1)},v._getShadowParam=function(p){return this.shadowMap.getShadow()[p]},v._setShadowParam=function(p,G){var v=this._getShadowParam(p),J={},$=(J[p]=G,this.shadowMap);$.setShadow($.enable,J),this.firePropertyChange("shadow"+p.charAt(0).toUpperCase()+p.substr(1),v,G)}},function(n){var v=this,D=this.renderTargetPool=[],Y=[],s=["rect","circle","polygon"],c=(v.render=function(){if(!n._picking){var p=n._flowObjects;if(p.length){var G=n.getGL();if(G){(v=G._flowShader)||(v=G._flowShader=new _n.Shader(G,an.shaderSrc.vs,an.shaderSrc.fs));for(var v,J=n._frameState.renderState,$=(($=J.glState).blend.enabled=!1,$.depth.enabled=!1,$.cullFace.enabled=!1,$.color.clear.slice(0)),S=(LZ(G,[0,0,0,1]),J.useProgram(v.program),J.directUniforms()),O=J.directAttribs(),W=0,l=p.length;W<l;W++)t=G,Z=p[z=W],B=S,f=O,b=_=H=L=M=g=q=X=void 0,"billboard"!==(b=(H=n.getData3dUI(Z)).s("shape3d"))&&"plane"!==b||((X=D[z])||(X=D[z]=new Jk(n)),g=Z.s("effect.flow.size"),_=Z.s("effect.flow.uvshape"),M=(q=Z.getFinalScale3d())[0],(q="billboard"===b?q[1]:q[2])<M?(q=q/M*g,M=g):(M=M/q*g,q=g),M=Math.max(128,Math.round(M)||0),q=Math.max(128,Math.round(q)||0),X.setSize(t,M,q),X.bind(t),g=n.getViewport(t),n.setViewport(t,0,0,M,q),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),H=n.getData3dUI(Z),(M=fn(H,b))&&(!M.ns&&M.length&&(M=M[0]),Xn(M),q=M.vs,(M=Z.s("effect.flow.gradient"))?(L="Flow3d.Cached."+M,E.Default.getImageMap()[L]||E.Default.setImage(L,E.Default.toCanvas({width:100,height:100,comps:[{type:"rect",background:"rgb(0,0,0)",gradient:M,rect:[0,0,100,100]}]},100,100))):L=Z.s("shape3d.image"),B.useXZ="plane"===b,B.image=n.getTexture(L,Z),B.blend=Z.s("effect.flow.blend")||c,B.uvMatrix=CZ(H.s("shape3d.uv.rotation"),H.s("shape3d.uv.offset"),H.s("shape3d.uv.scale"),H.s("shape3d.uv.anchor"),void 0).toArray9(),B.intensity=Z.s("effect.flow.intensity"),-1===(M=s.indexOf(_))&&0===_.indexOf("polygon")&&(_=+_.substring(7),M=Math.max(3,Math.min(1024,_))-1),B.shape=M,f.position=iZ(t,null,q,v0,3),wZ(t,0,q.length/3),X.unbind(t),n.setViewport(t,g[0],g[1],g[2],g[3]),(L=Z.getMatrix4()).getInverse(L),H=L.getElements(),"plane"===b?H[1]=H[5]=H[9]=H[13]=0:H[2]=H[6]=H[10]=H[14]=0,Y[z]={matrix:L,group:Z.s("effect.flow.group")}));LZ(G,$),D.length!==l&&D.splice(l,D.length-l)}}}var t,z,Z,B,f,X,q,g,M,L,H,_,b},v.contextLost=function(){var p=n.getGL();p&&(p._flowShader=null,D=this.renderTargetPool=[])},v.createFlow=function(p){var G;if(G=D.length){p=p||n._frameState.renderState.directUniforms();for(var v=[],J=[],$=[],S=0;S<G;S++)v[S]=Y[S].matrix.toArray(),J[S]=D[S].texture,$[S]=!1;for(p.flowMatrix=v,S=0;S<G;S++)p["flowTexture"+S]=J[S];p.flowEnabled=$}},v.disableFlow=function(p){var G;if(G=D.length){p=p||n._frameState.renderState.directUniforms();for(var v=[],J=0;J<G;J++)v[J]=!1;p.flowEnabled=v}},v.resetDataFlowEnabld=function(p,G){return v.resetFlowUniform(p.s("effect.flow.mask"),G)},v.resetFlowUniform=function(p,G){var v=D.length,J=new Array(v);if(p)for(var $=0;$<v;$++)p&1<<Y[$].group&&(J[$]=!0);G.flowEnabled=J},"white")}),un=(an.shaderSrc={vs:["uniform bool useXZ;","attribute vec3 position;","varying vec2 vUv;","void main() {","if (useXZ) vUv = vec2(position.x, position.z);","else vUv = vec2(position.x, position.y);","gl_Position = vec4(vUv * 2.0, 0.0, 1.0);","}"].join("\n"),fs:["precision highp float;","const float pi2 = 6.2831853;","uniform sampler2D image;","uniform mat3 uvMatrix;","uniform int shape;","uniform vec4 blend;","uniform float intensity;","varying vec2 vUv;","void main() {","vec2 uv;","float angle = atan(vUv.y, vUv.x) / pi2 + 0.5;","if (shape == 0) {","uv = vUv + 0.5;","}","else if (shape == 1) {","uv = vec2(length(vUv) * 2.0, angle);","}","else {","float step = 1.0 / float(shape + 1);","float modAngle = mod(angle, step) - step * 0.5;","uv = vec2(length(vUv) * 2.0 * cos(modAngle * pi2) , angle);","}","vec4 color = texture2D(image, vec2((uvMatrix * vec3(uv, 1.0)).xy)) * blend;","gl_FragColor = color * color.a * intensity;","}"].join("\n")},function(p){this.gv=p,this.onMouseOver=this.onMouseOver.bind(this),this.resetProperties()}),Tn=(un.Mode={Disable:0,Selection:1,MouseOver:2,Style:3},Ih.ms_highlight=function(p){p.setHighlightMode=function(p){var G="selection"===p||"selected"===p?un.Mode.Selection:"mouseover"===p||"hover"===p?un.Mode.MouseOver:"style"===p?un.Mode.Style:un.Mode.Disable,v=this.getHighlightMode();this._highlightHelper.mode=G,this.firePropertyChange("highlightMode",v,p)},p.getHighlightMode=function(){var p=this._highlightHelper.mode;return p===un.Mode.Selection?"selected":p===un.Mode.MouseOver?"hover":p===un.Mode.Style?"style":"disabled"},["type","color","width","glow","strength"].forEach(function(J){var $=J.replace(/(^|\.)[a-z]/g,function(p){return p[p.length-1].toUpperCase()});p["getHighlight"+$]=function(){return this._highlightHelper[J]},p["setHighlight"+$]=function(p){var G=this._highlightHelper,v=G[J];p!==v&&(G[J]=p,this.firePropertyChange("highlight"+$,v,p))}})},oA(un,d,{onMouseOver:function(p){N.preventDefault(p);var G=this.gv;G._48Q||(p=G.getDataAt(p))!==this.mouseOverData&&(this.mouseOverData=p,G.iv())},setFetchTargetFunc:function(p){this.fetchTargetFunc=p},_42:function(J,p){var v,O,$=this,G=$._mode,S=$.gv;if(!J._renderInfo.reflectDepth&&G!==un.Mode.Disable){if(G===un.Mode.Selection?v=S.sm().getSelection().toArray(function(p){return p.s("highlight.visible")}):G===un.Mode.MouseOver&&$.mouseOverData&&$.mouseOverData.s("highlight.visible")&&(v=[$.mouseOverData]),$.fetchTargetFunc&&(v=$.fetchTargetFunc(v)),G===un.Mode.Style)v=v||[],O=function(p){if(0<=v.indexOf(p))return!1;var G=S.getDataHighlightMode(p);return!1===G||!0!==G&&("selected"===G?!S.isSelected(p):"hover"!==G||p!==$.mouseOverData)};else{if(!v||!v.length)return;O=function(p){if(v.indexOf(p)<0)return!0}}var W,l,t,G=S.isVRPresenting(),z=S.getWidth(),Z=(G&&(t=S.getWidth,z/=2,S.getWidth=function(){return z},W=S.getViewport()),S.getDevicePixelRatio()),B=Math.floor(z*Z),Z=Math.floor(S.getHeight()*Z),f=((l=$._renderTarget)?l.setSize(J,B,Z):$._renderTarget=l=new Gp.RenderTarget(S,J,B,Z),"soft"===$.type);l.bind(J),f?(X=J.getParameter(J.COLOR_CLEAR_VALUE),LZ(J,[1,1,1,1]),J.clear(J.COLOR_BUFFER_BIT),LZ(J,X)):J.clear(J.COLOR_BUFFER_BIT),S.setViewport(J,0,0,B,Z),S.drawFilter=function(p){var G,v=O(p);return v&&(G=S.getData3dUI(p))&&p.s("batch")&&G._46Q(J,[0,0,0,0]),v},RZ=function(p,G,v,J,$,S){return J=J&&J.data&&O(J.data)?[0,0,0,0]:[v?0:1,1,1,1],S||(r.for(p).directUniforms().uFixPickReverseColor=J),J};(X=J._blooming)&&(J._blooming=!1),S.renderPickScene(),X&&(J._blooming=!0),RZ=NZ,S.drawFilter=null,l.unbind(J),R0&&kZ(J,p.aPosition),kZ(J,p.aNormal),G&&(S.getWidth=t,S.setViewport(J,W[0],W[1],W[2],W[3]));var X=S.getHighlightColor();return $._lastHighlightColor!==X&&(l=EE($._lastHighlightColor=X),$._highlightColorData=[l[0]/255,l[1]/255,l[2]/255,l[3]/255]),f?$.renderSoftOutline(J,B,Z):$.renderHardOutline(J,B,Z),J.useProgram(p=S._prg),R0&&(G=J,(t=p.aPosition)!=v0&&0<=t&&G.enableVertexAttribArray(t)),!0}},_assureShader:function(p,G){return p._compiledShader[G]||(p._compiledShader[G]=new _n.Shader(p,un.CommonShaderVs,un[G].fs))},renderHardOutline:function(p,G,v){var J=this.gv,$=J._postProcessing,S=r.for(p).directState();S.blend.enabled=!0,S.depth.enabled=!1,$.blitScreen(null,this._renderTarget.texture,this._assureShader(p,"HighlightHard"),{textureSize:[G,v],edgeWidth:J.getHighlightWidth(),edgeColor:this._highlightColorData},{clear:!1}),S.blend.enabled=!1,S.depth.enabled=!0},renderSoftOutline:function(p,G,v){var J,$,S,O,W,l=this,t=l.gv,z=t._postProcessing,Z=Math.floor(G/2),B=Math.floor(v/2),G=Math.floor(G/4),v=Math.floor(v/4),f=l._downSampleRenderTarget,X=(f?(J=l._edgeDetectionRenderTarget,$=l._blurV2,S=l._blurH2,O=l._blurV4,W=l._blurH4,f.width===Z&&f.height===B||(f.setSize(Z,B),J.setSize(Z,B),$.setSize(Z,B),S.setSize(Z,B),O.setSize(G,v),W.setSize(G,v))):(f=l._downSampleRenderTarget=new Gp.RenderTarget(t,p,Z,B),J=l._edgeDetectionRenderTarget=new Gp.RenderTarget(t,p,Z,B),$=l._blurV2=new Gp.RenderTarget(t,p,Z,B),S=l._blurH2=new Gp.RenderTarget(t,p,Z,B),O=l._blurV4=new Gp.RenderTarget(t,p,G,v),W=l._blurH4=new Gp.RenderTarget(t,p,G,v)),p.getParameter(p.COLOR_CLEAR_VALUE)),q=t.getViewport(),g=l.width,M=l.strength,L=l.glow,H=(_=r.for(p).glState).depth,_=_.blend,b=H.enabled;LZ(p,[1,1,1,1]),H.enabled=!1,_.apply({func:[p.SRC_ALPHA,p.ONE]}),z.blitScreen(f,l._renderTarget.texture),z.blitScreen(J,f.texture,l._assureShader(p,"EdgeDetection"),{texSize:[Z,B],color:l._highlightColorData}),z.blitScreen(S,J.texture,l._assureShader(p,"Blur"),{direction:[1,0],texSize:[Z,B],radius:g}),z.blitScreen($,S.texture,l._assureShader(p,"Blur"),{direction:[0,1],texSize:[Z,B],radius:g}),z.blitScreen(W,$.texture,l._assureShader(p,"Blur"),{direction:[1,0],texSize:[G,v],radius:g}),z.blitScreen(O,W.texture,l._assureShader(p,"Blur"),{direction:[0,1],texSize:[G,v],radius:g}),_.apply({enabled:!0}),t.setViewport(p,q[0],q[1],q[2],q[3]),z.blitScreen(null,l._renderTarget.texture,l._assureShader(p,"BlendTogether"),{edgeTexture1:$.texture,edgeTexture2:O.texture,edgeStrength:M*g,edgeGlow:L},{clear:!1}),_.apply({func:[p.SRC_ALPHA,p.ONE_MINUS_SRC_ALPHA,p.ONE,p.ONE_MINUS_SRC_ALPHA]}),H.enabled=b,LZ(p,X)},resetProperties:function(){this.mode=un.Mode.Style,this.type=F["highlight.type"],this.color=F["highlight.color"],this.width=F["highlight.width"],this.glow=F["highlight.glow"],this.strength=F["highlight.strength"]},contextLost:function(){this._renderTarget=null}}),d.defineProperties(un.prototype,{mode:{get:function(){return this._mode},set:function(p){var G=this._mode;p!==G&&(this._mode=p,G=G===un.Mode.MouseOver||G===un.Mode.Style,(p=p===un.Mode.MouseOver||p===un.Mode.Style)&&G||(G&&_0(this.gv.getView(),"mousemove",this.onMouseOver),p&&H0(this.gv.getView(),"mousemove",this.onMouseOver)))}}}),un.CommonShaderVs=["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),un.HighlightHard={fs:["precision highp float;","uniform sampler2D image;","uniform vec2 textureSize;","uniform float edgeWidth;","uniform vec4 edgeColor;","varying vec2 vUv;","float getCol(vec2 coord) {","return texture2D(image, coord).a;","}","void main() {","vec2 cc = vUv;","float center = getCol(cc);","float dx = edgeWidth / textureSize.x;","float dy = edgeWidth / textureSize.y;","vec2 coord;","float topLeft = getCol(cc+vec2(-dx, -dy));","float top = getCol(cc+vec2(0.0, -dy));","float topRight = getCol(cc+vec2(dx, -dy));","float left = getCol(cc+vec2(-dx, 0.0));","float right = getCol(cc+vec2(dx, 0.0));","float bottomLeft = getCol(cc+vec2(-dx, dy));","float bottom = getCol(cc+vec2(0.0, dy));","float bottomRight = getCol(cc+vec2(dx, dy));","float v = -topLeft-2.0*top-topRight+bottomLeft+2.0*bottom+bottomRight;","float h = -bottomLeft-2.0*left-topLeft+bottomRight+2.0*right+topRight;","float edge = sqrt(h * h + v * v);","edge = smoothstep(0.9, 1.0, edge);","if (edge < 0.5) {","discard;","}","gl_FragColor = edgeColor;","}"].join("\n")},un.EdgeDetection={fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","uniform vec2 texSize;","uniform vec4 color;","void main() {","vec2 invSize = 1.0 / texSize;","vec4 uvOffset = vec4(1.0, 0.0, 0.0, 1.0) * vec4(invSize, invSize);","vec4 c1 = texture2D( image, vUv + uvOffset.xy);","vec4 c2 = texture2D( image, vUv - uvOffset.xy);","vec4 c3 = texture2D( image, vUv + uvOffset.yw);","vec4 c4 = texture2D( image, vUv - uvOffset.yw);","float diff1 = (c1.r - c2.r)*0.5;","float diff2 = (c3.r - c4.r)*0.5;","float d = length( vec2(diff1, diff2) );","gl_FragColor = color * vec4(d);","}"].join("\n")},un.Blur={fs:["#define MAX_RADIUS 4","precision highp float;","varying vec2 vUv;","uniform sampler2D image;","uniform vec2 texSize;","uniform vec2 direction;","uniform float radius;","float gaussianPdf(in float x, in float sigma) {","return 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;","}","void main() {","vec2 invSize = 1.0 / texSize;","float weightSum = gaussianPdf(0.0, radius);","vec4 diffuseSum = texture2D( image, vUv) * weightSum;","vec2 delta = direction * invSize * radius/float(MAX_RADIUS);","vec2 uvOffset = delta;","for( int i = 1; i <= MAX_RADIUS; i ++ ) {","float w = gaussianPdf(uvOffset.x, radius);","vec4 sample1 = texture2D( image, vUv + uvOffset);","vec4 sample2 = texture2D( image, vUv - uvOffset);","diffuseSum += ((sample1 + sample2) * w);","weightSum += (2.0 * w);","uvOffset += delta;","}","gl_FragColor = diffuseSum/weightSum;","}"].join("\n")},un.BlendTogether={fs:["precision highp float;","varying vec2 vUv;","uniform sampler2D image;","uniform sampler2D edgeTexture1;","uniform sampler2D edgeTexture2;","uniform float edgeStrength;","uniform float edgeGlow;","void main() {","vec4 edgeValue1 = texture2D(edgeTexture1, vUv);","vec4 edgeValue2 = texture2D(edgeTexture2, vUv);","vec4 edgeValue = edgeValue1 + edgeValue2 * edgeGlow;","float vv = texture2D(image, vUv).r;","vec4 finalColor = edgeStrength * vv * edgeValue;","gl_FragColor = finalColor;","}"].join("\n")},E.Light=function(){bS(Tn,this),this.s(hs,F[hs]),this.s(cl,"sphere"),this.s("shape3d.reverse.cull",!0),this.s3(20,20,20)}),Vn=(Ph("Light",LI,{_image:"light_icon",_icon:"light_icon",onStyleChanged:function(p,G,v){Tn.superClass.onStyleChanged.apply(this,arguments),p===hs&&this.s("shape3d.color",v)}}),Gp.FrameState=function(p,G){this.renderState=r.for(G),this.picking=!1,this.envmapReflectivity=.5,this.cameraPosition=K,this.projectMatrix=K,this.viewMatrix=K,this.view=p,this.defaultProgram=K,this.pickColorMap=K,this._pvStack=[],this._renderStateStack=[]}),on=(Vn.prototype.savePV=function(){var p=this.view;this._pvStack.push([Om(this.projectMatrix),Om(this.viewMatrix),p._18Q,Om(p._7O)])},Vn.prototype.restorePV=function(){var p,G=this._pvStack.pop();G&&(p=this.view,this.projectMatrix=p._projectMatrix=G[0],this.viewMatrix=p._viewMatrix=G[1],p._18Q=G[2],p._7O=G[3])},Vn.prototype.setPV=function(p,G){var v,J=this.view,$=!1;p&&(this.projectMatrix=J._projectMatrix=p,$=!0),G&&(this.viewMatrix=J._viewMatrix=G,J._7O=Om(G),$=!0),$&&(p=J.getWidth(),$=J.getHeight(),v=Om(this.projectMatrix),J._18Q=Qs(v,v,G),J._18Q._wh=p/$)},Vn.prototype.syncEnv=function(p){var G=this.view;this.envmapReflectivity=G._envmapReflectivity||.5,this.cameraPosition=G.getEye(),this.projectMatrix=G._projectMatrix,this.viewMatrix=G._viewMatrix,this.pickColorMap=p,this.picking=G.getGL()._picking},Vn.prototype.setGLState=(U3=[0,0,0,0],F3=[!0,!0,!0,!0],C3=[-1,1],Q3=[w.FUNC_ADD,w.FUNC_ADD],pe=[w.SRC_ALPHA,w.ONE_MINUS_SRC_ALPHA,w.ONE,w.ONE_MINUS_SRC_ALPHA],function(p,G){var v=this.renderState.gl,J=this.renderState.glState;J.dither=!1,G?J.color.mask=F3:J.color.reset(),J.pixelStore.reset(),J.blend.color=U3,J.blend.equation=Q3,J.blend.func=pe,J.cullFace.enabled=!1,J.scissor.enabled=!1,J.depth.enabled=!0,J.depth.clear=1,J.depth.func=v.LEQUAL,J.depth.range=C3,J.stencil.enabled=!1,J.polygonOffset.enabled=!1,p?(J.depth.mask=!1,J.blend.enabled=!0):(J.depth.mask=!0,J.blend.enabled=!1)}),Vn.prototype.setUniforms=function(p){var G,v,J,$,S,O,W,l,t,z,Z,B,f,X,q,g,M=this.view,L=this.renderState,H=L.gl;(L=L.uniforms).uBrightness=1,L.uOpacity=1,L.uPartOpacity=1,L.uPick=this.picking,L.uUseInstance=!1,L.uTexture=!1,L.uBlendTexture=!1,L.uAlphaTest=F.alphaTest,L.uTransparent=!!p,L.uFix=!1,L.uBatchColor=!1,L.uBatchBlend=!1,L.uBatchBrightness=!1,L.uReflectivity=this.envmapReflectivity||.5,L.uCameraPosition=this.cameraPosition,L.uPMatrix=this.projectMatrix,L.uViewMatrix=this.viewMatrix,L.uEnvMap=null,_Z(M,L,ds),L.uClipperMatrix=M._boxClipperMatrixes,L.uClipperClipInner=M._boxClipperClipInner,L.uEnvmapQuat=M._envmapExtraQuaternion,M._envmapRenderer.resetUniformCache(),this.picking||(G=M,p=H,p=r.for(p).directUniforms(),f=G._lastLightUploadInfo={c:[],g:[],e:[]},(H=G._headlightDirection)&&3===H.length?X=H:"shadow"===H&&(X=G.shadowMap.getDirection()),X=X?m.normalizeArray(G._transformDirectionToViewSpace(null,X)):[0,0,0],p.uHeadlightDirection=X,p.uHeadlightRange=G._headlightRange,H=p.uHeadlightAmbientIntensity=G._headlightAmbientIntensity,X=G._headlightIntensity,q=yE(G._headlightColor),1!==X&&(q=[q[0]*X,q[1]*X,q[2]*X]),p.uHeadlightColor=[q[0],q[1],q[2],(X=G._headlightDisabled)?1:0],f.c.push(q[0],q[1],q[2]),f.g.push(X?-1:G._headlightGroup),f.e.push(X?1:0),q=G._59O,X=G._spots,g=G._dirs,q.length&&(v=[],J=[],$=[],q.forEach(function(p){ms(v,p,f),qS(J,G._transformPointToViewSpace(p.p3())),$.push(p.s("light.range"))}),p.uPointColor=v,p.uPointRange=$,p.uPointPosition=J),X.length&&(S=[],O=[],W=[],l=[],t=[],z=[],X.forEach(function(p){ms(S,p,f),qS(O,G._transformPointToViewSpace(p.p3())),qS(t,G._transformDirectionToViewSpace(p.p3(),p.s("light.center"))),W.push(p.s("light.range")),l.push(S0(p.s("light.angle")/2)),z.push(p.s("light.exponent"))}),p.uSpotColor=S,p.uSpotRange=W,p.uSpotAngle=l,p.uSpotExponent=z,p.uSpotPosition=O,p.uSpotDirection=t),g.length&&(Z=[],B=[],g.forEach(function(p){ms(Z,p,f),qS(B,G._transformDirectionToViewSpace(p.p3()))}),p.uDirColor=Z,p.uDirDirection=B),G._lastLightMask=ws,G._lastHeadlightAmbientIntensity=H,M._fogDisabled||(L.uFogColor=M._fogColor,L.uFogDensity=M._fogDensity,L.uFogNear=M._fogNear,L.uFogFar=M._fogFar))},Vn.prototype.drawLayer=function(p,G){return this.view.renderLayers(p,!0)},Vn.prototype.drawData=function(p,G,v){var J,$,S,O,W,l,t=this.view;t.isVisible(p)&&($=(J=this.renderState).uniforms,(p=t.getData3dUI(p))&&(O=(S=J.gl)._picking,W=t._picking,l=p._pickId,v&&(p._pickId=v),$.uPick=S._picking=t._picking=!!v,$.uTransparent=!!G,p._42(J.gl,J.program,G?M:L),$.uPick=S._picking=O,t._picking=W,p._pickId=l))},Gp.Graph3dView=function(p,G){var v,J=this;J.resetHeadlightProperties(),J.resetFogProperties(),J._webGLVersion=1,J._attributes=G||N.graph3dViewAttributes,J._25I={},J._view=ES(1,J),J._attributes&&(v=J._attributes.canvas)||(v=xS(J._view)),J._canvas=v,H0(v,"webglcontextlost",function(p){p.preventDefault(),ZZ(J),J._26I&&(J._doBufferGC(J._26I,!0),mS(J._canvas,0,0),["_highlightHelper","shadowMap","flowMap","_envmapRenderer","_postProcessing"].forEach(function(p){J[p].contextLost()}),J.dm().each(function(p){J.getData3dUI(p).contextLost()})),J._26I=v0,J._1o.onContextLost(),J._35O=!0}),H0(v,"webglcontextrestored",function(p){J._35O=!1,J.iv()}),J._40Q=new vk(J),J._43Q={},J._44Q=-1,J._batchIndexMap={},J._batchModelMap={},J._wireframeIndexMap={},J._wireframeModelMap={},J._wireframeIndexMapSwap={},J._wireframeModelMapSwap={},J._polylineIndexMap={},J._polylineIndexMap={},J._polylineIndexMapSwap={},J._polylineIndexMapSwap={},J._8O=[],J._7O=$m(),J._6O=$m(),J._1o=new lk(J),J._30O=new Zk(J),J._31O=new tk(J),J._32O=new zk(J),J._raycaster=new nk(J),J._highlightHelper=new un(J),J._postProcessing=new jk(J),J._41Q=[],J._42Q=0,J._frameRenderOptionStack=[],Gp.VR?(J.vr=new Gp.VR(J),J.isVREnabled=function(){return this.vr.enable},J.isVRPresenting=function(){return this.vr.isPresenting()}):(J.vr={enable:!1,isPresenting:q},J.isVREnabled=q,J.isVRPresenting=q),J.shadowMap=new Kn(J),J.flowMap=new an(J),J._33Q=!0,J._eye=MA(N.graph3dViewEye),J._center=MA(N.graph3dViewCenter),J._up=MA(N.graph3dViewUp),J._lightChanged=!1,J._59O=[],J._spots=[],J._dirs=[],J._boxClippers=[],J._flowObjects=[],J._frameId=0,J._picking=!1,J._batchInfoMap={},J._renderLayerInfoMap={},J._sortedRenderLayers=d.keys(Nm),J.overlappingBox=new AI(J),J.dm(p||new Cm),J._coreInteractor=new p3(this),J._envmapRenderer=new Gp.EnvmapRenderer(this),J.setInteractors([new $k(J)]),J._initView(),J._genBatchInstancedArrayFunc()}),Un={fogDisabled:1,fogMode:1,dashDisabled:1,batchColorDisabled:1,batchInstancedDisabled:1,batchBlendDisabled:1,batchBrightnessDisabled:1,flowBlendMode:1,uvClipEnabled:1,ortho:1},Fn={box:1,sphere:2},Cn={addRGB:"FLOW_BLEND_MODE_ADD_RGB",addRGBA:"FLOW_BLEND_MODE_ADD_RGBA",overrideRGBA:"FLOW_BLEND_MODE_OVERRIDE_RGBA",overrideRGB:"FLOW_BLEND_MODE_OVERRIDE_RGB",overrideA:"FLOW_BLEND_MODE_OVERRIDE_A",multiplyRGB:"FLOW_BLEND_MODE_MULTIPLY_RGB",multiplyRGBA:"FLOW_BLEND_MODE_MULTIPLY_RGBA"},Qn=0,pk=(S("Graph3dView",d,{ms_v:1,ms_tip:1,ms_gv:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_51o:1,ms_shadow:1,ms_highlight:1,ms_quickVisible:1,ms_ac:["devicePixelRatio","boundaries","moveStep","rotateStep","editHelperDisabled","blockSelectable","sizeEditableFunc","rotationEditableFunc","editableFunc","rotatable","zoomable","pannable","walkable","resettable","mouseRoamable","zoomToCenter",FJ,CJ,"firstPersonMode",ll,"movableFunc","gridVisible","gridSize","gridGap","gridColor","originAxisVisible","centerAxisVisible","axisXColor","axisYColor","axisZColor","editSizeColor","rectSelectable","rectSelectBackground","headlightRange","headlightDirection","headlightColor","headlightIntensity","headlightAmbientIntensity","headlightDisabled","headlightGroup","ortho","orthoWidth","syncEyeWithOrthoWidth","fovy","near","far",JJ,vJ,"up","aspect","fogDisabled","fogMode","fogDensity","fogColor","fogNear","fogFar","pickerResolution","dashDisabled","uvClipEnabled","batchColorDisabled","batchInstancedDisabled","batchBlendDisabled","batchBrightnessDisabled","flowBlendMode","hoverDelay","batchInfoMap","renderLayerInfoMap","rotateMinPhi","rotateMaxPhi","sortable","sortFunc"],_editable:!1,_sortable:N.graph3dViewSortable,_editHelperDisabled:N.graph3dViewEditHelperDisabled,_blockSelectable:N.graph3dViewBlockSelectable,_devicePixelRatio:K,_boundaries:K,_moveStep:N.graph3dViewMoveStep,_rotateStep:N.graph3dViewRotateStep,_rotateMinPhi:N.graph3dViewMinPhi===K?N.graph3dViewRotateMinPhi:N.graph3dViewMinPhi,_rotateMaxPhi:N.graph3dViewMaxPhi===K?N.graph3dViewRotateMaxPhi:N.graph3dViewMaxPhi,_pannable:N.graph3dViewPannable,_rotatable:N.graph3dViewRotatable,_walkable:N.graph3dViewWalkable,_resettable:N.graph3dViewResettable,_zoomable:N.graph3dViewZoomable,_zoomToCenter:!0,_firstPersonMode:N.graph3dViewFirstPersonMode,_mouseRoamable:N.graph3dViewMouseRoamable,_gridVisible:N.graph3dViewGridVisible,_gridSize:N.graph3dViewGridSize,_gridGap:N.graph3dViewGridGap,_gridColor:N.graph3dViewGridColor,_originAxisVisible:N.graph3dViewOriginAxisVisible,_centerAxisVisible:N.graph3dViewCenterAxisVisible,_axisXColor:N.graph3dViewAxisXColor,_axisYColor:N.graph3dViewAxisYColor,_axisZColor:N.graph3dViewAxisZColor,_ortho:N.graph3dViewOrtho,_orthoWidth:N.graph3dViewOrthoWidth,_syncEyeWithOrthoWidth:N.graph3dViewSyncEyeWithOrthoWidth,_fovy:N.graph3dViewFovy,_near:N.graph3dViewNear,_far:N.graph3dViewFar,_rectSelectable:N.graph3dViewRectSelectable,_rectSelectBackground:N.graph3dViewRectSelectBackground,_editSizeColor:N.graph3dViewEditSizeColor,_autoMakeVisible:E4,_pickerResolution:N.graph3dViewPickerResolution,_dashDisabled:N.graph3dViewDashDisabled,_uvClipEnabled:N.graph3dViewUvClipEnabled,_batchColorDisabled:N.graph3dViewBatchColorDisabled,_batchInstancedDisabled:N.graph3dViewBatchInstancedDisabled,_batchBlendDisabled:N.graph3dViewBatchBlendDisabled,_batchBrightnessDisabled:N.graph3dViewBatchBrightnessDisabled,_flowBlendMode:N.graph3dViewFlowBlendMode,addCamera:function(p){var G=d.freeze({id:this._42Q++,priority:p.priority||0,ignoreInPick:!!p.ignoreInPick,render:p.render});p.switch3DStatus&&(this._43Q[G.id]=!0),this._41Q.push(G),this._41Q.sort(function(p,G){return p.priority!==G.priority?p.priority-G.priority:p.id-G.id})},setEye:function(p,G,v){1===arguments.length&&(G=p[1],v=p[2],p=p[0]);var J=this._eye;J[0]=p,J[1]=G,J[2]=v,this.fp(JJ,v0,J)},setCenter:function(p,G,v){1===arguments.length&&(G=p[1],v=p[2],p=p[0]);var J=this._center;J[0]=p,J[1]=G,J[2]=v,this.fp(vJ,v0,J)},setUp:function(p,G,v){1===arguments.length&&(G=p[1],v=p[2],p=p[0]);var J=this._up;J[0]=p,J[1]=G,J[2]=v,this.fp("up",v0,J)},getDevicePixelRatio:function(){return this._picking?this._1o._resolution:this._devicePixelRatio||Rh},isTransparentMask:function(p){return p.s("transparent.mask")},getCoreInteractor:function(){return this._coreInteractor},getHighlightHelper:function(){return this._highlightHelper},getRaycaster:function(){return this._raycaster},getAspect:function(){return this._aspect||this.getWidth()/this.getHeight()||1.2},getCanvas:function(){return this._canvas},setDataModel:function(p){var G=this,v=G._dataModel,J=G._selectionModel;v!==p&&(v&&(v.ump(G.handleDataModelPropertyChange,G),v.umm(G.handleDataModelChange,G),v.umd(G.handleDataPropertyChange,G),J||v.sm().ums(G.handleSelectionChange,G)),(G._dataModel=p).mp(G.handleDataModelPropertyChange,G),p.mm(G.handleDataModelChange,G),p.md(G.handleDataPropertyChange,G),J?J._21I(p):p.sm().ms(G.handleSelectionChange,G),G._postProcessing.handleDataModleChange(v,p),G._tryInvalidateEnvmap(),G.invalidateAll(!0),G.invalidateLight(),G.invalidateboxClipper(),G.invalidateFlowObjects(),G._49Q(),G.fp(Dl,v,p),G._canvas.style.background=p.getBackground()||"")},handleDataModelPropertyChange:function(p){var G,v,J=p.property;"background"===J?(G=this._canvas.style.background,v=p.newValue||"",this._canvas.style.background=v,this.fp("canvasBackground",G,v)):"envmapType"===J?this._tryInvalidateEnvmap():"envmap"===J&&((G=this._shaderUseEnvmapFlag)!==(v=!(!p.newValue||!p.newValue.length))&&ZZ(this),this.iv())},handleDataPropertyChange:function(p){var G=p.data,p=(this.invalidateData(G),p.property);Es(G)&&"s:light.type"===p?this.invalidateLight():"s:3d.clipbox"===p?this.invalidateboxClipper(G,!0):"s:effect.flow"===p?this.invalidateFlowObjects(G,!0):"s:shadow.cast"===p?this.shadowMap.tryUpdateBounding(G):"s:3d.visible"===p&&this.invalidateQuickVisible(G)},invalidateboxClipper:function(p,G){var v=this._boxClippers,J=v.length;p?!!p.s("3d.clipbox")==(G=!!G)?v.indexOf(p)<0&&v.push(p):0<=(G=v.indexOf(p))&&v.splice(G,1):(v=this._boxClippers=[],this.dm().each(function(p){p.s("3d.clipbox")&&v.push(p)})),J!==(p=v.length)&&(ZZ(this),this.shadowMap.deleteShadowProgram(),this._updateBoxClipperMatrix(),_Z=p?HZ:Ii),this.iv()},_updateBoxClipperMatrix:function(){for(var p,G,v=this._boxClippers,J=this._boxClipperMatrixes=[],$=this._boxClipperClipInner=[],S=this._boxClipperGroups=[],O=this._boxClipperShape=[],W=new eh,l=0,t=v.length;l<t;l++)(p=v[l]).appendAnchorMatrix3d(G=Xm(p,this.getMat(p))),J.push(W.getInverse(W.fromArray(G)).toArray()),$.push("inner"===p.s("3d.clipbox")),S.push(p.s("3d.clipbox.group")),O.push(Fn[p.s("3d.clipbox.shape")]||1)},_49Q:function(){this._4AQ||this._48Q||this.dm().size()<N.graph3dViewDataNumWarningLine||(this._48Q=!0,console.log("Too many datas so than disable some feature to speed up.\nYou can set global Default.graph3dViewDataNumWarningLine to largeEnoughNum to avoid this, or call graph3dView.quitDataNumWarning() to quit.\n"),this.enableQuickVisibleMode(),this.getHighlightHelper().mouseOverData=null)},quitDataNumWarning:function(){this.disableQuickVisibleMode(),this._48Q=!1,this._4AQ=!0},invalidateFlowObjects:function(p,G){var v=this._flowObjects,J=v.length;p?!!p.s("effect.flow")==(G=!!G)?v.indexOf(p)<0&&v.push(p):0<=(G=v.indexOf(p))&&v.splice(G,1):(v=this._flowObjects=[],this.dm().each(function(p){p.s("effect.flow")&&v.push(p)})),J!==v.length&&ZZ(this),this.iv()},invalidateLight:function(){this._lightChanged||(this._lightChanged=!0,this.iv())},onPropertyChanged:function(p){var G=this,p=p.property;if(G.iv(),G._18Q=v0,"eye"===p)G._33Q=!0;else if("devicePixelRatio"===p)G._42(G.getDevicePixelRatio());else if(Un[p]&&(ZZ(G),"batchInstancedDisabled"===p)){G._genBatchInstancedArrayFunc(),this.shadowMap.deleteShadowProgram();var v,J=N.getBatchInfoMap();for(v in J)J[v]&&J[v].instanced&&G.invalidateBatch(v);for(v in J=G._batchInfoMap)J[v]&&J[v].instanced&&G.invalidateBatch(v)}},_5O:function(p){var G=p._22Q();return G?new G(this,p):v0},getData3dUI:function(p){var G=this._25I[p._id];return G===K&&(G=this._5O(p),this._25I[p._id]=G),G},invalidateAll:function(p,G){var v=this;if(p){for(var J in v._25I)(J=v._25I[J])&&J.dispose();v._25I={},v.iv(),fp(v)}else fp(v),v.dm().each(function(p){v.invalidateData(p)});v.shadowMap.tryInvalidateLater(p,G)},invalidateSelection:function(){var G=this;G.sm().each(function(p){G.invalidateData(p)})},invalidateData:function(p){var G=this.getData3dUI(p);G&&(G.iv(),this.iv()),fp(this,p)},getShape3dText:function(p){return p.getStyle("shape3d.text")||this.getLabel(p)},invalidateBatch:function(G){var v=this;v._40Q.each(function(p){v._invalidateBatch(G,p.batchModelMap,p.batchIndexMap),v._invalidateBatch("T"+G,p.wireframeModelMap,p.wireframeIndexMap),v._invalidateBatch("O"+G,p.wireframeModelMap,p.wireframeIndexMap),p.markBatchInvalid()}),v.iv()},_invalidateBatch:function(p,G,v){var J=this,$=G[p];$&&($.ds.forEach(function(p){var G=J.getData3dUI(p);G&&G.iv(),delete v[p._id]}),delete G[p])},handleDataModelChange:function(p){var G,v,J=this,$=p.kind,p=p.data;"add"===$?(J.invalidateData(p),zS(p)&&p.getEdgeGroup()&&p.getEdgeGroup().eachSiblingEdge(J.invalidateData,J),Es(p)&&J.invalidateLight(),p.s("3d.clipbox")&&J.invalidateboxClipper(p,!0),p.s("effect.flow")&&J.invalidateFlowObjects(p,!0),J._49Q()):$===LJ?(G=p._id,(v=J._25I[G])&&(v.dispose(),delete J._25I[G],J.iv()),p===J._currentSubGraph&&J.setCurrentSubGraph(v0),fp(J,p),Es(p)&&J.invalidateLight(),p.s("3d.clipbox")&&J.invalidateboxClipper(p,!1),p.s("effect.flow")&&J.invalidateFlowObjects(p,!1)):$===HJ&&(J.invalidateAll(!0),J.setCurrentSubGraph(v0),fp(J),J.invalidateLight(),J.invalidateboxClipper(),J.invalidateFlowObjects())},toCanvas:function(p,G,v){for(var J,$=this.getGL(),S=(this.validate(),p&&(J=$.getParameter($.COLOR_CLEAR_VALUE),LZ($,p)),this._42(1,{renderAxis:!1,renderEdit:!1,renderGrid:!1}),this.getWidth()||1),O=this.getHeight()||1,W=new Uint8Array(S*O*4),l=xS(),t=l.getContext("2d"),z=($.readPixels(0,0,S,O,$.RGBA,$.UNSIGNED_BYTE,W),mS(l,S,O,1),t.getImageData(0,0,S,O)),Z=z.data,B=0;B<Z.length;B+=4){var f=B/4,X=n0(f/S);Z[f=4*((O-1-X)*S+(f-X*S))]=W[B],Z[1+f]=W[B+1],Z[2+f]=W[B+2],Z[3+f]=W[B+3]}return t.putImageData(z,0,0),p&&LZ($,J),this._42(this.getDevicePixelRatio()),G&&v?(z=(t=xS()).getContext("2d"),mS(t,G,v,1),N.drawImage(z,l,0,0,G,v),t):l},toDataURL:function(p,G){var v,J=this.getGL(),G=(this.validate(),p&&(v=J.getParameter(J.COLOR_CLEAR_VALUE),LZ(J,p)),this._42(1,{renderAxis:!1,renderEdit:!1,renderGrid:!1}),this._canvas.toDataURL(G||"image/png",1));return p&&LZ(J,v),this._42(this.getDevicePixelRatio()),G},isWebGL2:function(){return 2===this._webGLVersion},getGL:function(){var p,G,v,J=this._26I;if(J)return this.acquireProgram(),J;if(!this._35O){var $=this,S=$._canvas,O=$._attributes;if(!O||!1!==O.requestWebGL2)try{(J=S.getContext("webgl2",O)||S.getContext("experimental-webgl2",O))&&($._webGLVersion=2,$._26I=J)}catch(J){}if(!J)try{J=S.getContext("webgl",O)||S.getContext("experimental-webgl",O)}catch(J){throw new Error("WebGL not supported")}if(J)return $._26I=J,S=$._frameState=new Vn(this,J),$._glExtensions=new $r(J),$._glCapabilities=new Sr(J,$._glExtensions),$._2O={},J._emptyCubeTexture=(p=J,v=new Uint8Array(4),G=p.createTexture(),p.activeTexture(p.TEXTURE0),p.bindTexture(p.TEXTURE_CUBE_MAP,G),p.texParameteri(p.TEXTURE_CUBE_MAP,p.TEXTURE_MAG_FILTER,p.LINEAR),p.texParameteri(p.TEXTURE_CUBE_MAP,p.TEXTURE_MIN_FILTER,p.LINEAR),p.texImage2D(p.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,p.RGBA,1,1,0,p.RGBA,p.UNSIGNED_BYTE,v),p.texImage2D(p.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,p.RGBA,1,1,0,p.RGBA,p.UNSIGNED_BYTE,v),p.texImage2D(p.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,p.RGBA,1,1,0,p.RGBA,p.UNSIGNED_BYTE,v),p.texImage2D(p.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,p.RGBA,1,1,0,p.RGBA,p.UNSIGNED_BYTE,v),p.texImage2D(p.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,p.RGBA,1,1,0,p.RGBA,p.UNSIGNED_BYTE,v),p.texImage2D(p.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,p.RGBA,1,1,0,p.RGBA,p.UNSIGNED_BYTE,v),G),J._compiledShader={},J._emptyTexture=zZ(J),J._emptyBlendTexture=zZ(J),J._bufPool={},J._id=++Qn,J._divisorState=[],S.setGLState(),$._buffer={vs:fZ(J),ns:fZ(J),is:fZ(J),uv:fZ(J),batchColor:fZ(J),batchBlend:fZ(J),batchBrightness:fZ(J),lineDistance:fZ(J)},$._1O=tZ(J),O=$._cube={vs:fZ(J),ns:fZ(J),is:fZ(J),uv:fZ(J)},PZ(J,O.vs,Kp),PZ(J,O.ns,Tp),PZ(J,O.uv,up),rZ(J,O.is,ap),$.acquireProgram(),$._genBatchInstancedArrayFunc(),J._renderInfo={calls:0,vertices:0,faces:0,lines:0,points:0,textureCache:{time:0,count:0,pixels:0},frame:0,cacheTimeCost:0,reflectDepth:0},J;throw new Error("WebGL not supported")}},getGLCapabilities:function(){if(this.getGL())return this._glCapabilities},getGLExtensions:function(){if(this.getGL())return this._glExtensions},getEnvmap:function(){return this._glCapabilities&&this._glCapabilities.maxVertexTextures<N.graph3dEnvmapCapabilityRequire?null:this.dm().getEnvmap()},getEnvmapType:function(){var p,G=this.dm();return(G?G.getEnvmapType():p)||"legacy"},setEnvmapExtraQuaternion:function(p){var G=this._envmapExtraQuaternion;this._envmapExtraQuaternion=p instanceof sh.Quaternion?p.clone().inverse().toArray():null,null==G!=(null==p)&&ZZ(this)},invalidateEnvmap:function(p){return this._envmapRenderer.invalidateEnvmap(p)},_setEnvmapByProbeId:function(p,G){return this._envmapRenderer.setEnvmapByProbeId(p,G)},_tryInvalidateEnvmap:function(){this.getEnvmapType()!==this._lastProgramEnvmapType&&(ZZ(this),this.iv())},acquireProgram:function(){var p=this,G=p._26I;if(G&&!p._prg){var v=p._prg=G.createProgram();if(!v)return v0;var J=p._dirs.length,$=p._spots.length,S=p._59O.length,O=p._boxClippers.length,W=p._flowObjects.length,l=["uPMatrix","uMVMatrix","uMMatrix","uReflectivity","uViewMatrix","uUseEnvMap","uEnvMap","uCameraPosition","uNMatrix","uViewMatrix","aNormal","aUv","uUvMatrix","uDiffuse","uBlend","uBlendColor","uBrightness","uPartOpacity","uAlphaTest","uTransparent","uClipDirection","uClipPercent","uTexture","uBlendTexture","uSampler","uBlendSampler","uDiscardSelectable","uFix","uPick","uReverseFlip","uFixPickReverseColor","uBatchBrightness","aBatchBrightness","uBatchColor","aBatchColor","uBatchBlend","aBatchBlend","uDash","aLineDistance","uDashDistance","uDashGapDistance","uLight","uHeadlightRange","uHeadlightAmbientIntensity","uHeadlightColor","uFogColor","uFogDensity","uFogNear","uFogFar"];J&&l.push("uDirColor","uDirDirection"),$&&l.push("uSpotColor","uSpotRange","uSpotAngle","uSpotExponent","uSpotPosition","uSpotDirection"),S&&l.push("uPointColor","uPointRange","uPointPosition"),ks||(vp=_S(vp.substring(0,vp.indexOf("^#"))),Jp=_S(Jp),ks=!0);var t=(t=p.getEnvmap())&&t.length,z=p.getEnvmapType(),J=["#define MAX_DIR "+J,"#define MAX_SPOT "+$,"#define MAX_POINT "+S,"#define MAX_BOX_CLIPPER "+O,"#define MAX_FLOW_OBJECT "+W,p._fogDisabled?"":"#define FOG","exp2"===p.getFogMode()?"#define FOG_EXP2":"",p._dashDisabled?"":"#define DASH",p._uvClipEnabled?"#define UV_CLIP":"",null==p._envmapExtraQuaternion?"":"#define ENVMAP_ROTATE",t?"#define USE_ENVMAP":"","legacy"!==z?"#define ENVMAP_TYPE_CUBE_UV":"",p.isOrtho()?"#define ORTHOGRAPHIC":"",p._batchColorDisabled?"":"#define BATCHCOLOR",p._batchInstancedDisabled?"":"#define BATCHINSTANCE",p._batchBlendDisabled?"":"#define BATCHBLEND",p._batchBrightnessDisabled?"":"#define BATCHBRIGHTNESS","#define "+(Cn[p.getFlowBlendMode()]||Cn[N.graph3dViewFlowBlendMode]),p.shadowMap.enable?p.shadowMap.genShaderDefine():"",""].join("\n"),$=BZ(G,v,G.VERTEX_SHADER,vp.replace("#PREFIX",J)),S=(G.getShaderParameter($,G.COMPILE_STATUS)||FZ("COMPILE",G.VERTEX_SHADER,G.getError(),G.getShaderInfoLog($)),BZ(G,v,G.FRAGMENT_SHADER,Jp.replace("#PREFIX",J)));if(G.getShaderParameter(S,G.COMPILE_STATUS)||FZ("COMPILE",G.FRAGMENT_SHADER,G.getError(),G.getShaderInfoLog(S)),R0?l.push("aPosition"):(v.aPosition=0,G.bindAttribLocation(v,0,"aPosition")),G.linkProgram(v),!G.getProgramParameter(v,G.LINK_STATUS))return O=G.getProgramInfoLog(v),p._prg=v0,0<=O.indexOf("maximum temp register")&&!p._glTempRegisterLimited?(p._glTempRegisterLimited=!0,G.deleteProgram(v),p.acquireProgram()):(FZ("LINK",G.getProgramParameter(v,G.VALIDATE_STATUS),G.getError(),O),G.deleteProgram(v),v0);l.forEach(function(p){v[p]=/^u/.test(p)?G.getUniformLocation(v,p):G.getAttribLocation(v,p)}),(W=p._frameState).renderState.program=W.defaultProgram=v,p._envmapRenderer.changeEnvmapType(p._lastProgramEnvmapType=z),p._shaderUseEnvmapFlag=t,G.deleteShader($),G.deleteShader(S)}},isGLTempRegisterLimited:function(){return this._glTempRegisterLimited},getBrightness:function(p){var G=p.s("brightness"),p=this.isSelected(p)?p.s("select.brightness"):v0;return G==v0?p:p==v0?G:G*p},getDataHighlightMode:function(p){return p.s("highlight.mode")},getWireframe:function(p){var G=p.s("wf.visible"),v=p.s("wf.width");if(!0===G||0<v&&"selected"===G&&this.isSelected(p))return{color:p.s("wf.color"),width:v,short:p.s("wf.short"),mat:p.s("wf.mat")}},getPartPosition:function(p,G,v,J){return J=J||Ai,[(p=this.getData3dUI(p)._16O(J.autoRotate,G,v0,v||U0,J.t3,J.r3,J.rotationMode))[12],p[13],p[14]]},_transformPointToViewSpace:function(p){return p=[p[0],p[1],p[2]],lm(p,this._viewMatrix),p},_transformDirectionToViewSpace:function(p,G){var p=p?[p[0],p[1],p[2]]:[0,0,0],G=(lm(p,this._viewMatrix),G?[G[0],G[1],G[2]]:[0,0,0]),v=(lm(G,this._viewMatrix),G[0]-p[0]),J=G[1]-p[1],G=G[2]-p[2];return(p=Math.sqrt(v*v+J*J+G*G))?[v/p,J/p,G/p]:[v,J,G]},getWireframeGeometry:function(p){if(p.s("wf.geometry"))return{color:p.s("wf.color"),width:p.s("wf.width"),mat:p.s("wf.mat"),geometry:!0}},getBodyColor:function(p){return p.s("body.color")},getMat:function(p){return p.getMat?p.getMat():p.s("mat")},getFaceMat:function(p,G){return p.getFaceMat?p.getFaceMat(G):p.s(G+".mat")},getFaceBlend:function(p,G){return p.s(G+".blend")||p.s("all.blend")},getFaceColor:function(p,G){return p.s(G+".color")||p.s("all.color")},getFaceImage:function(p,G){return p.s(G+".image")||p.s("all.image")},getFaceBlendImage:function(p,G){return p.s(G+".blend.image")||p.s("all.blend.image")},getFaceDiscardSelectable:function(p,G){return(G=p.s(G+".discard.selectable"))==v0?p.s("all.discard.selectable"):G},getFaceUv:function(p,G){return p.s(G+".uv")||p.s("all.uv")},getFaceUvOffset:function(p,G){return p.s(G+".uv.offset")||p.s("all.uv.offset")},getFaceUvScale:function(p,G){return p.s(G+".uv.scale")||p.s("all.uv.scale")},getFaceUvRotation:function(p,G){return p.s(G+".uv.rotation")||p.s("all.uv.rotation")},getFaceUvAnchor:function(p,G){return p.s(G+".uv.anchor")||p.s("all.uv.anchor")},getFaceLight:function(p,G){return(G=p.s(G+".light"))==v0?p.s("all.light"):G},getFaceVisible:function(p,G){return(G=p.s(G+".visible"))==v0?p.s("all.visible"):G},getFaceOpacity:function(p,G){return(G=p.s(G+".opacity"))==v0?p.s("all.opacity"):G},getFaceTransparent:function(p,G){return(G=p.s(G+".transparent"))==v0?p.s("all.transparent"):G},getFaceReverseColor:function(p,G){return p.s(G+".reverse.color")||p.s("all.reverse.color")},getFaceReverseFlip:function(p,G){return(G=p.s(G+".reverse.flip"))==v0?p.s("all.reverse.flip"):G},getFaceReverseCull:function(p,G){return(G=p.s(G+".reverse.cull"))==v0?p.s("all.reverse.cull"):G},getTextureMap:function(){return this._2O},_2Oi:function(p,G,v){var J;v=v||"",(J=(J=this._2O[p])?J:this._2O[p]={})[v]=G},deleteTexture:function(p){if(this._2O){var G=this._2O[p];if(G){delete this._2O[p];var v,J=this.getGL();for(v in G)J.deleteTexture(G[v])}}},renderPickScene:function(){var p=this.getGL();this.syncRenderState(),this._picking=p._picking=!0,this.renderScene(),this._picking=p._picking=!1},invalidateCachedTexture:function(p){this.getData3dUI(p).invalidateCachedTexture(this.getGL()),this.invalidateData(p)},invalidateShape3dCachedImage:function(p){this.invalidateCachedTexture(p)},invalidateCachedGeometry:function(p){this.getData3dUI(p).invalidateCachedGeometry(),this.invalidateData(p)},isInteractive:function(p){return p.s("interactive")},getTexture:function(p,G,v,J){if(!p)return v0;var $,S=this,O=S.getGL(),W=S._2O[p];if(!($=W?W[(z=G?G.s("texture.mipmap.max"):z)||""]||W.default:$)){if(J=J||{},!(W=T(p)))return O._emptyTexture;if(G&&(J.mipmapMaxLevel=z=G.s("texture.mipmap.max"),t=G.s("texture.wrap"),J.clampToEdge="clampToEdge"===t||"repeat"!==t&&K),W.uuid||(W.uuid=E.Math.generateUUID()),W.tagName){if(W.dynamic)return tZ(O,W,S._1O,J);$=tZ(O,W,K,J),S._2Oi(p,$,z)}else{var l,t=G&&(G.s("texture.cache")||G.s("shape3d.image.cache")||W.textureCache),z=S.isVRPresenting();if(z&&(G._textureUpdateFrame===O._renderInfo.frame?t=!0:G._textureUpdateFrame=O._renderInfo.frame),t&&($=(l=S.getData3dUI(G)).getCachedTexture(v))&&l.interactiveInfo&&$.interactiveInfo&&(l.interactiveInfo[$.interactiveInfo.key]=$.interactiveInfo.info),!$){var Z=O._renderInfo.textureCache;if(t){if(Z.time>N.graph3dMaxVectorCacheTime)return S.redraw(),O._emptyTexture;if(!zA(W,G))return O._emptyTexture}G&&(1!==G.s("texture.scale")?M=G.s("texture.scale"):1!==G.s("shape3d.texture.scale")&&(M=G.s("shape3d.texture.scale")));var B,f,X,q,g,M=M||1,L=(_=G&&(G.s("fixSizeOnScreen")||G.s("shape3d.fixSizeOnScreen")))?O.NEAREST:O.LINEAR;_?"number"==typeof _&&(M*=_<0?1:_):G&&(G.s("vector.dynamic")||G.s("shape3d.vector.dynamic"))&&(_=(l=l||S.getData3dUI(G)).getVectorDynamicSize());"billboard"===(H=G&&G.s("shape3d"))?B=G.getTall()/G.getWidth():"plane"===H&&(B=G.getHeight()/G.getWidth());var H=Am(W,G),_=_?(X=t?S._devicePixelRatio||Rh:S.getDevicePixelRatio(),f=0<_[0]?_[0]*X:M*H*X,0<_[1]?_[1]*X:M*(B?km(W,G,S,Math.min(4096,H*B)):km(W,G))*X):(f=M*H,M*(B?km(W,G,S,Math.min(4096,H*B)):km(W,G)));1<=f&&1<=_&&(X=0,(t||z)&&(X=Date.now()),M=S._glCapabilities.maxTextureSize,f=Math.min(f,M),_=Math.min(_,M),H=kE(f,_),(l=!l&&G?S.getData3dUI(G):l)&&l.interactiveInfo&&("object"==typeof(q=p)&&(q=q.uuid||(q.uuid=E.Math.generateUUID())),g=l.interactiveInfo[q]={},H.interactiveInfo=g.bodyInfo={compInfos:[],matrix:new ch,rect:{x:0,y:0,width:f,height:_}}),Im(H,W,0,0,f,_,G,S),H.interactiveInfo&&(H.interactiveInfo=null),H.restore(),Z.count++,Z.pixels+=f*_,G?(J.minFilter=pp(G.s("texture.filter.min")||G.s("texture.filter"))||L,J.magFilter=pp(G.s("texture.filter.mag")||G.s("texture.filter"))||L):J.minFilter=J.magFilter=L,t||z?($=tZ(O,AE,null,J),l.setCachedTexture($,v),Z.time+=Date.now()-X,g&&($.interactiveInfo={key:q,info:g}),AE=null):$=tZ(O,AE,S._1O,J))}}}return $},redraw:function(){this.iv()},validateImpl:function(){var v,J,$,p=this,G=(p._lightChanged&&(p._lightChanged=!1,v=[],J=[],$=[],p.dm().each(function(p){var G;Es(p)&&("point"===(G=p.s("light.type"))?v.push(p):"spot"===G?J.push(p):"directional"===G&&$.push(p))}),v.length===p._59O.length&&J.length===p._spots.length&&$.length===p._dirs.length||ZZ(p),p._59O=v,p._spots=J,p._dirs=$),p.getAspect());G!==p.__cachedAspect__&&(p._updateSkybox({property:"asceptChanged"}),p.__cachedAspect__=G),p._42(),p._1o.iv()},getRenderInfo:function(){var p=this.getGL();if(p)return p._renderInfo},getDebugTip:function(){var p,G,v=this.getRenderInfo();if(v)return p=this.getGL()._validBufCount||0,p="Draw Calls: "+v.calls+"<br/>Vertices: "+v.vertices+"<br/>Faces: "+v.faces+"<br/>Lines: "+v.lines+"<br/>"+(v.points?"Points: "+v.points+"<br/>":"")+"Buffers: "+p+"<br/>Cache Models: "+d.keys(si).length+"<br/>Shape3d Models: "+d.keys(Yi).length,this.isVRPresenting()&&(p+="<br/>VR fps: "+this.vr.getFps()),v.textureCache&&(G=v.textureCache.count,p+="<br/>2D Dynamic Textures: "+v.textureCache.count,0<G&&(p+="<br/>2D Dynamic pixels: "+(1e6<(G=v.textureCache.pixels)?Math.round(G/1e6)+"M":1e3<G?Math.round(G/1e3)+"K":Math.round(G)))),p},getFrameState:function(){return this._frameState},isBoundingBoxInView:(Le=new E.Math.Box3,He=new E.Math.Matrix4,function(p){if(!(p=p instanceof E.Data?this.getData3dUI(p):p).mat)return!0;var G=p.getBoundingBox(!0);return Le.copy(G).applyMatrix4(He.fromArray(p.mat)),this.getFrustum().intersectsBox(Le)}),updateScene:function(){var G=this,v=(G._81O=v0,G.overlappingBox.clear(),G._40Q),J=(v.init(),G.getGL()),p=G.dm();if(p.isHierarchicalRendering())p.eachByHierarchical(function(p){(p=G.getData3dUI(p))&&p.update(G,J,v)});else for(var $,S=p.getDatas().getArray(),O=S.length,W=0;W<O;W++)$=S[W],($=G.getData3dUI($))&&$.update(G,J,v);this._updateBoxClipperMatrix(),v.onUpdated()},_pushFrameRenderOptions:function(p){this._frameRenderOptionStack.push(this._currentFrameRenderOptions),this._currentFrameRenderOptions=p},_popFrameRenderOptions:function(p){this._currentFrameRenderOptions=this._frameRenderOptionStack.pop()},_getFrameRenderOptions:function(p){var G=this._currentFrameRenderOptions;return G&&G[p]},getRenderLists:function(){return this._40Q},renderScene:function(p){var v,J=this,$=(J._pushFrameRenderOptions(p),!1!==J._getFrameRenderOptions("createShadowMap")&&J.shadowMap.render(),J.flowMap.render(),J.getGL()),S=(J._envmapRenderer.onBeforeRender($),J._44Q=-1,J._frameState),O=S.renderState,p=O.glState;function W(p,G){S.setGLState(p,G),S.setUniforms(p),S.renderState.attribs.disable(),v=O.directUniforms(),O.directAttribs().disable()}var G,l=J._prg,t=(J._projectMatrix=WZ(J),OZ(J,J._7O),J._viewMatrix=Om(J._7O),J.isReflecting($)||Qs(J._projScreenMatrix=$m(),J._projectMatrix,J._viewMatrix),S.syncEnv(this._picking?this.pickColorMap:K),O.useProgram(l),W(!1,!0),$.clear($.DEPTH_BUFFER_BIT),J._picking),z=this._41Q,Z=0,B=z.length;function f(p){for(var G=!1;Z<B;Z++){var v=z[Z];if(!t||!v.ignoreInPick){if(v.priority>=p)break;J._43Q[J._44Q=v.id]&&!X0[AJ.length]||(v.render($,J,S),W(),G=!0)}}return G}if(f(N.cameraPriority.skybox),t?(G=p.color.clear.slice(0),LZ($,[0,0,0,0])):(LZ($,[0,0,0,0]),p.blend.enabled=!1,p.depth.enabled=!1,p.depth.mask=!1,J._camera&&!1===J._camera.s("camera.renderSky")||J.drawSky($,l),!1!==J._getFrameRenderOptions("renderReflector")&&J.drawReflectors($)&&(J._projectMatrix=WZ(J),OZ(J,J._7O),J._viewMatrix=Om(J._7O),S.syncEnv(),W()),p.blend.enabled=!1,p.depth.enabled=!0,p.depth.mask=!0,(v.uTransparent=!1)!==J._getFrameRenderOptions("renderGrid")&&J._31O._42($,l)),!$.textureBatch||X0[(ONE_FRAME_TIME-6)/2]){t||(J.shadowMap.enable&&J.shadowMap.createShadow(v),J.flowMap.createFlow(v));for(var X=J._sortedRenderLayers,q=0,g=X.length;q<g;q++){var M=X[q],L=J.getRenderLayerInfo(M);!J._camera&&L.ignore||J._camera&&!J._camera.isLayerVisible(L.mask)||(f(L.priority)&&!t&&(J.shadowMap.enable&&J.shadowMap.createShadow(v),J.flowMap.createFlow(v)),this.renderLayer(M))}f(N.cameraPriority.infinity),t||J.flowMap.disableFlow(v),Ks(J,v,0,N.graph3dViewHeadlightAmbientIntensity),v.uHeadlightColor=[1,1,1,0],v.uUseEnvMap=!1,v.uHeadlightDirection=[0,0,0],v.uHeadlightRange=0,p.depth.enabled=!1,v.uTransparent=!1,v.shadowReceive=!1,_Z(J,v,ds),t?J.drawFilter||J._30O._42($,l):(J._highlightHelper._42($,l),this._renderAxisAndEditHelper(!1!==J._getFrameRenderOptions("renderAxis"),!1!==J._getFrameRenderOptions("renderEdit")),p.blend.enabled=!1,p.depth.mask=!0),p.depth.enabled=!0,t&&LZ($,G),PZ($,v0),rZ($,v0),J._44Q=-1,J._popFrameRenderOptions(null)}},_renderAxisAndEditHelper:function(p,G){var v,J,$,S,O;(p||G)&&(v=this.getGL(),J=this._prg,$=(S=(O=this._frameState).renderState).glState,S=S.directUniforms(),O.renderState.attribs.disable(),$.depth.enabled=!1,S.uTransparent=!1,S.shadowReceive=!1,$.blend.enabled=!1,$.depth.mask=!0,S.uPick=this._picking,(O=!this._fogDisabled)&&(S.uFog=!1),p&&this._32O._42(v,J),G&&this._30O._42(v,J),O&&(S.uFog=!0),PZ(v,v0),rZ(v,v0))},renderLayers:function(p,G){for(var v=0,J=(p=G?um(p):p).length;v<J;v++)this.renderLayer(p[v])},renderSky:function(){var p=this,G=p._frameState,v=G.renderState,J=v.glState,$=p.getGL(),S=p._prg;p._projectMatrix=WZ(p),OZ(p,p._7O),p._viewMatrix=Om(p._7O),Qs(p._projScreenMatrix=$m(),p._projectMatrix,p._viewMatrix),G.syncEnv(),v.useProgram(S),G.setGLState(!1,!0),G.setUniforms(!1),G.renderState.attribs.disable(),$.clear($.DEPTH_BUFFER_BIT),LZ($,[0,0,0,0]),J.blend.enabled=!1,J.depth.enabled=!1,J.depth.mask=!1,p.drawSky($,S),J.depth.mask=!0,J.depth.enabled=!0,PZ($,v0),rZ($,v0)},addRenderLayerListener:function(p,G,v){this._renderLayerNotifier||(this._renderLayerNotifier=new Um),this._renderLayerNotifier.add(p,G,v)},removeRenderLayerListener:function(p,G){this._renderLayerNotifier&&this._renderLayerNotifier.remove(p,G)},fireRenderLayerEvent:function(p,G){var v=this._renderLayerNotifier;v&&v.fire({layer:p,phase:G})},renderLayer:function(p){var G=this,v=G._picking;if(X=G._40Q.get(p)){G.fireRenderLayerEvent(p,"prepare");var J,$,S,O=G.getGL(),W=G.getRenderLayerInfo(p),l=(t=G._frameState.renderState).glState,t=t.directUniforms(),z=(!v&&G.isSortable()&&X.sort(G._sortFunc,G._projScreenMatrix),X.opaque),Z=X.transparent,B=X.batchModelMap,f=X.polylineModelMap,X=X.wireframeModelMap,O=G.getGL(),q=G._prg,g=(v||(l.blend.enabled=!1,l.depth.enabled=!0,l.depth.mask=!0),(t.uTransparent=!1)!==W.clearDepth&&O.clear(O.DEPTH_BUFFER_BIT),this.drawFilter);if(g){for(J=0,$=(S=z).length;J<$;J++)!0!==g(S[J].data)&&S[J].ui._42(O,q,L);if(v)for(J=0,$=(S=Z).length;J<$;J++)S[J].ui._46Q(O);rp(G,B)}else{for(J=0,$=(S=z).length;J<$;J++)S[J].ui._42(O,q,L);if(v)for(J=0,$=(S=Z).length;J<$;J++)S[J].ui._46Q(O);rp(G,B),jp(G,f),jp(G,X)}if(v||(l.blend.enabled=!0,l.depth.mask=!1),G._45Q=t.uTransparent=!0,g){for(J=0,$=(S=Z).length;J<$;J++)!0!==g(S[J].data)&&S[J].ui._42(O,q,M);rp(G,B,0,!0)}else{for(J=0,$=(S=Z).length;J<$;J++)S[J].ui._42(O,q,M);rp(G,B,0,!0),jp(G,f,0,!0),jp(G,X,0,!0)}G._45Q=null,G.fireRenderLayerEvent(p,"post")}},_42:function(p,G){var v=this;if(!v._35O&&(!D||X0(D))){var J=v.getWidth(),$=v.getHeight();if(J&&$){var S=v.getGL();if(S){var O=v._canvas,W=(p?W=!0:p=v.getDevicePixelRatio(),v._picking||!W&&J===O.clientWidth&&$===O.clientHeight||(mS(O,J,$,p),W=p,J&&1<Math.abs(S.drawingBufferWidth-J*p)&&(W=Math.min(W,S.drawingBufferWidth/J)),(W=$&&1<Math.abs(S.drawingBufferHeight-$*p)?Math.min(W,S.drawingBufferHeight/$):W)!==p&&(v.setDevicePixelRatio(p=W),mS(O,J,$,p)),v._18Q=null),S.clear(S.COLOR_BUFFER_BIT),S._renderInfo);for(W.calls=0,W.vertices=0,W.faces=0,W.lines=0,W.points=0,W.textureCache={time:0,count:0,pixels:0},W.frame=++v._frameId,W.cacheTimeCost=0,W.reflectDepth=0,J*=p,$*=p,this.syncRenderState();(!v.isVREnabled()||!v.vr.render(S,J,$,G))&&(v.updateScene(),!v._postProcessing.render(S,J,$,G)&&(v.setViewport(S,0,0,J,$),v.renderScene(G),0)););v._33Q=!1,v.countFrame(),v._doBufferGC(S)}}}},syncRenderState:function(){var p;(p=this._frameState)&&(p=p.renderState)&&p.syncLoss()},drawReflectors:function(p){p._renderInfo.reflectDepth++;var G,v,J=this._dataModel.getReflectors(),$=!1;for(G in J)v=J[G],this.isVisible(v)&&(v=this.getData3dUI(v))&&v.drawReflector&&v.drawReflector(p)&&($=!0);return p._renderInfo.reflectDepth--,$},isReflecting:function(p){return p._renderInfo.reflectDepth},getPostProcessing:function(){return this._postProcessing},enablePostProcessing:function(p,G){return this._postProcessing.enableModule(p,G)},getPostProcessingModule:function(p){return this._postProcessing.getModule(p)},getPostProcessingValue:function(p,G){return(p=this._postProcessing.getModule(p))?p[G]:K},setPostProcessingValue:function(p,G,v){var J=this.getPostProcessingValue(p,G),$=this._postProcessing.getModule(p);$&&J!==v&&("enable"===G?this.enablePostProcessing(p,v):$[G]=v,this.firePropertyChange("postProcessing."+p+"."+G,J,v))},setDofImageFromGraphView:function(p,G,v){return this._postProcessing.getModule("Dof").setImageFromGraphView(p,G,v)},setViewport:function(p,G,v,J,$){this._viewport=[G,v,J,$],r.for(p).directState().viewport=this._viewport},getRenderState:function(){return r.for(this._26I)},getViewport:function(p){return this._viewport},setBufferGCInterval:function(p){this._bufferGCInterval=p},_doBufferGC:function(p,G){var v,J,$=p._bufPool,S=0,O=0,W=p._renderInfo.frame,l=this._bufferGCInterval||10;for(v in $)S++,(J=$[v])&&(G||W-J._fid>l?(p.deleteBuffer(J._buf),J._buf=null,$[v]=null):O++);if(O<S/2&&128<S){var t={};for(v in $)$[v]&&(t[v]=$[v]);p._bufPool=t}p._validBufCount=O},_swapLineMap:function(){var p=this;y0=p._polylineModelMap,p._polylineModelMap=p._polylineModelMapSwap,p._polylineModelMapSwap=y0,y0=p._wireframeModelMap,p._wireframeModelMap=p._wireframeModelMapSwap,p._wireframeModelMapSwap=y0,y0=p._polylineIndexMap,p._polylineIndexMap=p._polylineIndexMapSwap,p._polylineIndexMapSwap=y0,y0=p._wireframeIndexMap,p._wireframeIndexMap=p._wireframeIndexMapSwap,p._wireframeIndexMapSwap=y0},_updateSkybox:function(p){var G,v,J,$,S,O,W,l,t;this._skybox&&p&&(p=p.property,G=!1,v=this._skybox,"eye"!==p&&"forceUpdate"!==p||(J=this._eye,v.p3(J[0],J[1],J[2]),G=!0),"near"!==p&&"far"!==p&&"forceUpdate"!==p&&"asceptChanged"!==p||(J=(J=v.__cachedS3__)||(v.__cachedS3__=v.getFinalScale3d()),p=$0(J[0],J[1],J[2])/2,$=("sphere"===v.s("shape3d")?J0(J[0],J[1],J[2]):Y0(J[0]*J[0]+J[1]*J[1]+J[2]*J[2]))/2,S=this._near,O=this._far,t=Math.tan(this.getFovy()/2)*S,W=this.getAspect()*t,W=Y0(W*W+t*t+S*S),W=1.01*J0(W,Y0(3)*S),l=1,p<W?l=W/p:O<=$&&(l=O*O/(S+O)/$),1!==l&&(v.__updatingSkybox__=!0,t=J.map(function(p){return l*p}),v.s3(t),v.setScale3d(1,1,1),G=!0,delete v.__updatingSkybox__)),G&&this.invalidateData(v))},getSkyBox:function(){return this.getSkybox()},setSkyBox:function(p){return this.setSkybox(p)},getSkybox:function(){return this._skybox},setSkybox:function(G){var v,p=this._skybox;p===G?G&&this._updateSkybox({property:"forceUpdate"}):(p&&(this._skyboxStyleMap&&p.setStyleMap(this._skyboxStyleMap),this._skyboxStyleMap=null,this._skyboxAnchor3d&&p.setAnchor3d(this._skyboxAnchor3d),this._skyboxAnchor3d=null,this._skyboxP3&&p.p3(this._skyboxP3),this._skyboxP3=null,this.handleDataModelChange({kind:LJ,data:p})),this._skybox=G,this.ump(this._updateSkybox,this),G&&(G.removeFromDataModel(),this._skyboxStyleMap=E.Default.clone(G.getStyleMap()),this._skyboxAnchor3d=G.getAnchor3d(),G.setAnchor3d(.5,.5,.5),this._skyboxP3=G.p3().slice(0),G.s({"shape3d.reverse.flip":!0,"shape3d.reverse.cull":!1,"all.reverse.flip":!0,"all.reverse.cull":!1,"front.reverse.flip":!0,"front.reverse.cull":!1,"back.reverse.flip":!0,"back.reverse.cull":!1,"left.reverse.flip":!0,"left.reverse.cull":!1,"right.reverse.flip":!0,"right.reverse.cull":!1,"top.reverse.flip":!0,"top.reverse.cull":!1,"bottom.reverse.flip":!0,"bottom.reverse.cull":!1}),v=G.onPropertyChanged,G.onPropertyChanged=function(p){v.call(G,p),!G.__updatingSkybox__&&0<=["width","height","tall","scale","scaleTall"].indexOf(p.property)&&(G.__cachedS3__=K)},this.mp(this._updateSkybox,this),this._updateSkybox({property:"forceUpdate"})),this.fp("skybox",p,G))},drawSky:function(p,G,v){var J,$,S,O,W,l,t,z,Z=this,B=Z._skybox;B&&(J=r.for(p).directUniforms(),S=Z._headlightIntensity,$=yE(Z._headlightColor),G=Z._prg,1!==S&&($=[$[0]*S,$[1]*S,$[2]*S]),J.uHeadlightColor=[$[0],$[1],$[2],1],(S=Z.getData3dUI(B))&&((W=(O=Z.isOrtho())||this._computedProjectMatrix)&&(l=Z._projectMatrix,O&&(Z._ortho=!1),J.uPMatrix=Z._projectMatrix=WZ(Z,!0)),t=B.p3(),z=this.getEye(),t[0]===z[0]&&t[1]===z[1]&&t[2]===z[2]||(B._position.x=z[0],B._54O=z[1],B._position.y=z[2]),S.validate(),S._42(p,G,X),W&&(O&&(Z._ortho=!0),J.uPMatrix=Z._projectMatrix=l)),p.clear(p.DEPTH_BUFFER_BIT),J.uHeadlightColor=[$[0],$[1],$[2],Z._headlightDisabled?1:0])},getLogicalPoint:function(p){return RA(p,this._canvas)},isRectOverlapping:function(p){return this.getData3dUI(p)._rectOverlapping},getHitFaceInfo:function(p){p.target&&(p=this.lp(p));var G=this.getDataInfoAt(p);return G&&(p=this.intersectObject(p,G.data))?{data:G.data,face:p.part}:v0},unproject:function(p,G){var v=this.getWidth(),J=this.getHeight(),v=((p=p.target?this.lp(p):p).x-v/2)/v*2,p=-1*(p.y-J/2)/J*2,J=(G=G||0,$m()),$=WZ(this),S=OZ(this);return Qs(J,$,S),Us(J),[($=tm([v,p,G,1],J))[0]/$[3],$[1]/$[3],$[2]/$[3]]},getDataAt:function(p){return(p=this.getDataInfoAt(p))?p.data:v0},getDataInfoAt:function(p,G,v){return p.target&&(p=this.lp(p)),this._1o.get(pS(p.x,p.y,G),!0,v)},getDatasInRect:function(p,G){return this._1o.get(p,!1,G)},setEditable:function(p){var G=this._editable;this._editable=p,this.fp(fl,G,p)},isEditable:function(p){return p?!!this._editable&&!!k(p)&&!!p.s("3d.editable")&&(!this._editableFunc||this._editableFunc(p)):this._editable},isSelectable:function(p){return p.s("3d.selectable")&&this.sm().isSelectable(p)},isMovable:function(p){return(!zS(p)||p.getStyle(mJ)===hJ)&&!!p.s("3d.movable")&&(!this._movableFunc||this._movableFunc(p))},isSizeEditable:function(p){return!!k(p)&&(!this._sizeEditableFunc||this._sizeEditableFunc(p))},isRotationEditable:function(p){return!(!k(p)||!1===p.IRotatable)&&(!this._rotationEditableFunc||this._rotationEditableFunc(p))},handleDelete:function(p){this._editable&&this.removeSelection()},zoomIn:function(p){this.setZoom(JA,p)},zoomOut:function(p){this.setZoom(1/JA,p)},setZoom:(Xe=new m,qe=new m,ge=new m,Me=new m,function(p,G){if(1!==p){var v=this;v._14o&&v._14o.stop(!0);var J,$=1/p,S=(Xe.copy(v.getCenter()),qe.copy(v.getEye()),v._ortho);if(S){if((J=v._orthoWidth)<v._moveStep&&1<p)return}else if(Xe.distanceTo(qe)<v._moveStep&&$<1)return;var O=!1;if(!1===v._zoomToCenter&&v._lastZoomLP&&(ge.copy(qe).sub(Xe).normalize(),v._81O=null,Me.copy(v.getHitPosition(v._lastZoomLP,Xe.toArray(),ge.toArray())),O=!0,v._lastZoomHit=Me),G=gS(G))return G.action=function(p){v.fi({kind:v._zooming?"betweenZoom":"beginZoom"}),v._zooming=1,p=($-1)*p+1,S&&v.setOrthoWidth(J*p),O?(v.setEye(ge.lerpVectors(Me,qe,p).toArray()),v.setCenter(ge.lerpVectors(Me,Xe,p).toArray())):S||v.setEye(ge.lerpVectors(Xe,qe,p).toArray())},G._37o=function(){delete v._14o,delete v._zooming,v.fi({kind:"endZoom"}),v.onZoomEnded()},v._14o=HA(G);S&&v.setOrthoWidth(J*$),O?(v.setEye(ge.lerpVectors(Me,qe,$).toArray()),v.setCenter(ge.lerpVectors(Me,Xe,$).toArray())):S||v.setEye(ge.lerpVectors(Xe,qe,$).toArray())}}),setOrthoZoom:function(p,G){return this.setZoom(p,G)},getPositionInfo:function(p){var G=this._eye,v=this._center,J=this.getAspect(),p=p?Jm(Gm(v,G,!0),Gm(p,G)):iA(G,v);return this._ortho?{length:p,height:(G=this._orthoWidth)/J,width:G}:{length:p,height:v=d0(this._fovy/2)*p*2,width:v*J}},getCenterInfo:function(){return this._81O||(this._81O=this.getPositionInfo()),MA(this._81O)},rotate:function(v,J,p,$){var S=this;if(v||J){$==v0&&($=S._firstPersonMode),S._88O&&S._88O.stop(!0);var G=S._center,O=S._eye,W=S.getCenterInfo().length,l=$?G:O,t=$?O:G,z=Gm(l,t),Z=P0(z[0],z[2]),B=P0(Y0(z[0]*z[0]+z[2]*z[2]),z[1]),f=$?vJ:JJ;if($&&(J=-J),p=gS(p))return p.action=function(p){S.fi({kind:S._rotating?"betweenRotate":"beginRotate"}),S._rotating=1;var G=Z+v*p,p=B+J*p,p=$?j-as(S,j-p):as(S,p);z[0]=W*O0(p)*O0(G),z[1]=W*S0(p),z[2]=W*O0(p)*S0(G),l[0]=t[0]+z[0],l[1]=t[1]+z[1],l[2]=t[2]+z[2],S.fp(f,v0,l)},p._37o=function(){delete S._88O,delete S._rotating,S.fi({kind:"endRotate"}),S.onRotateEnded()},S._88O=HA(p);Z+=v,B+=J,B=$?j-as(S,j-B):as(S,B),z[0]=W*O0(B)*O0(Z),z[1]=W*S0(B),z[2]=W*O0(B)*S0(Z),l[0]=t[0]+z[0],l[1]=t[1]+z[1],l[2]=t[2]+z[2],S.fp(f,v0,l)}},pan:function(p,G,v,J){if(p||G){var $,S,O=this;J==v0&&(J=O._firstPersonMode),O._89O&&O._89O.stop(!0);var p=[(W=OZ(O))[0]*p,W[4]*p,W[8]*p],W=[W[1]*G,W[5]*G,W[9]*G],l=p[0]+W[0],t=p[1]+W[1],z=p[2]+W[2],Z=O._center,B=O._eye;if(J&&(G=QZ(O.getBoundaries(),B[0],B[2],B[0]+l,B[2]+z,Y0(l*l+z*z)),l=G[0],z=G[1]),v=gS(v))return $=MA(B),S=MA(Z),v.action=function(p){O.fi({kind:O._panning?"betweenPan":"beginPan"}),O._panning=1,Z[0]=S[0]+l*p,Z[1]=S[1]+t*p,Z[2]=S[2]+z*p,B[0]=$[0]+l*p,B[1]=$[1]+t*p,B[2]=$[2]+z*p,O.fp(JJ,v0,B),O.fp(vJ,v0,Z)},v._37o=function(){delete O._89O,delete O._panning,O.fi({kind:"endPan"}),O.onPanEnded()},O._89O=HA(v);Z[0]+=l,Z[1]+=t,Z[2]+=z,B[0]+=l,B[1]+=t,B[2]+=z,O.fp(JJ,v0,B),O.fp(vJ,v0,Z)}},walk:function(G,p,v){if(G){var J,$,S=this,O=(v==v0&&(v=S._firstPersonMode),S._90O&&S._90O.stop(!0),S._center),W=S._eye,l=Gm(O,W,!0);if(v){if(v=QZ(S.getBoundaries(),W[0],W[2],W[0]+l[0]*G,W[2]+l[2]*G,I(G)),!(G=iA(v)))return;l=[v[0]/G,0,v[1]/G]}if(p=gS(p))return J=MA(W),$=MA(O),p.action=function(p){S.fi({kind:S._walking?"betweenWalk":"beginWalk"}),S._walking=1,p*=G,W[0]=J[0]+l[0]*p,W[1]=J[1]+l[1]*p,W[2]=J[2]+l[2]*p,O[0]=$[0]+l[0]*p,O[1]=$[1]+l[1]*p,O[2]=$[2]+l[2]*p,S.fp(JJ,v0,W),S.fp(vJ,v0,O)},p._37o=function(){delete S._90O,delete S._walking,S.fi({kind:"endWalk"}),S.onWalkEnded()},S._90O=HA(p);W[0]+=l[0]*G,W[1]+=l[1]*G,W[2]+=l[2]*G,O[0]+=l[0]*G,O[1]+=l[1]*G,O[2]+=l[2]*G,S.fp(JJ,v0,W),S.fp(vJ,v0,O)}},handleScroll:function(p,G){tA(p);var v=this,J=v._moveStep,$=v.getDataInfoAt(p);if(($=$&&$.data)&&v.isInteractive($)){var S=v.intersectObject(p,$);if(S&&(S=S.part,(S=T($.s(S+".image")||$.s("shape3d."+S+".image")||$.s("all.image")||$.s("shape3d.image")))&&V(S.scrollable,$,v)))return}v.isFirstPersonMode()?v.isPannable()&&v.pan(0,0<G?J:-J):v.isZoomable()&&(v._lastZoomLP=v.lp(p),v.setZoom(G<0?1/$A:$A),v._lastZoomLP=v._lastZoomHit=null)},handlePinch:function(p,G){!this.isZoomable()||Math.abs(p-G)<N.pinchZoomThreshold||this.setZoom(p<G?1/SA:SA)},reset:function(p){this.setUp(N.graph3dViewUp),this.moveCamera(N.graph3dViewEye,N.graph3dViewCenter,p)},moveSelection:function(p,G,v){this.dm().beginTransaction(),M4(this.sm().toSelection(this.isMovable,this),p,G,v),this.dm().endTransaction()},getMoveMode:function(p,G){return(G=G.s("3d.move.mode"))?G:dA(p)||ci[88]&&ci[89]&&ci[90]?"xyz":ci[88]&&ci[89]?"xy":ci[88]&&ci[90]?"xz":ci[89]&&ci[90]?"yz":ci[88]?"x":ci[89]?"y":ci[90]?"z":"xz"},handleTick:function(){var p,G=this,v=!1,J=G._moveStep,$=J,S=-1*G._rotateStep;G.isWalkable()||($=0),G.isPannable()||(J=0),G.isRotatable()||(S=0),G._32Q&&($*=p=(Vi()-G._32Q)/50,J*=p,S*=p),G._31Q&&(qA(G._31Q),delete G._31Q,delete G._32Q),nE()&&G.pan(-J,0,!(v=!0),!0),YE()&&G.pan(J,0,!(v=!0),!0),sE()&&(v=!0,dA()?G.pan(0,J,!1,!0):G.walk($,!1,!0)),DE()&&(v=!0,dA()?G.pan(0,-J,!1,!0):G.walk(-$,!1,!0)),cE()&&G.rotate(-S,0,!(v=!0),!0),wE()&&G.rotate(S,0,!(v=!0),!0),hE()&&G.rotate(0,-S/2,!(v=!0),!0),dE()&&G.rotate(0,S/2,!(v=!0),!0),v&&(G._32Q=Vi(),G._31Q=XA(G.handleTick,G))},handleKeyDown:function(p){!PA(p)&&rE[p.keyCode]?this.handleTick():_E(p)?this.selectAll():bE(p)?this.handleDelete(p):PE(p)&&this.isResettable()&&this.reset()},checkDoubleClickOnNote:function(p,G,v){if(v===rJ){if(G.s("note.toggleable"))return G.s(yJ,!G.s(yJ)),this.fi({kind:"toggleNote",event:p,data:G,part:v}),!0}else if(v===eJ&&G.s("note2.toggleable"))return G.s(xJ,!G.s(xJ)),this.fi({kind:"toggleNote2",event:p,data:G,part:v}),!0;return!1},checkDoubleClickOnRotation:function(p,G,v){return v===qk?(G.setRotationX(0),!0):v===gk?(G.setRotationY(0),!0):v===Mk&&(G.setRotationZ(0),!0)},onRotateEnded:function(){},onWalkEnded:function(){},getViewRatio:function(p){if(this.isOrtho())return this.getWidth()/this.getOrthoWidth();var G=this.getCenter(),v=this.getHeight(),J=this.getEye(),G=[G[0]-J[0],G[1]-J[1],G[2]-J[2]],p=[p[0]-J[0],p[1]-J[1],p[2]-J[2]];return v*Math.sqrt(G[0]*G[0]+G[1]*G[1]+G[2]*G[2])*(1/Math.tan(this.getFovy()/2))/(p[0]*G[0]+p[1]*G[1]+p[2]*G[2])},inViewSpace:function(p){var G,p=this._transformPointToViewSpace(p),v=this.getAspect(),J=this.getNear(),$=this.getFar();return!(-p[2]<J||-p[2]>$)&&(this.isOrtho()?(G=this.getOrthoWidth()/2,Math.abs(p[0])<=G&&Math.abs(p[1]*v)<=G):(G=Math.sqrt(p[0]*p[0]+p[1]*p[1]+p[2]*p[2])*Math.tan(this.getFovy()/2),Math.abs(p[1]<=G)&&Math.abs(p[0])<=G*v))},getPVMatrix:function(){var p;return(p=this._18Q)||(p=WZ(this),this._18Q=Qs(p,p,OZ(this)),this._18Q._wh=this.getWidth()/2/this.getHeight()),p},getFrustum:(Ze=new eh,Be=new I4,fe=new Array(16),function(){for(var p=this.getPVMatrix(),G=!1,v=0;v<16;v++)p[v]!==fe[v]&&(G=!0,fe[v]=p[v]);return G&&Be.setFromMatrix(Ze.fromArray(p)),Be}),toViewPosition:function(p){var G=this.getWidth()/2,v=this.getHeight()/2,J=this.getPVMatrix();return{x:G+G*(p=tm([p[0],p[1],p[2],1],J))[0]/p[3],y:v-v*p[1]/p[3],z:p[2]/p[3]}},getHitPosition:function(p,G,v){var J=this.getWidth(),$=this.getHeight(),S=(p=p.target?this.lp(p):p).x-J/2,p=p.y-$/2,O=this.getCenterInfo(),W=OZ(this),J=(G=G||[0,0,0],v=v||[0,1,0],S=S/J*O.width,p=-1*p/$*O.height,[W[0]*S,W[4]*S,W[8]*S]),$=[W[1]*p,W[5]*p,W[9]*p],O=[J[0]+$[0],J[1]+$[1],J[2]+$[2]],S=this.getCenter();return Ts(this,G,v,[O[0]+S[0],O[1]+S[1],O[2]+S[2]])||[0,0,0]},intersectObject:function(p,G){return this._raycaster.intersectObject(p,G)},intersectObjects:function(p,G,v){return this._raycaster.intersectObjects(p,G,v)},getLineLength:function(p){return this.validate(),(p=this.getData3dUI(p))&&p.getCache&&(p=p.getCache())?p[p.length-1].length:0},getLineOffset:function(p,G){var v=this.getData3dUI(p);if(v&&v.getCache&&(v=v.getCache())){var J,v=gn(v,G);if(p.s("shape3d")!==XJ)return v;if(p.getScale3d&&1===($=p.getScale3d())[0]&&1===$[1]&&1===$[2]&&($=null),!(J=p.r3&&0===(J=p.r3())[0]&&0===J[1]&&0===J[2]?null:J)&&!$)return v;var $,G=new m(p.p3()),S=new m(v.point).sub(G),v=new m(v.tangent).add(S);return $&&($=new m($),S.multiply($),v.multiply($)),J&&($=(new wh).setFromEuler(new kh(J,p.getRotationMode(),!0)),S.applyQuaternion($),v.applyQuaternion($)),{point:S.clone().add(G),tangent:v.sub(S).normalize()}}return v0},_genBatchInstancedArrayFunc:function(){var p=this._glCapabilities&&this._glCapabilities.instancedArray&&!this._batchInstancedDisabled,W=p?bp:np,J=(this.batchInstancedModel=function(p,G,v,J,$,S,O){W(this,p,G,v,J,$,S,O)},p?Yp:sp),S=(this.batchInstancedShapeFace=function(p,G,v){J(p,G,v)},p?cp:hp);this.batchInstancedFace=function(p,G,v,J,$){S(this,p,G,v,J,$)}},isLabelVisible:function(p){return!0},isNoteVisible:function(p){return!0},moveCamera:function(p,G,v){var J=this,$=[($=J.getEye())[0],$[1],$[2]],S=[(S=J.getCenter())[0],S[1],S[2]];if(p=p||$,G=G||S,J._flyAnim&&J._flyAnim.stop(!0),!(v=gS(v)))return J.setEye(p[0],p[1],p[2]),J.setCenter(G[0],G[1],G[2]),delete J._flyAnim,!0;var O=[p[0]-$[0],p[1]-$[1],p[2]-$[2]],W=[G[0]-S[0],G[1]-S[1],G[2]-S[2]];return v.action=function(p){J.setCenter(S[0]+W[0]*p,S[1]+W[1]*p,S[2]+W[2]*p),J.setEye($[0]+O[0]*p,$[1]+O[1]*p,$[2]+O[2]*p)},v._37o=function(){delete J._flyAnim},J._flyAnim=HA(v)},flyTo:(ve=new m,Je=new m,$e=new m,Se=new m,Oe=new m,We=new eh,le=new E.Math.Quaternion,te=new kh,ze=new rh,function(p,G,v){var J,$,S=this,O=(G=("boolean"==typeof G?{animation:G}:G)||{}).center,W=G.distance,l=G.direction,t=G.worldDirection,z=v||G.ratio||.8,Z=G.xRatio||z,z=G.yRatio||z,B=((v!==K||G.duration||G.frames)&&(G={animation:G}),[]),v=W===K;if(O&&$e.fromArray(O),!O||v)if((p=1===(p=p||S.dm().getDatas()).length?tS(p)?p.get(0):p[0]:p)instanceof E.Node)O||$e.fromArray(p.p3()),v&&(Or(B,S,p),J=B.length);else{if(!p.length)return;if(!(!v&&O||(B=[],p.forEach(function(p){Or(B,S,p)}),J=B.length)))return;O||(ze.setFromPoints(B),$e.copy(ze.min).add(ze.max).multiplyScalar(.5))}S._flyAnim&&S._flyAnim.stop(!0),ve.fromArray(S.getEye()),Je.fromArray(S.getCenter()),S.setCenter($e.x,$e.y,$e.z),Se.subVectors(ve,Je),(l||t)&&(!t&&p instanceof E.Node?le.setFromEuler(te.set(p.r3(),p.getRotationMode(),!0)):le.set(0,0,0,1),O=Se.length(),Se.fromArray(t||l).applyQuaternion(le).setLength(O));var f=new m(S.getUp()),X=sh.fequal(f.x,0,1e-5)&&sh.fequal(f.z,0,1e-5),q=(X&&0===Se.x&&0===Se.z&&(p=Se.y,Se.y=.999*p,Se.z=.001*Math.sign(p)),0);if(v){var g,M,L,H=Z,_=z;if(Oe.copy(Se),S.isOrtho()){var b=-1/0;for(S._eye[0]=Se.x+$e.x,S._eye[1]=Se.y+$e.y,S._eye[2]=Se.z+$e.z,g=WZ(S),Qs(g,g,OZ(S)),$=0;$<J;$++)L=B[$],M=tm([L.x,L.y,L.z,1],g),b=Math.max(b,Math.max(Math.abs(M[0])/H,Math.abs(M[1])/_));q=S.getOrthoWidth()*b}else{for(var n,D,k=S.getNear(),Y=10;Y--;){for(S._eye[0]=Se.x+$e.x,S._eye[1]=Se.y+$e.y,S._eye[2]=Se.z+$e.z,g=WZ(S),Qs(g,g,OZ(S)),n=!0,D=-1/0,$=0;$<J;$++){if(L=B[$],(M=tm([L.x,L.y,L.z,1],g))[3]<k&&Y){Se.multiplyScalar(2),n=!1;break}D=Math.max(D,Math.max(Math.abs(M[0])/H,Math.abs(M[1])/_)-M[3])}if(n)break}Se.setLength(D+Se.length())}Se.manhattanLength()<1e-6&&Se.copy(Oe)}else Se.setLength(W);var s,c,h,w,d,P,j,i,r,e,A,I,t=Se.add($e);return(l=gS(G.animation))?(S.setEye(ve.x,ve.y,ve.z),S.setCenter(Je.x,Je.y,Je.z),O=t.clone().sub($e),(s=O.length())&&O.multiplyScalar(1/s),p=ve.clone().sub(Je),(c=p.length())&&p.multiplyScalar(1/c),v=(new eh).lookAtDirection(p,f),Z=(new eh).lookAtDirection(O,f),h=(new wh).setFromRotationMatrix(v),w=(new wh).setFromRotationMatrix(Z),d=(new m).subVectors($e,Je),q&&(P=S.getOrthoWidth()),j=new m,i=new m,r=new m,e=l.action,A=l._37o,I=Je.clone(),l.action=function(p,G){i.copy(I).addScaledVector(d,p);var v=h.clone().slerp(w,p);j.set(0,0,1).applyQuaternion(v).setLength(c+(s-c)*p).add(i),r.set(0,1,0).applyQuaternion(v),S.setCenter(i.x,i.y,i.z),S.setEye(j.x,j.y,j.z),S.setUp(r.x,r.y,r.z),q&&S.setOrthoWidth((q-P)*p+P),e&&e(p,G)},l._37o=function(){delete S._flyAnim;var p=S.getUp(),G=X?N.graph3dViewUp:f.toArray();p[0]===G[0]&&p[1]===G[1]&&p[2]===G[2]||S.setUp(G),A&&A()},{lastEye:ve,lastCenter:Je,eye:t,center:$e,orthoWidth:q,animation:S._flyAnim=HA(l)}):(S.setEye(t.x,t.y,t.z),S.setCenter($e.x,$e.y,$e.z),q&&S.setOrthoWidth(q),delete S._flyAnim,{lastEye:ve,lastCenter:Je,eye:t,center:$e,orthoWidth:q})}),getBoundingBox:(Ge=new eh,function(p){if(0===(p=(p=p||this.sm().getSelection())instanceof E.Node?[p]:p).length)return v0;var v=[],G=(p.forEach(function(p){var G;k(p)&&(G=v,Ge.fromArray(Xm(p,this.getMat(p))),p=p.getAnchor3d(),G.push((new m).set(0-p.x,0-p.y,0-p.z).applyMatrix4(Ge)),G.push((new m).set(0-p.x,0-p.y,1-p.z).applyMatrix4(Ge)),G.push((new m).set(0-p.x,1-p.y,0-p.z).applyMatrix4(Ge)),G.push((new m).set(0-p.x,1-p.y,1-p.z).applyMatrix4(Ge)),G.push((new m).set(1-p.x,0-p.y,0-p.z).applyMatrix4(Ge)),G.push((new m).set(1-p.x,0-p.y,1-p.z).applyMatrix4(Ge)),G.push((new m).set(1-p.x,1-p.y,0-p.z).applyMatrix4(Ge)),G.push((new m).set(1-p.x,1-p.y,1-p.z).applyMatrix4(Ge)))},this),[1/0,1/0,1/0]),J=[-1/0,-1/0,-1/0];return v.forEach(function(p){G[0]=Math.min(p.x,G[0]),G[1]=Math.min(p.y,G[1]),G[2]=Math.min(p.z,G[2]),J[0]=Math.max(p.x,J[0]),J[1]=Math.max(p.y,J[1]),J[2]=Math.max(p.z,J[2])}),{min:G,max:J}}),setBatchInfo:function(p,G){var v=this._batchInfoMap[p];this._batchInfoMap[p]=G,this.fp("batchInfo",v,G)},getBatchInfo:function(p){return this._batchInfoMap[p]||Di[p]},setOrthoWidth:function(p){var G,v,J,$=this._orthoWidth;this._orthoWidth=p,this._syncEyeWithOrthoWidth&&(G=p/this.getAspect()/2/d0(this.getFovy()/2),v=(new m).fromArray(this.getEye()),J=(new m).fromArray(this.getCenter()),v.sub(J).setLength(G).add(J),this.setEye(v.toArray())),this.fp("orthoWidth",$,p)},getCamera:function(p){var G=this,v=((p=(p=p||G._mainCamera)||(G._mainCamera=new E.Camera)).s({"camera.type":G.isOrtho()?"ortho":"perspective","camera.aspect":G.getAspect(),"camera.fovy":G.getFovy(),"camera.ortho.width":G.getOrthoWidth(),"camera.near":G.getNear(),"camera.far":G.getFar()}),G.getEye());return p.p3(v.slice()),p.lookAt(G.getCenter(),G.getUp()),p},syncFromCamera:function(p){var G=this,v=new m(G.getEye()),J=new m(G.getCenter()),$=new m,S=J.sub(v).length(),O=(G.setEye(p.p3()),p.getEuler());return $.set(0,0,-1).applyEuler(O),v.copy($).setLength(S).add(J.copy(p.p3())),G.setCenter(v.toArray()),v.set(0,1,0).applyEuler(O),J.set(0,1,0),Math.abs($.cross(v).dot(J))<1e-5?G.setUp(J.toArray()):G.setUp(v.toArray()),G.setOrtho("ortho"===p.s("camera.type")),G.setAspect(p.s("camera.aspect")),G.setFovy(p.s("camera.fovy")),G.setOrthoWidth(p.s("camera.ortho.width")),G.setNear(p.s("camera.near")),G.setFar(p.s("camera.far")),!0},resetHeadlightProperties:function(){this._headlightColor=N.graph3dViewHeadlightColor,this._headlightIntensity=N.graph3dViewHeadlightIntensity,this._headlightRange=N.graph3dViewHeadlightRange,this._headlightDirection=N.graph3dViewHeadlightDirection,this._headlightGroup=N.graph3dViewHeadlightGroup,this._headlightAmbientIntensity=N.graph3dViewHeadlightAmbientIntensity,this._headlightDisabled=N.graph3dViewHeadlightDisabled},resetFogProperties:function(){this._fogDisabled=N.graph3dViewFogDisabled,this._fogMode=N.graph3dViewFogMode,this._fogDensity=N.graph3dViewFogDensity,this._fogColor=N.graph3dViewFogColor,this._fogNear=N.graph3dViewFogNear,this._fogFar=N.graph3dViewFogFar},_sortRenderLayers:function(){var p,v=this,G=v._sortedRenderLayers=d.keys(v._renderLayerInfoMap);for(p in Nm)0<=G.indexOf(p)||G.push(p);G.sort(function(p,G){return p=v.getRenderLayerInfo(p),G=v.getRenderLayerInfo(G),p.priority-G.priority})},_appendRenderLayer:function(p,G){p=p||0;var v,J=this.getRenderLayerInfo(G);if(J)v=J.mask,!this._renderLayerInfoMap[G]&&Nm[G]&&(this._renderLayerInfoMap[G]=J);else{var $=this._sortedRenderLayers.length;if(!($<32))throw new Error("Only 31 render layer can be defined.");v=1<<$,J=this.getRenderLayerInfo(mm),this._renderLayerInfoMap[G]={mask:v,priority:J.priority}}return p|v},setRenderLayerInfo:function(p,G){this._appendRenderLayer(0,p);var v,J=this.getRenderLayerInfo(p),p=MA(J);for(v in G)"mask"!==v&&(J[v]=G[v]);this._sortRenderLayers(),this.fp("renderLayerInfo",p,J)},getRenderLayerInfo:function(p){return this._renderLayerInfoMap[p]||MA(Nm[p])},setRenderLayerInfoMap:function(p){var G,v=this._renderLayerInfoMap;for(G in this._renderLayerInfoMap={},p)this.setRenderLayerInfo(G,p[G]);this.fp("renderLayerInfoMap",v,this._renderLayerInfoMap)},getRenderLayerKeys:function(){return this._sortedRenderLayers}}),(((G=Gp.EnvmapRenderer=function(p){this.gv=p,this._envmaps={},this._envmapHash={},this._probeCaptureTime={},this._pingPongRenderTarget=null,this._equirectShader=null,this._cubemapShader=null,this._blurMaterial=null,this._lastCaptureFrame=0}).prototype={}).constructor=G).prototype.changeEnvmapType=function(p){"legacy"===p?(this.setEnvmapByProbeId=this.setEnvmapLegacy,this.onBeforeRender=this.onBeforeRenderLegacy):(this.setEnvmapByProbeId=this.setEnvmap,this.onBeforeRender=this.onBeforeRenderNew)},G.prototype.invalidateEnvmap=function(p){var G=this.gv;"legacy"!==G.getEnvmapType()&&G.getGL()&&(p?(delete this._envmapHash[p],delete this._probeCaptureTime[p]):(this._envmapHash={},this._probeCaptureTime={}),G.iv())},G.prototype.contextLost=function(){this._envmaps={},this._envmapHash={},this._pingPongRenderTarget=null,this._equirectShader=this._cubemapShader=this._blurMaterial=null,this._envmapLegacy=null,this._lastLegacyImage=null},G.prototype.onBeforeRenderLegacy=function(p){this.assureTextureLegacy(p)},G.prototype.assureTextureLegacy=function(p){var G,v,J=this.gv.getEnvmap();J!==this._lastLegacyImage&&(this._envmapLegacy&&(p.deleteTexture(this._envmapLegacy),this._envmapLegacy=null),J?(G=N.getImage(J))&&G.tagName&&(G=N.resizeImagePOT(G,!0),v=this._envmapLegacy=p.createTexture(),p.activeTexture(p.TEXTURE0),p.bindTexture(p.TEXTURE_CUBE_MAP,v),p.texParameteri(p.TEXTURE_CUBE_MAP,p.TEXTURE_MAG_FILTER,p.LINEAR),p.texParameteri(p.TEXTURE_CUBE_MAP,p.TEXTURE_MIN_FILTER,p.LINEAR),p.texImage2D(p.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,p.RGBA,p.RGBA,p.UNSIGNED_BYTE,G),p.texImage2D(p.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,p.RGBA,p.RGBA,p.UNSIGNED_BYTE,G),p.texImage2D(p.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,p.RGBA,p.RGBA,p.UNSIGNED_BYTE,G),p.texImage2D(p.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,p.RGBA,p.RGBA,p.UNSIGNED_BYTE,G),p.texImage2D(p.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,p.RGBA,p.RGBA,p.UNSIGNED_BYTE,G),p.texImage2D(p.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,p.RGBA,p.RGBA,p.UNSIGNED_BYTE,G),p.bindTexture(p.TEXTURE_CUBE_MAP,p._emptyCubeTexture),this._lastLegacyImage=J):this._lastLegacyImage=J)},G.prototype.setEnvmapLegacy=function(p,G){p.uEnvMap=this._envmapLegacy},G.prototype.onBeforeRenderNew=function(p){this.assureTextureNew(p),this.resetUniformCache()},G.prototype.assureTextureNew=function(p){var G=this.gv,v=G.getEnvmap(),J=this._envmapHash,$=this._envmaps,p=p._renderInfo.frame;if(!(this._lastCaptureFrame>=p||G._picking))for(var S in v){var O=v[S];switch(O.type){case"sphere":(z=O.image)!==J[S]&&(l1=N.getImage(z))&&(J[S]=z,Wr($,S,this.fromEquirectangular(z)));break;case"cube":var W=O.images;if(W&&6===W.length&&(z=W.join(","))!==J[S]){for(var l=!0,t=0;t<6;t++)if(!N.getImage(W[t])){l=!1;break}l&&(J[S]=z,Wr($,S,this.fromCubemap(W)))}break;case"skybox":var z,Z=G.getSkybox();if(Z)if((z="sphere"===(q=Z.s("shape3d"))?Z._id+"_"+Z.s("shape3d.image"):Z._id+"_"+Z.s("front.image"))!==J[S]){if("sphere"===q)l=N.getImage(Z.s("shape3d.image"));else for(var l=!0,B=["front","back","left","right","top","bottom"],t=0;t<6;t++)if(!N.getImage(Z.s(B[t]+".image"))){l=!1;break}l&&(J[S]=z,Wr($,S,this.fromSkybox()))}break;case"probe":var f,X,q=O.pos,g=O.size;(z=q[0]+"_"+q[1]+"_"+q[2]+"_"+g)!==J[S]&&(f=this._probeCaptureTime[z],X=Date.now(),f||(this._probeCaptureTime[z]=f=X),X-f>N.envmapProbeMinWaitTime&&!Ni&&!Ap||X-f>N.envmapProbeMaxWaitTime?(delete this._probeCaptureTime[z],J[S]=z,Wr($,S,this.fromSceneProbe(q,g,O.filter))):G.iv())}}},G.prototype.resetUniformCache=function(){this._frameUniformCache={}},G.prototype.setEnvmap=function(p,G){var v=p.uuid,J=this._frameUniformCache,G=(G=this._envmaps[G])&&G.texture;J[v]!==G&&(J[v]=G,p.uEnvMap=G)},G.prototype.fromEquirectangular=function(p){var G=E.Default.getImage(p);return this.rectSize=[1/G.width,1/G.height],p=this.gv.getTexture(p),this.fromTexture(p)},G.prototype.fromCubemap=function(p){for(var G=this.gv.getGL(),v=G.createTexture(),J=(G.activeTexture(G.TEXTURE0),G.bindTexture(G.TEXTURE_CUBE_MAP,v),G.texParameteri(G.TEXTURE_CUBE_MAP,G.TEXTURE_MAG_FILTER,G.LINEAR),G.texParameteri(G.TEXTURE_CUBE_MAP,G.TEXTURE_MIN_FILTER,G.LINEAR),[]),$=Pe/3,S=0;S<6;S++)J[S]=N.resizeImage(E.Default.getImage(p[S]),$);return G.texImage2D(G.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,G.RGBA,G.RGBA,G.UNSIGNED_BYTE,J[0]),G.texImage2D(G.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,G.RGBA,G.RGBA,G.UNSIGNED_BYTE,J[1]),G.texImage2D(G.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,G.RGBA,G.RGBA,G.UNSIGNED_BYTE,J[2]),G.texImage2D(G.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,G.RGBA,G.RGBA,G.UNSIGNED_BYTE,J[3]),G.texImage2D(G.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,G.RGBA,G.RGBA,G.UNSIGNED_BYTE,J[4]),G.texImage2D(G.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,G.RGBA,G.RGBA,G.UNSIGNED_BYTE,J[5]),G.bindTexture(G.TEXTURE_CUBE_MAP,G._emptyCubeTexture),this.fromTexture(v,!0)},G.prototype.fromTexture=function(p,G){var v=this._allocateTargets(),J=(this._pingPongRenderTarget||(this._pingPongRenderTarget=this._allocateTargets()),this.gv),$=J.getGL(),S=r.for($).directState(),O=S.depth.enabled,W=(S.scissor.enabled=!0,S.depth.enabled=!1,J.getViewport($));return this._textureToCubeUV(p,v,G),this._applyPMREM(v),v.unbind($),J.setViewport($,W[0],W[1],W[2],W[3]),S.depth.enabled=O,S.scissor.enabled=!1,v},G.prototype.fromSkybox=function(){return this._fromCamera(function(p){p.s({"camera.onlySky":!0})})},G.prototype.fromScene=function(G){return this._fromCamera(function(p){p.s({"camera.onlySky":!1}),G&&G(p)})},G.prototype.fromNode=function(p){var G,v=this.gv.getData3dUI(p),J=v._42,$=(v._42=Ii,this.gv.getSkybox()),S=p.p3(),p=($&&(G=$.p3(),$.p3(S)),this.fromScene(function(p){p.p3(S)}));return v._42=J,$&&$.p3(G),p},G.prototype.fromSceneProbe=function(G,v,J){var p,$,S=this.gv,O=S.getSkybox(),W=(O&&(p=O.p3(),O.p3(G)),J&&($=S.isVisible,S.isVisible=function(p){var G=J(p);return G!==K?G:$.call(S,p)}),this.fromScene(function(p){p.p3(G),p.s("camera.near",v)}));return J&&(S.isVisible=$),O&&O.p3(p),W},G.prototype._fromCamera=function(p){var G=this.gv,v=G.getCamera(),p=(p&&p(v),new Jk(G,Pe,Pe,{cube:!0})),J=G.getGL(),$=G.getViewport(J),S=this.setEnvmapByProbeId,O=this.onBeforeRender,v=(this.setEnvmapByProbeId=function(p){p.envMap=J._emptyTexture},this.onBeforeRender=Ii,v.attachRenderTarget(p),v.render(G),v.detachRenderTarget(),this.setEnvmapByProbeId=S,this.onBeforeRender=O,G.setViewport(J,$[0],$[1],$[2],$[3]),this.fromTexture(p.texture,!0));return p.releaseTexture(),v},G.prototype._allocateTargets=function(p){return new Jk(this.gv,3*ne,3*ne,{magFilter:w.NEAREST,minFilter:w.NEAREST})},G.prototype._textureToCubeUV=function(p,G,v){var J=this.gv,$=(v?null==(S=this._cubemapShader)&&(this._cubemapShader=S=this.createShader({vs:tr(),fs:["precision mediump float;\n","precision mediump int;\n","varying vec3 vOutputDirection;","uniform samplerCube envMap;\n",lr(),"\n void main() {","gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );","gl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3(- vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;","gl_FragColor = linearToOutputTexel( gl_FragColor );","}"].join("")})):null==(S=this._equirectShader)&&(this._equirectShader=S=this.createShader({vs:tr(),fs:["precision mediump float;\n","precision mediump int;\n","varying vec3 vOutputDirection;","uniform sampler2D envMap;","uniform vec2 texelSize;\n",lr(),"\n #define RECIPROCAL_PI 0.3183098861837907 \n","\n #define RECIPROCAL_PI2 0.15915494309189535 \n","vec2 equirectUv( in vec3 dir ) {","float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;","float v = 0.5 - asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI;","return vec2( u, v );","}","void main() {","gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );","vec3 outputDirection = normalize( vOutputDirection );","vec2 uv = equirectUv( outputDirection );","vec2 f = fract( uv / texelSize - 0.5 );","uv -= f * texelSize;","vec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;","uv.x += texelSize.x;","vec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;","uv.y += texelSize.y;","vec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;","uv.x -= texelSize.x;","vec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;","vec3 tm = mix( tl, tr, f.x );","vec3 bm = mix( bl, br, f.x );","gl_FragColor.rgb = mix( tm, bm, f.y );","gl_FragColor = linearToOutputTexel( gl_FragColor );","}"].join("")})),J.getGL());G.bind($),this._setViewport(G,0,0,3*ne,2*ne);(G=J.getRenderState()).useProgram(S);var J=G.directUniforms(),S=G.directAttribs(),G=(J.envMap=p,v||(J.texelSize=this.rectSize),he[0]);S.position=iZ($,null,G.vs,v0,3),S.uv=iZ($,null,G.uv,v0,2),S.faceIndex=iZ($,null,G.faceIs,v0,1),wZ($,0,G.vs.length/3)},G.prototype._applyPMREM=function(p){for(var G,v,J=1;J<Ye;J++)G=Math.sqrt(de[J]*de[J]-de[J-1]*de[J-1]),v=ce[(J-1)%ce.length],this._blur(p,J-1,J,G,v)},G.prototype._setViewport=function(p,G,v,J,$){var S=this.gv;S.setViewport(S.getGL(),G,v,J,$),S.getRenderState().directState().scissor.box=[G,v,J,$]},G.prototype._blur=function(p,G,v,J,$){var S=this._pingPongRenderTarget;this._halfBlur(p,S,G,v,J,"latitudinal",$),this._halfBlur(S,p,v,v,J,"longitudinal",$)},G.prototype.createShader=function(p){var G=this.gv;return G.getPostProcessing().createShader(G.getGL(),p).program},G.prototype._halfBlur=function(p,G,v,J,$,S,O){var W=this.gv,l=this._blurMaterial;if("latitudinal"===S||"longitudinal"===S){l||(this._blurMaterial=l=this.createShader((z=se,{vs:tr(),fs:["precision mediump float;\n","precision mediump int;\n","#define n "+z+"\n","varying vec3 vOutputDirection;","uniform sampler2D envMap;","uniform int samples;","uniform float weights[ n ];","uniform bool latitudinal;","uniform float dTheta;","uniform float mipInt;","uniform vec3 poleAxis; \n",lr(),"\n #define ENVMAP_TYPE_CUBE_UV \n",["\n #ifdef ENVMAP_TYPE_CUBE_UV \n","#define cubeUV_maxMipLevel 8.0 \n","#define cubeUV_minMipLevel 4.0 \n","#define cubeUV_maxTileSize 256.0 \n","#define cubeUV_minTileSize 16.0 \n","float getFace(vec3 direction) {","vec3 absDirection = abs(direction);","float face = - 1.0;","if (absDirection.x > absDirection.z) {","if (absDirection.x > absDirection.y)","face = direction.x > 0.0 ? 0.0 : 3.0;"," else ","face = direction.y > 0.0 ? 1.0 : 4.0;","} else {","if (absDirection.z > absDirection.y) ","face = direction.z > 0.0 ? 2.0 : 5.0;"," else ","face = direction.y > 0.0 ? 1.0 : 4.0;","}","return face;","} ","vec2 getUV(vec3 direction, float face) {","vec2 uv;","if (face == 0.0) {","uv = vec2(direction.z, direction.y) / abs(direction.x);","} else if (face == 1.0) {","uv = vec2(- direction.x, - direction.z) / abs(direction.y);","} else if (face == 2.0) {","uv = vec2(- direction.x, direction.y) / abs(direction.z);","} else if (face == 3.0) {","uv = vec2(- direction.z, direction.y) / abs(direction.x);","} else if (face == 4.0) {","uv = vec2(- direction.x, direction.z) / abs(direction.y);","} else {","uv = vec2(direction.x, direction.y) / abs(direction.z);","}","return 0.5 * (uv + 1.0);","} ","vec3 bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {","float face = getFace(direction);","float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);","mipInt = max(mipInt, cubeUV_minMipLevel);","float faceSize = exp2(mipInt);","float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);","vec2 uv = getUV(direction, face) * (faceSize - 1.0);","vec2 f = fract(uv);","uv += 0.5 - f;","if (face > 2.0) {","uv.y += faceSize;","face -= 3.0;","}","uv.x += face * faceSize;","if (mipInt < cubeUV_maxMipLevel) {","uv.y += 2.0 * cubeUV_maxTileSize;","}","uv.y += filterInt * 2.0 * cubeUV_minTileSize;","uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);","uv *= texelSize;","vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;","uv.x += texelSize;","vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;","uv.y += texelSize;","vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;","uv.x -= texelSize;","vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;","vec3 tm = mix(tl, tr, f.x);","vec3 bm = mix(bl, br, f.x);","return mix(tm, bm, f.y);","}","\n #define r0 1.0 \n","#define v0 0.339 \n","#define m0 - 2.0 \n","#define r1 0.8 \n","#define v1 0.276 \n","#define m1 - 1.0 \n","#define r4 0.4 \n","#define v4 0.046 \n","#define m4 2.0 \n","#define r5 0.305 \n","#define v5 0.016 \n","#define m5 3.0 \n","#define r6 0.21 \n","#define v6 0.0038 \n","#define m6 4.0 \n","float roughnessToMip(float roughness) {","float mip = 0.0;","if (roughness >= r1) {","mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;","} else if (roughness >= r4) {","mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;","} else if (roughness >= r5) {","mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;","} else if (roughness >= r6) {","mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;","} else {","mip = - 2.0 * log2(1.16 * roughness);","}","return mip;","} ","vec4 textureCubeUV(sampler2D envMap, vec3 sampleDir, float roughness) {","float mip = clamp(roughnessToMip(roughness), m0, cubeUV_maxMipLevel);","float mipF = fract(mip);","float mipInt = floor(mip);","vec3 color0 = bilinearCubeUV(envMap, sampleDir, mipInt);","if (mipF == 0.0) {","return vec4(color0, 1.0);","} else {","vec3 color1 = bilinearCubeUV(envMap, sampleDir, mipInt + 1.0);","return vec4(mix(color0, color1, mipF), 1.0);","}","} ","\n #endif \n"].join(""),"\n vec3 getSample( float theta, vec3 axis ) {","float cosTheta = cos( theta );","vec3 sampleDirection = vOutputDirection * cosTheta + cross(axis, vOutputDirection) * sin(theta) + axis * dot(axis, vOutputDirection) * (1.0 - cosTheta);","return bilinearCubeUV( envMap, sampleDirection, mipInt );","}","void main() {","vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );","if ( all( equal( axis, vec3( 0.0 ) ) ) ) {","axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );","}","axis = normalize( axis );","gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );","gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );","for ( int i = 1; i < n; i++ ) {","if ( i >= samples ) { break; }","float theta = dTheta * float( i );","gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );","gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );","}","gl_FragColor = linearToOutputTexel( gl_FragColor );","}"].join("")})));var t,z=W.getGL();G.bind(z);(W=W.getRenderState()).useProgram(l);for(var l=W.directUniforms(),W=W.directAttribs(),Z=we[v]-1,B=$/(Z=isFinite($)?Math.PI/(2*Z):2*Math.PI/(2*se-1)),f=isFinite($)?1+Math.floor(3*B):se,X=[],q=0,g=0;g<se;++g)M=g/B,t=Math.exp(-M*M/2),X.push(t),0==g?q+=t:g<f&&(q+=2*t);for(g=0;g<X.length;g++)X[g]=X[g]/q;l.envMap=p.texture,l.samples=f,l.weights=X,l.latitudinal="latitudinal"===S,O&&(l.poleAxis=O),l.dTheta=Z,l.mipInt=be-v;var $=we[J],M=3*Math.max(0,ne-2*$),p=(this._setViewport(G,M,(0===J?0:2*ne)+2*$*(be-_e<J?J-be+_e:0),3*$,2*$),he[J]);W.position=iZ(z,null,p.vs,v0,3),W.uv=iZ(z,null,p.uv,v0,2),W.faceIndex=iZ(z,null,p.faceIs,v0,1),wZ(z,0,p.vs.length/3),G.unbind(z)}},_e=4,be=8,ne=Math.pow(2,be),Ye=be-_e+1+(De=[.125,.215,.35,.446,.526,.582]).length,se=20,i0=1/(G=(1+Math.sqrt(5))/2),ce=[new m(1,1,1),new m(-1,1,1),new m(1,1,-1),new m(-1,1,-1),new m(0,G,i0),new m(0,G,-i0),new m(i0,0,G),new m(-i0,0,G),new m(G,i0,0),new m(-G,i0,0)],G=function(){for(var p=[],G=[],v=[],J=be,$=0;$<Ye;$++){var S=Math.pow(2,J),O=(G.push(S),1/S);be-_e<$?O=De[$-be+_e-1]:0==$&&(O=0),v.push(O);for(var W=-(O=1/(S-1))/2,l=1+O/2,t=[],z=[],Z=[],B=0;B<6;B++){var f=B%3*2/3-1,X=2<B?0:-1;t.push(f,X,0,f+2/3,X,0,f+2/3,1+X,0,f,X,0,f+2/3,1+X,0,f,1+X,0),z.push(W,W,l,W,l,l,W,W,l,l,W,l),Z.push(B,B,B,B,B,B)}p.push({vs:new pm(t),uv:new pm(z),faceIs:new pm(Z)}),_e<J&&J--}return{_lodPlanes:p,_sizeLods:G,_sigmas:v}}(),he=G._lodPlanes,we=G._sizeLods,de=G._sigmas,Pe=N.EnvmapTextureSize,["left","front","right","back","top","bottom"]),Gk=Gp._RenderList=function(p){var g=[],M=[],G={},v={},J={},$={},S={},O={},L={};return{opaque:g,transparent:M,init:function(){g.length=0,M.length=0,L={}},push:function(p,G){if(G){var v,J,$,S,O=p,W=O.gv,l=O.data,t=O.shapeModel;if(t){var z,Z,B=l.s("shape3d.transparent")||l.s("points.transparent");for(lS(t)||(z=V(t.transparent,l,W),t=[t]),$=0,S=t.length;$<S;$++)Z=t[$],(Z=(Z=(Z=V(Z.transparent,l,W))===K?z:Z)===K?B:Z)?J=!0:v=!0}for($=0,S=pk.length;$<S;$++){var f=O[pk[$]];f&&(f.transparent?J=!0:v=!0)}W.isLabelVisible(l)&&(O.labelInfo&&(l.s(jJ+".transparent")?J=!0:v=!0),O.label2Info&&(l.s(iJ+".transparent")?J=!0:v=!0)),W.isNoteVisible(l)&&(O.noteInfo&&(l.s(rJ+".transparent")?J=!0:v=!0),O.note2Info&&(l.s(eJ+".transparent")?J=!0:v=!0)),O._38o&&(J=v=!0),O._renderParams={opaque:v=!J||v,transparent:J}}var X,q=(G=p.data)._id;L[q]||(L[q]=!0,(X=p._renderParams)&&!1!==X.visible&&(p={ui:p,data:G,z:0,id:q},X.opaque&&g.push(p),X.transparent&&M.push(p)))},batchModelMap:G,batchIndexMap:v,polylineModelMap:J,polylineIndexMap:$,wireframeModelMap:S,wireframeIndexMap:O,ivBatch:function(p){p?(Xp(G,v,p),Xp(J,$,p),Xp(S,O,p)):(G=this.batchModelMap={},v=this.batchIndexMap={},J=this.polylineModelMap={},$=this.polylineIndexMap={},S=this.wireframeModelMap={},O=this.wireframeIndexMap={}),this.markBatchInvalid()},ivModelBatch:function(p){p?Xp(G,v,p):(G=this.batchModelMap={},v=this.batchIndexMap={}),this.markBatchInvalid()},ivPolylineBatch:function(p){p?Xp(J,$,p):(J=this.polylineModelMap={},$=this.polylineIndexMap={}),this.markBatchInvalid()},ivWireframeBatch:function(p){p?Xp(S,O,p):(S=this.wireframeModelMap={},O=this.wireframeIndexMap={}),this.markBatchInvalid()},markBatchInvalid:function(){this._batchInvalid=!0},isBatchInvalid:function(){return this._batchInvalid},onUpdated:function(){this._batchInvalid=null},sort:function(p,G){if(1<M.length){for(var v,J,$=[0,0,0,0],S=0,O=M.length;S<O;S++)(J=(v=M[S].data)._position)?($[0]=J.x,$[1]=v._54O,$[2]=J.y,$[3]=1,tm($,G),M[S].z=$[2]/$[3]):M[S].z=0;M.sort(p||zr)}}}},vk=Gp._RenderLists=function(J){var $={};function v(p,G){var v=$[p=p||"main"];return!v&&G?$[p]=new Gk(J):v}return{init:function(){for(var p in $)$[p].init()},onUpdated:function(){for(var p in $)$[p].onUpdated()},get:v,push:function(p,G){v(p.data.getRenderLayer(),!0).push(p,G)},each:function(p){for(var G in $)p($[G])},lists:$}},Jk=Gp.RenderTarget=function(p,G,v,J){var $;null!=G&&G.canvas?($=G,G=v,v=J,J=arguments[4]):$=p.getGL(),J=J||{},J.cube?J.samples=0:J.samples=Math.min(p._glCapabilities.maxSamples,J.samples&&1<J.samples&&2===p._webGLVersion?J.samples:0),this.options=J,this.uuid=E.Math.generateUUID(),this.gv=p,this.init(p,$,J),this.format=J.format||w.RGBA,this.generateMipmaps=!!J.generateMipmaps,this.depthInternalFormat=J.depthFormat||$.DEPTH_COMPONENT16,J.samples&&!p._glCapabilities._maxSamplesChecked?this.setSize($,G||1,v||1):this.setSize($,G,v)},Cl=(d.assign(Gp.RenderTarget.prototype,{bind:function(p,G){var v,J,$,S=this.options;S.autoSize&&(v=($=this.gv).getDevicePixelRatio(),J=$.getWidth()*v,$=$.getHeight()*v,this.setSize(p,J,$)),S.cube?es(p,this.frame[G]):es(p,this.options.samples?this._MSAAFbo:this.frame)},unbind:function(p){As(p),this.options.samples&&(p.bindFramebuffer(p.READ_FRAMEBUFFER,this._MSAAFbo),p.bindFramebuffer(p.DRAW_FRAMEBUFFER,this.frame),p.blitFramebuffer(0,0,this.width,this.height,0,0,this.width,this.height,p.COLOR_BUFFER_BIT,p.NEAREST),p.bindFramebuffer(p.READ_FRAMEBUFFER,null),p.bindFramebuffer(p.DRAW_FRAMEBUFFER,null))},isCube:function(){return this.options.cube},init:function(p,G,v){var J=v.samples,$=v.cube,S=this.texture=G.createTexture(),O=$?w.TEXTURE_CUBE_MAP:w.TEXTURE_2D,S=(G.activeTexture(G.TEXTURE0),G.bindTexture(O,S),G.texParameteri(O,G.TEXTURE_WRAP_S,v.wrapS||G.CLAMP_TO_EDGE),G.texParameteri(O,G.TEXTURE_WRAP_T,v.wrapT||G.CLAMP_TO_EDGE),J?G.NEAREST:G.LINEAR);if(G.texParameteri(O,G.TEXTURE_MIN_FILTER,v.minFilter||S),G.texParameteri(O,G.TEXTURE_MAG_FILTER,v.magFilter||S),G.bindTexture(O,null),$){this.depth=[],this.frame=[];for(var W=0;W<6;W++)this.depth[W]=G.createRenderbuffer(),this.frame[W]=G.createFramebuffer()}else this.depth=G.createRenderbuffer(),this.frame=G.createFramebuffer();this.assureTexture()},assureTexture:function(){this.gv._2Oi(this.uuid,this.texture,"default"),E.Default.setImage(this.uuid,null)},releaseTexture:function(){this.gv.deleteTexture(this.uuid)},setSize:function(p,G,v){var J=this;if(G=Math.round(G),v=Math.round(v),G&&v&&(J.width!==G||J.height!==v)){J.width=G,J.height=v;var $=p.RENDERBUFFER,S=p.FRAMEBUFFER,O=J.options.samples,W=J.options.cube,l=W?w.TEXTURE_CUBE_MAP:w.TEXTURE_2D;if(O){var t=J.gv._glCapabilities;if(!t._maxSamplesChecked){for(p.bindRenderbuffer($,J.depth),p.getError();1<O&&(p.renderbufferStorageMultisample($,O,J.depthInternalFormat,G,v),p.getError());)O=Math.floor(O>>1);O<=1&&(O=0,p.texParameteri(l,p.TEXTURE_MIN_FILTER,J.options.minFilter||p.LINEAR),p.texParameteri(l,p.TEXTURE_MAG_FILTER,J.options.magFilter||p.LINEAR),p.renderbufferStorage($,J.depthInternalFormat,G,v)),t._maxSamplesChecked=!0,t.maxSamples=J.options.samples=O,p.bindRenderbuffer($,v0)}}if(O&&(J._MSAAFbo||(J._MSAAFbo=p.createFramebuffer(),J._MSAARbO=p.createRenderbuffer()),p.bindRenderbuffer($,J._MSAARbO),p.renderbufferStorageMultisample(p.RENDERBUFFER,O,p.RGBA8,G,v),es(p,J._MSAAFbo),p.framebufferRenderbuffer(S,p.COLOR_ATTACHMENT0,$,J._MSAARbO),p.framebufferRenderbuffer(S,p.DEPTH_ATTACHMENT,$,J.depth),As(p),p.bindRenderbuffer($,null)),p.activeTexture(p.TEXTURE0),p.bindTexture(l,J.texture),W)for(var z=p.TEXTURE_CUBE_MAP_POSITIVE_X,Z=0;Z<6;Z++)J.setupFrameBufferTextureAndDepth(p,J.frame[Z],J.depth[Z],z+Z);else J.setupFrameBufferTextureAndDepth(p,J.frame,J.depth,p.TEXTURE_2D);J.generateMipmaps&&(2===gv._webGLVersion||sh.isPOT(G)&&sh.isPOT(v))&&(p.generateMipmap(l),t=J.options.minFilter||(O?p.NEAREST:p.LINEAR),p.texParameteri(l,p.TEXTURE_MIN_FILTER,t===p.NEAREST?p.NEAREST_MIPMAP_NEAREST:p.LINEAR_MIPMAP_LINEAR)),p.bindTexture(l,null)}},setupFrameBufferTextureAndDepth:function(p,G,v,J){var $=this.format;p.texImage2D(J,0,$,this.width,this.height,0,$,p.UNSIGNED_BYTE,null),es(p,G),p.framebufferTexture2D(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0,J,this.texture,0),this.setupRenderBufferStorage(p,v),As(p)},setupRenderBufferStorage:function(p,G){var v=p.RENDERBUFFER,J=(p.bindRenderbuffer(v,G),this.options.samples);J?p.renderbufferStorageMultisample(v,J,this.depthInternalFormat,this.width,this.height):(p.renderbufferStorage(v,this.depthInternalFormat,this.width,this.height),p.framebufferRenderbuffer(p.FRAMEBUFFER,p.DEPTH_ATTACHMENT,v,G)),p.bindRenderbuffer(p.RENDERBUFFER,null)},toCanvas:function(){var p=this.gv.getGL(),G=(es(p,this.frame),this.width),v=this.height,J=new Uint8Array(G*v*4);p.readPixels(0,0,G,v,this.format,p.UNSIGNED_BYTE,J),As(p);(p=B.createElement("canvas")).width=G,p.height=v;var $=p.getContext("2d");return(G=$.createImageData(G,v)).data.set(J),$.putImageData(G,0,0),p}}),Gp.Interactor=function(p){this.gv=this.g3d=p}),$k=(S("Interactor",d,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()},fi:function(p){this.gv.fi(p)},startDragging:function(p){mA(this,p)}}),Gp.DefaultInteractor=function(p){bS($k,this,[p])}),Sk=(S("DefaultInteractor",Cl,{getState:function(){return this._62O},setState:function(p){this._62O=p},getDataInfoAt:function(p,G){var v=this.gv,J=v.getDataInfoAt(p);if(!v.isBlockSelectable()||!J||!J.data)return J;if(!G&&v.isSelected(J.data))return J;for(var $=J.data;($=$.getParent())&&$ instanceof E.Block&&v.isSelectable($);){var S=v.isSelected($);if(S&&G)break;if(J={data:$,part:J.part},S&&!G)break}return J},handle_contextmenu:function(p){tA(p)},handle_mousewheel:function(p){this.gv.handleScroll(p,p.wheelDelta/40)},handle_DOMMouseScroll:function(p){2===p.axis&&this.gv.handleScroll(p,-p.detail)},handle_keydown:function(p){this.gv.handleKeyDown(p)},handle_mousedown:function(p){this.handle_touchstart(p)},handle_touchstart:function(p){tA(p);var G=this,v=G.gv,J=YA(p),$=(S=G.getDataInfoAt(p))?S.data:v0,S=S?S.part:v0,O=v.sm(),W=LE(p),l=hA(p);v.setFocus(p)&&(G._62O=v0,G._57I=v0,G.pendingClickThrough=v0,G.__lastClientPoint__=i(p),$?PA(p)?O.co($)?O.rs($):O.as($):O.co($)?$ instanceof hI&&$.isClickThroughEnabled()&&YA(p)&&(G.pendingClickThrough=i(p)):O.ss($):J&&(PA(p)?v.isRectSelectable()&&(G._62O=UJ):G._57I=i(p)),G._31Q&&(qA(G._31Q),delete G._31Q,delete G._32Q),G._62O||(v.isFirstPersonMode()&&(dA(p)||sA(p)||2<l?G._62O="pan":v.isMouseRoamable()||ZE(p)?(G._62O="roaming",G.foward=W&&YA(p),G._32Q=Vi(),G._31Q=XA(G.tick,G)):J||(G._62O="roaming")),G._62O||(J&&W&&bk[S]?(G._62O=S,G.p3=$.p3()):J&&W&&k($)&&v.isSelected($)?v.isMovable($)?(G._62O="move",G.p3=$.p3(),G.movedata=$):v._39Q($)&&(G._62O="none"):ZE(p)&&(2<l?G._62O="pan":2===l&&(G.dist=B4(p),G._62O="pinch")))),G.point=v.lp(p),mA(G,p),wA(p)?v.handleDoubleClick(p,$,S):v.handleClick(p,$,S))},tick:function(){var p=this.gv,G=p._moveStep;this.point&&p.isWalkable()&&(this._32Q&&(G*=(Vi()-this._32Q)/50),p.walk(this.foward?G:-G),this._32Q=Vi(),this._31Q=XA(this.tick,this))},handle_mouseup:function(p){this.handle_touchend(p)},handle_touchend:function(p){var G=this._57I;G&&(iA(G,i(p))<=1&&this.gv.sm().cs(),this._57I=v0),(G=this.pendingClickThrough)&&(iA(G,i(p))<=1&&(G=this.getDataInfoAt(p))&&G.data instanceof hI&&G.data.isClickThroughEnabled()&&(G=this.getDataInfoAt(p,!0))&&(p.clickThrough=!0,this.gv.sm().ss(G.data)),this.pendingClickThrough=null)},handleWindowMouseMove:function(p){this.handleWindowTouchMove(p)},handleWindowTouchMove:function(G){var v,J,p=this,$=p.gv,S=p._62O,O=p.point,W=$.dm(),l=$.lp(G),t=l.x-O.x,z=l.y-O.y,Z=$.getWidth(),B=$.getHeight();if(Z&&B){var f=i(G),f=_j($,f,p.__lastClientPoint__),f=iA({x:0,y:0},f),X=-W0*t/Z,q=-W0*z/B;if("roaming"===S)p.rotate(G,X/2,q/2);else if(S===qk||S===gk||S===Mk)$._86O||W.beginTransaction(),$.fi({kind:$._86O?"betweenEditRotation":"beginEditRotation",event:G}),$._86O=1,$.sm().each(function(p){var G;k(p)&&$.isRotationEditable(p)&&(G=I(X)>I(q)?X:q,S===qk?p.setRotationX(p.getRotationX()+G):S===gk?p.setRotationY(p.getRotationY()+G):S===Mk&&p.setRotationZ(p.getRotationZ()+G))});else if("move"===S||bk[S]){if(S===Lk||S===Hk||S===_k)$._87O||W.beginTransaction(),$.fi({kind:$._87O?"betweenEditScale":"beginEditScale",event:G}),$._87O=1;else{if(!$._moving){if(f<N.touchMoveThreshold)return;W.beginTransaction()}$.fi({kind:$._moving?"betweenMove":"beginMove",event:G}),$._moving=1}var g,M,f=p.p3,W=$.getPositionInfo(f),L=OZ($),H=S===Bk?"x":S===fk?"y":S===Xk?"z":S===Lk?"sx":S===Hk?"sy":S===_k?"sz":$.getMoveMode(G,p.movedata),t=t/Z*W.width,z=-1*z/B*W.height,Z=[L[0]*t,L[4]*t,L[8]*t],B=[L[1]*z,L[5]*z,L[9]*z],W=Z[0]+B[0],L=Z[1]+B[1],Z=Z[2]+B[2],B=[f[0]+W,f[1]+L,f[2]+Z],_=Gm($.getEye(),B,!0);if("xyz"===H?(g=B,$.moveSelection(W,L,Z)):"xz"===H?(g=Ts($,f,[0,1,0],B))&&$.moveSelection(g[0]-f[0],0,g[2]-f[2]):"xy"===H?(g=Ts($,f,[0,0,1],B))&&$.moveSelection(g[0]-f[0],g[1]-f[1],0):"yz"===H?(g=Ts($,f,[1,0,0],B))&&$.moveSelection(0,g[1]-f[1],g[2]-f[2]):"x"===H||"sx"===H?(_[0]=0,(g=Ts($,f,_,B))&&(M=g[0]-f[0],"x"===H?$.moveSelection(M,0,0):$.sm().each(function(p){k(p)&&$.isSizeEditable(p)&&(v=p.getScaleX()+M/100,J=v/p.getScaleX(),p.setScaleX(v),dA(G)&&(p.setScaleY(p.getScaleY()*J),p.setScaleTall(p.getScaleTall()*J)))}))):"y"===H||"sy"===H?(_[1]=0,(g=Ts($,f,_,B))&&(M=g[1]-f[1],"y"===H?$.moveSelection(0,M,0):$.sm().each(function(p){k(p)&&$.isSizeEditable(p)&&(v=p.getScaleTall()+M/100,J=v/p.getScaleTall(),p.setScaleTall(v),dA(G)&&(p.setScaleY(p.getScaleY()*J),p.setScaleX(p.getScaleX()*J)))}))):"z"!==H&&"sz"!==H||(_[2]=0,(g=Ts($,f,_,B))&&(M=g[2]-f[2],"z"===H?$.moveSelection(0,0,M):$.sm().each(function(p){k(p)&&$.isSizeEditable(p)&&(v=p.getScaleY()+M/100,J=v/p.getScaleY(),p.setScaleY(v),dA(G)&&(p.setScaleX(p.getScaleX()*J),p.setScaleTall(p.getScaleTall()*J)))}))),!g)return;p.p3=g}else S===UJ?((W=p.div)||(W=p.div=yS(),KS(p.getView(),W),W.op=O,W.style.background=$.getRectSelectBackground()),$.fi({kind:$._rectSelecting?"betweenRectSelect":"beginRectSelect",event:G}),$._rectSelecting=1,W.rect=rA(W.op,l),P(W,W.rect)):"pinch"===S&&2===hA(G)?($.fi({kind:$._pinching?"betweenPinch":"beginPinch",event:G}),$._pinching=1,M=B4(G),$._lastZoomLP||($._lastZoomLP=(Z=(L=G).touches[0],L=L.touches[1],_=Z.clientX,Z=Z.clientY,{x:(_+L.clientX)/2,y:(Z+L.clientY)/2})),$.handlePinch(M,p.dist),p.dist=M):"pan"===S||dA(G)||sA(G)?p.pan(G,t,z):"none"===S||$.isFirstPersonMode()||p.rotate(G,X,q);p.point=l}},pan:function(p,G,v){var J,$,S=this.gv;S.isPannable()&&($=S.getWidth(),J=S.getHeight(),$&&J&&($=G/$*(G=S.getCenterInfo()).width,v=-1*v/J*G.height,S.fi({kind:S._panning?"betweenPan":"beginPan",event:p}),S._panning=1,S.pan(-$,-v)))},rotate:function(p,G,v){var J=this.gv;J.isRotatable()&&(J.fi({kind:J._rotating?"betweenRotate":"beginRotate",event:p}),J._rotating=1,J.rotate(G,v))},handleWindowMouseUp:function(p){this.handleWindowTouchEnd(p)},handleWindowTouchEnd:function(p){var G,v,J,$,S,O=this,W=O.gv,l=W.dm(),t=O.div;t&&((G=W.getDatasInRect(t.rect)).isEmpty()||(v=W.sm(),J=v.toSelection(),$=dA(p),S=p.altKey,G.each(function(p){v.co(p)?$&&!S||J.remove(p):(!S||$&&S)&&J.add(p)}),v.ss(J)),KA(t)),W._moving&&(delete W._moving,W.fi({kind:"endMove",event:p}),W.onMoveEnded(),l.endTransaction()),W._panning&&(delete W._panning,W.fi({kind:"endPan",event:p}),W.onPanEnded()),W._rotating&&(delete W._rotating,W.fi({kind:"endRotate",event:p}),W.onRotateEnded()),W._86O&&(delete W._86O,W.fi({kind:"endEditRotation",event:p}),l.endTransaction()),W._87O&&(delete W._87O,W.fi({kind:"endEditScale",event:p}),l.endTransaction()),W._pinching&&(delete W._pinching,W.fi({kind:"endPinch",event:p}),W.onPinchEnded()),W._rectSelecting&&(delete W._rectSelecting,W.fi({kind:"endRectSelect",event:p}),W.onRectSelectEnded()),W._walking&&(delete W._walking,W.fi({kind:"endWalk",event:p}),W.onWalkEnded()),W._lastZoomLP=W._lastZoomHit=null,O.dist=O.point=O._62O=O.p3=O.movedata=O.div=O._57I=O.pendingClickThrough=O._32Q=O._31Q=O.foward=v0,O.__lastClientPoint__=v0}}),Gp.MapInteractor=function(p){bS(Sk,this,[p]),this._keepHorizon=!0,this._threshold=2,this._touchScaleThreshold=.05,this._touchRotateThreshold=.03,this._touchScaleCheckAccuracy=.01,this._panButton="right",this._minPhi=0,this._maxPhi=5*Math.PI/12}),Ok=(S("MapInteractor",Cl,{setUp:function(){Sk.superClass.setUp.call(this);var p=this.gv;this.__oldMinPhi__=p.getRotateMinPhi(),this.__oldMaxPhi__=p.getRotateMaxPhi(),p.setRotateMinPhi(this._minPhi),p.setRotateMaxPhi(this._maxPhi)},tearDown:function(){Sk.superClass.tearDown.call(this);var p=this.gv;p.setRotateMinPhi(this.__oldMinPhi__),p.setRotateMaxPhi(this.__oldMaxPhi__),delete this.__oldMinPhi__,delete this.__oldMaxPhi__},handle_contextmenu:function(p){tA(p)},handle_mousewheel:function(p){this.gv.handleScroll(p,p.wheelDelta/40)},handle_DOMMouseScroll:function(p){2===p.axis&&this.gv.handleScroll(p,-p.detail)},handle_keydown:function(p){this.gv.handleKeyDown(p)},handle_mousedown:function(p){this.handle_touchstart(p)},handle_touchstart:function(p){tA(p);var G,v,J,$=this.gv;$.setFocus(p)&&(G=(v=$.getDataInfoAt(p))?v.data:v0,v=v?v.part:v0,this.__lastClientPoint__=i(p),J=this.editing={point:$.lp(p),data:G,part:v},ZE(p)?J.touch=!0:(J.touch=!1,J.clickLeft=YA(p),sA(p)?J.pan=!0:J.pan="left"===this.panButton===J.clickLeft),G&&$._39Q(G)&&(J.preventDefault=!0),mA(this,p),wA(p)?$.handleDoubleClick(p,G,v):$.handleClick(p,G,v))},handle_mouseup:function(p){this.handle_touchend(p)},handle_touchend:function(p){},handleWindowMouseMove:function(p){this.handleWindowTouchMove(p)},handleWindowTouchMove:function(p){var G=this,$=G.gv,v=G.editing;if(v){var J=$.lp(p),S=v.point,O=J.x-S.x,S=J.y-S.y;if(!v.moved){if(Math.abs(O)<G.threshold&&Math.abs(S)<G.threshold&&!(p.touches&&1<p.touches.length))return;v.moved=!0}if(!v.preventDefault){v.point=J;var W,l,t,z,Z,B,f=v.part;if(bk[f]){var J=v.data,X=$.dm(),q=$.getWidth(),g=$.getHeight(),M=-W0*O/q,L=-W0*S/g;if(f===qk||f===gk||f===Mk){$._86O||X.beginTransaction(),$.fi({kind:$._86O?"betweenEditRotation":"beginEditRotation",event:p}),$._86O=1;var H=I(M)>I(L)?M:L;$.sm().each(function(p){k(p)&&$.isRotationEditable(p)&&(f===qk?p.setRotationX(p.getRotationX()+H):f===gk?p.setRotationY(p.getRotationY()+H):f===Mk&&p.setRotationZ(p.getRotationZ()+H))})}else{var _,b,n,D,J=J.p3(),O=O/q*(s=$.getPositionInfo(J)).width,S=-1*S/g*s.height,Y=[(s=OZ($))[0]*O,s[4]*O,s[8]*O],s=[s[1]*S,s[5]*S,s[9]*S],Y=[J[0]+(Y[0]+s[0]),J[1]+(Y[1]+s[1]),J[2]+(Y[2]+s[2])],s=Gm($.getEye(),Y,!0);if(f===Lk||f===Hk||f===_k)$._87O||X.beginTransaction(),$.fi({kind:$._87O?"betweenEditScale":"beginEditScale",event:p}),$._87O=1,(_=Ts($,J,s,Y))&&(w=0,f===Lk?b="X":f===Hk?(b="Tall",w=1):f===_k&&(b="Y",w=2),(n=["X","Y","Tall"]).splice(n.indexOf(b),1),D=dA(p),h=(_[w]-J[w])/100,$.sm().each(function(G){var p,v,J;k(G)&&$.isSizeEditable(G)&&(p=G["getScale"+b](),G["setScale"+b](v=p+h),D&&(J=v/p,n.forEach(function(p){G["setScale"+p](G["getScale"+p]()*J)})))}));else if(f===Bk||f===fk||f===Xk){if(!$._moving){var c=i(p),c=_j($,c,G.__lastClientPoint__);if(iA({x:0,y:0},c)<N.touchMoveThreshold)return;X.beginTransaction()}$.fi({kind:$._moving?"betweenMove":"beginMove",event:p}),$._moving=1;var h,w=0;f===Bk?w=0:f===fk?w=1:f===Xk&&(w=2),s[w]=0,(_=Ts($,J,s,Y))&&(h=_[w]-J[w],(c=[0,0,0])[w]=h,$.moveSelection.apply($,c))}}}else v.touch?2!==(X=p.touches.length)?G.pan(p,O,S):X<=1||(Y=(s=p.touches)[0].clientX,_=s[0].clientY,c={x:(J=s[1].clientX)-Y,y:(w=s[1].clientY)-_},X=v.lastCenter,s=Math.atan2(c.y,c.x),W=0,(t=v.theta)==v0?t=v.theta=s:(W=s-t,v.thetaStarted||Math.abs(W)>G.touchRotateThreshold?(v.thetaStarted=!0,v.theta=s):W=0),t=j*(_+w)/2/$.getHeight(),s=0,(l=v.phi)==v0?l=v.phi=t:(s=t-l,v.phiStarted||Math.abs(s)>G.touchRotateThreshold?(v.phiStarted=!0,v.phi=t):s=0),l=Math.sqrt(c.x*c.x+c.y*c.y),(t=v.vlen)?(c=Y-X.x,Z=_-X.y,B=J-X.x,X=w-X.y,c=Math.sqrt(c*c+Z*Z),Z=Math.sqrt(B*B+X*X),(X=G._sign2(c-(B=t/2)))*(c=G._sign2(Z-B))<0||0===X&&0===c?(z=1,v.vlen=l):(z=z||l/t,v.scaleStarted||Math.abs(z-1)>G.touchScaleThreshold?(v.vlen=l,v.scaleStarted=!0):z=1)):(t=v.vlen=l,z=1),1!==z&&$.setZoom(z),(s||W)&&G.rotate(p,W,-s),v.lastCenter={x:(J+Y)/2,y:(w+_)/2}):v.pan?G.pan(p,O,S):(q=$.getWidth(),g=$.getHeight(),q&&g&&(M=-W0*O/q,L=-W0*S/g,G.rotate(p,M,L)))}}},_sign2:function(p){return Math.abs(p)<this._touchScaleCheckAccuracy?0:0<p?1:-1},handleWindowMouseUp:function(p){this.handleWindowTouchEnd(p)},getDataInfoAt:function(p,G){var v=this.gv,J=v.getDataInfoAt(p);if(!v.isBlockSelectable()||!J||!J.data)return J;if(!G&&v.isSelected(J.data))return J;for(var $=J.data,S=J.part;($=$.getParent())&&$ instanceof E.Block&&v.isSelectable($);){var O=v.isSelected($);if(O&&G)break;if(J={data:$,part:S},O&&!G)break}return J},handleWindowTouchEnd:function(p){var G,v,J=this.editing;this.editing=null,J&&(G=this.gv,J.moved||!J.clickLeft&&!J.touch?(G._panning=null,G._rotating=null,G.fi({kind:J.pan?"endPan":"endRotate",event:p})):(v=(v=(J=this.getDataInfoAt(p))&&J.data)instanceof hI&&v.isClickThroughEnabled()&&(J=this.getDataInfoAt(p,!0))?J.data:v)?G.sm().setSelection([v]):G.sm().clearSelection(),J=G.dm(),G._moving&&(delete G._moving,G.fi({kind:"endMove",event:p}),G.onMoveEnded(),J.endTransaction()),G._86O&&(delete G._86O,G.fi({kind:"endEditRotation",event:p}),J.endTransaction()),G._87O&&(delete G._87O,G.fi({kind:"endEditScale",event:p}),J.endTransaction()))},pan:function(p,G,v){var J=this.gv;if(J.isPannable()){var $=J.getWidth(),S=J.getHeight();if($&&S){var O=J.getCenterInfo(),G=-G/$*O.width,$=+v/S*O.height,v=(J.fi({kind:J._panning?"betweenPan":"beginPan",event:p}),J._panning=1,this.keepHorizon);if(!(v=(S=this.editing.touch)&&p.touches&&1<p.touches.length||!S&&dA(p)?!v:v))return J.pan(G,$);(G||$)&&(S=[(O=OZ(J))[0]*G,O[4]*G,O[8]*G],p=[O[1],0,O[9]],(v=Math.sqrt(p[0]*p[0]+p[2]*p[2]))&&(p=[p[0]/v*$,0,p[2]/v*$]),G=S[0]+p[0],O=S[1]+p[1],v=S[2]+p[2],$=J._center,S=J._eye,$[0]+=G,$[1]+=O,$[2]+=v,S[0]+=G,S[1]+=O,S[2]+=v,J.fp(JJ,v0,S),J.fp(vJ,v0,$))}}},rotate:function(p,G,v){var J,$,S=this.gv;S.isRotatable()&&($=S._center,J=S._eye,J=Gm(J,$),$=P0(Y0(J[0]*J[0]+J[2]*J[2]),J[1]),v=as(S,$+v)-$,S.fi({kind:S._rotating?"betweenRotate":"beginRotate",event:p}),S._rotating=1,S.rotate(G,v))}}),d.defineProperties(Sk.prototype,{panButton:{get:function(){return this._panButton},set:function(p){this._panButton=p}},minPhi:{get:function(){return this._minPhi},set:function(p){this.gv.setRotateMinPhi(this._minPhi=p)}},maxPhi:{get:function(){return this._maxPhi},set:function(p){this.gv.setRotateMaxPhi(this._maxPhi=p)}},keepHorizon:{get:function(){return this._keepHorizon},set:function(p){this._keepHorizon=p}},threshold:{get:function(){return this._threshold},set:function(p){this._threshold=p}},touchScaleThreshold:{get:function(){return this._touchScaleThreshold},set:function(p){this._touchScaleThreshold=p}},touchRotateThreshold:{get:function(){return this._touchRotateThreshold},set:function(p){this._touchRotateThreshold=p}}}),Gp.GlobeInteractor=function(f,p){function J(p){return f._81O=null,p=f.getHitPosition(p,f.getCenter(),Z.copy(f.getEye()).sub(L.copy(f.getCenter())).toArray()),B.origin.copy(f.getEye()),B.direction.copy(p).sub(B.origin).normalize(),B.intersectEllipsoid(H)}function X(p,G){var v;M&&(v=Date.now(),M.deltaTime=M.lastTime?v-M.lastTime:1e3,M.lastTime=v,M.lastAxis=p,M.lastAngle=G),G&&($.setFromAxisAngle(p,G),f.setEye(Z.copy(f.getEye()).applyQuaternion($).toArray()),f.setCenter(Z.copy(f.getCenter()).applyQuaternion($).toArray()),f.setUp(Z.copy(f.getUp()).applyQuaternion($).toArray()))}function q(p){return Math.abs(p)<.01?0:0<p?1:-1}bS(Ok,this,[f]);var S,g=p.radius||6378137,W=this,M=null,$=(je||((je=yS()).style.border="",je.style.backgroundImage="url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAEyUlEQVRYR62XW0xcVRSG/58cmIG2HmstE9N4SX2xtVqBCISoFS/RmDSpKQSvTWNixUStQSqVyBQYJUGttrQVtYkPatuQPmhivMUHqbUBZ2itl1qjTzZpImNUZhDLsUeWWXgOOd2cgcGyk3mYs/de69trr70uxP8YIlJKMi0i9wIgyf0iEiM5PFdxzGeDiBQAuB7AjQBuALCN5NcGQDmANgBfeL8UyYnZ5M8KICJ3AXgAwAlfOMl/VHAQwPtveYAKuQLA2yQ/ngliRgAR2QogA2AvSdcUZAIE50VEYR4BsIDkC7kgQgFE5GIAuwDsJnkk1+aZAPw9IqLX1gjgcZK/m7KmAXjK4wBaSf4ZplxEIgCuA3Cz3gSAfgDHSf6dY/0FAJ4D0G5ChAEcAPBwmHIRqXNd90nLsiocx/k+k8n8oK/Atu2rIpHIStd1v7QsawfJd0Ouywawh6T609Q4B8C788NhZnddt29sbGxBd3f39q6urtNhJ43H48uam5u3lJSUjFiWdV8IxE0Aqki+6M9NAXjefjnJXsOZogBGBgYGttbU1Hw427PS+cHBwbVVVVUJAItJOoa8xwD8RPIT/T4J4L3zfQAeNL1dRMZra2ur+/v7/8pHub+mvr7+wr6+vs8KCgoWGABFAN4EsEHjhA9QBeA2ks8HF6vZk8nkQL4nNwGTyeTa8vLycsuy7jcg1Mk/IpnyAZoBaOQ6FHg+ddlsdqNt201zObm5NpvN7ly0aNHrJN8LyL4FwGqSr/gAOrnej3C60HXdw/F4PJ7L4fKFSiQSl7W0tLQVFRWtCQDoNRwguZ6aWABcorE9sEDf+QjJ1fkqmmmdiHwHoCToXyKiceR0rkhY5TjOq9FoVLPdeY/x8fG+SCSySe/cFKYWCFOyPJ1Or4zFYh3nrR3A8PBwe2lp6TcAfg4DmBYwAFyRTqdXxWKx9nkE+DYUIEyBiFQ6jvNaNBq9Zz4AZruCGIBlJI8ZXpolee18AORwwgoAp/xnqMmjPuilZ8+ePZRIJNo7OztD436+YB0dHZe2trY+W1hYWGsccD/JOh/gKQBHSWpanRwicnc2m91k2/bmfJWFrRsdHd29cOHCXSTfD8i+FcA1JHcEQ/HtJDVnTw3XdfcPDQ0dra6unto8F5hUKrWurKxslWVZG4L7RGQbgA9IDgWT0VsANprJaGJi4kxDQ8OagwcPjsxFeWNj49Le3l6N91qMTA2vmNnr6fovGXkmvxPAlST3hGz4LZVKbausrMzLEnryioqKNpJLzCpJRJ4AcJLkp6rHLEieBjBA8rB5Wtd1942NjS3p6el5qa2t7VSYNdThmpqaWoqLi38xze4dUku4CpLb/f1hJZnWBY+SzJpKRGSdV5LVOI5zIpPJnNQ1tm2viEQiV7uue8SyrJeDDhew8GIAO0me4w9hABdp8ahNBkktyacNr+Qu84pSndfX81VY6e6dXJV3AoiT/CMoMFcyUogeAG+Q/DyX8+VZlqvZHwKw2VQ+zQdCTL4FwBkPZFrJPUtjoildG5PC4J2bOvJpze7QWhHAj4HWbBImpDXTQsPvH5cDeMf39lxWnBXAU6TNqcZu7fn0lyB53GhOdf6ZQHN6bF6a0xxOuJTkrwbA5LdcJ831/V8SOUYQxYGhRwAAAABJRU5ErkJggg==)"),new wh),Z=new m,L=new m,l=new m,B=new ih,O="number"==typeof g?{x:g,y:g,z:g}:g,H={center:new m(0,0,0),radius:O};W._showCrossIcon=function(p){KS(W.getView(),je),P(je,{x:p.clientX-16,y:p.clientY-16,width:32,height:32})},W._hideCrossIcon=function(){KA(je)},W._scrollImpl=function(p,G){(M={point:f.lp(p),screen:i(p),hit:J(p),type:"right"}).hitNormalize=M.hit?M.hit.clone().normalize():new m,p={clientX:M.screen.x,clientY:M.screen.y+10*G},W._handleMoveImpl(p),W._endMoveImpl(p)},W._startMoveImpl=function(p){S&&(S.stop(!0),S=null),(M={point:f.lp(p),screen:i(p),hit:J(p)}).hitNormalize=M.hit?M.hit.clone().normalize():new m,ZE(p)?1===p.touches.length?M.hit&&(M.type="left"):2===p.touches.length&&(M.type="touch2"):(YA(p)?M.hit&&(M.type="left"):cA(p)?M.type="right":sA(p)&&M.hit&&(M.type="middle"),!M.hit||"right"!==M.type&&"middle"!==M.type||W._showCrossIcon(p)),M.type&&mA(W,p)},W._handleMoveImpl=function(p){if(M)switch(M.type){case"left":return W._handleLeft(p);case"right":return W._handleRight(p);case"middle":return W._handleMiddle(p);case"touch2":return W._handleTouch2(p)}},W._endMoveImpl=function(p){var v,J,$;M&&(this._hideCrossIcon(),"left"!==M.type&&"middle"!==M.type||(v=M.lastAngle/(M.deltaTime||30)*1e3,J=M.lastAxis,$=M.lastTime,S=HA({action:function(){var p=Date.now(),G=(p-$)/1e3;$=p,v*=Math.pow(Math.abs(W.decelerationRate),3*G),Math.abs(v)<.01?(v=0,S&&S.stop()):X(J,v*G)},duration:5e3})),M=null)},W._handleLeft=function(p){if(!M.finished){var G=i(p),v=function(p,G){f._81O=null,B.origin.copy(f.getEye());for(var v,J,$=f.getCenter(),S=Z.copy(f.getEye()).sub(L.copy(f.getCenter())).toArray(),O=1,W=16,l=0,t=1,z={x:0,y:0};W--;){if(z.x=G.x+(p.x-G.x)*O,z.y=G.y+(p.y-G.y)*O,v=f.getHitPosition(z,$,S),B.direction.copy(v).sub(B.origin).normalize(),(J=B.intersectEllipsoid(H))&&1===O)return{hit:J};J?l=O:t=O,O=(l+t)/2}return{hit:J,out:O<1}}(G,M.lastScreen||M.screen);if(M.lastScreen=G,!v.hit)return M.finished=!0,void W._endMoveImpl(p);(G=v.hit).normalize();var J=M.hitNormalize,$=Math.acos(G.dot(J));X(G=G.cross(J).normalize(),$),v.out&&(M.finished=!0,W._endMoveImpl(p))}},W._handleRight=function(p){var G,v=(M.lastScreen||M.screen).y;(p=(M.lastScreen=i(p)).y-v)&&(v=Math.min(.5,p*W.scaleSpeed),Z.copy(f.getEye()),p=(p=M.hit)||Z.clone().divide(O).normalize().multiply(O),L.copy(Z).lerp(p,v),f.setEye(L.toArray()),Z.copy(f.getUp()),L.normalize(),p=Z.clone().cross(L).normalize(),l.copy(f.getCenter()),l.sub(p.multiplyScalar(l.dot(p))),f.setCenter(l.toArray()),M.hit&&(v=J(M.screen),p=M.hitNormalize,v&&(v.normalize(),G=Math.acos(v.dot(p)),v=v.cross(p).normalize(),G&&X(v,G))))},W._handleTouch2=function(p){var G,v,J,$,S,O,W,l,t,z,Z,B;2===p.touches.length&&(G=(p=p.touches)[0].clientX,v=p[0].clientY,B={x:(J=p[1].clientX)-G,y:(p=p[1].clientY)-v},z=M.lastCenter,O=Math.atan2(B.y,B.x),$=0,(S=M.theta)==v0?S=M.theta=O:($=O-S,M.thetaStarted||.03<Math.abs($)?(M.thetaStarted=!0,M.theta=O):$=0),S=Math.sqrt(B.x*B.x+B.y*B.y),(O=M.vlen)?(Z=G-z.x,l=v-z.y,t=J-z.x,z=p-z.y,Z=Math.sqrt(Z*Z+l*l),l=Math.sqrt(t*t+z*z),(z=q(Z-(t=O/2)))*(Z=q(l-t))<0||0===z&&0===Z?(W=1,M.vlen=S):(W=W||S/O,M.scaleStarted||.05<Math.abs(W-1)?(M.vlen=S,M.scaleStarted=!0):W=1)):(O=M.vlen=S,W=1),B=L.copy(f.getEye()).clone(),1!==W&&f.setEye(B.setLength((B.length()-g)/W+g).toArray()),$&&X(B.normalize(),$),M.lastCenter={x:(J+G)/2,y:(p+v)/2})},W._handleMiddle=function(p){var p=i(p),G=M.screen,v=((M.screen=p).y-G.y)/180*Math.PI*W.rollSpeed,J=(L.copy(f.getCenter()).sub(Z.copy(f.getEye())).normalize(),Z.copy(f.getUp()).cross(L).normalize(),L.copy(f.getEye()).sub(M.hit).applyAxisAngle(Z,v).add(M.hit),L.clone()),$=(L.copy(f.getCenter()).sub(M.hit).applyAxisAngle(Z,v).add(M.hit),L.clone()),S=L.copy(f.getUp()).applyAxisAngle(Z,v).clone(),O=!1,v=(0<v&&(l.copy(S),L.copy($).sub(J).normalize(),Z.copy(J).multiplyScalar(-1).normalize(),0<Z.dot(l)-L.dot(l)&&(O=!0)),O||0<=l.copy(M.hit).sub(J).dot(M.hitNormalize)&&(O=!0),O||(f.setEye(J.toArray()),f.setCenter($.toArray()),f.setUp(S.toArray())),-(p.x-G.x)/180*Math.PI*W.rotateSpeed);X(M.hitNormalize,v)}}),Wk=(S("GlobeInteractor",Cl,{handle_contextmenu:function(p){tA(p)},handle_mousewheel:function(p){this._scrollImpl(p,p.wheelDelta/40)},handle_DOMMouseScroll:function(p){2===p.axis&&this._scrollImpl(p,-p.detail)},handle_keydown:function(p){this.gv.handleKeyDown(p)},handle_mousedown:function(p){this.handle_touchstart(p)},handle_touchstart:function(p){tA(p);var G,v,J=this.gv;J.setFocus(p)&&((G=(v=J.getDataInfoAt(p))?v.data:v0)&&J.isInteractive(G)||this._startMoveImpl(p),v=v?v.part:v0,wA(p)?J.handleDoubleClick(p,G,v):J.handleClick(p,G,v))},handle_mouseup:function(p){this.handle_touchend(p)},handle_touchend:function(p){},handleWindowMouseMove:function(p){this.handleWindowTouchMove(p)},handleWindowTouchMove:function(p){this._handleMoveImpl(p)},handleWindowMouseUp:function(p){this.handleWindowTouchEnd(p)},handleWindowTouchEnd:function(p){this._endMoveImpl(p)}}),d.defineProperties(Ok.prototype,{rotateSpeed:{get:function(){return this._rotateSpeed||.3},set:function(p){this._rotateSpeed=p}},rollSpeed:{get:function(){return this._rollSpeed||.1},set:function(p){this._rollSpeed=p}},scaleSpeed:{get:function(){return this._scaleSpeed||.002},set:function(p){this._scaleSpeed=p}},decelerationRate:{get:function(){return this._decelerationRate||.04},set:function(p){this._decelerationRate=p}}}),function(p){return[((p|=2147483648)>>16&255)/255,(p>>8&255)/255,(255&p)/255,(p>>24&255)/255]}),lk=function(p){this.gv=p,this.gv.pickColorMap={_pickIdUsed:2e3}},tk=(oA(lk,d,{_iv:!0,iv:function(){this._iv=!0},get:function(p,G,v){this.validate();var J=this.gv.getGL();if(!J)return v0;var $,S,O=this._resolution,W=Math.round(p.x*O),l=Math.ceil(p.width*O),t=Math.ceil(p.height*O),p=this.height-Math.round(p.y*O)-t,z=n0(l/2),Z=new Uint8Array(l*t*4),B=0,f=Z.length,X=G?v0:new o,q=G?v0:{};if(es(J,this.frame),J.readPixels(W,p,l,t,J.RGBA,J.UNSIGNED_BYTE,Z),As(J),G){for(;B<=z;B++)for(var g=z-B,M=z+B,L=g;L<=M;L++)for(var H=g;H<=M;H++)if((L===g||L===M||H===g||H===M)&&($=this.info(Z,4*(L*l+H)))&&(!v||!1!==v($)))return $}else for(;B<f;B+=4)!($=this.info(Z,B))||v&&!1===v($)||q[(S=$.data)._id]||(X.add(S),q[S._id]=S);return X},info:function(p,G){return this.gv.pickColorMap[(p[G]<<16)+(p[G+1]<<8)+p[G+2]+((127&p[G+3])<<24)]},getResolution:function(){return this._resolution},onContextLost:function(){this.texture=null,this.width=this.height=-1},validate:function(p){var G,v,J,$,S,O,W,l=this,t=l.gv,z=t.getGL();z&&(v=l._resolution=t._pickerResolution*t.getDevicePixelRatio(),G=Math.round(v*t.getWidth()),v=Math.round(v*t.getHeight()),J=z.RGBA,$=z.TEXTURE_2D,S=z.RENDERBUFFER,O=z.FRAMEBUFFER,l.texture||(l.texture=tZ(z),l.render=z.createRenderbuffer(),l.frame=z.createFramebuffer()),l.width===G&&l.height===v||(z.activeTexture(z.TEXTURE0),XZ(z,l.texture),z.texImage2D($,0,J,G,v,0,J,z.UNSIGNED_BYTE,v0),qZ(z,z.TEXTURE_MIN_FILTER,z.LINEAR),z.bindRenderbuffer(S,l.render),z.renderbufferStorage(S,z.DEPTH_COMPONENT16,G,v),es(z,l.frame),z.framebufferTexture2D(O,z.COLOR_ATTACHMENT0,$,l.texture,0),z.framebufferRenderbuffer(O,z.DEPTH_ATTACHMENT,S,l.render),XZ(z,v0),z.bindRenderbuffer(S,v0),As(z),l.width=G,l.height=v),l._iv&&(W=l._iv=!1,t._40Q.each(function(p){!W&&p.isBatchInvalid()&&(W=!0)}),W&&t.updateScene(),es(z,l.frame),z.clear(z.COLOR_BUFFER_BIT),t.overlappingBox.clear(),t.setViewport(z,0,0,G,v),t.renderPickScene(),As(z)))}}),function(p){this.gv=p}),zk=(oA(tk,d,{gap:0,size:0,_42:function(p,G){var v,J=this,$=J.gv,S=$._gridGap,O=$._gridSize;if($._gridVisible){if(J.gap!==S||J.size!==O){for(var W=[],l=$._gridSize/2,t=S*l,z=0;z<2*l+1;z++){var Z=6*z,B=6*(2*l+1)+Z;W[Z]=-t,W[1+Z]=0,W[2+Z]=z*S-t,W[3+Z]=t,W[4+Z]=0,W[5+Z]=z*S-t,W[B]=z*S-t,W[1+B]=0,W[2+B]=-t,W[3+B]=z*S-t,W[4+B]=0,W[5+B]=t}J.vs=new pm(W),J.gap=S,J.size=O}yZ($),bZ(p),sZ(p),(O=!$._fogDisabled)&&((v=r.for(p).directUniforms()).uFog=!1),hZ(p,0,1,$._gridColor,$._buffer.vs,J.vs),wZ(p,0,J.vs.length/3,p.LINES),O&&(v.uFog=!0),cZ(p),nZ(p)}else J.vs=J.gap=J.size=v0}}),function(p){this.gv=p}),Zk=(oA(zk,d,{_42:function(p,G){var v,J,$,S,O,W=this.gv,l=W._buffer.vs,t=W._axisXColor,z=W._axisYColor,Z=W._axisZColor,B=W._originAxisVisible,f=W._centerAxisVisible;(B||f)&&($=R0?p.TRIANGLES:p.TRIANGLE_FAN,v=p.LINES,yZ(W),bZ(p),sZ(p),B&&(S=W.getCenterInfo(),O=$0(S.width,S.height)/5,hZ(p,0,1.5,t,l,new pm([0,0,0,O,0,0,B=.8*O,J=.05*O,0,B,0,J,B,-J,0,B,0,-J,B,J,0,0,0,0,0,O,0,J,B,0,0,B,J,-J,B,0,0,B,-J,J,B,0,0,0,0,0,0,O,J,0,B,0,J,B,-J,0,B,0,-J,B,J,0,B])),wZ(p,0,2,v),wZ(p,1,6,$),hZ(p,0,v0,z),wZ(p,7,2,v),wZ(p,8,6,$),hZ(p,0,v0,Z),wZ(p,14,2,v),wZ(p,15,6,$)),f&&(B=(J=W._center)[0],$=J[1],f=J[2],S=W.getPositionInfo(J),O=$0(S.width,S.height)/20,hZ(p,0,1.5,t,l,new pm([B,$,f,B+O,$,f,B,$,f,B,$+O,f,B,$,f,B,$,f+O])),wZ(p,0,2,v),hZ(p,0,v0,z),wZ(p,2,2,v),hZ(p,0,v0,Z),wZ(p,4,2,v)),cZ(p),nZ(p))}}),function(p){this.gv=p}),Bk="edit_tx",fk="edit_ty",Xk="edit_tz",qk="edit_rx",gk="edit_ry",Mk="edit_rz",Lk="edit_sx",Hk="edit_sy",_k="edit_sz",bk={},nk=(bk[Bk]=101,bk[fk]=102,bk[Xk]=103,bk[qk]=104,bk[gk]=105,bk[Mk]=106,bk[Lk]=107,bk[Hk]=108,bk[_k]=109,oA(Zk,d,{_42:function(p,G,v){var J,$,S,O,W,l,t,z,Z,B,f,X,q,g,M=this,L=M.gv,H=L.sm().ld();!H||!L.isEditable(H)||L.isEditHelperDisabled()||!k(H)||L.isFirstPersonMode()&&(L.isMouseRoamable()||u0)||(yZ(L),J=L.isMovable(H),$=L.isRotationEditable(H),S=L.isSizeEditable(H),O=L._axisXColor,W=L._axisYColor,l=L._axisZColor,t=L._editSizeColor,X=H.p3(),L=(z=L.isOrtho()?(z=L.getCenterInfo(),$0(z.width,z.height)/8):iA(L.getEye(),X)/10)/(v?5:10),Z=.4*(z*=.7),B=X[0],f=X[1],X=X[2],g=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],J&&M._17O(p,G,H,v,Bk,O,g,[B,f-L,X,B+z,f-L,X,B+z,f,X,B+z,f,X,B,f,X,B,f-L,X,B,f-L,X+L,B+z,f-L,X+L,B+z,f-L,X,B+z,f-L,X,B,f-L,X,B,f-L,X+L]),q=B+z,S&&M._17O(p,G,H,v,Lk,t,g,[q,f-L,X,q+Z,f-L,X,q+Z,f,X,q+Z,f,X,q,f,X,q,f-L,X,q,f-L,X+L,q+Z,f-L,X+L,q+Z,f-L,X,q+Z,f-L,X,q,f-L,X,q,f-L,X+L]),q+=Z,$&&M._17O(p,G,H,v,qk,O,g,[q,f-L,X,q+Z,f-L,X,q+Z,f,X,q+Z,f,X,q,f,X,q,f-L,X,q,f-L,X+L,q+Z,f-L,X+L,q+Z,f-L,X,q+Z,f-L,X,q,f-L,X,q,f-L,X+L]),g=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0],J&&M._17O(p,G,H,v,fk,W,g,[B,f,X,B,f+z,X,B-L,f+z,X,B-L,f+z,X,B-L,f,X,B,f,X,B,f,X,B,f,X-L,B,f+z,X-L,B,f+z,X-L,B,f+z,X,B,f,X]),q=f+z,S&&M._17O(p,G,H,v,Hk,t,g,[B,q,X,B,q+Z,X,B-L,q+Z,X,B-L,q+Z,X,B-L,q,X,B,q,X,B,q,X,B,q,X-L,B,q+Z,X-L,B,q+Z,X-L,B,q+Z,X,B,q,X]),q+=Z,$&&M._17O(p,G,H,v,gk,W,g,[B,q,X,B,q+Z,X,B-L,q+Z,X,B-L,q+Z,X,B-L,q,X,B,q,X,B,q,X,B,q,X-L,B,q+Z,X-L,B,q+Z,X-L,B,q+Z,X,B,q,X]),g=[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],J&&M._17O(p,G,H,v,Xk,l,g,[B,f,X,B,f,X+z,B,f-L,X+z,B,f-L,X+z,B,f-L,X,B,f,X,B,f-L,X,B-L,f-L,X,B-L,f-L,X+z,B-L,f-L,X+z,B,f-L,X+z,B,f-L,X]),q=X+z,S&&M._17O(p,G,H,v,_k,t,g,[B,f,q,B,f,q+Z,B,f-L,q+Z,B,f-L,q+Z,B,f-L,q,B,f,q,B,f-L,q,B-L,f-L,q,B-L,f-L,q+Z,B-L,f-L,q+Z,B,f-L,q+Z,B,f-L,q]),q+=Z,$&&M._17O(p,G,H,v,Mk,l,g,[B,f,q,B,f,q+Z,B,f-L,q+Z,B,f-L,q+Z,B,f-L,q,B,f,q,B,f-L,q,B-L,f-L,q,B-L,f-L,q+Z,B-L,f-L,q+Z,B,f-L,q+Z,B,f-L,q]))},_17O:function(p,G,v,J,$,S,O,W){var l=this.gv,t=l._buffer,z=(Z=r.for(p)).directUniforms(),Z=Z.directAttribs();l._picking&&(l.pickColorMap[l=bk[$]]={data:v,part:$},z.uFixPickReverseColor=Wk(l)),DZ(p,0,v0,!0,v0,!0,v0,!1),z.uDiffuse=S,Z.aPosition=PZ(p,t.vs,new pm(W)),Z.aNormal=PZ(p,t.ns,new pm(O)),sZ(p),wZ(p,0,12),cZ(p),YZ(p)}}),E.Raycaster=function(p){this.gv=p,this.maxTriangleTest=1/0,this.backfaceCulling=!0}),Dk=(Ph("Raycaster",d,{intersect:function(p){var G=this.gv.getDataAt(p);return G?this.intersectObject(p,G):null},intersectObjects:function(G,p,v){var J,$,S,O,W=this,l=1/0,t=G.origin||(new m).fromArray(W.gv.getEye()),z=W.maxTriangleTest,Z=[],B=(p.forEach(function(p){v&&!1===v(p)||!1!==p.s("intersect")&&Z.push(p)}),t.distanceToSquared2([0,0,0]));return Z.sort(function(p,G){return(p.p3?t.distanceToSquared2(p.p3()):B)-(G.p3?t.distanceToSquared2(G.p3()):B)}),W.countTriangles=0,Z.forEach(function(p){W.countTriangles>z||(J=W.intersectObject(G,p))&&($=t.distanceToSquared(J.world))<l&&(S=p,O=J,l=$)}),W.countTriangles=0,{data:S,intersect:O}},intersectObjectAndRecordTriangle:function(p,G){return this._4GQ=!0,p=this.intersectObject(p,G),this._4GQ=!1,p},intersectLastTriangle:function(p,G){if((p=this.getRay(p)).applyMatrix4(G.inverseMatrix),!(p=p.intersectPlane(G.plane)))return null;var v=Ah.uvIntersection(p,G.p1,G.p2,G.p3,G.uv1.clone(),G.uv2.clone(),G.uv3.clone());return{world:p.clone().applyMatrix4(G.matrixWorld),local:p.clone(),uv:v}},getRay:function(p){if(p instanceof ih)return p;var G,v=this.gv,p=v.unproject(p),J=new m,$=v.getEye(),S=new m;return v.isOrtho()?(G=new m($),S.copy(v.getCenter()).sub(G).normalize(),v=J.copy(p).sub(G).dot(S),J.copy(S).setLength(-v).add(G.copy(p))):(J.copy($),S.copy(p).sub(J).normalize()),new E.Math.Ray(J,S)},intersectObject:function(p,G){return this._intersectObjectImpl(this.getRay(p),G)},_intersectObjectImpl:(ie=new eh,re=new eh,ee=new ih,Ae=new m,ke=new m,Ie=new m,Ee=new m,ye=new m,xe=new m,Re=new m,Ne=new m,me=new H,Ke=new H,ae=new H,ue=new m,Te={vs:Kp,is:ap,uv:up},(Ve=Vp.slice(0)).push("csg"),function(p,G){var v,J,$,S,O,W,l,t,z,Z,B,f,X,q=this.gv.getData3dUI(G),g=((P=G.mat||q.mat)?ie.fromArray(P):ie.identity(),re.getInverse(ie),ee.copy(p).applyMatrix4(re),"body");if(!(P=(P=(P=!(P=q.shapeModel)&&(G instanceof E.Polyline||G instanceof E.Edge)&&q.lineShapeModel?q.lineShapeModel:P)||fn(q))||(E.CSGNode&&G instanceof E.CSGNode||E.CSGShape&&G instanceof E.CSGShape?($=!0,[q.left,q.front,q.right,q.back,q.top,q.bottom,q.csg]):G instanceof E.Node&&!(G instanceof E.Shape)?(v=!0,Te):(J=!0,[q.left,q.front,q.right,q.back,q.top,q.bottom]))))return console.log("Can not find shape model."),null;lS(P)||(P=[P]);var M,L,H,_,b,n,D=1/0,Y=["","top_","bottom_"],s=!1,c=this.backfaceCulling,h=[];for(UZ(P,q,h),S=0,O=h.length;S<O;S++)if(L=h[S])for(W=0,l=Y.length;W<l;W++)if(Z=L[(H=Y[W])+"vs"],B=L[H+"is"],f=L[H+"uv"]||L[H+"tuv"],Z){if(_=L[H+"boundingBox"]){if(!(n=ee.intersectBox(_)))continue;if(ee.origin.distanceTo(n)>D)continue;b=!1}else L[H+"boundingBox"]=_=new E.Math.Box3,b=!0;for(t=0,z=B?B.length:Z.length/3;t<z;t+=3)this.countTriangles++,B?(ke.fromArray(Z,3*B[t]),Ie.fromArray(Z,3*B[t+1]),Ee.fromArray(Z,3*B[t+2])):(ke.fromArray(Z,3*t),Ie.fromArray(Z,3*(t+1)),Ee.fromArray(Z,3*(t+2))),b&&(_.expandByPoint(ke),_.expandByPoint(Ie),_.expandByPoint(Ee)),(X=ee.intersectTriangle(ke,Ie,Ee,c,Ae))&&(M=ee.origin.distanceTo(X))<D&&(D=M,ye.copy(X),xe.copy(ke),Re.copy(Ie),Ne.copy(Ee),""!==H?g=H.slice(0,-1):v?g=Vp[Math.floor(t/6)]:J?g=Vp[S]:$&&(g=Ve[S]),f&&(s=!0,B?(me.fromArray(f,2*B[t]),Ke.fromArray(f,2*B[t+1]),ae.fromArray(f,2*B[t+2])):(me.fromArray(f,2*t),Ke.fromArray(f,2*(t+1)),ae.fromArray(f,2*(t+2)))))}if(!isFinite(D))return null;var w,d,p=ye.clone().applyMatrix4(ie),G=this._4GQ,P=(s&&(G&&(d={inverseMatrix:re.clone(),matrixWorld:ie.clone(),p1:xe.clone(),p2:Re.clone(),p3:Ne.clone(),uv1:me.clone(),uv2:Ke.clone(),uv3:ae.clone(),plane:(new E.Math.Plane).setFromCoplanarPoints(xe,Re,Ne)}),w=Ah.uvIntersection(ye,xe,Re,Ne,me,Ke,ae)),Zr()),q=Zr(xe.applyMatrix4(ie),Re.applyMatrix4(ie),Ne.applyMatrix4(ie)),G=(0<ee.direction.dot(P)&&(P.multiplyScalar(-1),q.multiplyScalar(-1)),{world:p,local:ye.clone(),worldNormal:q,normal:P,uv:w,part:g});return d&&(G.triangleInfo=d),G})}),function(J,$){this.gv=J,this.s=function(p,G,v){return(G=G==v0?v:G)==v0?$.getStyle(p):V(G,$,J)},this.data=$}),Yk=(oA(Dk,d,{I3d:!0,ms_icons:1,_iv:!0,_cacheBoundingBox:K,iv:function(){this._iv=!0},update:function(p,G,v){var J=this,$=J.data;if(p||(G=(p=J.gv).getGL(),v=p._40Q),J.needValidate(G)&&p.isVisible($)){var S,O,W,G=$._id,l=$._47Q?null:J.s("batch"),t=$.getRenderLayer(),z=(t=v.get(t,!0)).batchIndexMap,Z=t.batchModelMap,B=p.getBrightness($),f=B!=v0&&1!==B,Z=qp(z,Z,$,l,p),l=l?p.getBatchInfo(l)||Ai:v0,X=J.validate(Z,l);if(Z&&(!l.ms||!l.ms.length)&&(S=(l=z[G]).size=Z.vs.length/3-l.begin,W=Z.rs))for(B=f?B:1,O=0;O<S;O++)W.push(B);(z=p.getWireframeGeometry($))?Lp(p,$,z):k($)&&(G=p.getWireframe($))&&Lp(p,$,G),J.labelInfo=J.label2Info=J.noteInfo=J.note2Info=J._38o=v0,J._24O(jJ,"getLabel"),J._24O(iJ,"getLabel2"),J._26O(rJ,"getNote"),J._26O(eJ,"getNote2"),J._15O(),J.interactiveInfo=p.isInteractive($)?{}:v0,t.push(this,!0),!1!==X&&(J._iv=!1)}else v.push(this,!1)},clearWireframeGeometryCache:function(){var p;(p=(p=this.shapeModel)||fn(this))&&(p._ctlineModel=[],p._lineModel=K),this.data.iv()},_46Q:function(p,G){var v,J,$,S,O=this.data,W=this.gv;W.isVisible(O)&&(S=O._id,J=(v=W._40Q.get(O._renderLayer,!0)).batchIndexMap[S],$=v.polylineIndexMap[S],S=v.wireframeIndexMap[S],(J||$||S)&&(G=G==v0?RZ(p,W.pickColorMap,W.isSelectable(O),this,PJ,!0):G)&&(Hp(G,J,v.batchModelMap),Hp(G,$,v.polylineModelMap),Hp(G,S,v.wireframeModelMap)))},_42:function(p,G,v){var W=this,J=W.data,$=W.gv;if($.isVisible(J)){var S,O,l,t,z,Z,B,f,X,q,g=$._picking;if(g)S=$.pickColorMap;else{if($.isTransparentMask(J)||$.isReflecting(p)&&!1===J.s("3d.reflectable"))return;S=K}if(Dk.getTitle===K)for(var M in Dk.getTitle=0,N)if(M.length===iJ.length+1&&M[iJ.length]===$l[4].toUpperCase()&&M[iJ.length-1]===$l[iJ.length+1].toUpperCase()){Dk.getTitle=dS;break}if(!Dk.getTitle||X0[iJ.length+2]){if(Dk.getHead===K)for(var M in Dk.getHead=0,WE){var L="box-sizing";6===M.length&&M[0]===$l[4]&&M[3]===L[0]&&M[4]===L[1]&&M[5]===L[2]&&(Dk.getHead=Fi)}if(!Dk.getHead||X0[iJ.length]){if(Dk.getTitle2===K)for(var M in Dk.getTitle2=0,WE)6===M.length&&M[0]===yl[1].toUpperCase()&&M[1]==="uv"[0]&&(Dk.getTitle2=Ui);Dk.getTitle2&&!X0[Zl.length]||(O=J._id,X=(l=$._40Q.get(J._renderLayer,!0)).batchIndexMap,q=l.batchModelMap,t=$.isSelectable(J),f=!(B=!1),X=X[O],g&&(Z=RZ(p,S,t,W,PJ,X))&&!$._45Q&&(Hp(Z,X,q),Hp(Z,l.polylineIndexMap[O],l.polylineModelMap),Hp(Z,l.wireframeIndexMap[O],l.wireframeModelMap)),X||(B||(B=!0,H(p,$,J)),f&&W._80o(p,G,v)),$.isLabelVisible(J)&&((z=W.labelInfo)&&(g&&RZ(p,S,t,W,jJ),B||(B=!0,H(p,$,J)),W._28O(z,jJ,v)),(z=W.label2Info)&&(g&&RZ(p,S,t,W,iJ),B||(B=!0,H(p,$,J)),W._28O(z,iJ,v))),$.isNoteVisible(J)&&((z=W.noteInfo)&&(g&&RZ(p,S,t,W,rJ),B||(B=!0,H(p,$,J)),W._29O(z,rJ,v)),(z=W.note2Info)&&(g&&RZ(p,S,t,W,eJ),B||(B=!0,H(p,$,J)),W._29O(z,eJ,v))),(z=W._38o)&&(B||(B=!0,H(p,$,J)),W._99O(p,G,z,S,t,v)),B&&((q=r.for(p).directUniforms()).uBrightness=1,q.uClipDirection=0,p._blooming&&(q.blackout=!1)))}}}function H(p,G,v){var J=G.getBrightness(v),$=v.s("alphaTest"),S=v.s("envmap"),O=r.for(p).directUniforms();J!=v0&&1!==J&&(O.uBrightness=J),O.uAlphaTest=$,O.uUseEnvMap=!!S,O.uReflectivity=S||.01,O.roughness=v.s("roughness"),G._setEnvmapByProbeId(O,v.s("envmap.probe")),O.shadowReceive=!g&&v.s("shadow.receive"),O.shadowCull=!g&&!!v.s("shadow.cull"),_Z(G,O,v.s("3d.clipbox")?ds:v.s("3d.clipbox.mask")),(J=W.s("3d.clip.direction"))?(0===($=W.s("3d.clip.percentage"))&&(f=!1),S=W._formatClipUniforms(J,$,v),O.uClipPercent=S[1],O.uClipDirection=S[0]):O.uClipDirection=0,p._blooming&&!v.s("bloom")&&(O.blackout=!0),g||(G._flowObjects.length&&G.flowMap.resetDataFlowEnabld(v,O),Ks(G,O,v.s("light.mask"),v.s("headlight.ambientIntensity")))}},_formatClipUniforms:function(p,G,v){switch(p){case"uv.right":p=7;break;case"uv.left":p=8;break;case"left":p=2;break;case"top":p=3;break;case"bottom":p=4;break;case"front":p=5;break;case"back":p=6;break;default:p=1}var J,$;return p%2==0&&(G=1-G),7===p||8===p?(J=this.shapeModel)&&J.internalUvScale&&(G*=J.internalUvScale):v instanceof E.Shape?(J=v.s3(),$=v.p3(),v=v.getAnchor3d(),G=p<3?(G-v.x)*J[0]+$[0]:p<5?(G-v.y)*J[1]+$[1]:(G-v.z)*J[2]+$[2]):G-=.5,[p,G]},prepare:function(){var p=this,G=p.data;if(!(G instanceof hI)){var v,J,$,S=p.gv,O=S.getGL(),W=G._id,l=p.s("batch"),t=S._batchIndexMap,z=S._batchModelMap,Z=S.getBrightness(G),B=Z!=v0&&1!==Z;if(p.needValidate(O)){O=qp(t,z,G,l,S),z=l?S.getBatchInfo(l)||Ai:v0;if(p.validate(O,z),O&&(!z.ms||!z.ms.length)&&(v=(l=t[W]).size=O.vs.length/3-l.begin,$=O.rs))for(Z=B?Z:1,J=0;J<v;J++)$.push(Z);k(G)&&((z=S.getWireframeGeometry(G))?Lp(S,G,z):(t=S.getWireframe(G))&&Lp(S,G,t)),p.labelInfo=p.label2Info=p.noteInfo=p.note2Info=p._38o=v0,p._24O(jJ,"getLabel"),p._24O(iJ,"getLabel2"),p._26O(rJ,"getNote"),p._26O(eJ,"getNote2"),p._15O(),p.interactiveInfo=S.isInteractive(G)?{}:v0,p._iv=!1}}},dispatchBoundingBoxChanged:function(){this._cacheBoundingBox=K},getBoundingBox:function(p){if(this._cacheBoundingBox)return this._cacheBoundingBox;oe||(oe={vs:Kp,is:ap,uv:up},Ue=new m,Fe=new m,Ce=new m,Qe=new m,ps=new m);var G,v,J,$,S,O,W,l,t=this,z=t.data,Z=t.shapeModel;if((Z=(Z=!Z&&(z instanceof E.Polyline||z instanceof E.Edge)&&t.lineShapeModel?t.lineShapeModel:Z)||fn(t))||(E.CSGNode&&z instanceof E.CSGNode||E.CSGShape&&z instanceof E.CSGShape?(isCSG=!0,Z=[t.left,t.front,t.right,t.back,t.top,t.bottom,t.csg]):z instanceof E.Node&&!(z instanceof E.Shape)?Z=oe:(t.left||t.front||t.right||t.back||t.top||t.bottom)&&(Z=[t.left,t.front,t.right,t.back,t.top,t.bottom])),!Z)return K;lS(Z)||(Z=[Z]);var B,f,X,q,g=["","top_","bottom_"],M=new E.Math.Box3,L=!1,H=(t._needRecoverPosition?(Qe.set.apply(Qe,z.p3()),q=z.s3(),ps.set(1/(q[0]||1),1/(q[1]||1),1/(q[2]||1))):(Qe.set(0,0,0),ps.set(1,1,1)),[]);for(UZ(Z,t,H),G=0,v=H.length;G<v;G++)if(B=H[G])for(J=0,$=g.length;J<$;J++)if(W=B[(X=g[J])+"vs"],l=B[X+"is"],W){if(!(f=B[X+="boundingBox"]))for(B[X]=f=new E.Math.Box3,S=0,O=l?l.length:W.length/3;S<O;S+=3)l?(Ue.fromArray(W,3*l[S]).sub(Qe).multiply(ps),Fe.fromArray(W,3*l[S+1]).sub(Qe).multiply(ps),Ce.fromArray(W,3*l[S+2]).sub(Qe).multiply(ps)):(Ue.fromArray(W,3*S).sub(Qe).multiply(ps),Fe.fromArray(W,3*(S+1)).sub(Qe).multiply(ps),Ce.fromArray(W,3*(S+2)).sub(Qe).multiply(ps)),Ue.isNaN()||f.expandByPoint(Ue),Fe.isNaN()||f.expandByPoint(Fe),Ce.isNaN()||f.expandByPoint(Ce);M.expandByBox(f),L=!0}return L?(this._cacheBoundingBox=M,d.freeze(M),d.freeze(M.min),d.freeze(M.max),p||fp(t.gv,z),M):K},needValidate:function(p){return this._iv},validate:function(p,G){},_16O:function(p,G,v,J,$,S,O,W,l){return Sm},_80o:function(p,G,v){},dispose:function(){var p,G=this._pickId;G&&(p=this.gv.pickColorMap)[G]&&delete p[G]},getBodyColor:function(p){var G=this.data;return this.gv.getBodyColor(G)||(p?G.getStyle(p):v0)},contextLost:function(){this._cachedTextures&&this.gv.invalidateCachedTexture(this.data)},getCachedTexture:function(p){var G=this._cachedTextures;return G?G[p||"main"]:null},setCachedTexture:function(p,G){return(this._cachedTextures||(this._cachedTextures={}))[G||"main"]=p},invalidateCachedTexture:function(p){var G=this._cachedTextures;if(G){for(var v in G)p.deleteTexture(G[v]);this._cachedTextures={}}},invalidateCachedGeometry:function(){},_24O:function(p,G){var v,J,$=this.data,S=this.gv,O=this.s,W=S[G]($);W!=v0&&(v=O(p+".scale"),J=O(p+".max"),G=(S=this[p+"Info"]={label:W,textureScale:O(p+".texture.scale"),color:S[G+"Color"]($),font:O(p+".font"),align:O(p+".align"),background:S[G+"Background"]($)}).rect=aS(S,W),0<J&&J<G.width&&(S.labelWidth=G.width,G.width=J),G.x=G.y=0,G.width*=v,G.height*=v,S.mat=this._16O(O(p+".autorotate"),O(p+".position"),G,O(p+".face"),O(p+".t3"),O(p+".r3"),O(p+".rotationMode")),$=G.width/2,W=G.height/2,S.vs=new pm([-$,W,0,-$,-W,0,$,-W,0,$,W,0]),G.width/=v,G.height/=v)},_26O:function(p,G){var v,J=this.data,$=this.gv,S=this.s,O=$[G](J);O!=v0&&(v=S(p+".scale"),O=($=this[p+"Info"]={note:O,textureScale:S(p+".texture.scale"),expanded:S(p+".expanded"),font:S(p+".font"),color:S(p+".color"),align:S(p+".align"),borderWidth:S(p+".border.width"),borderColor:S(p+".border.color"),background:$[G+"Background"](J)}).expanded?(G=S(p+".max"),(J=aS($,O)).width+=6,J.height+=2,0<G&&G<J.width&&($.labelWidth=J.width,J.width=G),{x:-J.width/2,y:-8-J.height,width:J.width,height:J.height+8}):{x:-6,y:-18,width:12,height:18},$.mat=this._16O(S(p+".autorotate"),S(p+".position"),v0,S(p+".face"),S(p+".t3"),S(p+".r3"),S(p+".rotationMode")),$.rect=O,1!==v&&((O=MA(O)).x*=v,O.height*=v,O.y=-O.height,O.width*=v),G=O.x,J=O.y,S=O.width,p=O.height,$.vs=new pm([G,-J,0,G,-J-p,0,G+S,-J-p,0,G+S,-J,0]))},eachShapeModel:function(O,p){var W=this,G=W.data;!function p(G){var v,J,$,S;if(lS(G))for(J=0,$=G.length;J<$;J++)(v=G[J])&&p(v);else JS(G)?p(fn(W,G)):OS(G)&&(G.shape3d?p(G.shape3d):(Xn(S=G),S.vs&&O(S.vs,S.is,S.ns,S.uv),S.top_vs&&O(S.top_vs,S.top_is,S.top_ns,S.top_uv),S.bottom_vs&&O(S.bottom_vs,S.bottom_is,S.bottom_ns,S.bottom_uv),S.from_vs&&O(S.from_vs,S.from_is,S.from_ns,S.from_uv),S.to_vs&&O(S.to_vs,S.to_is,S.to_ns,S.to_uv)))}(p=(p=p||W.shapeModel||fn(W))||(G instanceof E.Node&&!(G instanceof E.Shape)?{vs:Kp,is:ap}:[W.left,W.front,W.right,W.back,W.top,W.bottom]))},_28O:function(p,G,v){var J,$,S;v(this.s(G+".transparent"))&&(v=p.rect,J=p.textureScale,S=v.width*J,$=v.height*J,1<=S&&1<=$&&(S=kE(S,$),1!==J&&(S.translate(v.x,v.y),S.scale(J,J),S.translate(-v.x,-v.y)),bj(S,p),S.restore(),TZ(this,G,p.mat,p.vs,!0)))},_29O:function(p,G,v){var J,$,S,O,W;v(this.s(G+".transparent"))&&(v=p.rect,J=p.textureScale,$=v.x,S=v.y,W=v.width*J,O=v.height*J,1<=W&&1<=O&&(v.x=v.y=0,W=kE(W,O),1!==J&&W.scale(J,J),nj(W,p),W.restore(),v.x=$,v.y=S,TZ(this,G,p.mat,p.vs,!1)))},_99O:function(p,G,v,J,$,S){if(v){var O,W=this.gv,l=this.data,t=W._buffer,z=W._1O,Z=v.icons,B=r.for(p).directAttribs();for(O in Z){var f=Z[O],X=v.rects[O];if(X&&S(V(f.transparent,l,W))){W._picking&&RZ(p,J,$,this,O);var q=V(f.shape3d,l,W),g=q?[q]:V(f.names,l,W),M=g?g.length:0,L=V(f.textureScale,l,W)||1,H=V(f.light,l,W);H==v0&&(H=!!q),DZ(p,0,V(f.blend,l,W),H,V(f.opacity,l,W),V(f.reverseFlip,l,W),V(f.reverseColor,l,W),V(f.reverseCull,l,W));for(var _=0;_<M;_++){var b,n,D,Y=g[_],s=X[_];uZ(this,s.mat),q?Zn(W,l,fn(this,q),this):(Y=T(Y))&&(b=s.width*L,n=s.height*L,1<=b&&1<=n&&(D=kE(b,n),BA(D,Y,V(f.stretch,l,W),0,0,b,n,l,W),D.restore(),tZ(p,AE,z),sZ(p,G,z,V(f.discardSelectable,l,W),t.uv,Rp),B.aPosition=PZ(p,t.vs,s.vs),B.aNormal=iZ(p,t.ns,Np,v0),eZ(p,t.is,mp),dZ(p,0,mp.length),cZ(p,0,z))),IZ(W)}YZ(p)}}}}}),function(p,G){bS(Yk,this,[p,G])}),sk=(oA(Yk,Dk,{_16O:function(p,G,v,J,$,S,O,W,l){var t,z,Z=this.data,B=Z.getFinalScale3d(),f=((Z.hasOwnProperty("_anchor")||Z.hasOwnProperty("_anchorElevation"))&&(t=[-((t=Z.getAnchor3d()).x-.5)*B[0],-(t.y-.5)*B[1],-(t.z-.5)*B[2]]),Z.s("part.boundingBox")&&(f=this.getBoundingBox(!0))&&(z=f.max.clone().sub(f.min),f=f.max.clone().add(f.min).divideScalar(2),(t=t||[0,0,0])[0]+=f.x*B[0],t[1]+=f.y*B[1],t[2]+=f.z*B[2],B[0]*=z.x,B[1]*=z.y,B[2]*=z.z),KZ(G,B,v,J,W,l));return t&&(f[0]+=t[0],f[1]+=t[1],f[2]+=t[2]),aZ($m(),f,Z.p3(),J,$,S,O,p,Z.getFinalRotation3d(),Z.getRotationMode())},clear:function(){var p=this;p.faceMat=p.mat=p.shapeModel=p.left=p.right=p.front=p.back=p.top=p.bottom=p.csg=v0},needValidate:function(p){return this._iv?(this._validateFrameId=p._renderInfo.frame,!0):!(!this.data._47Q||(p=p._renderInfo.frame,this._validateFrameId===p))&&(this._validateFrameId=p,!0)},invalidateUnstableWireframe:function(){var p,G=this.data;G._47Q&&(p=G.getRenderLayer(),(p=this.gv._40Q.get(p))&&p.ivWireframeBatch(G))},validate:function(p,G){var v=this,J=v.gv,$=v.data,S=v.shapeName=v.s(cl),O=fn(v,S),W=(v._updateAutoRotation(),v._updateFixSize2d(),v._updateOverlapping(),v.dispatchBoundingBoxChanged(),v.invalidateUnstableWireframe(),Xm($,J.getMat($),!O||v.s("shape3d.scaleable")));$.appendAnchorMatrix3d(W),v.clear(),v.mat=$.mat=W,!O&&S||(v.shapeModel=O,p?O?G.instanced?J.batchInstancedModel($,O,v,v.getBodyColor(),[W],p):np(J,$,O,v,v.getBodyColor(),[W],p):(S=EZ(W),G.instanced?J.batchInstancedFace($,p,G,W,S):hp(J,$,p,G,W,S)):O||(v._cubeUvs=null,v.vf(C0,0),v.vf(Q0,16),v.vf(U0,8),v.vf(F0,24),v.vf(pJ,32),v.vf(GJ,40)))},_updateAutoRotation:(Hs=new kh,_s=new eh,bs=new m,ns=new m,Ds=new m,function(){var p,G,v=this.data,J=this.s("autorotate")||this.s("shape3d.autorotate");J?(p=this.gv,Ds.copy(this.s("shape3d.autorotate.up")||p._up),J="string"==typeof J?[(J.indexOf("x")<0?p._eye:p._center)[0],(J.indexOf("y")<0?p._eye:p._center)[1],(J.indexOf("z")<0?p._eye:p._center)[2]]:p._eye,p=p._center,G=v.p3(),bs.copy(G),ns.set(J[0]-p[0],J[1]-p[1],J[2]-p[2]).add(bs),_s.lookAt(ns,bs,Ds),Hs.set(0,0,0,v.getRotationMode(),!0).setFromRotationMatrix(_s),(G=v._dynamicRotation)&&Math.abs(G[0]-Hs.x)<1e-5&&Math.abs(G[1]-Hs.y)<1e-5&&Math.abs(G[2]-Hs.z)<1e-5||(v._dynamicRotation=[Hs.x,Hs.y,Hs.z])):v._dynamicRotation&&delete v._dynamicRotation}),_updateFixSize2d:function(){var p,G,v,J,$,S,O=this.data,W=this.s("fixSizeOnScreen")||this.s("shape3d.fixSizeOnScreen");W?(v=this.gv,p=Xm(O,v.getMat(O)),S=lm([0,0,0],p),S=v.toViewPosition(S),isNaN(S.x)||isNaN(S.y)||(G=lm([1,0,0],p),G=v.toViewPosition(G),p=lm([0,1,0],p),v=v.toViewPosition(p),p=G.x-S.x,G=v.y-S.y,p&&G&&(v=O._dynamicScale3d||[1,1,1],S=T(O.s("shape3d.image")),0<W[0]&&(J=W[0]),0<W[1]&&($=W[1]),J&&$||(W=0<W?W:1,J=J||(Am(S,O)||O.getWidth())*W,$=$||(km(S,O)||O.getTall())*W),S=Math.abs(p/J),W=Math.abs(G/$),Math.abs(S-1)<.001&&Math.abs(W-1)<.001||(O._dynamicScale3d=[v[0]/S,v[1]/W,v[2]])))):O._dynamicScale3d&&delete O._dynamicScale3d},_updateOverlapping:function(){var p=this.s("hide.overlapping.group");if(p){for(var G,v=this.gv,J=this.data,$=Xm(J,v.getMat(J)),S=1/0,O=1/0,W=-1/0,l=-1/0,t=(J=J.getAnchor3d()).x,z=J.y,Z=J.z,B=0;B<8;B++){if(G=lm([(B>>2)-t,(B>>1&1)-z,(1&B)-Z],$),G=v.toViewPosition(G),isNaN(G.x)||isNaN(G.y))return;S=Math.min(S,G.x),W=Math.max(W,G.x),O=Math.min(O,G.y),l=Math.max(l,G.y)}this._rectOverlapping=v.overlappingBox.isOverlapping(p,{x:S,y:O,w:W-S,h:l-O})}else this._rectOverlapping&&(this._rectOverlapping=K)},getVectorDynamicSize:function(){var J,$,S,O,W,l,p,G,v,t,z=this.s("shape3d"),Z=this.data;if("billboard"===z||"plane"===z||(G=Z._currentCubeElementId)!=v0)return J=this.gv,$=Xm(Z,J.getMat(Z)),p=Z.getAnchor3d(),S=.5-p.x,O=.5-p.y,W=.5-p.z,l=Math.min(this.s("vector.dynamic.maxsize"),J._glCapabilities.maxTextureSize)/J.getDevicePixelRatio(),p=function(p,G){p[0]+=S,p[1]+=O,p[2]+=W,G[0]+=S,G[1]+=O,G[2]+=W;var p=J.toViewPosition(lm(p,$)),G=J.toViewPosition(lm(G,$)),v=p.x-G.x,p=p.y-G.y;return Math.min(l,Math.sqrt(v*v+p*p))},"billboard"===z?(v=p([-.5,0,0],[.5,0,0]),t=p([0,-.5,0],[0,.5,0])):"plane"===z?(v=p([-.5,0,0],[.5,0,0]),t=p([0,0,-.5],[0,0,.5])):Z._currentCubeElementId!=v0&&(z=3*ap[G+1],Z=3*ap[G],G=3*ap[G+2],v=p([Kp[z],Kp[1+z],Kp[2+z]],[Kp[G],Kp[1+G],Kp[2+G]]),t=p([Kp[z],Kp[1+z],Kp[2+z]],[Kp[Z],Kp[1+Z],Kp[2+Z]])),[v,t]},vf:function(p,G){if(this.gv.getFaceVisible(this.data,p)){(p=VZ(this,p)).mat&&(this.faceMat=!0);var v=p.uv;if(v)for(var J=(J=this._cubeUvs)||(this._cubeUvs=new pm([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0])),$=0;$<8;$++)J[G+$]=v[$];return p}},_billboardInView:(Xs=[-.5,-.5,0,-.5,.5,0,.5,-.5,0,.5,.5,0],qs=[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,.5],gs=new rh,Ms=new m,Ls=new eh,function(p){if(!this.mat)return!0;var G=this.gv.getFrustum(),v="billboard"===p?Xs:qs;gs.makeEmpty(),Ls.fromArray(this.mat);for(var J=0,$=v.length;J<$;J+=3)gs.expandByPoint(Ms.fromArray(v,J).applyMatrix4(Ls));return G.intersectsBox(gs)}),_80o:function(p,G,v){var J=this;if(J._rectOverlapping)return!0;var $=J.shapeModel;if($||!J.shapeName){if(("billboard"===(S=J.s("shape3d"))||"plane"===S)&&!J._billboardInView(S))return!0;var S=J.gv,O=J.data,W=S._cube,l=r.for(p).directAttribs();yZ(S,J.mat),!p._picking&&J.s("shape3d.reflector")||J.s("effect.flow")||($?Zn(S,O,$,J,J.getBodyColor(),v):(l.aPosition=PZ(p,W.vs,v0),l.aNormal=PZ(p,W.ns,v0),rZ(p,W.is),J._18O(p,G,"left",0,v),J._18O(p,G,"front",6,v),J._18O(p,G,"right",12,v),J._18O(p,G,"back",18,v),J._18O(p,G,"top",24,v),J._18O(p,G,"bottom",30,v))),IZ(S),J.faceMat&&(J._18O(p,G,"left",0,v,!0),J._18O(p,G,"front",6,v,!0),J._18O(p,G,"right",12,v,!0),J._18O(p,G,"back",18,v,!0),J._18O(p,G,"top",24,v,!0),J._18O(p,G,"bottom",30,v,!0))}},_18O:function(p,G,v,J,$,S){var O,W,l,t,z,Z,B,f,X,q=this[v];!q||!$(q.transparent)||S&&!q.mat||!S&&q.mat||(($=this.data.s("polygonOffset"))&&gZ(p,$),S&&yZ(this.gv,q.mat),O=this.data,W=r.for(p).directUniforms(),O._currentCubeElementId=J,v=(l=this.gv).getTexture(q.texture,O,v),t=q.uv,z=q.uvScale,Z=q.uvOffset,B=q.uvRotation,f=q.uvAnchor,X=q.discardSelectable,v?t?sZ(p,G,v,X,l._buffer.uv,this._cubeUvs,Z,z,B,f):sZ(p,G,v,X,l._cube.uv,v0,Z,z,B,f):sZ(p),DZ(p,0,q.blend,q.light,q.opacity,q.reverseFlip,q.reverseColor,q.reverseCull),W.uDiffuse=q.color||F["color.empty"],dZ(p,J,6),YZ(p),cZ(p,0,v),S&&IZ(l),$&&MZ(p),O._currentCubeElementId=null)},contextLost:function(){Yk.superClass.contextLost.apply(this,arguments),this.data.s("shape3d.reflector")&&(this._reflectorRenderTarget=null,this._reflectNormal=null)},drawReflector:(Gs=new m,vs=new m,Js=new kh,$s=new eh,Ss=new m,Os=new m,Ws=new m,ls=new m,ts=new eh,zs=new eh,Zs=new jh,Bs=new dh,fs=new dh,function(p){var G=this,v=(G._reflectorInfo=null,G.data);if(v._reflecting)return!1;var J=G.gv;if(J._picking)return!1;var $,S,O,W,l=v instanceof dI,t=G._reflectorRenderTarget,z=J._canvas.width,Z=J._canvas.height;if(t?t.setSize(p,z,Z):t=G._reflectorRenderTarget=new Gp.RenderTarget(J,p,z,Z),l?($=v.getPointsMatrix3d().getElements(),(z=v.p3())[1]+=(1-v.getAnchorElevation())*v.getTall(),Gs.copy(lm(z,$))):Gs.copy(v.p3()),vs.copy(J.getEye()),$s.makeRotationFromEuler(Js.set(v.r3(),v.getRotationMode(),!0)),!G._reflectNormal){if(l&&v.getThickness()<0){if(!G.shapeModel||!G.shapeModel.top_vs)return!1;B={vs:G.shapeModel.top_vs,ns:G.shapeModel.top_ns}}else{if(!(B=fn(G,G.s("shape3d"))))return!1;!B.ns&&B.length&&(B=B[0])}if(!B.ns||!B.vs)return!1;G._reflectNormal=[B.ns[0],B.ns[1],B.ns[2]],G._reflectorVbuffer=_n.Buffer.createVertexBuffer(p,new Float32Array(B.vs))}if(Ss.copy(G._reflectNormal),Ss.applyMatrix4($s),Os.subVectors(Gs,vs),0<Os.dot(Ss))return!1;Os.reflect(Ss).negate(),Os.add(Gs),Ws.copy(J.getCenter()).negate().add(Gs),Ws.reflect(Ss).negate(),Ws.add(Gs),ls.copy(J.getUp()),ls.reflect(Ss),Br(z=Z=[0,0,0,0,0,0,0,0,0],(B=J).getEye(),0),Br(z,B.getCenter(),3),Br(z,B.getUp(),6),fr(J._eye,Os.toArray()),fr(J._center,Ws.toArray()),fr(J._up,ls.toArray()),J._18Q=v0,(z=J._skybox)&&(z.p3(J._eye),J.getData3dUI(z).iv()),es(p,t.frame),J.setViewport(p,0,0,t.width,t.height),(z=v.s("shape3d.reflector.background"))?(S=p.getParameter(p.COLOR_CLEAR_VALUE),LZ(p,z)):LZ(p,[0,0,0,1]),r.for(p).glState.depth.mask=!0,p.clear(p.COLOR_BUFFER_BIT|p.DEPTH_BUFFER_BIT);var B=(B=v.s("shape3d.reflector.clip"))===K?.003:B,f=WZ(J),X=OZ(J),B=(Zs.setFromNormalAndCoplanarPoint(Ss,Gs.add(Ss.clone().multiplyScalar(B))),Zs.applyMatrix4(zs.fromArray(X)),Bs.set(Zs.normal.x,Zs.normal.y,Zs.normal.z,Zs.constant),zs.fromArray(f).getInverse(zs),fs.set(Math.sign(Bs.x),Math.sign(Bs.y),1,1).applyMatrix4(zs),Bs.multiplyScalar(2/Bs.dot(fs)),f[2]=Bs.x-f[3],f[6]=Bs.y-f[7],f[10]=Bs.z-f[11],f[14]=Bs.w-f[15],J._computedProjectMatrix),X=(J._computedProjectMatrix=f,v._reflecting=!0,v.s("shape3d.reflector.shadow")),f={renderAxis:!1,renderEdit:!1,renderGrid:!1};return"disabled"===X?(f.createShadowMap=!1,f.renderShadow=!1):"scene"===X?f.createShadowMap=!1:f.useReflectorSelfShadowMap=!0,J.renderScene(f),J._computedProjectMatrix=B,ts.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),ts.multiply(zs.fromArray(J._projectMatrix)),ts.multiply(zs.fromArray(J._viewMatrix)),z&&LZ(p,S),As(p),fr((f=J)._eye,X=Z,0),fr(f._center,X,3),fr(f._up,X,6),f._18Q=v0,(B=f._skybox)&&(B.p3([X[0],X[1],X[2]]),f.getData3dUI(B).iv()),(z=v.s("shape3d.reflector.blur"))&&(S=J.getPostProcessingModule("Blur"))&&S.drawImpl(p,t,z,3<=z,v.s("shape3d.reflector.blur.iterations")),(Z=J.getPostProcessingModule("Glitch"))&&Z.enable&&Z.onlyReflector&&(t=Z._42(p,t)),(X=(X=p._compiledShader.reflector)||(p._compiledShader.reflector=new _n.Shader(p,Ps.Reflector.vs,Ps.Reflector.fs))).bind(),p.activeTexture(p.TEXTURE0),XZ(p,t.texture),X.uniforms.tDiffuse=0,X.uniforms.color=yE(v.s("shape3d.reflector.color")||"rgb(128,128,128)"),X.uniforms.textureMatrix=ts.toArray(),X.uniforms.modelMatrix=l?$:Xm(v),X.uniforms.viewMatrix=OZ(J),X.uniforms.projectionMatrix=WZ(J),(f=G._reflectorVbuffer).upload(),X.attributes.pos.pointer(f),(B=this.s("shape3d.transparent"))&&(W=(O=r.for(p).glState).depth.mask,O.depth.mask=!1),p.drawArrays(p.TRIANGLES,0,f.data.length/3),B&&(O.depth.mask=W),v._reflecting=!1,p.useProgram(J._prg),XZ(p,v0),!0})}),Ps.Reflector={vs:["attribute vec3 pos;","uniform mat4 textureMatrix;","uniform mat4 modelMatrix;","uniform mat4 viewMatrix;","uniform mat4 projectionMatrix;","varying vec4 vUv;","void main() {","\tvUv = textureMatrix * modelMatrix * vec4( pos, 1.0 );","\tgl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4( pos, 1.0 );","}"].join("\n"),fs:["precision highp float;","uniform vec3 color;","uniform sampler2D tDiffuse;","varying vec4 vUv;","float blendOverlay( float base, float blend ) {","\treturn( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );","}","vec3 blendOverlay( vec3 base, vec3 blend ) {","\treturn vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );","}","void main() {","\tvec4 base = texture2DProj( tDiffuse, vUv );","   vec2 tUv = vUv.xy / vUv.w;","   if (tUv.x < .0 || tUv.y < .0 || tUv.x > 1. || tUv.y > 1.) discard;","\tgl_FragColor = vec4( blendOverlay( base.rgb, color ), base.a );","}"].join("\n")},function(p,G){bS(sk,this,[p,G])}),ck=(oA(sk,Yk,{_80o:function(p){}}),function(p,G){bS(ck,this,[p,G])}),hk=(oA(ck,Dk,{_25Q:1,validate:function(p,G){var v=this,J=v.s;if(J(cl)!==XJ||J("batch")!=v0||!v.info||v.data._needChangeGeometry){var $=v.gv,S=v.data,O=J("edge.width"),W=S._40I,l=S._41I;if(S._needChangeGeometry=v.shapeModel=v.info=v.lineShapeModel=v0,W&&l){var t=S.isLooped(),z=J(mJ);if(h=N.getEdgeType(z)){if(!(h=h(S,cj(v,$,S,t,z),$,v._19Q)).points||h.points.isEmpty())return;for(var Z=v.info={},B=h.segments,f=(c=h.points).size(),X=W.getElevation(),q=l.getElevation(),g=0;g<f;g++){var M=c.get(g);M.e==v0&&(M.e=X+(q-X)*g/(f-1))}var L=ys(c.get(0)),H=ys(c.get(f-1)),_=(f-(Y=f%2))/2;Z.c1=ys(c.get(_-1)),Z.c2=ys(c.get(_)),0!==Y&&(Z.p3=Z.c2),Z.s1=L,Z.s2=ys(c.get(1)),Z.t1=ys(c.get(f-2)),Z.t2=H}else{var b,n,D,Y,s,c=new o,Z=v.info={},h=J("edge.offset"),l=J("edge.center"),w=J("edge.source.t3"),d=J("edge.target.t3"),P=mZ($,S,"source"),j=mZ($,S,"target");if(!P||!j)return $.invalidateData(S),delete v.info,!1;w&&(P[0]+=w[0],P[1]+=w[1],P[2]+=w[2]),d&&(j[0]+=d[0],j[1]+=d[1],j[2]+=d[2]),z===hJ?(B=J("edge.segments"),(f=(w=Z.points=J(NJ)||om).size())?(L=ys(w.get(0)),H=ys(w.get(f-1)),!l&&h&&(d=h,b=Gm(L,P,!0),h=$0(d,iA(P,L)),P=[P[0]+b[0]*h,P[1]+b[1]*h,P[2]+b[2]*h],b=Gm(j,H,!0),h=$0(d,iA(H,j)),j=[j[0]-b[0]*h,j[1]-b[1]*h,j[2]-b[2]*h]),1===f?Z.p3=L:(_=(f-(Y=f%2))/2,n=ys(w.get(_-1)),D=ys(w.get(_)),0!==Y&&(Z.p3=D),Z.s1=P,Z.s2=L,Z.t1=H,Z.t2=j)):(!l&&h&&(b=Gm(j,P,!0),s=iA(P,j),h=Dj(h,s),P=[P[0]+b[0]*h,P[1]+b[1]*h,P[2]+b[2]*h],j=[j[0]-b[0]*h,j[1]-b[1]*h,j[2]-b[2]*h]),n=P,D=j),c.add({x:P[0],y:P[2],e:P[1]}),c.addAll(w),c.add({x:j[0],y:j[2],e:j[1]})):(d=cj(v,$,S,t,z),v._19Q||(d=-d),t?(_=P[0],Y=P[1],L=P[2],n=[_-d,Y+(H=W.getTall()/2+d),L],D=[_+d,Y+H,L],c.add({x:_-d,y:L,e:Y}),c.add({x:_-d,y:L,e:Y+H}),c.add({x:_+d,y:L,e:Y+H}),c.add({x:_+d,y:L,e:Y})):(b=Gm(j,P,!0),s=iA(P,j),w={x:P[0],y:P[2]},$={x:j[0],y:j[2]},z=(S=os(v0,w,$,d)).x-w.x,t=S.y-w.y,h=Dj(h,s),b[0]*=h,b[1]*=h,b[2]*=h,n=[P[0]+b[0]+z,P[1]+b[1],P[2]+b[2]+t],D=[j[0]-b[0]+z,j[1]-b[1],j[2]-b[2]+t],l?(c.add({x:P[0],y:P[2],e:P[1]}),c.add({x:n[0],y:n[2],e:n[1]}),c.add({x:D[0],y:D[2],e:D[1]}),c.add({x:j[0],y:j[2],e:j[1]})):(c.add({x:n[0],y:n[2],e:n[1]}),c.add({x:D[0],y:D[2],e:D[1]})))),Z.c1=n,Z.c2=D}Z._lastPointsSegments={points:c,segments:B},J(cl)===XJ?Z.list=v.createTubeModel(c,B,O/2,p):Z.list=v.createLineModel(c,B,O,"edge","edge.dash")}}},invalidateCachedGeometry:function(){this.info=v0}}),function(p,G){bS(hk,this,[p,G]),this._needRecoverPosition=!0}),wk=(oA(hk,Yk,{_80o:function(p,G,v){var J,$,S=this,O=S._matWithExtraction||S.mat;!O||S.s("shape3d.reflector")&&!p._picking||(J=S.gv,$=S.shapeModel,yZ(J,O),$?Zn(J,S.data,$,S,S.getBodyColor(),v):(oZ(S,p,G,"left",v),oZ(S,p,G,"front",v),oZ(S,p,G,"right",v),oZ(S,p,G,"back",v),oZ(S,p,G,"top",v),oZ(S,p,G,"bottom",v)),IZ(J))},validate:function(p,G){var v,J,$,S=this,O=S.s,W=S.data,l=W._thickness/2,t=W.isClosePath(),z=W.getPoints(),Z=W.getSegments(),B=O(hl),f=p&&p.uv;if(S.invalidateUnstableWireframe(),S.clear(),S.dispatchBoundingBoxChanged(),N.extractShapeTranslation||N.extractVerticesTranslation?(J=new sh.Vector3(W.p3()),(z=MA(z)).forEach(function(p){p.x-=J.x,p.y-=J.z}),S._vsTranslation=(new sh.Matrix4).setPosition(J),$=W.getShapeElevation,W.getShapeElevation=function(){return-(this.getTall()||0)*(this._anchorElevation-.5)}):S._vsTranslation=null,l<0){S.s("shape3d.reflector")&&(S._reflectNormal=null);try{var X,q,g=O("shape3d.image.projection");g&&g[4]&&(X=(P=W.p3())[0],q=P[2],g=[X+g[0],g[1]+q,X+g[2],g[3]+q]),v=S.shapeModel=mj(z,Z,O(jl),O(il),B,O(rl),W.getTall(),W.getShapeElevation(),t,g)}catch(p){v=S.shapeModel={}}O(wl)?O("shape3d.image")||delete v.uv:(delete v.vs,delete v.ns,delete v.uv),O("shape3d.top.image")||delete v.top_uv,O("shape3d.bottom.image")||delete v.bottom_uv}else if(O(cl)===XJ)c=aE(z,Z,B,t),v=S.shapeModel={vs:[]},O("shape3d.image")&&(v.uv=[],v.sum=O(rl)||AS(c)||1,v.len=0),O(jl)&&!t&&(v.top_vs=[],O("shape3d.top.image")&&(v.top_uv=[])),O(il)&&!t&&(v.bottom_vs=[],O("shape3d.bottom.image")&&(v.bottom_uv=[])),S._12O(c,l);else{var M,L,H,_,b,n,D,Y,s,c=aE(z,Z,B,t),h=S.vf(U0,f,!1,G);if(l&&(b=S.vf(F0,f,!1,G),n=t?v0:S.vf(C0,f,!1,G),D=t?v0:S.vf(Q0,f,!1,G),Y=S.vf(pJ,f,!1,G),s=S.vf(GJ,f,!1,G)),l){for(var w=0,d=c.length;w<d;w++)c[w]=S._tryRemoveBezierPoints(c[w],l);S._12O(c,l)}else h&&c.forEach(function(p){if(0<(_=p.length))for(M=p[0],H=1;H<_;H++)L=p[H],S.addV(h.vs,M,L),M=L});S._20Q(c),p||(h&&(h.ns=lZ(h.vs),qn(h,"vs"),qn(h,TJ)),l&&(b&&(b.ns=lZ(b.vs),qn(b,"vs"),qn(b,TJ)),n&&(n.ns=lZ(n.vs),qn(n,"vs"),qn(n,TJ)),D&&(D.ns=lZ(D.vs),qn(D,"vs"),qn(D,TJ)),Y&&(Y.ns=lZ(Y.vs),qn(Y,"vs"),qn(Y,TJ)),s&&(s.ns=lZ(s.vs),qn(s,"vs"),qn(s,TJ))))}var P=S.mat=W.getPointsMatrix3d().getElements();S._vsTranslation?P=S._matWithExtraction=(new sh.Matrix4).fromArray(P).multiply(S._vsTranslation).toArray():S._matWithExtraction=null,p&&(S.gv.getWireframeGeometry(W)&&(S.wfGeometry=Mp(S,v),S.wfMatrix=P?Om(P):null),wp(S,P,p,v,G),S.clear()),$!=v0&&(W.getShapeElevation=$)},_20Q:function(p){var G,v,J,$,S,O,W,l,t,z,Z,B,f,X=this,q=X.front,g=X.back,M=X.top,L=X.bottom,q=q?q.tuv:v0,g=g?g.tuv:v0,M=M?M.tuv:v0,L=L?L.tuv:v0,H=0,_={front:0,back:0,top:0,bottom:0};(q||g||M||L)&&(f=X.s(rl),G=f||AS(p)||1,Z=X.s("all.uv.union"),p.forEach(function(p){if(0<(v=p.length)){for(z in _)(!1===(B=X.s(z+".uv.union"))||B==v0&&!1===Z)&&(_[z]=0,f||(G=AS([p])));for(O=p[0],J=1;J<v;J++){for(z in W=p[J],l=iA(O,W),_)H=_[z],$=H/G,_[z]=H+=l,S=H/G,"back"===z&&(t=$,$=1-S,S=1-t),X._14O(X[z],$,S);O=W}}}))},_14O:function(p,G,v){var J,$,S,O,W,l,t,z;p&&(z=p.uv,(p=p.tuv)&&(z=z?(J=z[0]+(z[6]-z[0])*G,$=z[1]+(z[7]-z[1])*G,S=z[2]+(z[4]-z[2])*G,O=z[3]+(z[5]-z[3])*G,W=z[2]+(z[4]-z[2])*v,l=z[3]+(z[5]-z[3])*v,t=z[0]+(z[6]-z[0])*v,z[1]+(z[7]-z[1])*v):(S=J=G,l=O=1,t=W=v,$=0),p.push(S,O,W,l,t,z,t,z,J,$,S,O)))},_13O:function(p){var G=p.uv;(p=p.tuv)&&(G?p.push(G[2],G[3],G[4],G[5],G[6],G[7],G[6],G[7],G[0],G[1],G[2],G[3]):p.push(0,1,1,1,1,0,1,0,0,0,0,1))},_tryRemoveBezierPoints:function(G,p){var v=G.length;if(v<4)return G;for(var J,$,S,O,W=!1,l=function(p){return G[p]},t=function(p){return G[v-1-p]},z=0;z<=1;z++)for(J=(S=z?t:l)(0),$=S(1),B=2;B<v-1;B++)(O=S(B)).remove||(O.b&&os(J,$,O,p).adjust?W=O.remove=!0:(J=$,$=O));if(!W)return G;for(var Z=[],B=0;B<v;B++)G[B].remove||Z.push(G[B]);return Z},_12O:function(p,G){var v,J,$,S,O,W=this.s("shape3d.point.epsilon"),l=this;p.forEach(function(p){if(0<(O=p.length))for(v={p:p[0],n:!0},S=1;S<O;S++)J=p[S],($=S<O-1?p[S+1]:v0)&&Math.abs(J.x-$.x)<W&&Math.abs(J.y-$.y)<W||l.addPoint(v,J,$,G,p)})},addPoint:function(p,G,v,J,$){var S,O,W,l,t,z,Z=this,B=p.p,f=p.f,X=p.b,q=Z.s("shape3d.side")||VA,g=Z.s("shape3d.start.angle"),M=Z.s("shape3d.sweep.angle"),L=Z.shapeModel,H=Z.data.isClosePath();if(p.n&&(p.n=!1,f=H&&2<$.length?os($[$.length-2],B,G,J):os(v0,B,G,J),X=Vs(B,f),L?L.top_vs&&Z._10O(X,f,q,g,M,L.top_vs,L.top_uv):(S=Z.left)&&(Z.addV(S.vs,X,f),Z._13O(S))),H=v?os(B,G,v,J):H&&2<$.length?os(B,G,$[1],J):os(B,G,v0,J),$=Vs(G,H),L){var _,b,n=L.vs,D=L.uv,J=L.sum;for(D&&(_=L.len/J,L.len+=iA(B,G),b=L.len/J),W=Z._9O(X,f,q,g,M),l=Z._9O($,H,q,g,M),t=0;t<q;t++)qS(n,W[z=t+1]),qS(n,l[t]),qS(n,W[t]),qS(n,l[t]),qS(n,W[z]),qS(n,l[z]),D&&D.push(_,z/=q,b,O=t/q,_,O,b,O,_,z,b,z);!v&&L.bottom_vs&&Z._10O($,H,q,g,M,L.bottom_vs,L.bottom_uv,!0)}else!v&&(S=Z.right)&&(Z.addV(S.vs,H,$),Z._13O(S)),(S=Z.front)&&Z.addV(S.vs,f,H),(S=Z.back)&&Z.addV(S.vs,$,X),(S=Z.top)&&Z.addH(S.vs,f,H,$,X,!0),(S=Z.bottom)&&Z.addH(S.vs,X,$,H,f);p.p=G,p.f=H,p.b=$},_10O:function(p,G,v,J,$,S,O,W){for(var l,t,z=this.data,Z=this._9O(p,G,v,J,$),B=(p.x+G.x)/2,f=(p.y+G.y)/2,X=z.getShapeElevation(),q=0,q=0;q<v;q++)W?(qS(S,Z[q]),qS(S,Z[q+1])):(qS(S,Z[q+1]),qS(S,Z[q])),qS(S,[B,X,f]),O&&(t=W?(l=W0*(q+1)/v+J,W0*q/v+J):(l=W0*q/v+J,W0*(q+1)/v+J),O.push(.5-.5*S0(t),.5-.5*O0(t),.5-.5*S0(l),.5-.5*O0(l),.5,.5))},_9O:function(p,G,v,J,$){var S,O,W=this.data,l=[],t=(p.x+G.x)/2,z=(p.y+G.y)/2,Z=W.getTall()/2,B=W.getShapeElevation(),f=0;for($==v0&&($=W0);f<=v;f++)O=S0(S=$*f/v+J),l.push([t+(p.x-t)*O,B+Z*O0(S),z+(p.y-z)*O]);return l},addV:function(p,G,v){var J=G.x,G=G.y,$=v.x,v=v.y,S=(O=this.data).getShapeElevation(),O=O.getTall()/2;p.push(J,S-O,G,$,S-O,v,$,S+O,v,$,S+O,v,J,S+O,G,J,S-O,G)},addH:function(p,G,v,J,$,S){var O=(W=this.data).getTall()/2,W=W.getShapeElevation()+(S?O:-O);p.push(G.x,W,G.y,v.x,W,v.y,J.x,W,J.y,J.x,W,J.y,$.x,W,$.y,G.x,W,G.y)},vf:function(p,G,v,J){var $,S=this.gv.getFaceVisible(this.data,p);return(v||S)&&(($=VZ(this,p,J)).vs=[],$.tuv=S&&($.texture||G)?[]:v0,$.visible=S),$}}),function(p,G){bS(wk,this,[p,G])}),dk={},Pk=(oA(wk,Yk,{validate:function(){var p=this,G=p.gv,v=p.data,J=p.s,$=yE(J("points.color")),S=J("points.size"),O=J("points.uv.offset"),W=J("points.image"),l=(!W||/\.(png|jpg|gif|jpeg|bmp|svg)$/i.test(W)||ji.test(W)||(dk[W]||(dk[W]=p._createCachedImage(W)),W=dk[W]),v._modelDirty),t=J("points.model");if(t){if(p._lastShapeModel!==t||!p.shapeModel){var z=fn(p,t);if(!z)return;var Z=[],B={};p.eachShapeModel(function(p){for(var G=0,v=p.length;G<v;G+=3){var J=p[G],$=p[G+1],S=p[G+2],O=J+"_"+$+"_"+S;B[O]||(B[O]=!0,Z.push(J,$,S))}},z),p._setShapeModelPoints(new pm(Z)),p._lastShapeModel=t,l=!0}X=p.shapeModel.vs.length/3}else{var f=v.getPoints(),X=f.length;if(l||v._pointsDirty||!p.shapeModel){for(var q=[],g=0;g<X;g++){var M=f[g];M&&q.push(M.x,M.e,M.y)}p._setShapeModelPoints(new pm(q)),v._pointsDirty=!1,l=!(p._lastShapeModel=null)}}if(p.info={mat:Xm(v),size:S,diffuse:$,opacity:J("points.opacity"),texture:W,alphaTest:J("points.transparent")?0:J("alphaTest"),uvScale:J("points.uv.scale"),uvOffset:O,discardSelectable:J("points.discard.selectable")},l||v._colorsDirty){var L=!1,H=v.getColors();if(H&&0<H.length)for(var _=[],g=0;g<X;g++)for(var b=H[g],k=b?(L=!0,yE(b)):$,I=4*g,n=0;n<4;n++)_[I+n]=k[n];p.shapeModel.cs=L?new pm(_):null,v._colorsDirty=!1}if(l||v._sizesDirty){var D=!1,Y=v.getSizes();if(Y&&0<Y.length)for(var s,c=[],g=0;g<X;g++)0<=(s=Y[g])?(c.push(s),D=!0):c.push(S);p.shapeModel.ss=D?new pm(c):null,v._sizesDirty=!1}if(l||v._offsetsDirty){var h=!1,w=v.getUvoffsets();if(w&&0<w.length)for(var d,P,j=[],g=0;g<X;g++)d=w[P=2*g],P=w[1+P],d!=K&&P!=K?(j.push(d,P),h=!0):j.push(O[0],O[1]);p.shapeModel.os=h?new pm(j):null,v._offsetsDirty=!1}if(l||p._lastPointNumber!==X){this.dispose();for(var i=G.pickColorMap,r=p._startPickId=i._pickIdUsed,q=(i._pickIdUsed=r+X,[]),g=0;g<X;g++){var e=r+g,A=Wk(e);q.push(A[0],A[1],A[2],A[3]),i[e]||(i[e]={data:v,part:g})}p.shapeModel.ps=new pm(q),p._lastPointNumber=X}v._modelDirty=!1,this.dispatchBoundingBoxChanged()},_setShapeModelPoints:function(p){var G=this.shapeModel,v=this.shapeModel={vs:p};return G&&(p=p.length,p=Math.round(p/3),G.cs&&G.cs.length==4*p&&(v.cs=G.cs),G.ss&&G.ss.length==p&&(v.ss=G.ss),G.os&&G.os.length==2*p&&(v.os=G.os),G.ps&&G.ps.length==4*p&&(v.ps=G.ps)),v},_createCachedImage:function(p){var G=xS(),v=G.getContext("2d"),v=(mS(G,128,128,1),Im(v,{width:128,height:128,comps:[{type:p,background:"white",borderWidth:0,rect:[0,0,128,128]}]},0,0,128,128),E.Math.generateUUID());return bi[v]=G,v},_80o:function(p,G){var v,J,$,S,O,W=this.gv,l=W._picking;l&&!W.isSelectable(this.data)||(v=this.shapeModel,J=this.info,v&&v.vs&&v.vs.length&&(($=r.for(p)).useProgram(this._asureProgram(p)),S=$.directUniforms(),O=$.directAttribs(),S.modelMatrix=J.mat,S.modelViewMatrix=Qs([],W._viewMatrix,J.mat),S.projectionMatrix=W._projectMatrix,S.viewMatrix=W._viewMatrix,S.scale=W.getHeight()/2,S.size=J.size,S.diffuse=J.diffuse,S.opacity=J.opacity,S.map=W.getTexture(J.texture,this.data),S.alphaTest=J.alphaTest,S.resolution=W.getDevicePixelRatio(),S.discardSelectable=J.discardSelectable,S.uvScale=J.uvScale,!l&&v.os?O.uvOffset=iZ(p,W._buffer.os,v.os,v0):O.uvOffset=J.uvOffset,S.blackout=p._blooming&&!this.data.s("bloom"),O.position=iZ(p,W._buffer.vs,v.vs,v0),l?(S.picking=!0,O.pickColor=iZ(p,W._buffer.ps,v.ps,v0),S.useColor=!1,O.color=null):(S.picking=!1,O.pickColor=null,v.cs?(S.useColor=!0,O.color=iZ(p,W._buffer.cs,v.cs,v0)):(S.useColor=!1,O.color=null)),v.ss?(S.useSizeArray=!0,O.sizeArray=iZ(p,W._buffer.ss,v.ss,v0)):(S.useSizeArray=!1,O.sizeArray=null),wZ(p,0,v.vs.length/3,p.POINTS),$.useProgram(G),O.disable(),W.shadowMap.enable&&W.shadowMap.createShadow(),W.flowMap.createFlow()))},_asureProgram:function(p){return p._pointsShader||(p._pointsShader=this.gv._postProcessing.createShader(p,wk.shaderSrc)),p._pointsShader.program},dispose:function(){wk.superClass.dispose.call(this);var p=this._startPickId,G=this._lastPointNumber;if(p&&G){for(var v=this.gv.pickColorMap,J=0;J<G;J++){var $=p+J;v[$]&&delete v[$]}delete this._startPickId,delete this._lastPointNumber}}}),wk.shaderSrc="!\v\v!~v!o\vj<g*p!s{n/!onpbjuu5j!tnppQewfnm!N.b!u0s!jfym<b\vd!tv!o)j!g>p+s!nf!{njbTuu5o!jnppQe`fmmhW!j*f!xfNwbjuusdjfyq<t\vs!fvQotjjg!p)s!ng!jn!b\vu<5*!!q1s/p2k!f.d!u>j>p!o^N!b4u!s]j^y!<3\v!!]vyojjsgupbsNno!pnjbuud5f!kwpjsfqx!N)b!u>s!jfyw<j\vu!dvfoqjtgspfsQnt!jg!mmppbpuc!!t\vd\vb\vm~f!<\v\v<\vo!pbjuuuvsmjpctvfusf!!+w!ffd{4j!tq!p>t!jfu{jjpTou<o\vj\vp!Qv`omjhg!p\vs|n!!fctpmpfm!!~v!t\vf<Doppmjpusv<m\vp!tbfusu!s+j!czvbusfs!Bwff{dj5t!!d>p!mfp{sj<T\vu!owjbpsQz`jmohh!!\vw|f!d*5z!bwsDspBmfp{sj<T\vf\vt!vb)u!ugsjj!c\vv<uofp!jwufjdt3p!QvwwnP!g+g!tyfjus<u\vb!Nwobpsjzujdofhk!pwsfqd!3>!!woPpgjgutjftup<Q\v`\vm!hv!o\vj<goppsjnu!jctpppQmw!nq!j+d!lyjjoshu<b\vN!xbfujuWsmjfcevpunf!!>w!fodp5j!uqjjtdplQDwpnm!p\vs<<*\v!\v1!/v2o!j-gepfsnns!pggmtpobbus!ut!j){5fd<f\vw!!v>o!jogppjsunj!tgpmQpwbnu!!5sdfftwp!m\vv<u*j!poop<j\vu!jvtopjqg!p)s4nd!fcwp!p>m!!evftnfsTpjg{tfoBbsssub!z4<d\vf!wb!u\vu<s*jucfvtugfg!Pgwmvp)b3ud!ftwj!{>f!Busfstbgzg<P\vw\v!!\vc~p!p\vm<!sjptmQpfds!t>q!fsdpumjpwDfwN!b\vu|s!j*ys)p!mnpbDuf5t!vn)!!*g!j|!\vf!tsmffu!v\vs~o!!\vn<]s!p3m!p^D]l!d4j!q^!!>>!>s!p.m!p2D/w1!<\v\v|!!~*\vh\vo!jwlpdjjeq!)n!bgjjo!)\v*|!^#!\v\v!~q\vs~f!d\vj<tsjppmop!Difjthvigqg!jgem!p>b!us<p\vm!p$DehfbgsjGo`fm!hV!T\vF|`!NfBtQm\vf\v!!\vv~o!j\vg<psspnm!pwDfwd!5>!!esjpgmgpvDthfb<s\vG!`vmohj!g\vp<sens!bgdmtpjbeu!!*p1q/b1d!j>u>z!<b\v/!svpomjpgDpfstnv!gggmjpeb)u!!gbjm!q\vi|b!U*fhtouj<l\vd\vj!qv)o!jggjp!s\vn<!ecspbpdmt!jvet!f*DuptmfpUsb<i\vq!mwbb!s=z!jbo/hs!pwmfpdD5f!twvDgpgmjpes)<!\vg\vj!!v\vogjjgeposfn$!!c\vp~p!m\v!<q*jwdvl!j-oqhb<n\v!!)vEo3jfgspvsuny!fcup!p>m+!!esjptmdpbDsfetTvfgmgfjdeu!b\vc<muff<t\vg\vg!Pvwo!j>g,p!swnv!!c\vp<pfmm!bcdmTbwdvl!p+v!ue<s\vp\vp!DvuoojjgppQs`nm!hw!f>d!3w!vv!w3Tddfbwm!f\v<|\v!!*wfbmsczbjuodhf!mwffTde3s!bwdPtgjgetaf!u}<}\v!\vh$ojjgl!dejfqgaj)o!fgej)!!\vV*T!FQ`BNNB`QF!T*V\v!!)veofjogjpgsfne!!tgbjn$q!m\vf~s!3\vE<!*n!bzqu<j\vd$bfqope!j+g!\vb\v/wfptjveg!gnjbej!o-){*z!y|/\vf!tjvgg!g)jcem!b)d5ldpfvwu!*>!!|s!phmmp`DGfstbvhgDgpjmep!s\v!|>!!fwtfmdf5!)~1!/\v1<-*!!1z/u1j-d!b1q/p1!-+!!2b//1s*p<m!psDfwu!v-s{oz<y!/~s\vp\vm!pwDfwd!5)!5edjfgwg!v>t!fsDppmmppDsf<t\vv!gjggj!e)!a\vq|j!d*lsjpomhp!D%f%t!v",function(p,G){bS(Pk,this,[p,G]),this._needRecoverPosition=!0}),jk=(oA(Pk,Dk,{_25Q:1,validate:function(p,G){var v,J,$,S,O,W=this,l=W.data,t=W.s,z=l.getPoints(),Z=z.size(),B=(W.dispatchBoundingBoxChanged(),l.p3()),f=W.mat=$m(),X=(Fs(f,B),DI(f,l.getFinalRotation3d(),l.getRotationMode()),l.getScale3d()),q=l._dynamicScale3d;q&&(X[0]*=q[0],X[1]*=q[1],X[2]*=q[2]),Cs(f,X),Fs(f,vm(B)),t(cl)===XJ&&t("batch")==v0&&W.shapeModel&&!l._needChangeGeometry||(l._needChangeGeometry=W.shapeModel=W.info=W.lineShapeModel=v0,1<Z&&(q=W.info={},X=l.getSegments(),v=l.getThickness(),J=ys(z.get(0)),$=ys(z.get(Z-1)),q.c1=ys(z.get((O=(Z-(S=Z%2))/2)-1)),q.c2=ys(z.get(O)),0!=S&&(q.p3=q.c2),q.s1=J,q.s2=ys(z.get(1)),q.t1=ys(z.get(Z-2)),q.t2=$,t(cl)===XJ?(N.extractPolylineTranslation||N.extractVerticesTranslation?(B=new sh.Vector3(l.p3()),(z=MA(z)).forEach(function(p){p.x-=B.x,p.e-=B.y,p.y-=B.z}),W._vsTranslation=(new sh.Matrix4).setPosition(B),W._matWithExtraction=(new sh.Matrix4).fromArray(f).multiply(W._vsTranslation).toArray()):(W._vsTranslation=null,W._matWithExtraction=null),q.list=W.createTubeModel(z,X,v/2,p)):q.list=W.createLineModel(z,X,v,"shape.border","shape.dash")))},invalidateCachedGeometry:function(){this.shapeModel=this.info=this.lineShapeModel=v0},_80o:function(p,G,v){var J,$,S,O,W,l,t,z,Z,B,f=this,X=f.shapeModel;X&&($=f.mat,(N.extractPolylineTranslation||N.extractVerticesTranslation)&&f._matWithExtraction&&($=f._matWithExtraction),J=f.gv,yZ(J,$),$=f.s("3d.clip.direction"),J._uvClipEnabled&&("uv.left"===$||"uv.right"===$)&&(S=f.s("3d.clip.percentage"))<1?(W=O=!0,Xn(X),l=X.top_vs,t=X.bottom_vs,z=X.vs,Z=(B=r.for(p)).directUniforms(),B=B.directAttribs(),"uv.left"==$?(S<1&&(O=!1),S<=0&&(W=!1)):(S<1&&(W=!1),S<=0&&(O=!1)),X.top_vs=X.bottom_vs=K,B.aUv=iZ(p,J._buffer.uv,X.uv,v0,2),Zn(J,f.data,X,f,f.getBodyColor(),v),B.aUv=!1,Z.uClipDirection=0,X.vs=K,O&&(X.top_vs=l),W&&(X.bottom_vs=t),Zn(J,f.data,X,f,f.getBodyColor(),v),X.vs=z,X.top_vs=l,X.bottom_vs=t):Zn(J,f.data,X,f,f.getBodyColor(),v),IZ(J))}}),E.graph3d.PostProcessing=function(Z){var B,z,f,X,q=this,g={},M=!1,L=!1,H=(d.keys(jk).forEach(function(p){g[p]=new jk[p](Z)}),q.getModule=function(p){return p?g[p]:q},q.getModuleList=function(){return d.keys(g)},q.resetModules=function(){for(var p in g)(p=g[p]).enable=!1,p.resetProperties&&p.resetProperties();M=!1},q._serializable=!0,q.handleDataModleChange=function(p,G){p&&(q._serializable&&p.setPostProcessingData(q.serialize()),p.removeSerializeListener(q.onDataModelSerialize,q)),G&&(G.addSerializeListener(q.onDataModelSerialize,q),q.deserialize(G))},q.onDataModelSerialize=function(p){"serialize"===p.type?q._serializable&&(Z.dm()._postProcessingData=q.serialize()):"deserialize"===p.type&&q.deserialize(Z.dm())},q.isDeserializeDisabled=function(p){return!q._serializable||p.a("sceneBloom")!==K},q.isSerializable=function(){return q._serializable},q.setSerializable=function(p){(q._serializable=p)||Z.dm().setPostProcessingData(K)},q.serialize=function(){var p,G,v,J,$={};for(G in g)if(J=(v=g[G]).serializeProperties){for(var S in p={},v.enable&&(p.enable=!0),J){var O=v[S];O!=J[S]&&(p[S]=O)}d.keys(p).length&&($[G.toLowerCase()]=p)}return $},q.deserialize=function(p){var G,v,J={},$={};for(G in g){var S,O,W=(S=g[G]).serializeProperties,l={},t="scene"+G;for(O in(z=p.a(t))!==K&&(l.enable=z),W)(z=p.a(t+O[0].toUpperCase()+O.slice(1)))!==K&&z!==W[O]&&(l[O]=z);nS(l)||($[G[0].toLowerCase()+G.slice(1)]=l)}if($=nS($)?p.getPostProcessingData():$)for(v in $)if(v&&(G=v[0].toUpperCase()+v.slice(1),S=g[G])){J[G]=!0;var z,Z=!!(W=$[v]).enable;for(O in q.enableModule(G,Z),p.a(G="scene"+G,Z),S.resetProperties&&S.resetProperties(),W)"enable"!==O&&(z=W[O],S[O]=z,p.a(G+O[0].toUpperCase()+O.slice(1),z))}for(G in g)J[G]||((S=g[G]).enable=!1,S.resetProperties&&S.resetProperties())},q.getRenderTarget=function(){return B},q.blitScreen=function(p,G,v,J,$){var S=Z.getGL();if(S&&(L||H())){p&&(p.bind(S),Z.setViewport(S,0,0,p.width,p.height)),$&&!1===$.clear||S.clear(S.COLOR_BUFFER_BIT|S.DEPTH_BUFFER_BIT),(v=v||z).bind(),S.activeTexture(S.TEXTURE0+0),XZ(S,G||S._emptyTexture);var O=v.uniforms,W=(O.image=0,1);if(J)for(var l in J){var t=J[l];t instanceof WebGLTexture&&(S.activeTexture(S.TEXTURE0+W),XZ(S,t),t=W,W++),O[l]=t}if(f.upload(),X.upload(),v.attributes.pos.pointer(X),S.drawElements(S.TRIANGLES,6,S.UNSIGNED_SHORT,0),1<W)for(;0<=--W;)S.activeTexture(S.TEXTURE0+W),XZ(S,null);else XZ(S,null);p&&p.unbind(S)}},q.decodeShader=function(p){for(var G,v="",J="",$=0;$<p.length;$++)"%"===(G=p[$])?G="'":"a"===G?G='"':"]"===G&&(G="\\"),G=String.fromCharCode(G.charCodeAt(0)-1),$%2?J+=G:v=G+v;return J+v},q.createShader=function(p,G,v){var J,$="string"==typeof G?($=G.indexOf("^#"),J=q.decodeShader(G.substr(0,$)),q.decodeShader(G.substr($+2))):(J=G.vs,G.fs);return v&&((G=v(J,$))&&G.vs&&(J=G.vs),G&&G.fs&&($=G.fs)),new _n.Shader(p,J,$)},q.enableModule=function(p,G){for(var v,J=p.split(","),$=0,S=J.length;$<S;$++)v=J[$].trim(),g[v]&&(g[v].enable=G);for(v in M=!1,g)if(g[v].enable){M=!0;break}},function(){if(L)return!1;var p=Z.getGL();return!!p&&(B=new Gp.RenderTarget(Z,p,null,null,{samples:F.renderTextureSamples||1,minFilter:p.LINEAR,magFilter:p.LINEAR,depthFormat:Z.isWebGL2()?p.DEPTH_COMPONENT32F:null}),z=new _n.Shader(p,G.vs,G.fs),f=_n.Buffer.createIndexBuffer(p,new Uint16Array([0,2,1,1,2,3])),X=_n.Buffer.createVertexBuffer(p,new Float32Array([0,0,1,0,0,1,1,1])),L=!0)}),G=q.blitScreenShaderSrc={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D(image, vUv);","}"].join("\n")};q.contextLost=function(){for(var p in L=!1,g)g[p].contextLost&&g[p].contextLost()},q.render=function(p,G,v,J){if(M&&(L||H())){B.setSize(p,G,v),B.bind(p);var $=p.getParameter(p.COLOR_CLEAR_VALUE),S=($&&0===$[0]&&0===$[1]&&0===$[2]&&0===$[3]?$=null:LZ(p,[0,0,0,0]),p.clear(p.COLOR_BUFFER_BIT|p.DEPTH_BUFFER_BIT),Z.setViewport(p,0,0,G,v),!1!==(J=J||{}).renderAxis),O=!1!==J.renderEdit;J.renderAxis=J.renderEdit=!1,Z.renderScene(J),B.unbind(p);for(var W,l=0,t=Z._glCapabilities.maxAttributes;l<t;l++)p.disableVertexAttribArray(l);var z=B;for(W in g)z=g[W]._42(p,z)||z;return Z.setViewport(p,0,0,G,v),$&&LZ(p,$),(J=q.getModule("Fxaa"))&&J.enable?q.blitScreen(null,z.texture,J.getShader(p),{resolution:[1/G,1/v]}):q.blitScreen(null,z.texture),p.useProgram(Z._prg),Z._renderAxisAndEditHelper(S,O),!0}}}),ik=E.graph3d.PostProcessing.HueSaturation=function($){var S,O,W,l,t=!1,z=!1,Z=[],B=[],f=[];this.serializeProperties={hue:[0,0,0,0,0,0,0],saturation:[0,0,0,0,0,0,0],lightness:[0,0,0,0,0,0,0]},this.resetProperties=function(){var p,G=this.serializeProperties;for(p in G)this[p]=G[p]},this.resetProperties(),d.defineProperties(this,{enable:{get:function(){return t},set:function(p){!!t!=!!p&&(t=p,$.iv())}},hue:{get:function(){return Z.map(function(p){return n0(180*p)})},set:function(p){if(Z!==p&&7===p.length){for(var G=0;G<7;G++)Z[G]=p[G]/180;$.iv()}}},saturation:{get:function(){return B.map(function(p){return n0(100*p)})},set:function(p){if(B!==p&&7===p.length){for(var G=0;G<7;G++)B[G]=p[G]/100;$.iv()}}},lightness:{get:function(){return f.map(function(p){return n0(100*p)})},set:function(p){if(f!==p&&7===p.length){for(var G=0;G<7;G++)f[G]=p[G]/100;$.iv()}}}}),this.contextLost=function(){z=!1},this._42=function(p,G){if(t&&(z||(v=$.getGL())&&(l=new Gp.RenderTarget($,v),W=$._postProcessing.createShader(v,ik.hueSaturationShader),S=_n.Buffer.createIndexBuffer(v,new Uint16Array([0,2,1,1,2,3])),O=_n.Buffer.createVertexBuffer(v,new Float32Array([0,0,1,0,0,1,1,1])),z=!0))){var v=G.width,J=G.height;if(v&&J)return l.setSize(p,v,J),es(p,l.frame),$.setViewport(p,0,0,l.width,l.height),p.clear(p.COLOR_BUFFER_BIT|p.DEPTH_BUFFER_BIT),W.bind(),p.activeTexture(p.TEXTURE0+0),XZ(p,G.texture),(J=W.uniforms).image=0,J.hue=Z,J.saturation=B,J.lightness=f,S.upload(),O.upload(),W.attributes.pos.pointer(O),p.drawElements(p.TRIANGLES,6,p.UNSIGNED_SHORT,0),XZ(p,null),As(p),l}}},rk=(ik.hueSaturationShader="!!\vb~u!u\vs<j*czv/utfp!qw!f.d!31!/q2p!t-<y\v/!twpbqs)z3jdofhw!!w>f!dw3V!ww!V\vw<<*\v1\v/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!\v+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!\vq~s!f\vd<j*txj/psop!mipjdh!i-q*!mgtmip)bcuh<s\v3!mvtoij)g5pdsfnw!!t>b!nsqpmmfpsD3hEb!sjGn`bmhhf!<\v\v<!*w!b\vs*zfjhoohb!Swtftdf3o!uwiVhwj<m\v!\v-!^$1e]ftgtjfoofu!iNhBjYm`!S-B{O/HmFt!i8)\vt!t$feofugijhojfm!`SqBbOnH!F\v`-B*MfMh!o1b\vS\vo!pvjoujbgspvsunb!tg!m-p^b1u]!oipvjfu]bNsBvYu`bStB!O-HzF/^m<t\vi!)voopjjgupbssnv!ugbmtp`bqub!nt!b\vu-v*sfbhuojbpSof]vNiB!Y-`^S1B]OfHvFi^!<-\vy!/vmotjig)pfsvni!`gqmbpnb!u\v!)m4jdhfiwu!o>f!tmtt]iN!B\vY\v`~S!B\vO~H!F\v^<<l\vb\vf!sgcm!p\vb<u^!snfbuqo`vipvdf`)fgvmip]btut!fjoouWibhmjvmf!->!!gfmhpobbuS!titvffoBumimh-j!mg!m\vp<b^us!fiuvofvSpbdo`hffv*i!]|o\vp!jgumbpsbvuu!bwtb!m>v!ff!h>o!bjSooWpbjmuvbfs!v,u!b)ti!v\vf<B^msmf!u,o!vipvdf`Sfbvoih]ff*v!i0!!>3!/f1h<o\vb\vS!fjvgi!!)\vw|b!m*vffh!o=b!s1!/>1>*!!ssffuuovvspod!`wfbvmiv)f!!g,j!!2\v/|1!<*\v,!,fsmftufo!vjpgd!`)fwvbim!v<fF!H?O!B2S/`1Y*B!Ns!f=u!vssfou!owvbpmdv`ff!v.i!!2</11!<>\v!!sffmutofv!psdf`ufvvsio!!uwobjm)v!fs<p\vg!!~\v\v<!2g!m,p!bfuh!onbbsq!`>t!bfuhvosbbsu!j\vp<o1)!g>m!pfbhuo!bjso!W*b7m!v>f?-!!fghmopbbsu)!!tgbju!v\vs~b!u\vj~p!o\vB<mlmb-f!sgcm!p\vb<us!ftubouvvpsdb`ufjvpio!S>b!ofhhfo*b!s|!\v\v!|g!m*p6b/u1!!w,b!m*vsff!u>o!vjpodW`bfmvvif)!u+b!p)m2g/!1=!!,i!)t!bgujv!s\vb|u!j*p,o,Bsmfmu!o,v!ptdb`ufvvsib!u<jFpHoOSBbSo`hYfB*N<!\v=!!ssffuuvosvop!dd`mfbvniq!)<w1b!m>v!fs-f!u1o/v1p-d!`2f/v1i*!<u\vo!j~)\v!!sgpmgp!b\vu\v!<nfbhqo`bmSjthtifuooufithtj)mg!m-pfbhuo!bjSooWpbjmuvbfs-v!ugbmtp!b-uf!hmojbhSifuvoif!tutbBpmmmg-!!\vg<m1p!b>u!!fmhjohbisu!oufotjt!S\vb<oehmfp*i!t|f\vs!igum`pfbvui!!wu!b>p!mmgj!h\vi<u1o/f7t!t+B!mym/!m,t!im!j>h!iiu!oufbtptmSgb!o\vh<f*<{\vz!yj/gs!p)mwp!d=)!m1t/i13*c\vh!ss!f>u!vmstoi!!j4odWfbwm!v\vf<!*+w!V)ww!!-,f!h2b/n1j*)<E\v3!ffsmvtufy\vf!us!f>u!vsspom!pjdo!W5bdmfvwf!!\v,|!!)*w)!o+j!b)n2!/e1j!p.w!!j\vo\vW~b!m\vv<f**m*!<-\vt!!~-\vi!)g4mdpfbwu!!oisvvfu3fssh!c\v)~g!m\vp<b1u/!7g!20-!!ig!m>p!biu!!\vg~3!-\v!<g1m/p7b!u>!,i!vif!*\v!||!\v*!1j/g1!!)=i!vif)!!=g!j1!/\v1\v*~\v!!\vi<vbfu!m,f>E!d2!/01!<*\vh!!f.m!tsf)!!j,g!!1)/i5v!f>!!?i!!2\v/|1!*f\vt!mifv!f~!!.\v><!b2u/m1f<E\vd!!g0m!p*bsu!!.s!fct)<!\v,!!j1g/!3)!)>7!/i1!!\v+|!!i*vyfb*N!d=!!>2>/!1h*)\v!!gsjf!tf!t>m!fg!2~!!,\v!<)bgu3m!f.E!dg!20*!!*+c!!7./!1h!)+!!>i!vif!<\v\v|!!f*mytbfN!dj!g>!>)!)s3)/!1g!j+!!\vi\vv<f***!o=j!N2d/!1,*!\vy!bsNfdt)!!>.!!g13/<3\v)!!f0m!tbfu!mjfgE!d)!);4!/*1o!j+N!di!v,f!*y!b=N!d3)/!10*!\vb!usmfftE!d>!!@g!26!/,1!!)=g!3m!!.>!!gt2!*\v!\v+<!o)j)N3d/!1.!!0y!b4N/d1!*>!!.b!uimvffE*d!!+u!b7p/m1g<!\v\v!|f!m*tofj\vN!ds!f?t!!y>b!Ngd2)<!\vg!js!f\vu\vv<s1o/!3s!f0t!<*\vo!j~N\vd\v!!,w!fydb4N!di)t!m>3!smh!c\v)\vw<f*d*4c!!i-thm)*y!b|n\v!!-wsf)dy4b!ns!h>c!<y\vb\vN!dj!gu!b)pimtgm!/\vz<!*>*>c!!1-/h1)*o!j|n\v!!-ssh)co!j>n!!w>f!do4j)Nidt!mu/b{p*m<g\v!!\v~<!cf/mdt!f>!!|c\v!!ugbmppmbgu!!\vg<3h</\vd\v!!>j!gh!!)uibtpmm/g{!!\v=<!s1//d6!*>\v!!sg!3u!b>p!migt!m\v/<{1!/+1!!)>2!/m1!!u,b!pimtgm!/\vz<*1</\v1!!f>m!ttf!\vu!bgp3m!g>!!\vi<t1m//2{.!!,>!!iit!mu/bzp!m.g!!i\vt|m!/*zd!!+4!diftwm)/m{t<i\v3\vc!hgsm!p4bduf!wg!2\v!\v>~!!3\v/<1c!h+s!!iotsmv/u{f!s.!!\vg~3!<\v\v<\v*!*s1h/c4/0s1!/>2!)i!v.f!3ys/hmct)ig!2--3!gg!3--2!gi)tcmh/sy3!f,v!i)!2>/!1c0/4c/h1s*!*\v<<\v*!ys/hmct/ih!!->3!gi!v-f23gs)hc",E.graph3d.PostProcessing.Bloom=function(t){var z,Z,B,J,f,X,q,g,M,L,H,_,b=!1,n=!1,D=(this.serializeProperties={strength:1.5,threshold:.55,radius:.4,overrideAlpha:!0,selective:!1},this.resetProperties=function(){var p,G=this.serializeProperties;for(p in G)this[p]=G[p]},d.defineProperties(this,{enable:{get:function(){return b},set:function(p){!!b!=!!p&&(b=p,t.iv())}},strength:{get:function(){return z},set:function(p){z!==p&&(z=p,t.iv())}},threshold:{get:function(){return Z},set:function(p){Z!==p&&(Z=p,t.iv())}},radius:{get:function(){return B},set:function(p){B!==p&&(B=p,t.iv())}},overrideAlpha:{get:function(){return J},set:function(p){!!J!=!!p&&(J=p,n&&w(),t.iv())}},selective:{get:function(){return f},set:function(p){!!f!=!!p&&(f=!!p,t.iv())}}}),this.resetProperties(),[256,256]),Y=[],s=[],c=5,$=[3,5,7,9,11],h=[];function w(){var p=t.getGL();if(p)for(var G=t._postProcessing,v=0;v<c;v++)h[v]=G.createShader(p,rk._35Q,function(p,G){return{fs:G.replace(/DEFINE_VALUE/g,$[v]).replace("%OVERRIDE_ALPHA_DEFINE%",J?"#define OVERRIDE_ALPHA":"")}})}this.contextLost=function(){n=!1,g=null},this._42=function(W,p){if(b&&(n||function(){var p=t.getWidth(),G=t.getHeight();if(p&&G){var v=t.getGL();if(v){D=[p,G];var J,$=Math.round(D[0]/2),S=Math.round(D[1]/2);for(M=new Gp.RenderTarget(t,v,$,S),Y=[],s=[],J=0;J<c;J++)Y.push(new Gp.RenderTarget(t,v,$,S)),s.push(new Gp.RenderTarget(t,v,$,S)),$=Math.round($/2),S=Math.round(S/2);return p=t._postProcessing,L=p.createShader(v,rk._34Q),w(),H=p.createShader(v,rk._36Q,function(p,G){return{fs:G.replace(/NUM_MIPS/g,c)}}),_=p.createShader(v,rk.finalShader),X=_n.Buffer.createIndexBuffer(v,new Uint16Array([0,2,1,1,2,3])),q=_n.Buffer.createVertexBuffer(v,new Float32Array([0,0,1,0,0,1,1,1])),n=!0}}}())){var l,G;f&&((g=g||new Gp.RenderTarget(t,W)).setSize(W,p.width,p.height),g.bind(W),(G=W.getParameter(W.COLOR_CLEAR_VALUE))&&0===G[0]&&0===G[1]&&0===G[2]&&1===G[3]?G=null:LZ(W,[0,0,0,1]),W.clear(W.COLOR_BUFFER_BIT|W.DEPTH_BUFFER_BIT),t.setViewport(W,0,0,p.width,p.height),W._blooming=!0,t.syncRenderState(),t.renderScene({renderAxis:!1,renderGrid:!1,renderEdit:!1}),W._blooming=!1,G&&LZ(W,G),g.unbind(W)),O(L,M,{smoothWidth:.01,luminosityThreshold:Z,tDiffuse:(f?g:p).texture});for(var v=M,J=Math.round(D[0]/2),$=Math.round(D[1]/2),S=0;S<c;S++)O(h[S],Y[S],{colorTexture:v.texture,direction:[1,0],texSize:[J,$]}),O(h[S],s[S],{colorTexture:Y[S].texture,direction:[0,1],texSize:[J,$]}),J=Math.round(J/2),$=Math.round($/2),v=s[S];return O(H,Y[0],{blurTexture1:s[0].texture,blurTexture2:s[1].texture,blurTexture3:s[2].texture,blurTexture4:s[3].texture,blurTexture5:s[4].texture,bloomStrength:z,bloomRadius:B,bloomTintColor:[1,1,1]}),O(_,p,{image:Y[0].texture},function(p){r.for(p).glState.blend.apply({enabled:!0,equation:p.FUNC_ADD,func:[p.SRC_ALPHA,p.ONE]})}),r.for(W).glState.blend.apply({equation:W.FUNC_ADD,func:[W.SRC_ALPHA,W.ONE_MINUS_SRC_ALPHA,W.ONE,W.ONE_MINUS_SRC_ALPHA]}),p}function O(p,G,v,J){es(W,G.frame),t.setViewport(W,0,0,G.width,G.height),J?J(W):W.clear(W.COLOR_BUFFER_BIT|W.DEPTH_BUFFER_BIT),l!==p&&p.bind();var $,S=0;for($ in v){var O=v[$];O instanceof WebGLTexture&&(W.activeTexture(W.TEXTURE0+S),XZ(W,O),O=S,S++),p.uniforms[$]=O}for(l!==p&&(X.upload(),q.upload(),p.attributes.pos.pointer(q),l=p),W.drawElements(W.TRIANGLES,6,W.UNSIGNED_SHORT,0);S--;)W.activeTexture(W.TEXTURE0+S),XZ(W,null);As(W)}}}),ek=(rk._34Q="~b\vu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<t\vpwqb)s3zdjfowh!!>w!fwdV3w!\vw<V*w1</\v2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!\v+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~q\vs<f*d!jbtijqpmob!!i-jmhfiyqf!ug!m-psbpum<p\vDvuovjqgupvspn!!)tybjnnq!m>f!ss3pEm!puDEhjbgsgGv`tmfh<\v\v<v*o!jwg!p-sinu!egjmXpibuup!pmnvtn!j,o!petmjpuiztUfissifUtziupjmtep<o\vjvnovjmg!p-senm!pgimtpfbsui!UtznupjptupioXjjnevumi!<)\vqwfbustzijuophp!nwtf!d>3!!bwiVqwm<b\v!wupbjpem!gn\vb<j*o1)/*1!!|-\v1w/f1d!5-!1u/f1y!f-m1!/>1!)u5fdyfuwv!s>f!3sEp)m!puDEujvgqguvvtpf!-5!dwfVww\v!<**<!\vbwnfvdm4!!-m{vznyb/!m>f!ywffud!4))u!p1e/!3>:!:w-!!u1b/p6m9g8\v-<!*1!/522",rk._35Q="~b\vu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<t\vpwqb)s3zdjfowh!!>w!fwdV3w!\vw<V*w1</\v2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!\v+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~q\vsgfjdejotfj$p\vo<!*ibj/hyijqQ!fgsmvpubyuf<u\v!w-bnsvzTjuoihh!jwffxd03n!vwTVfwt<v\vgvgojjeg)p5sdnf!wt!b>n!qsmpfmsp3DEh!bdspGm`pmshU\vffytumvfs$f\v<<\v*v1o/j2g!p-snnv!Twufidh3j!fuxf0ynTvjT{fft<v\vgvgojjeg)p5sdnf!ww!f>d!3s!pemjpsDfhdbusjGp`om<h\v\v$BeIfQgMjBo`fF!ELJFSSSOFFWMP`!SgBfEeJgVjT$!\vE~F\vG<JxO!F+`!W1B/M3V!F>\v,$!enfvgTjuoifh!jTfJxH\vN<Bx!!E+F!G*J3OfFm`qWnBbMtV!F,\v!&2PfWmFqSnSbJtE)F!`>B,M!QnIvBT`fEtFvGgJgOjFe&\v\v<gcmhpsb/u*!uhfbtvgtgtPjwbvo!Q.e!gw)Vjwo!!-gfmspvbuuy!fyU-s!pjmop!dg!m)pEb3uf!stvjuhynfbu*!!>|!\v3sffmuqvnsbot!!14/d4f:w9\v:<5c!h+s!/f*yuqf)t!g.g1P/w6v!!+,!!yw!V+w!!y-0f)s!vtujyhfnUbs!p+m!ptdj!h)nEb3*f*s0vtujyhfnub!<>\v!~2\vfwmpqjneb!tn!b4jdof)w*\v!<|y\v!w+f!df3{!jjTowwoTjj!{+f!!o>p!j2u/d1f!s0j!eu!f>y!Tujf{tfg<g\vPgwmvp!b3ud!fgwT\vj<h*nbbn!h>j!Tggm!p-byu))gTeJQHoNbBj*t<t\vvgbmhp!b>u!!xx!fujbhpimugT\vv<n*!j>)!uhbbpvmtgt!j>b!oyQ!eugb)p1m/g1\v-|!!g*T!j,h,n!bj*!<<\vTwVfJdE5B!Su`fMyFuOvSsFfLQ!j=y!!j>!!<u2f!y>u!vjs!fu3oEj)!!)dsppmgp\vs<UnfvyTuuvishfj-f!xw!V+w!*c<h\vsw/fydj4Q!fesjvgugyvftuf!T>v!n",rk._36Q="~b\vu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<t\vpwqb)s3zdjfowh!!>w!fwdV3w!\vw<V*w1</\v2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!\v+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~q\vs<f*d!j*twjVpwo!!-i6jfhsivqu!ygfmUpsbvum<c\v)wEb3sfzsjvouhy!fwuf!d+3!!*w1V/w2<!\v-vsopjmgppDsuno!jtUbnnpqpmmfcs)35Ed!fcwm!v+s!U*f3y/u1v)ssfp2u<d\vbvGonjpgppmsCnq!stfbmn\vq!m,f!s*3wEV!wc!m-v5sfUsfvyuuyvfsUfs3v<m\vcv)oEj3gfpssvnu!ytfbun!q+m!f*s13/E2!!c-msvpsmUpfDyuuovjsUfn4p<p\vmvco)j5gdpfswn!!+t!b*n5q/m1f)ss3pEu!dcbmGvnspUpfmyCuqvssffm5\v<!\v,v!o*jwgVpws!n-!4tfbsnvqumyffsU3sEv!mccm)vEs3Uffsyvuuvysffu6!<+\v!v*o1j/g2p!s-ns!ptmbpnDqumofjsU3nEp!pemjcs)u5Udffywu!v+s!f*<7\v/v1o)jsgppusdnb!GgnmpppbmuC!qcsmfpmp\vn!T,u!s*fwoVhwu!i-<3\vfvsovjugypfsUns!vgmmcp)bEu3!fcsmvpupynfSub!e+j!v*t1</\v2v!o-jsgppmspnD!uwofjdU4n!pcpmmpcp)n5Udjfowu!D+p!m*p9s/<1\v)gsmppubdub!GmnfpspqmCCmqpspfnmG\vb!d,u!p*sw)Vdwp!o-t2uf!sjvou!ygfmUpsbvum!cg)bEd3ufpssv*u!y|f\vug!m+p!b*u1!/n2j!s-ssppsmGpbDduuopjsU!n>p!p2m/c3)!5.d!fgwb!d+u!p*s1</\v2s)fsupvusdob!Gnnjpyp)mgCbqdsufpms!-)!!n+j!sisuphsoGfbsduuTpnsp-p!mccm!p>p!nsSpbmepjDvhtb*s<G\v`~m\vhw\vp|j!e*!)nobj",rk.finalShader="~b\vu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<t\vpwqb)s3zdjfowh!!>w!fwdV3w!\vw<V*w1</\v2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!\v+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~q\vs<f*dwjVtwj!p-of!hibjnhji)qE!3gfmspvbuuy<f\vuv!o>j!gsppsmnp!DthbbnsqGm`fmsh3\vE|!!j*n)bohjfb<n\v!webjspzwj\vo<hw!Vwwf!d3",E.graph3d.PostProcessing.Dof=function(Z){var B,f,X,q,g,G,v,J,t,z,M,L=!1,H=!1,_=0,b=!1,n=sh.generateUUID();this.serializeProperties={aperture:.025,maxblur:1,image:null},this.resetProperties=function(){var p,G=this.serializeProperties;for(p in G)this[p]=G[p]},d.defineProperties(this,{enable:{get:function(){return L},set:function(p){!!L!=!!p&&((L=p)||(b=!1),Z.iv())}},image:{get:function(){return G},set:function(p){G!==p&&(G=p,b=!1,g&&(Z.deleteTexture(n),g=null),Z.iv())}},maxblur:{get:function(){return v},set:function(p){v!==p&&(v=p,Z.iv())}},aperture:{get:function(){return J},set:function(p){J!==p&&(J=p,Z.iv())}}}),this.resetProperties(),this.contextLost=function(){H=!1,g&&(Z.deleteTexture(n),g=null)},this.setImageFromGraphView=function(p,G,v){this.image=null,function p(G,v,J,$){M=null;var S=G.getCanvas(),O=S.width,W=S.height,l=(((J=J||1024)<O||J<W)&&(l=J/Math.max(O,W),O=Math.round(O*l),W=Math.round(W*l),t=t||xS(),S=N.resizeImage(S,O,W,t)),Z.getGL());z=z||l.createTexture(),g=tZ(l,S,z),_=v||.01,b=!0,Z.iv(),$--&&(M=M||N.callLater(function(){p(G,v,J,$)}))}(p,G,v,2)},this._42=function(p,G){if(L&&(H||(J=Z.getGL())&&(B=new Gp.RenderTarget(Z,J),f=Z._postProcessing.createShader(J,ek._38Q),X=_n.Buffer.createIndexBuffer(J,new Uint16Array([0,2,1,1,2,3])),q=_n.Buffer.createVertexBuffer(J,new Float32Array([0,0,1,0,0,1,1,1])),H=!0))){var v;if(!g){var J=T(this.image);if(!J||!J.comps&&!J.tagName)return G;E.Default.setImage(n,J),g=Z.getTexture(n)}var J=G.width,$=G.height;if(J&&$){B.setSize(p,J,$);var S=f,O=B,W={tColor:G.texture,tDepth:g,aspect:J/$,aperture:this.aperture,maxblur:this.maxblur,useG2d:b,threshold:_},G=void 0;es(p,O.frame),Z.setViewport(p,0,0,O.width,O.height),G?G(p):p.clear(p.COLOR_BUFFER_BIT|p.DEPTH_BUFFER_BIT),v!==S&&S.bind();var l,t=0;for(l in W){var z=W[l];z instanceof WebGLTexture&&(p.activeTexture(p.TEXTURE0+t),XZ(p,z),z=t,t++),S.uniforms[l]=z}for(v!==S&&(X.upload(),q.upload(),S.attributes.pos.pointer(q),v=S),p.drawElements(p.TRIANGLES,6,p.UNSIGNED_SHORT,0);t--;)p.activeTexture(p.TEXTURE0+t),XZ(p,null);return As(p),B}}}}),Ak=(ek._38Q="~b\vu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<t\vpwqb)s3zdjfowh!!>w!fwdV3w!\vw<V*w1</\v2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!\v+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~q\vs<f1d/j2t!j>p!ob!/isjphmipqD!hgbmspGb`um<h\v\vw<b1s/z2j5o!h0!!wmfpdd3!!>w!Vswp<m\vpvDohjbgspGs`nm!hc\vp<p*m!!5vstvfmEcfgqpuei!<+\v!v*o!jugdpfssns!ptdbundqfmqftsb3!E+!!u*D!p5m/p1s!<-\v1v/o1j!g)p3sdnf!wt!b)n!q,m!fzsy3/Ew!VuwE!f-qsupim<p\vDvuo!j)gEp3sfns!vcupypfmu!!v>t,f!Hm3ped<\v\v<v*o!j5gspvsmnc!ggpmep!b+u!!*u!iusdfftsisppmdeu<d\vfvqotjbg!p+s!n*!!g:m3p/b1u.!!n-b:y3c/m1v.s!<)\v3vdofjwg!p)s!n,!!gzmyp/bwuV!wb!q-fsspumvpsDfu<!\v)vEo3jfgspvsuny!fgum!p>b,u!!mopfdb\vs<D*m!j5qs<v\vmvcogjpgep!s+n!!*g!mupdbfus!sgpbdsuDdmfjqqt<b\v!v+o!j*g!p1s/n1!!g-m5p/b1u.!!g)p3ddvftw<!\v)v!o,j!gzpys/nw!Vgwm!p-bsup!mbptDquf!d)uE<3\vfdspvoutyuf!ug!m>p,b!um!pVdo\vq<b*d!l5Espvxmoctgdpbem!f+!!>*!!3u6d6f/s!s0p!d3u6d7f/q<t!b0!0+!!1*/!/:23!/.1?!!-g:s3b/d1u.j!p)o3!d)ffwy!d)m!v,e!jzoyh/!w2V*w\v!d-psoptmup!Dwuf!d)4E!3QfbsdvluGybfduu!p>s,t!!m>p!dw\vf<d*4!)5!s3v6m7c/g!p+e!!3+6!7*/!!u+d!f3s6s7p/d-u!d3f6q7t/b!!++!!3*6!75//-1!.3!6-71//!1*!<)\v3ddpfowt!u)!!w,f!dz5y!/VwoVqwb!d-lsGpbmdpuDpus!t)!E>3!fVsovqubydfluE!p>x,o!tmdpbdm\vf<!*0!!5wsfvdm5c)g!pQeb!d+l!G*b!duudpfssts-p!d2u/d!f*q<t\vbg!m+p!b*u!!:v3o/q1b.d!l-S:H3C/B1U!p)E3fdqfuwi!))!!d,p!oztyu/!wjVow!!w-fsdp5m!pwD!u*!!)|E\v3!fssfvuuvysfou!!e>p,u!)m!pwd-\v!<V*o!q5bsdvlmGcbgdpuep!s+t!!**!<u\vd~f\vsgsmppdbuud!fhqftubE!f+q!u*i!)1!/d1p!o-t5u/!1j!o)!3wdffdw3!!)t!d,s!fzfyo/QwpVtwj!u-jsppom!p*D!u|!\v)\nEs3ffusvvsuoy!fvuo!q>b,d!lmSpHdC\vB<U*p!E5fsqvumic)g!puef!y+u!v*s!fu3dEf)s!supEdfuqdufiq-t!bt!d+s!f*f!o:Q3p/t1j!u-j:p3o/!1*!!)*3<d\vf~w\v!g)m!p,b!uz!yq/fwsVtwq!f-dsupjmwpfDEuf!q)uEi3UfpsWvjufyxf[u)!!>d,p!omtpud!\vj<o*!!g8mspvbmuc!gjpoew!D+m!j*q![u-d!fdspsoptduu!djfoq!tgbm!p+b!u*!!o5f/b1s!--!1d/p1o!t)u3!djfow!!g)m!p,b!uz!yg/bwsV!w*!!-|s\vp!mspfDuuv!s)oE!3)f!sovfubysf!u+!!>g,b!sm!p*d!\v0<!*)!!8)s!vgmbcsg!p.e!!o+f!b*s!!u*d!f+s!sjpodwuDdmfjqqt[b!!.+!!g*b!s:!3*/<1\v.~!\v-g:m3p/b1u.!!h)f3udWfjwf!x)[!),!!dzpyo/twuV!wj!o-!sgpmmppbDuu!!e)fEq3ufis!v*u!y|f\vu\n!s>f,u!vmspod!\vq<f*s!t8qsfvdmucjgwpfeE!f+q!u*i!UupdWfjsfsxp[d)u!deffqqtubi!-+!!o*f!b1s/D1m!j-q5-/!1g.b!s)D3mdjfqw!!*)<!\v,~!\vzwyp/jweV!wn!b-jsop)m*p!D|u\v!w)fEd33f!sevpugycfmuv!s><,\v!wmfpdd3\v!<b*t!q8fsdvumdcpgspsef!d+u!!*>!!uwdffds3s)p!d2u/d1f-q!tbbt!q+f!d*u!!:*3</\v1j!g-!:)3v/t1f.E!f)q3udif*w!!|)\v!!,g!mzpyb/uw!Vwwj!f-xs[p!m>p!Dhuf!u)WEj3ffxs[v)u!yhffuu!E>f,q!umip)d!\vw<V*w!!8*s!v*m<c\vg!pgem!p+b!u*!!gubddfuspssp!d>u!d)f!qgtpbd!v+t!!*,!!5w/j1f.x![-!1*/<1\v!!)e3pdgfcwm!v)s!!,>!!zwyf/dw3V!w)!!-dsmpbmnpqD)u!!g)bEd3ufpssv!u+y!fbuq!f>s,u!vmspfd-\v!<.*n!b8yscvmmvcsg-p!en!b+y!c*m!vusd!f*s!s*p<d\vu~d\vffqmttbf!!+|!\v*w!f:d35/!1u.f!y-f:m3!/>1!!u)f3ydufvws!f)3!E,)!!zuyE/fwqVuwi!--!swpfmdp3D)uw!V)wE/3yf-s!v2u/y1f!u.!!>w,V!wm/pzd*\v!<**<!\v8gsmvpmbcug!pbem!q+i!b*<!\vujdgf!s)svptdfuHd3feq*t!b|!\v+b!m*q!i1b/!1>!!-t1n5p/p1u!i)t3udffqw)!!)u!i,s!fztyi/pwmVew-!!-usipsmfptDiup!m)eE!3,f!s1v/u1y2f-u!!u>f,y!fmmp/db\v!<**<!\v8~s!vfmmctgfp!e|!!+b!m*q!iubd!f>s!supfdyufdmf/qbt<b!!~+\v!!*e!p:g3c/m1v!s-!:>3!/w1f!d)33!d)f!wd!m)b!n,q!)z!yb/mwqViwb!!-+s!pbmqpfDsuu!v)sEf3-f!s.vnubyyfcum!v>s,-!!mnpbdy\vc<m*v!s:!s*v!m*c<g\vp~e\v!w+f!d*3!!uedpfgscsmpvdsu:d!f>q!tebp!g+c!m*v!s8!4+/!11./!:-<6\v2w/f1d!3)!3edpfgwc!m)v!s,8!!z>y!/ewpVgwc!m-vssp!m+p!D1u/!8)<E\v3wffsdv3u!yefpug!c>m,v!sm5p!d>\v!<e*p!g:csmvvmsc!g+p!e1!/+5!<*\v!wufddf5s!sdppdmu!d>f!qwtfbd!5+)!!*1!/612!/*1<.\v!d-p8m4!/,1>.!!u)f3ydufvws!f)3!E,)!!zuyD/pwmVpws!--!swpVmwp/Dyuz!!)*E<3\vfdspvmu!y,f>u!!u>f,y!umvpsdf\v3<E*)!!:usDvpmmcpgsp-e!!w+V!w*/!yuzd!f,s!s)p!dwufddf3q)t!b1!/+1!-*!!16/25/!1*!!-+8!4b/t1q!f)d3uddfpws!s)f!d,u!!z*y!/+w!Vewp!g-csmpvmsp!D*u<!\v)dEp3mf!s,v>u!yuffuy!u>v,s!fm3pEd)\v!<u*D!p:mspvsm-c!gwpVew!/+y!z*!!,u!d)f!swsfpdd3u)d!f1q/t2b6!-+!!1*/!4884!/*1!!+-!6b2t/q1f.d!u)d3pdsfswf!d)u!!,*!!z+y!/ewpVgwc!m-vssp!m*p<D\vud!p)mE!3,f>s!vuufyyfuuv!s>f,3!Em)p!du\vD<p*m!p:ss-v!mwcVgwp/ey!z+!!,*!!)u!dwffsds3p)d!u1d/f3q:t-b!!1+/!3*:!!8*4!/+1!.b!t-q6f2d/u1d.p!s)s3fddfuw!!*)!!+,!!ezpyg/cwmVvws!!-*s<p\vmdppDmu!!,)>E!3uffsyvuuvysffu3!E>),!!umDppdm\vp<s*-!!:wsVvwm/cygzp!e,!!+)!!*w!fudd3f)s!s.p1d/u4d8f-q!t1b/!2+6!!**!!6+2!/b1t.q!f-d8u4d/p1s!s)f3dduf!w*!!)+!!,e!pzgyc/mwvVsw!!*-<s\vpdmppmD!u,!>)!Eu3ffysuvvusyff3uE!)>!,u!Dmppmdp\vs<-*!!w:Vswv/myczg!p,e!!)+!!w*f!du3d)f!s1s/p5d1u-d!f1q/t1b!!*+!!+*!!b6t2q/f1d!u-d8p4s/s1f.d!u)!3*d!f+w!!e)p!g,c!mzvys/!w*V<w\v!d-psmp!m,p>D!uu!f)yEu3vfssfv3uEy)f!uu!D>p,m!pmsp-d!\vw<V*w!/:yszv!m,c!g)p!ew!f+d!3*)!!u1d/f4s8s-p!d.u1d/f2q6t!b*!!++!!*b!t8q4f/d1u!d-p6s2s/f1d!u)!3*d!f+w!!e)p!g,c!mzvys/!w*V<w\v!d-psmp!m,p>D!uu!f)yEu3vfssfv3uEy)f!uu!D>p,m!pmsp-d!\vw<V*w!/syvzm!c,g!p)e!!w+f!d*3!)u!d1f/s3s:p-d!u.d1f/q3t:b!!*+!!+*!!b8t4q/f1d.u!d-p6s2s/f1d!u)!3*d!f+w!!e)p!g,c!mzvys/!w*V<w\v!d-psmp!m,p>D!uu!f)yEu3vfssfv3uEy)f!uu!D>p,m!pmsp-d!\vw<V*w!/syvzm!c,g!p)e!!w+f!d*3!)u!d.f1s/s2p6d-u!d.f1q/t4b8!!+*!!*+!!:b3t/q1f.d!u-d:p3s/s1f.d!u)!3*d!f+w!!e)p!g,c!mzvys/!w*V<w\v!d-psmp!m,p>D!uu!f)yEu3vfssfv3uEy)f!uu!D>p,m!pmsp-d!\vw<V*w!/syvzm!c,g!p)e!!w+f!d*3!)u!d1f/s1s-p!d.u1d/f5q!t*b!!++!!b*t!q6f2d/u1d.p!s-s8f4d/u1!.*!!)+3!defpwg!c)m!v,s!!z*y</\vwdVpwm!!-,s>p!mupfDyuu!v)sEf33fEs)v!uuyDfpum!p>s,-!!mwpVdw\v/<y*z!!s,v!m)c!gwpfed!3+)!!*.!1u/d2f6s-s!p1d/u4d8f!q*t!b+!!+b!t*q!f1d/u1d!p-s5s/f1d.u!!)*3!d+f!we!p)g!c,m!vzsy!/*w<V\vwd!p-ms!p,m>p!Duuf!y)uEv3sffs3vEu)y!fuuD!p>m,p!sm-p!dw\vV<w*/!yszv!m,c!g)p!ew!f+d!3*)!!u.d1f/s3s:p-d!u1d/f3q:t!b*!!++!!*b!t6q2f/d1u!d-p8s4s/f1d!u)!3*d!f+w!!e)p!g,c!mzvys/!w*V<w\v!d-psmp!m,p>D!uu!f)yEu3vfs",E.graph3d.PostProcessing.Blur=function(q){var g,M,L,H,_,b,n,D,$,S=this,O=!1,Y=!1,G=(this.serializeProperties={value:0,downSample:!1,iterations:1,layer:"main"},this.resetProperties=function(){var p,G=this.serializeProperties;for(p in G)this[p]=G[p]},d.defineProperties(S,{enable:{get:function(){return O},set:function(p){!!O!=!!p&&((O=p)?q.addRenderLayerListener(G,this):q.removeRenderLayerListener(G,this),q.iv())}},downSample:{get:function(){return n},set:function(p){n!==p&&(n=p,q.iv)}},value:{get:function(){return b},set:function(p){b!==p&&(b=p,q.iv())}},iterations:{get:function(){return D},set:function(p){D!==p&&(D=p,q.iv())}},layer:{get:function(){return $},set:function(p){$!==p&&($=p,q.iv())}}}),this.resetProperties(),function(p){if(O&&p.layer===$&&"post"===p.phase){var G=q.getGL();if(!q._picking&&!q.isReflecting(G)){(p=q._postProcessing.getRenderTarget()).unbind(G);for(var v=0,J=q._glCapabilities.maxAttributes;v<J;v++)G.disableVertexAttribArray(v);S.drawImpl(G,p),p.bind(G),G.useProgram(q._prg)}}});S._42=function(){},S.contextLost=function(){Y=!1,H=null},S.drawImpl=function(p,G,v,J,$){if(Y||(t=q.getGL())&&(L=new Gp.RenderTarget(q,t),g=q._postProcessing.createShader(t,Ak.hBlurShader),M=q._postProcessing.createShader(t,Ak.vBlurShader),Y=!0)){var S,O=G?(S=G.width,G.height):(S=q._viewport[2],q._viewport[3]);if(S&&O){for(var W,l=q._postProcessing,t=("boolean"!=typeof J&&(J=n),v==v0&&(v=b),$==v0&&($=D),$=Math.max(1,Math.round($)),r.for(p).glState.depth),z=t.enabled,Z=(t.enabled=!1,J?(v/=2,W=[S,O],S/=2,O/=2,H||(H=new Gp.RenderTarget(q,p),_=l.createShader(p,Ak.downSampleShader)),H.setSize(p,S,O),l.blitScreen(H,G.texture,_,{texelSize:[1/W[0],1/W[1]]}),G.setSize(p,S,O)):H&&H.setSize(0,0),L.setSize(p,S,O),[]),B=0;B<$;B++)Z.push(v),v=Math.max(1,Math.floor(v/2));for(B=0;B<$;B++){var f=Z[$-B-1],X=(J&&0===B?H:G).texture;l.blitScreen(L,X,g,{value:f/S}),J&&B===$-1&&G.setSize(p,W[0],W[1]),l.blitScreen(G,L.texture,M,{value:f/O})}return t.enabled=z,G}}}}),kk=(Ak.hBlurShader="!!\vb~u!u\vs<j*czv/utfp!qw!f.d!31!/q2p!t-<y\v/!twpbqs)z3jdofhw!!w>f!dw3V!ww!V\vw<<*\v1\v/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!\v+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!\vq~s!f\vd<jntvjtp!o>!!isjphmipqD!hgbmspGb`um<h\v!!\vv\vo<j2g6p1s/n1!!t+b!n*q!m*f!sz3/Ew!Vjwn!b-hffv<m\vb!ww!b+s!z1j/o5h!!,w!fyd/3w!VwwV!w)<3\vd!fvwo!j-gfphsbnn!jg!m)pEb3uf!swvbumyvffu<!\v>\v,!!wnpvjte!!\vn<b9j2o:)1*/!1|!\v+!!w*f!d*5!!zt/vwnV!w>!!-wffvdm5b)w!!1+/!11!/*4<!\v,\v!!yt/vwnV!w,!>)!3udffywu!v-sffh3bEn)j!!j)nEb3hffs-v!uwyffdu3!)>!,w!Vnwv/ty!!\v.<!655/313!2+/!1w!b+m!v*f!-*!!wzV/ww/Vzw!!*-!f*v!m+b!w1!/+1!612/<3\v!!,t!vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv!t.!!\v4</214!6+2!/w1b!m+v!f*-!!*w!Vzw//wzV!w*!!-*f!v+m!b1w/!1+:!219/<2\v!!,t!vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv!t.!!\v3</414!7+2!/w1b!m+v!f*-!!*w!Vzw//wzV!w*!!-*y!/+w!V1w/!2)333d5f6w<!\v-!fthvbnn!j,!>)!Eu3ffysuvvusyff3uE!)>!,j!nnbvhtf!-\v!<w2f4d632)/!1w!V+w!/*y!!*.!!z2//w1V!w+!!-wfbvm",Ak.vBlurShader="!!\vb~u!u\vs<j*czv/utfp!qw!f.d!31!/q2p!t-<y\v/!twpbqs)z3jdofhw!!w>f!dw3V!ww!V\vw<<*\v1\v/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!\v+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!\vq~s!f\vd<jntvjtp!o>!!isjphmipqD!hgbmspGb`um<h\v!!\vv\vo<j2g6p1s/n1!!t+b!n*q!m*f!sf3vEm!bjwn!b+h!f1</\v5!!w,b!szz/jwoVhw!!w-fyd/3w!VwwV!w)<3\vd!fvwo!j-gfphsbnn!jg!m)pEb3uf!swvbumyvffu<!\v>\v,!!wnpvjte!!\vn<b9j2o:)1*/!1|!\v+!!w*f!d*5!!ftvvmnb!w>!!+w!f1d/54)!!,1!/z1/!w*V<w\v!\v-!yt/vwnV!w,!>)!3udffywu!v-sffh3bEn)j!!j)nEb3hffs-v!uwyffdu3!)>!,w!Vnwv/ty!-\v!<w6V5w3/3z2!/.1!!5+/!1*!!+*!!wfbvmmvbfw!!*+!!*1!/+3!!1,/!1z6/2w<V\vw!!t-vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv-t!!w\vV<w2/4z6!2./!14!/+1!!*+!!*w!bfmvvmfb!w*!!+*!!1+/!21!/,1!:z2/9w<V\vw!!t-vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv-t!!w\vV<w4/4z7!2./!13!/+1!!*+!!*w!bzm/vwfV!w*!!-*y!/+w!V1w/!2)333d5f6w<!\v-!fthvbnn!j,!>)!Eu3ffysuvvusyff3uE!)>!,j!nnbvhtf!-\v!<w2f4d632)/!1w!V+w!/*y!-*!!wfVvwm/bzw!!.+!!21/",Ak.downSampleShader="!!\vb~u!u\vs<j*czv/utfp!qw!f.d!31!/q2p!t-<y\v/!twpbqs)z3jdofhw!!w>f!dw3V!ww!V\vw<<*\v1\v/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!\v+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!\vq~s!f\vd<j1t/j5p!o0!!i*j*h*i1q/!2g!m-p1b/u1<)\v3!dvfowj!g+p!sfn{!jtTbmnfqymffus!3,E!!wjVnwb!h-ff<h\vb!nwjb)sEz3jfoshv!uwyffdu3!!\vw,V!w*<*\v1!/v2o.j!g-p1s/n1!)w3fddf3w!!u+f!yff{mjTTjm{ffy<f\vu\v!!,w!pwjVew!!n-bfjhob)n*j\v)!E|3\vf!shvmu`yGfsub!h\vD,p!m*p*s1!/>1!!)-u1f/y2u.v)s3fd3fEw)!j+n!bfh{fj-T!mwfVywf!u,!!,u!fwyVfwm!T-jf{hfb!n+j!)wEf3df3s)v2u/y1f-u!!1\v/,1!**",E.graph3d.PostProcessing.Glitch=function(W){var l,t,v,z,Z,B,f,X,J,q,g=!1,M=!1,L=sh.randomFloat,H=sh.randomInt,$=0;function _(){if(q&&J){z=Date.now(),v=1e3*L(J[Z=0],J[1]),B=[];for(var p=1,G=q.length;p<G;p+=2)B.push((1<p?B[B.length-1]:0)+v*q[p]/$)}}function b(){W.redraw()}this.serializeProperties={onlyReflector:!1,period:[2,3],intensity:[3,.3,1,.1,0,.4]},this.resetProperties=function(){var p,G=this.serializeProperties;for(p in G)this[p]=G[p]},d.defineProperties(this,{enable:{get:function(){return g},set:function(p){!!g!=!!p&&((g=p)&&_(),W.iv())}},onlyReflector:{get:function(){return X},set:function(p){!!X!=!!p&&(X=p,W.iv())}},period:{get:function(){return J},set:function(p){J=p,_(),W.iv()}},intensity:{get:function(){return q},set:function(p){$=0;for(var G=1,v=(q=p=p||[1,1]).length;G<v;G+=2)$+=p[G];_(),W.iv()}}}),this.resetProperties(),this.contextLost=function(){M=!1},this._42=function(p,G){if(g&&(M||function(){var p=W.getGL();if(p){l=new Gp.RenderTarget(W,p),t=W._postProcessing.createShader(p,kk.Shader);for(var G=kE(64,64),v=G.getImageData(0,0,64,64),J=v.data,$=0;$<4096;$++)J[3*$+0]=H(256),J[3*$+1]=H(256),J[3*$+2]=H(256),J[3*$+3]=H(256);return G.putImageData(v,0,0),f=tZ(p,AE),M=!0}}())&&(S=!!W.isReflecting(p))==!!X){var v,J,$,S=G.width,O=G.height;if(S&&O)return v=W._postProcessing,$=(J=r.for(p).glState.depth).enabled,J.enabled=!1,l.setSize(p,S,O),Date.now()-z>B[Z]&&++Z>=B.length&&_(),p=q[2*Z],S={seed:Math.random(),byp:p?0:1,tDisp:f},p&&(S.angle=L(-Math.PI,Math.PI),S.distortion_x=L(0,1),S.distortion_y=L(0,1),S.amount=Math.random()/30*p,S.seed_x=L(-1,1)*p,S.seed_y=L(-1,1)*p),v.blitScreen(l,G.texture,t,S),J.enabled=$,requestAnimationFrame(b),l}}}),Ik=(kk.Shader="!!\vb~u!u\vs<j*czv/utfp!qw!f.d!31!/q2p!t-<y\v/!twpbqs)z3jdofhw!!w>f!dw3V!ww!V\vw<<*\v1\v/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!\v+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!\vq~s!f\vd~j!t\vj<p*ow!Viwj!h-ifqh!bgnmjp)b!uE<3\vf!svvoujygfpus>ns!pjmopuD!hcbzsqG<`\vm!hv!o\vj|g!pfstnm!ft!b\vn~q!m\vf<sx3pEo!tj!n,bshpfm<p\vD!hvbosjGg`pmshn!!>t!bsnpqmmpfDsh3bEs!Gu`Emjht!q\v<<\v*\v3!/v1o+j*g*p/s1n6!+gemfpfbtu!!+b!ntpzv-oeuf<f\vt!!v+o!jtgyp)s3nd!fgwm)peboub!sb)o5hdmffw<+\vu!ovvopjngbp+s/n1!1g3m!p>b!ux!ptoftf!e5<d\vf!wv!o\vjfgtpjspno!!gemepbb0u0!!t\vf<f*eb`/yb<h\vd!!v-ocj/gcpds!n-!hg/mbphbdu!!-tsf/fsed`)z5<d\vf!wv!o>j!gsppsmnp!DghmbpsbGu`!mehj!t\vu<p*suufjtpgog`py!<.\v!!qv!o-jfghpbsnnj!)gEm3pfbsuv!ueyjftuu!p>s!ucjdp!o5`dzf<w\v!!\vv<o*jqg!p-sfnh!bgnmjp)bEu3!fdspvmu`ytf<u\v!\v>!!wbbhsdz!j5odhf!ww!f\vd<3*!uwfVtwg<g\vp\v!!,d!pqo!t-uf!hgbmnpjb)uE!3VfosqvbudylfEup!x>o!tsddb!m5fd!f>w!!3\v6<6*/*!f0m!h3o6b7)/o<j\vt!!d-p*oftmuh!owbf)dt4p!dQ)b3ddlfGwb!d+u!pusotv!p>n!bw!f>d!4u)f!t3g6g7p/!!3+d!f3w6!7\v/s!f+e!b3i6t7!/u-g!j3i6t7!/C!H+S!!3n6p7s/g-!!f3t6b7c/0!0*!<\v\v<!*d/p6o0teuf!fwtf)d+5z!`Veofqfbtd+lmGbbndsuppos>t,!z>/!qV!o\vq<b*d/l6E0pexfofttd)b+myf`!e0f!fwtf+dm5b)n!sQpbod>l,Gyb/dqu!p\vs~t!-\v!~2!/\v!<**<y\v`!ogpmjpubsup!uvtojqeb!d,l!SyH/CqB)U!p.E!f/q2u!i>)!!yd/pqo!t\vu|!!jfot!mwff!d\v5~!!w\v!<*y!`|o\vp!jsufsupvustoj!ee>pyu/)q!!w\v-|!*V/o1q?bzd`leGfbfdtu)pgsjt!!\v*|<!\v*!e~f\vf\vt!+gtm`pmbpud!.szb`ooep)jwufsdp3u!tdjpe*?|y\v/!qs!f%u%v!sto`!mgpsdb,dzu`)otpjjou)seppuut)jdep=/yy/zq!)-gwjf!d\v3~)!2\v3~/!:\v9<:z9`-o8p9j/u3s4p4u*t*j*e!!+>!!5z4/8q6!9\v/|6!5f6t4m*f<!\v\v!~~!\v\v\v<!*wzp`joep!jnubsjpou)t*j!e|!\v,!!jzg/)qc)z!q.=!2/*2!!|>\v!!zw/fqd!3\v!|q*!/>1!?wyV`we<f\vf!tg)mgpjb!u\v!|y!t*!e>f!fgtm+ptp`sm)phdm.`yG`sobphjDupsppsuet/jye!?0z!/1q/!6%*%<!\vt!`gmmppdb,uy!`zotp!j>u!sgpmuptpjse)=hzm/`qG)sgbjh!D\vp<p*s*ee/fzf!t0+!e1f/f6t*+<q\v!!-gqmtpjbEuu!)o!pEs3nfbsmv!u>y!fvuo)qibudqlfSEHpCUB",E.graph3d.PostProcessing.Fxaa=function(v){var J,G=!1;d.defineProperties(this,{enable:{get:function(){return G},set:function(p){!!G!=!!p&&(G=p,v.iv())}}}),this.contextLost=function(){J=null},this.getShader=function(p){if(J)return J;var G=v.getPostProcessingModule();return J=G.createShader(p,{vs:G.blitScreenShaderSrc.vs,fs:G.decodeShader(Ik.ShaderSourceFs)})},this._42=function(){}}),Ek=(Ik.ShaderSourceFs="~\v!!\vq<sbf/d*jwtVjwp!o-!fihjbhnijq)!Eg3mfpsbvuu<y\vf!uv>obj/gsppsmnp!DthbbnsqGm`fmsh3!E\v!<j*n!b\vh*f1</\v1!)v5odjfgwp!s\vn-!1w/f1d!3\v!-s1f/t1p!m\vv-u1j/p1o!<\v\v-!4w4b9s1z/j1o!h\v!-w7f7d23/!1w!V\vw-<6\v8\v/!1$!e\vf-g*j1o/f1!)G5YdBfBw`!R\vV-B*M1J/U1Z)`5Qd1f!w2!/\v1-\v*!1$/e1f)g5jdoffw!!G\vY-BoBp`jRuVvBmMpJtUfZs`!Q\v2-!f2h/b6n\vj!!$\ve-ffghjbonfj!!G\vY-BfBh`bRnVjB!M\vJ-U*Z1`/Q13)!53d/f1w\v!!\v$-ewfVgwj!o\vf)!sGfYeBbBi`TRmVfByMjJQUbZb`yQG4>!s5p/m1p\vD!h$besfGg`jmohf!!\vG|Y!B*B)`oRjVbBnM!JeUjZp`wQ!5\v!~2!3\v/<1*\vN!b$nevfmg!j-o{fz!yG/y*bNbtCppqp!m-!ycfpup)mq\vp\vU!y$feUfbgbjyoGf)!5GuybbpbmGGmbpbbyuG!!gomspvbuuf\vs!!$\ve<foghjjoTfi!uGhyobfbmG!m+p!byuj3q!cwvfTdu3f\vt!g$gePfmgfjyojfq!>G,yzb/bNGtmppqb!u*4o!bwqfTd{4s\vp!i$!e)fggjj!o\vf<!oGhyjbTbiGumhpobfum5!!+w!fydj5q\vc\vv!T$uefftggjgoPfm!fGyyjbqb>T,byu/)Nyt*p!qd!m*bonbqq)Ty{-s!p1i/a1)-g!j2!/\v1<**\vI!y$jeqfcgvjto!f-!eGpypbHbuUfftyg!gtPbmnfqymjfqs)3yEb\vn!>$yejfqgcjvoTfu!fGtygbgbPUmffyyUjpqq!)uub-p!mqG*b!buyfGy!u\vv<s1f/31E!);u!-u!fqt-g!g1P/m1f*y\vj!q$!e@f!gojboqfT!eGpypbhb>UefpypPHgugf)tug-g!Pqm-f!ypj-q!!su*b!pumfGybubvysGf!3\vE<)yuj-q!cqv,T)zpu!j+m!bsv*R-b!b1y/g1!*+\v!!HGyyjbqbcGvmtp>bIuy!jGqycbvbtM!vunbbp)mGGybbbbyGGm!p\vb<u65/!1s,h*c*bq*d!S|i!ushfoufvMsoob!qsth.c)b!/+z!<u!t~e\v)!>GuyfbtbgGgmPpmbfuy5j!qG!yubbbpQmjGybfbmyTGi!b\ve<fGsy)j\vq!cGvytb!b+G!mGpybjuq3c!vqtp>tH-y\vj!qGcyvbtb!GumbppbmuG5b!bgyyGb!b\vD<pQootbpqmTfeQpppthQ!p;t!-O\vo!bGqyTbebpUpfhy!!@u!fOyo-p\vj!uGdyfbsbjUef>yo!bgqyTbebpDppho!tmppmpfC4b7b1yUGf!y\vF<y*qQCujtbet!O-fOhuPtoef)-o\vj!nG>yubtbeU!fuyb!pgmyGbbbbDypGo!t\vp<mQfu4t7e1!U=f!yOFuytqeC>jObotpOjfuhdUfxspj-e\v!!mGpypbCbbGbmypGb!u\v3<!iguyhbobfRMvobbmqjtu0z1S/d2q>GqsdbSnifu-h\vo!fGMyobbbqGtm!pubbup5m!GgbybbybGD!p\vo<tppsmff[SUdMqNGbsnbvnmf!P>qau!-*\v1!/G1y!b=b!GQmepobFub5n!vgmy)b>bQDopboqtTpempfpShd!qmGpspbCnbfbPyqGu!3\v-<\v*!OGuytbeb,GQmuptbeu)5>!iguyhbobfDMpoobtqptm!fu4b7p1mSGdbqbGysGb!n\vf<Ppqsuf3[-U\vM!NGbynbvbmG!m>pab!u*!1g/y1b!b=R!vObemojFubznTvvmc)q>jOyo-b\vq!TGeypbpbhG!mmppbpuC!bgbyybGb!R\vv<bzm/jNutzpFqe.hzf/UQitspfqt>iQpumtee-!\v*!oGbyqbTb{Gsmppibau)!ggjy!b\vb<Rzv/bOmtjpuqz.Fze/hNftUpiqs>fOtuitpem!e*Nojboq-T\v{!sGpyibab)Ggmjp!b\vu<!yg/yNbtbpDqp.oyt/pQmtfpFqe>hQfuTtieb!suqbopfmtGtb-b\vy!GG!y\vb<byG/mOptbpuq!.gyy/bNbtDppqo>tOpumtfeF!euhbfpUmiGsbfbtyiGp!m\ve~-!\v\v!~G!y\vb~b!G\vm<p5bQu`!ZgUyJbMbBDVpRo`tBpBmYfGF!e+h!fzU/iQsOfgtgipp>m,ezN/jQot-p\vq!!G*yQbfboGpmepab)ug5j!!g\vy<b5bQD`pZoUtJpMmBfV4R7`1BDBpYoGt!u+E!jys/\vQ!O*g!g|p\v>!,Gyy/bQbtGpmqp!b*uQ3f!oqppetaN)<g\vj!!q\vp<t*NQ/fyo>pqepat)/!y}<}\v!!*qOpftoNp/eza>)q>pQtO/fzo<p\ve!!G\vy<b5bQG`mZpUbJuM5B!VsRh`cBzBNY>GG!y+b!bzU/fQyOUgpgqp)>u.fzy/-O!tqppqt!N**O<f\vo!p$eeaf)ggjjo!f\v!<m5vQn`bZNU!JsMhBcVzRN`/BzB\vY!GG!y+b!byG/mQpObgug!pm>v.nyb/TO>tGpyqb!b*MOvfnobp)eGay)bgbjU!f\vy<Pegfgm)budfTyu-o!fqjpetbNs-h!!G>y?b!b*GQmepobFub3n)v!m1)/t1c-b!>2Q/f1o*p-e!!g\vy<bebfRmvbbdmTjuuozfSjdeqbGsshb!n>f?/!y*zO*e*o<F\vb!nGvymb)btGcmbp>bOuf!ompven!b\vF<>6G/y1b!b+M!vOnObb)nGvymb.bQUefoyFPbgngv)mu>fQye-o!FqbpntvNm-!!*GQyfbobpGemap)bguj3!)\v!<26//11-!!+1!/O1O*b-n!vgmy.bObeRovFbbmnjvumz>SOdeqoGFsbbnnvfm/!y*zO*f*o<p\ve!aG)ygbjb!G\vm<p*b*uz!ym/vQntbpOq>!G-yybfbuM)vqnpbU)yGfyUbbbbUyfGy)Pbgngv)Mubfbyy-G!>qQpetoNF-b!nGvymb!b*GQmfpobpue3a))!g1j/!1\v-<.*2*/z1y*/-O!tgpyqb!b-Ryvfbum)jqupzUSydfqUGbsbbynGf)/bynzv*M*b<b\vy!GG>yObeboGFmbpnbvum!!m*vOnfboXp>eGay)bgbjM!v\vn|b!)*GQyObfboUpfey)Pggjg!)\vu<f4yQ-`!ZqUpJtMNB-V!RG`yBbBbYGGm!p+b!uz3/)Q.O2g/g1p->!,1z//1Q*t-p!qg!y*bQbfRovpbemaj)ugzjS!d\vq<G4sQb`nZfU/JyMzB*V*R<`\vB!BGYyGb!b+G!myp/bQuO!gngbpy>T,Ny>/nQbtyp)qm!v*nQbfTo-p!emav)ngbjN!*\v<<\v*!QGfyobpbeGam)p!b}u}!!n*jOofToNp>enaj)o>)QmOvfnobpTe-!!\vm<v4nQb`NZ*U<J\vM!BGVyRb`bBGBmYpGb!u+!!nzb/yQFOTgNg>pn>b.yz)/mOvtnpbqF!-*!OnfboypTeNa*)<g\vj!!G\vy<b4bQG`mZpUbJuM!BnVjRo`FBTBNY>Gn!j+o!)ym/vQnObgFg-p!>n.jyo/TONt*p<q\v!!*GOyfbobpGemap)bguj!!n\vb<yeXfOm>bndbTyu)omfvjnebbOs-h!!m>v?n!b*XQ*e<o\vF!bGnyvbmb)Gtmcpbb>uQ!fnojpoeX!O\v><nejfom)bmdvTnuboOf-j!embvsnhb!X>*?<!\v*!OGeyobFbbGnmvpmb)ut!csbb>oOhffoNpbey!>\vn<b6y/)1n!b+y!XOOO-b!nnvbmy.FQTeNo*F<b\vn!vGmy>bQbeGomFpbbnuv!ms!b*oQhffoNpjeoa>)ngjjo!)\vn<j6o/X1O!-+!!nOjOobFnTvNm*.<O\ve!oGFybbnbvGmm>pObeuo!Fsbbnovhmf!N*bOyfTodpbemaf)eg>js!b\vo<h*f*Nzbyy/!Q+t!pgqy!b-byRfvub)mqjpuUzyFfeUhbfbUyiGs)fbtnivpMmbeb<y\vG!>GQyebobFGbmnpvbmu!!*sQbfoohpfe>as)bgojh!f\vN<b*y*.zsyb/oOhtfpNqj!o-<y\vf!uG)yqbpbUGymfpUbbub!ysGb)obhnfvNMbbybDymGb>nOqefoeF>bnnbvym)!g*yObfboRpvebam)jgujz!F\ve|h!f*UQiOsffotpiep)mgejN!j\vo<-3!Qs`bZoUhJfMNBbVyRT`dBbBmYfGe!*+<!\vz!/GQyObgbgCpp>p,mz!/fQbtspmqz!F*yQjfuo>psebao)hgfj!!=\v!<s3bQo`hZfUNJbMyBDVmRb`nBqBfYeG<!\v+!!jyg/)QfObgsgmpz>F,yyj/uQ*t\vp!qs!f*uQvfsoop!esah)cgzjN!<\v\v<!*GQyfbobpGemap)b!u}!}m!v*nObfOoXp>eGay)b>bQMOvfnobp)eG!y\vb<b3UQf`yZPUgJgM)BuVfRy`-B!BqYpGt!N+-!!zG/yQbObgGgmpp>b.uz3/)O.t2p/q1!-*.O2f/o1p*e-a!)ggyjb!b\vR<v3bQm`jZuUzJSMdBqVGRs`bBnBfY/Gy!z+*!*y</\vQ!OGgygbpb>G.myp/bOut!pmqv!n*bOTfFo>pGeyab)bgMjv!n\vb<)eGfymbbbdUTfuyoPfgjge)busfhy!->!?q!p*tQNe-o!FGbynbvbmG)mtpcbbu>3Q)f!o2p/e1!-\v!<2e/f1m*b-d!TguyobfbjRevbbsmhj!u>z?S!d*qOGesobFnbfn/vymz)*t*c<b\v>!OGfyobpbeG!m\vp<b6u/!1m!v+n!bOOOFb>nGvymb.bQMevonFbb)nGvymb>bQUefoyFPbgngv)mu!f*yQ-f!oqppetaN)-g!jG!y\vb<b6G/m1p!b+u!3O)O!b2n/v1m-..O2e/o1F*b-n!vgmy>bObeRovFbbmnjvumz!S*dOqfGospbenaf)/gyjz!*\v*<<*\v*!zGyy/bQbtGpmqp!b-uy!fmuv)nqbpTUXy>fGUybbbbyMGv)nbbn)vGMybbbbyUGf>yQPegogF)bunfvym-!!*qQpftoNp-e!aG)ygbjb!G\vm<p*b*uz3y)/.O2t/p1q-!!-2y/f1u*)-q!pgUyybfbURbvbbymGj)ubznSvdMqbGbsybGn>fO/eyozF*b*n<v\vm!!G*yObfboGpmepab)ug!jm!v\vn|b!O*TQ>OmfvonpbeO),gmjv!n\vb<T2<Q\v`!ZGUyJbMbBGVmRp`bBuB!YmGv!n+b!XzF/>QmOvgngbpX>,,mzv/nQbtFp<q\v!!*GQyfbobpGemap)bguj!!t\vv<c2qQj`yZSUdJqMSBbVoRh`fB>B2Y/G1!0+s!byo/hQfO<g\vg!pG>y,byb/GQmtppbqu!!*tQvfcoqpjeyaO)TgXjF!>\vm<v*nQbfOoTp,emav)n!b}X}F!<*\vO!fGoypbebaG)m>pQbOuf!ofpeeh!fmIpppsC{b2b>y)G.!3\v/<12!Q+`!ZmUvJnMbBNV*R,`mBvBnYbGO!T+<!\vz!/GQyObgbgGpm>p.bzu/!Oftephqf!W*fOsfuo2p>e)a.)3g/j1!!\v+<!2mQv`nZbUNJ*M,BmVvRn`bBXBFY<G\v!!+G!yyb/bQGOmgpgbpu>!.myv/nObtOpFqT!F*>OmfvonpbeOaF),gmjv!n\vb<TeFf<m\vb!dGTyubobfGjmepbbsuh!!m>v?n!b*OQXeOoFF>bmnvvnmb)OtXc,bm>vQnfboOpFe<!\vm!pGpyCbbbbGymGp!b\vu<!effemhbfdITpuso{f3j>e)b.s3h/!1>!?+!!*mOvenobFFb*n,vmmv)ntbcObF>TOFf<o\vp!eG!ymbpbpGCmbpbbyuG!!f\ve<h6f/W1f!s+u!3O>O)b.n3v/m1>!.+Q!emovFnbbnOv*m,!m\vv<n6b/O1X!O+F!<O\vO!bGnyvbmb>G.mOpebouF!bmnvvnmb!O\vX<T1X/>1m!v=n!bNONXb,nmvvmn>bpTsXf<[\vU!MGNybbnbvGmm!pmbpup!CmbvbnybGT!X\vT<FF>ymjvqncbvTtX!,+m!vEnybjTqFc<v\vt!>GGyybjbqGcmvptb!uu!bfpemhGfbIbpysG{!5\v><)6b/c1t!)+f!eOhOfbInpvsm{.2N*b!n+v!m3>/N1N*b,nbvcmt!)ufbephmfGIbpbsy{G3!*\v<<\v1!/G5y0b1b/G2m!p+b!uu!offejhefbWsfhs>ue5f>m)bbdcTtu)offejhefbWsfhs!uu2b*p!m+G!b3b/y1G*!,\vb<cTtT)bfnevhmf>WOfOsbun3v*m<!\v*!OGsyjbbbqGam)pgbju!!\vf<e*h*fQItppsq{!4->y)f.u3)/q1p!U+y!fmUvbnbbyXG*),bmnvvnMbbObXyTGX><Q\ve!oGFybbnbvGmm!pubbup!mfGebhbfyWGf!s\vu<4D>y)j.q3c/v1t!!++!!mDvynjbqTc*v,tm>vFnybjTqXcTvFt<!\vu!bGpymbGbbGbmypGb!u\v!<f*e*hOftIppqs!{->ybfcut))qfpeUhyffIUpbsb{y4G*),bfnevhMfbIbpysG{>5O<e\vo!FGbynbvbmG!mupbbpum!GfbebhyfGW!f\vs<u1>/b4c,t*)DfyejhqfcWvfts+u*41*/,3f.e)h)f>WEfysjuq5c<v\vt!!GuybbpbmGGmbpbbyuG!!t\vv<c1qQj`yZOUXJTMXBOVFRT`FB>BmYvGn!b+O!XzT/XQ,Omgvgnpb,OzF/TCFt<p\vq!>Gzy/bQbtGpmqp!b\vu<!1mQf`oZhUuJiMTBjVhRo`>BgByYbGb!R+v!bym/jQuOzgSgdpq,Gys/bCntfp/qy><y\v/!QGtypbqb!C\vp<pQmt!piqp!s3{uTbqpbmoG>bfbeyhGf!I\vp<s1{Q!`?Z>U!JfMeBhVfRW`fBsBuY<G\v!!+G!yzb/bQGOmgpgbpu.!zt/vCctqpjqy>Bz>/tOvtcpqqj!y\vO<T1XQF`!Z+U!J3M/B1V,Rt`vBcBqYjGy!O+X!TyX/OQFOTgFg<p\v.!yj/gC)tapiqp>sy{/TOqtbpoq*!!\vm<vOntbpOq>!m3vunbbpXm<G\vb!bjygG)!a\vi<p6s/{1T!q+b!oo*h!jmTvinubhTo>fmmv>n,bzF/<C\vt!pjqg!)*iopbsq{TT{qsbpoi*!!)mgfjo!h\vu<i6T/j1h!o+>!goyhbjbTRivubhmojfumz>S,dyq/GCstbpnqf!/*zo<b\vq!TG{ysbpbiGam)pgbju!!\vt<vzc/qfjnybCs>G)qtdvSczqujjymBb!v+R!b)b2y/g1!0;2!31//11*!*@.!m*vonbbqNT<{\vs!pGiy!b)b>Gzm/pQbOug!ghps!b\ve<jyf/ofunOb>smGvqndbSOz.umjvmnbbvNR<b\vb!yGgy!b;b!G1m/p1b!u@!!h*sobbeqjTf{osupTi>am)v>nyb/TQ.Omgvgnpb!N\v<<\vQ!OGgygbpb!G3mupbbpum!GmbvbnybGO!O\v><mzv/nNbtOp,qm>vzn/bCNt<p\vq!!G\vy<byb/GNmtppbqu>!ym/vCntbpTqT!>\vm<vCntbpTq,!m3vunbbpNm<G\vb!bGyyGb!b\vC<p*pfmh!oqbbSjqsdOS>ybjcqtc)vhts!b+e!j*fCoyujOq*c!v?t>)!tbccbt))uhbsTbbebjyfGo>uDTy*j<q\vc!vGty!bubbGpmmpGbbub!yhGs!b\ve<jofhojuT>inubhyo)fbmc.t>)ohhsjbTeijufhooufOm*!-*!Obscjtb)qh)sgbje!j\vf<o*u*T",MS(N,{accordionViewExpandIcon:Fi(Y4),accordionViewCollapseIcon:Fi(Y4,!0),accordionViewLabelColor:e0,accordionViewLabelFont:Uh,accordionViewTitleBackground:b,accordionViewSelectBackground:r4,accordionViewSelectWidth:3,accordionViewSeparatorColor:K,splitViewDividerSize:1,splitViewDividerBackground:b,splitViewDragOpacity:.5,splitViewToggleIcon:{width:16,height:16,comps:[{type:BJ,rect:[2,2,12,12],background:Y4}]},propertyViewLabelColor:oh,propertyViewLabelSelectColor:e0,propertyViewLabelFont:Uh,propertyViewExpandIcon:Fi(c4),propertyViewCollapseIcon:Fi(c4,!0),propertyViewBackground:s4,propertyViewRowLineVisible:!0,propertyViewColumnLineVisible:!0,propertyViewRowLineColor:P4,propertyViewColumnLineColor:P4,propertyViewSelectBackground:r4,listViewLabelColor:oh,listViewLabelSelectColor:e0,listViewLabelFont:Uh,listViewRowLineVisible:!1,listViewRowLineColor:P4,listViewSelectBackground:r4,treeViewLabelColor:oh,treeViewLabelSelectColor:e0,treeViewLabelFont:Uh,treeViewExpandIcon:Fi(d4),treeViewCollapseIcon:Fi(d4,!0),treeViewRowLineVisible:!1,treeViewRowLineColor:P4,treeViewSelectBackground:r4,treeViewDoubleClickToToggle:!0,tableViewLabelColor:oh,tableViewLabelSelectColor:e0,tableViewLabelFont:Uh,tableViewRowLineVisible:!0,tableViewColumnLineVisible:!0,tableViewRowLineColor:P4,tableViewColumnLineColor:P4,tableViewSelectBackground:r4,treeTableViewLabelColor:oh,treeTableViewLabelSelectColor:e0,treeTableViewLabelFont:Uh,treeTableViewExpandIcon:Fi(d4),treeTableViewCollapseIcon:Fi(d4,!0),treeTableViewRowLineVisible:!0,treeTableViewColumnLineVisible:!0,treeTableViewRowLineColor:P4,treeTableViewColumnLineColor:P4,treeTableViewSelectBackground:r4,tableHeaderLabelColor:oh,tableHeaderLabelFont:Uh,tableHeaderColumnLineVisible:!0,tableHeaderColumnLineColor:w4,tableHeaderBackground:s4,tableHeaderMoveBackground:z,tableHeaderInsertColor:r4,tableHeaderSortDescIcon:Ci(c4,!0),tableHeaderSortAscIcon:Ci(c4),tabViewTabGap:1,tabViewLabelColor:e0,tabViewLabelFont:Uh,tabViewTabBackground:b,tabViewSelectWidth:3,tabViewSelectBackground:r4,tabViewMoveBackground:z,tabViewInsertColor:r4,toolbarLabelColor:oh,toolbarLabelSelectColor:e0,toolbarLabelFont:Uh,toolbarBackground:s4,toolbarSelectBackground:r4,toolbarItemGap:8,toolbarSeparatorColor:h4},!0),{translateX:1,sortColumn:1}),yk={sortable:1,sortOrder:1,sortFunc:1},xk={focusData:1},Rk={dataModel:1,sortColumn:1,sortFunc:1,visibleFunc:1,rootData:1,rootVisible:1},Nk={dataModel:1,sortFunc:1,visibleFunc:1,categorizable:1},mk=function(p,G){G.add(p),p.hasChildren()&&p.eachChild(function(p){mk(p,G)})},Kk=function(p,G,v,J,$,S,O,W,l,t,z){var Z,B,f,X,q,g,M=v.getValueType(t),L=v.getAlign(t);if(v.getEnumValues(t))return Z=v.toEnumLabel(G,t),B=Fh||0,f=0,X=S,q=N.getTextSize(J,Z).width,(g=T(v.toEnumIcon(G,t)))&&(f=S+Fh/2,"center"===L?f+=(W-(B+q))/2:"right"===L&&(f=f+W-(B+q)),ZA(p,g,f,O+l/2,t,z),X=f+Fh/2),void(Z!=v0&&(g?nA(p,Z,J,$,X,O,W-(X-S),l):nA(p,Z,J,$,S,O,W,l,L)));if((G=v.formatValue(G))!=v0){if(M!==Nl)return M===Rl||!M&&SS(G)?(g=T(G?DJ:YJ),void ZA(p,g,S+W/2,O+l/2,t,z)):void nA(p,G,J,$,S,O,W,l,L);VE(p,S,O,W,l,G)}},ak=function(v,J){var $=J.view,S=tE(v),O=J.column||J.property;$.getDataModel().beginTransaction(),(J.editor=v).info=J,$.setCurrentEditor(v),$.getView().insertBefore(S,$._79O),P(v,J.editorRect),v.setFocus?v.setFocus():lE(v),v.commitValue=function(p,G){v._17Q&&(v=v._17Q),G||$.setValue(J.data,O,v.getValue?v.getValue():v.value),v.close&&v.close(),KA(S)},O.onEditorCreated&&O.onEditorCreated(J)},uk=function(p,G,v,J,$){var S=aA(p,v),O=G.value,W=G.view,v=$.getValueType(G.data);return S.onblur=S.onchange=function(p){W.endEditing()},"input"===p?((O=$.formatValue(O))!=v0&&(S.value=O),S.onkeydown=function(p){jE(p)?W.endEditing():iE(p)&&W.endEditing(!0)},v!==ml&&v!==Kl||H0(S,vi,N.numberListener)):p===UJ&&J.forEach(function(p){var G=B.createElement("option");G.innerHTML=$.toEnumLabel(p),G.value=p,$.isEnumEqual(O,p)&&(G.selected=!0),KS(S,G)}),ak(S,G),S},Tk=E.widget={},k4=function(p,G,v){oA("ht.widget."+p,G,v)},Vk=(MS(Ih,{ms_value:function(p,G){p.getValue=function(p){var G=(p=this.getItemById(p)).element;return JS(G)?G:G?G.getValue?G.getValue():G.value:p.selected},p.setValue=function(p,G){var v;(p=this.getItemById(p))&&((v=p.element)&&!JS(v)?v.setValue?v.setValue(G):v.value=G:(SS(G)?p.selected=G:p.element=G,this.iv()))},p.v=function(p,G){if(2===arguments.length)this.setValue(p,G);else{if(!OS(p))return this.getValue(p);for(var v in p)this.setValue(v,p[v])}return this}},_46o:function(p,G){p._icon=v0,p._accessType=v0,p._valueType=v0,p._editable=!1,p._batchEditable=!0,p._align=C0,p._nullable=!0,p._emptiable=!1,p.setParent=Ei,p.formatValue=function(p){var G=this._valueType;return this.getEnumValues()?this.toEnumLabel(p):G===Rl?!!p:p!=v0&&G===ml?b0(p):p},p.setEnum=function(p,G,v,J,$,S,O){p&&!lS(p)&&p.values&&(J=p.editable,v=p.icons,G=p.labels,$=p.strict,S=p.maxHeight,O=p.dropDownWidth,p=p.values),tS(p)&&(p=p._as),tS(G)&&(G=G._as),tS(v)&&(v=v._as),this._enumValues=p,this._enumLabels=G,this._enumIcons=v,this._enumEditable=J,this._enumStrict=$==v0||$,this._enumMaxHeight=S,this._enumDropDownWidth=O,p&&p.length&&$S(p[0])&&(this._valueType=Kl),this.fp("enum",!1,!0)},p.getEnumDropDownWidth=function(){return this._enumDropDownWidth},p.getEnumMaxHeight=function(){return this._enumMaxHeight},p.isEnumEditable=function(){return this._enumEditable},p.getEnumValues=function(){return this._enumValues},p.getEnumLabels=function(){return this._enumLabels},p.getEnumIcons=function(){return this._enumIcons},p.isEnumStrict=function(){return this._enumStrict},p.isEnumEqual=function(p,G){return this._enumStrict?p===G:p==G},p.toEnumLabel=function(p,G){var v=this.getEnumValues(G),J=this.getEnumLabels(G);if(v&&J)for(var $=0;$<v.length;$++)if(this.isEnumEqual(p,v[$]))return J[$];return p},p.toEnumIcon=function(p,G){var v=this.getEnumValues(G),J=this.getEnumIcons(G);if(v&&J)for(var $=0;$<v.length;$++)if(this.isEnumEqual(p,v[$]))return J[$];return K}},_45o:function(p,G){p._87o=function(p,G,v,J,$,S){var O,W;p&&(O=this._90I,W=yS(1),this._columnLineVisible&&--$,this._rowLineVisible&&--S,$<=0||S<=0||((O=this._90I?O:this._90I={})[G]||(O[G]=new o),P(W,this.tx()+v,this.ty()+J,$,S),KS(W,p),this._view.insertBefore(W,this._79O),p.onParentAdded&&p.onParentAdded(W),O[G].add(W)))},p._76o=function(){var p=this._90I;if(p){for(var G in p)p[G].each(function(p){KA(p)});delete this._90I}},p._77o=function(p){var G;this._90I&&(G=this._90I[p])&&(G.each(function(p){KA(p)}),delete this._90I[p])}},_47o:function(p,G){p.getValue=function(p,G){return G.getValue?G.getValue(p,G,this):dS(p,G.getAccessType(),G.getName())},p.setValue=function(p,G,v){var J,$,S,O;G.isEmptiable(p)||""!==v||(v=K),!G.isNullable(p)&&v==v0||(J=this,$=G.getName(p),S=G.getAccessType(p),(O=G.getValueType(p))===ml&&JS(v)?v=r0(v):O===Kl&&JS(v)?v=parseFloat(v):O===Rl&&JS(v)&&(v="true"===v),J._batchEditable&&G._batchEditable&&J.isSelected(p)?J.sm().each(function(p){G.setValue?G.setValue(p,G,v,J):PS(p,S,$,v)}):G.setValue?G.setValue(p,G,v,J):PS(p,S,$,v))},p.setCurrentEditor=function(p){this.endEditing(),this._currentEditor=p,this.redraw()},p.isEditing=function(p,G){var v=this._currentEditor;return!!v&&(!G||!!(v=v.info)&&(v.column||v.property)===G&&v.data===p)},p.endEditing=function(p){var G=this._currentEditor;G&&(delete this._currentEditor,G.commitValue&&G.commitValue(G.info,p),this.redraw(),this.getDataModel().endTransaction())},p.beginEditing=function(p){this.endEditing();var v=this,J=p.column||p.property;if(J.beginEditing)J.beginEditing(p);else{var G,$,S=p.data,O=p.value,W=v.getSelectBackground(S),l=J.getEnumValues(S),t=J.getSlider(S),z=J.getColorPicker(S);if(t)return(G=lA(Tk.Slider,t)).setValue(O),G.getView().onblur=function(p){v.endEditing()},G.isInstant()&&(G.onValueChanged=function(){v.setValue(S,J,G.getValue())}),void ak(G,p);if(z||J.getValueType(S)===Nl)return(t=lA(Tk.ColorPicker,z)).setValue(O),$=t.onClosed,t.onClosed=function(){v.endEditing(),$&&$.call(this)},t.isInstant()&&(t.onValueChanged=function(p,G){v.setValue(S,J,G)}),ak(t,p),void t.open();if(l)Tk.ComboBox?((z=new Tk.ComboBox).setValue(O),z.setValues(l),z.setLabels(J.getEnumLabels(S)),z.setIcons(J.getEnumIcons(S)),z.setEditable(J.isEnumEditable(S)),z.setStrict(J.isEnumStrict(S)),z.setMaxHeight(J.getEnumMaxHeight(S)),z.setDropDownWidth(J.getEnumDropDownWidth(S)),z.onClosed=function(){v.endEditing()},ak(z,p),z.open()):uk(UJ,p,W,l,J);else{if(J.getValueType(S)!==Rl&&!SS(O))return J.getItemEditor(S)?(((z=(t=new(LA(J.getItemEditor(S)))(S,J,v,p)).getView())._17Q=t).setValue(O),NS(z),ak(z,p),void(t.editBeginning&&t.editBeginning())):void uk("input",p,W,v0,J);v.setValue(S,J,!O)}}}},_44o:function(p,G){p.init=function(p){var G=this,v=G.th=new lM(p),J=G._view=ES(1,G);G.tv=G._tableView=p,KS(J,v.getView()),KS(J,p.getView()),v.mp(function(p){p.property===bJ&&G.iv()}),G.iv()},p.getTableView=function(){return this.tv},p.getTableHeader=function(){return this.th},p.getDataModel=function(){return this.tv.dm()},p.getColumnModel=function(){return this.tv.getColumnModel()},p.setColumns=function(p){this.tv.setColumns(p)},p.addColumns=function(p){this.tv.addColumns(p)},p.endEditing=function(){this.tv.endEditing()},p.validateImpl=function(){var p=this.th,G=CS(p),v={x:0,y:0,width:this.getWidth(),height:G};P(p,v),v.y=G,v.height=J0(0,this.getHeight()-G),P(this.tv,v)}},ms_vs:function(p,G){p._41o=function(){return this._29I.height<this._59I},p._43o=function(){var p=this;p._41o()&&(p._58I||(I0(function(){p._94O()},pA),p.iv()),p._58I=new Date)},p._94O=function(){var p=this;p._58I&&((new Date).getTime()-p._58I.getTime()>=pA?(delete p._58I,p.iv()):I0(function(){p._94O()},pA))},p._93I=function(){var p,G,v,J,$,S,O,W=this,l=W._27I;W._58I||!W._autoHideScrollBar?(l||KS(W._79O,l=W._27I=yS()),p=(J=W._29I).height,G=W._59I,v=W.getScrollBarSize(),J=J.width-v-2,$=p*(-W.ty()/G),S=p*(p/G),O=l.style,p<G?(S<GA&&(p<($=($=$+S/2-GA/2)<0?0:$)+GA&&($=p-GA),S=GA),O.visibility=uJ,O.background=W.getScrollBarColor(),O.borderRadius=v/2+tJ,P(l,J,$,v,S)):O.visibility=aJ):l&&(l.style.visibility=aJ)}},ms_hs:function(p,G){p._40o=function(){return this._29I.width<this._91I},p._42o=function(){var p=this;p._40o()&&(p._95O||(I0(function(){p._94I()},pA),p.iv()),p._95O=new Date)},p._94I=function(){var p=this;p._95O&&((new Date).getTime()-p._95O.getTime()>=pA?(delete p._95O,p.iv()):I0(function(){p._94I()},pA))},p._92I=function(){var p,G,v,J,$,S,O,W=this,l=W._28I;W._95O||!W._autoHideScrollBar?(l||KS(W._79O,l=W._28I=yS()),p=(J=W._29I).width,G=W._91I,v=W.getScrollBarSize(),J=J.height-v-2,$=p*(-W.tx()/G),S=p*(p/G),O=l.style,p<G?(S<GA&&(p<($=($=$+S/2-GA/2)<0?0:$)+GA&&($=p-GA),S=GA),O.visibility=uJ,O.background=W.getScrollBarColor(),O.borderRadius=v/2+tJ,P(l,$,J,S,v)):O.visibility=aJ):l&&(l.style.visibility=aJ)}}}),K0(DJ,oi(16,16,[{type:y,rect:[1,1,14,14],background:r4},{type:ZJ,rect:[1,1,14,14],width:1,color:j4},{type:qJ,points:[13,3,7,12,4,8],borderWidth:2,borderColor:"#FFF"}])),K0(YJ,oi(16,16,{type:ZJ,rect:[1,1,14,14],width:1,color:j4})),K0(sJ,oi(16,16,[{type:fJ,rect:[2,2,12,12],borderWidth:1,borderColor:j4,background:"#FFF"},{type:fJ,rect:[4,4,8,8],background:r4}])),K0(cJ,oi(16,16,{type:fJ,rect:[2,2,12,12],borderWidth:1,borderColor:j4})),Ih._15Q=function(p,G){p._29I=xi,p._59I=0,p._91I=0,p._5o=function(p){var G=this;G._30I=new o,G._rows=new o,G._rowMap={},G._31I=0,G._14I=0,G._view=ES(1,G),G._canvas=xS(G._view),KS(G._view,G._79O=yS()),G.dm(p||new Cm)},p.getCheckIcon=function(p){var G=this.sm(),p=G.co(p);return G.sg()?T(p?sJ:cJ):T(p?DJ:YJ)},p.checkData=function(p){var G=this.sm(),v=G.co(p);G.sg()&&v||(this._32o=1,v?G.rs(p):G.as(p),delete this._32o)},p.getDataAt=function(p){p.target&&(p=this.lp(p));var p=n0(p.y/this._rowHeight),G=this._rows;return p<0||p>=G.size()?v0:G.get(p)},p.onDataDoubleClicked=function(p,G){},p.onDataClicked=function(p,G){},p.adjustTranslateX=function(p){return 0},p.adjustTranslateY=function(p){var G=this.getHeight()-this._59I;return 0<(p=p<G?G:p)?0:b0(p)},p.onPropertyChanged=function(p){p=p.property,Rk[p]?this.ivm():xk[p]||this.redraw(),p===bl?this._42o():p===nl&&this._43o()},p.getLabel=function(p){return p.toLabel()},p.getLabelFont=function(p){return this._labelFont},p.getLabelColor=function(p){if(this.isCheckMode()){if(this._focusData===p)return this._labelSelectColor}else if(this.isSelected(p))return this._labelSelectColor;return this._labelColor},p.getStartRowIndex=function(){return this._31I},p.getEndRowIndex=function(){return this._14I},p.getRowDatas=function(){return this._rows},p.getRowIndex=function(p){return this._rowMap[p._id]},p.getRowSize=function(){return this._rows.size()},p.getViewRect=function(){return MA(this._29I)},p.isVisible=function(p){return!this._visibleFunc||this._visibleFunc(p)},p.getCurrentSortFunc=function(){return this._sortFunc},p.setDataModel=function(p){var G=this,v=G._dataModel,J=G._selectionModel;v!==p&&(v&&(v.umm(G.handleDataModelChange,G),v.umd(G.handleDataPropertyChange,G),v.umh(G.handleHierarchyChange,G),J||v.sm().ums(G.handleSelectionChange,G)),(G._dataModel=p).mm(G.handleDataModelChange,G),p.md(G.handleDataPropertyChange,G),p.mh(G.handleHierarchyChange,G),J?J._21I(p):p.sm().ms(G.handleSelectionChange,G),G.fp("dataModel",v,p))},p.validateModel=function(){var p=this,G=(p._rows.clear(),p._rowMap={},p.buildChildren(p._dataModel._roots),p._rows=p._rows.toList(p.isVisible,p)),v=0,J=p.getCurrentSortFunc(),$=G.size();for(J&&G.sort(J);v<$;v++)p._rowMap[G.get(v)._id]=v},p.buildChildren=function(p){var G=this;p.each(function(p){G._rows.add(p),G.buildChildren(p._children)})},p.handleDataModelChange=function(p){this.ivm()},p.handleDataPropertyChange=function(p){"parent"===p.property?this.ivm():this.invalidateData(p.data)},p.handleHierarchyChange=function(p){this.ivm()},p.handleSelectionChange=function(p){p.datas.each(this.invalidateData,this),this.onSelectionChanged(p)},p.onSelectionChanged=function(p){var G=this.sm();!this.isAutoMakeVisible()||1!==G.size()||"set"!==p.kind&&"append"!==p.kind||this._32o||this.makeVisible(G.ld())},p.handleBackgroundClick=function(p){YA(p)&&!this.isCheckMode()&&this.sm().cs()},p.makeVisible=function(p){p&&(this._23I=p,this.iv())},p.scrollToIndex=function(p){var G=this._29I,v=G.height,J=this._rowHeight,$=J*p;0<=p&&p<this._rows.size()&&0<v&&($+J>G.y+v?this.ty(-$+v-J):$<G.y&&this.ty(-$))},p.autoScroll=function(p,G){var v=this,J=v._rowHeight,$=J,S=J/4,O=v._29I,p=v.lp(p),W={x:v.tx(),y:v.ty()};return 0<J&&O&&(p.x-O.x<$?v.translate(S,0):O.x+O.width-p.x<$&&v.translate(-S,0),p.y-O.y<$?v.translate(0,S):O.y+O.height-p.y<$&&v.translate(0,-S)),W.x=v.tx()-W.x,W.y=v.ty()-W.y,G&&(G.x+=W.x,G.y+=W.y),W},p.getTopRowOrderSelection=function(){var p=this.sm().getTopSelection(),G={},v=new o;return p.each(function(p){G[p._id]=p}),this._rows.each(function(p){G[p._id]&&v.add(p)}),v},p.getRowOrderSelection=function(){var G=new o;return this._rows.each(function(p){this.isSelected(p)&&G.add(p)},this),G},p.ivm=function(){this.invalidateModel()},p.invalidateModel=function(){this._96I||(this._96I=1,this._32I=1,delete this._24I),this.iv()},p.redraw=function(){this._32I||(this._32I=1,delete this._24I,this.iv())},p.invalidateData=function(p){N0?this.redraw():this._32I||(this._24I||(this._24I={}),this._24I[p._id]=p,this.iv())},p.getFocusData=function(){return this._focusData},p.setFocusDataById=function(p){this.setFocusData(this.dm().getDataById(p))},p.setFocusData=function(p){var G=this._focusData;G!==p&&(this._focusData=p,this.fp("focusData",G,p),G&&this.invalidateData(G),p&&(this.invalidateData(p),this.isAutoMakeVisible()&&this.makeVisible(p)))},p.drawRowBackground=function(p,G,v,J,$,S,O){var W=this.isCheckMode();(G===this._focusData&&W||v&&!W)&&VE(p,J,$,S,O,this.getSelectBackground(G))},p.drawData=function(p,G,v){var J=this._rowHeight,$=J*v,S=(O=this._29I).x,O=O.width;p.save(),p.beginPath(),p.rect(S,$,O,J),p.clip(),this._87o(this.drawRow(p,G,this.isSelected(G),S,$,O,J),v,S,$,O,J),p.restore(),this._rowLineVisible&&VE(p,S,$+J-1,O,1,this._rowLineColor)},p._12I=function(p){var G=this._31I,v=(S=this._29I).x,J=S.y,$=S.width,S=S.height;for(p.beginPath(),p.rect(v,J,$,S),p.clip(),p.clearRect(v,J,$,S),this._76o(),this._93db(p);G<this._14I;G++)this.drawData(p,this._rows.get(G),G);this._92db(p)},p._13I=function(G){for(var p,v=this,J=v._rowHeight,$=v._29I,S=$.x,O=$.width,W=v._31I,l=v._30I;W<v._14I;W++)p=v._rows.get(W),v._24I[p._id]&&l.add({data:p,index:W});l.isEmpty()||(G.beginPath(),l.each(function(p){G.rect(S,p.index*J,O,J)}),G.clip(),l.each(function(p){G.clearRect(S,p.index*J,O,J)}),l.each(function(p){v._77o(p.index)}),v._93db(G),l.each(function(p){v.drawData(G,p.data,p.index)}),v._92db(G),l.clear())},p.preValidateModel=function(){this.endEditing&&this.endEditing()},p.validateImpl=function(){var p=this,G=p._canvas,v=p.getWidth(),J=p.getHeight(),$=p._rowHeight,S=p._32I,O=(v===G.clientWidth&&J===G.clientHeight||(mS(G,v,J),S=1),p._96I&&(p.preValidateModel(),p.validateModel()),p._29I),v={x:-p.tx(),y:-p.ty(),width:v,height:J},J=p._rows.size(),G=GE(G),W=p._23I,O=(S||YS(v,O)||(S=1),p._29I=v,p._59I=J*$,p._31I=n0(v.y/$),p._14I=D0((v.y+v.height)/$),p._31I<0&&(p._31I=0),p._14I>J&&(p._14I=J),p._99I&&S&&p._99I(),p.tx()),v=p.ty();(p._40o()||p._41o())&&(p._59I+=p.getScrollBarSize(),p._99I&&S&&(p._91I+=p.getScrollBarSize())),vE(G,O,v,1),S?p._12I(G):p._24I&&p._13I(G),p._93I(),p._92I(),G.restore(),p._32I=p._24I=p._96I=v0,W&&(p.scrollToIndex(p.getRowIndex(W)),delete p._23I),p.tx(p.tx()),p.ty(p.ty())},p.canHandleSelectMode=function(p,G){return!0},p.isDraggable=function(p){return!0}},Ih._48o=function(p,G){p._rootVisible=!0,p._rootData=v0,p._35o=function(){this._expandMap={},this._levelMap={}},p.validateModel=function(){var p=this,G=p._rootData;p._rows.clear(),p._levelMap={},p._rowMap={},p._currentLevel=0,G?p._rootVisible?p.isVisible(G)&&p.buildData(G):p.buildChildren(G):p.buildChildren(),delete p._currentLevel},p.buildData=function(p){var G=p._id,v=this._rows;this._rowMap[G]=v.size(),v.add(p),this._levelMap[G]=this._currentLevel,this.isExpanded(p)&&(this._currentLevel++,this.buildChildren(p),this._currentLevel--)},p.buildChildren=function(p){var G=this,v=p?p._children:G._dataModel._roots,J=G.getCurrentSortFunc();J&&G.isChildrenSortable(p)?v.toList(G.isVisible,G).sort(J).each(G.buildData,G):v.each(function(p){G.isVisible(p)&&G.buildData(p)})},p.getLevel=function(p){return this._levelMap[p._id]},p.getToggleIcon=function(p){var G=this._loader,v=this._collapseIcon;return G&&!G.isLoaded(p)?v:p.hasChildren()?this.isExpanded(p)?this._expandIcon:v:v0},p.isCheckMode=function(){return this._checkMode!=v0},p.isChildrenSortable=function(p){return!0},p.handleDataModelChange=function(p){p.kind===LJ?delete this._expandMap[p.data._id]:p.kind===HJ&&(this._expandMap={}),this.ivm()},p.toggle=function(p){this.isExpanded(p)?this.collapse(p):this.expand(p)},p.isExpanded=function(p){return 1===this._expandMap[p._id]},p.expand=function(p){var G=this._loader;this.isExpanded(p)||(G&&!G.isLoaded(p)&&G.load(p),this._expandMap[p._id]=1,this.ivm(),this.onExpanded(p))},p.onExpanded=function(p){},p.collapse=function(p){this.isExpanded(p)&&(delete this._expandMap[p._id],this.ivm(),this.onCollapsed(p))},p.onCollapsed=function(p){},p.expandAll=function(p){var G;p?(this.expand(p),p.eachChild(function(p){this.expandAll(p)},this)):((G=this)._dataModel.each(function(p){p.hasChildren()&&(G._expandMap[p._id]=1)}),G.ivm())},p.collapseAll=function(){this._expandMap={},this.ivm()},p.makeVisible=function(p){if(p&&(!this._rootData||p.isDescendantOf(this._rootData))){for(var G=p._parent;G;)this.expand(G),G=G._parent;this._23I=p,this.iv()}},p.checkData=function(p){var G,v=this._checkMode,J=this.sm(),$=J.co(p);if(!J.sg()||!$){if(this._32o=1,v===T0)$?J.rs(p):J.as(p);else if(v===_l)(G=new o(p)).addAll(p._children);else if("descendant"===v)G=new o,mk(p,G);else if("all"===v&&(G=new o,mk(p,G),!$))for(var S=p._parent;S;)G.add(S),S=S._parent;G&&($?J.rs(G):J.as(G)),delete this._32o}},p.drawTree=function(p,G,v,J,$,S,O){var W=this,l=W._indent,t=W._levelMap[G._id],z=W.getIconWidth(G),Z=T(W.getToggleIcon(G));Z?(ZA(p,Z,(J+=l*t)+l/2,$+O/2,G,W),J+=l):J+=l*(t+1),W._checkMode&&(ZA(p,W.getCheckIcon(G),J+l/2,$+O/2,G,W),J+=l),W.drawIcon(p,G,J,$,z,O),W.drawLabel(p,G,J+z,$,O)}},Ih._14Q=function(p,G){p.getIcon=function(p){return p.getIcon()},p.getIconWidth=function(p){return this.getIcon(p)?this._indent:0},p.drawIcon=function(p,G,v,J,$,S){var O,W;$&&(O=this.getBodyColor(G),(W=T(this.getIcon(G),O))&&(S-=this.isRowLineVisible()?1:0,BA(p,W,kl,v,J,$,S,G,this,O),J4(p,this.getBorderColor(G),v,J,$,S)))},p.drawLabel=function(p,G,v,J,$){nA(p,this.getLabel(G),this.getLabelFont(G),this.getLabelColor(G),v,J,0,$)}},Ih._50o=function(p,G){p._98I=function(){var p=this._39o=new Cm;this._60I=new o,p.mm(this._17o,this),p.md(this._18o,this),p.mh(this._19o,this)},p.setColumns=function(p){this._39o.clear(),this.addColumns(p)},p.addColumns=function(p){var v=this._39o;p.forEach(function(p){var G;p instanceof ok||(G=LA(p.className),p=lA(G||ok,p)),v.add(p)})},p.onColumnClicked=function(p){},p.onCheckColumnClicked=function(p){},p._3Q=function(p){for(var G,v=0,J=this._60I,$=J.size();v<$;v++)if((G=J.get(v)).column===p)return G;return v0},p.getColumnAt=function(p){return(p=this._4Q(p))?p.column:v0},p._4Q=function(p){for(var G=(p.target?this.lp(p):p).x,v=this._60I,J=0;J<v.size();J++){var $=v.get(J),S=$.startX;if(S<=G&&G<S+$.column.getWidth())return $}return v0},p.getToolTip=function(p){var G=this.getDataAt(p),p=this.getColumnAt(p);return G&&p?p.getToolTip(G,this):v0},p.adjustTranslateX=function(p){var G=this.getWidth()-this._91I;return 0<(p=p<G?G:p)?0:b0(p)},p._99I=function(){var v=this,J=v._29I,$=v._60I;$.clear(),v._91I=0,v._39o._roots.each(function(p){var G;p.isVisible()&&(G=v._91I+p.getWidth(),v._91I<=J.x+J.width&&G>=J.x&&$.add({column:p,startX:v._91I}),v._91I=G)})},p.drawData=function(J,$,S){var O=this,W=O._rowHeight,l=W*S,t=O.isSelected($),p=(G=O._29I).x,G=G.width;O.drawRowBackground(J,$,t,p,l,G,W),O._60I.each(function(p){var G=p.column,p=p.startX,v=G.getWidth();0<v&&!O.isEditing($,G)&&(J.save(),J.beginPath(),J.rect(p,l,v,W),J.clip(),O._87o(O.drawCell(J,$,t,G,p,l,v,W),S,p,l,v,W),O._columnLineVisible&&VE(J,p+v-1,l,1,W,O._columnLineColor),J.restore())}),O._rowLineVisible&&VE(J,p,l+W-1,G,1,O._rowLineColor)},p.drawCell=function(p,G,v,J,$,S,O,W){if(J.drawCell)return J.drawCell(p,G,v,J,$,S,O,W,this);v=this.getValue(G,J),Kk(p,v,J,this.getLabelFont(G,J,v),this.getLabelColor(G,J,v),$,S,O,W,G,this)},p.getColumnModel=function(){return this._39o},p._17o=function(p){this.redraw()},p._18o=function(p){p.data===this._sortColumn&&yk[p.property]?this.ivm():(this._42o(),this.redraw())},p._19o=function(p){this.redraw()},p.getCurrentSortFunc=function(){var v,J,$=this,S=$._sortColumn;return S&&S.isSortable()?(J=S.getSortFunc(),v=gl===S.getSortOrder()?1:-1,J=J||gA,function(p,G){return J.call($,$.getValue(p,S),$.getValue(G,S),p,G)*v}):$._sortFunc},p.isCellEditable=function(p,G,v){return!(!G.isEditable()||!this.isEditable())&&(!G.isCellEditable||G.isCellEditable(p,G,v,this))},p._37O=function(p,G){if(YA(G))for(var v=this,J=v.lp(G),$=v._60I,S=v._rowHeight,O=v._29I,W=O.x,l=O.y,t=O.width,z=O.height,Z=0;Z<$.size();Z++){var B,f,X=$.get(Z),q=X.startX,g=(X=X.column).getWidth();if(X!==v._31o&&X!==v._4o&&J.x>=q&&J.x<q+g&&v.isCellEditable(p,X,G))return g={x:(q={x:q,y:v.getRowIndex(p)*S,width:g,height:S}).x+v.tx(),y:q.y+v.ty(),width:q.width,height:q.height},f=B=0,q.x<W?B=q.x-W:W+t<q.x+q.width&&(B=q.x+q.width-W-t),B&&(v.tx(v.tx()-B),g.x-=B),q.y<l?f=q.y-l:l+z<q.y+S&&(f=q.y+S-l-z),f&&(v.ty(v.ty()-f),g.y-=f),void v.beginEditing({data:p,column:X,value:v.getValue(p,X),event:G,rect:q,editorRect:g,view:v})}}},Tk.BaseItemEditor=function(p,G,v,J){this._data=p,this._column=G,this._master=v,this._editInfo=J},k4("BaseItemEditor",d,{ms_ac:["data","column","master","editInfo"],editBeginning:function(){},getView:function(){},getValue:function(){},setValue:function(){}}),E.Tab=function(){bS(Vk,this)}),ok=(Ph("Tab",Fm,{ms_ac:["view","closable","disabled","visible"],_icon:v0,_closable:!1,_disabled:!1,_visible:!0,setParent:Ei}),E.Column=function(){bS(ok,this)}),Uk=(Ph("Column",Fm,{_46o:1,ms_ac:["accessType","valueType",uJ,fl,Xl,_J,"align",Nl,"sortOrder",Bl,"sortable","clickable","nullable","emptiable","slider","colorPicker","itemEditor"],_visible:!0,_width:80,_sortOrder:gl,_sortFunc:v0,_sortable:!0,_clickable:!0,setWidth:function(p){var G=this._width;this._width=p=p<16?16:p,this.fp(_J,G,p)},getToolTip:function(p,G){return this.formatValue(G.getValue(p,this))}}),E.Property=function(){bS(Uk,this)}),Fk=(Ph("Property",Fm,{_46o:1,ms_ac:["accessType","valueType",fl,Xl,"categoryName",Nl,"align","nullable","emptiable","slider","itemEditor","colorPicker"],_categoryName:v0,getToolTip:function(p,G,v){return G?this.formatValue(v.getValue(p,this)):v.getPropertyName(this)}}),Tk.AccordionView=function(){this._20o={},this._21o=new o,this._10o=v0,this._9o=v0,this._11o=v0,this._view=ES(0,this),this.iv()},k4("AccordionView",d,{ms_v:1,ms_fire:1,ms_ac:[tl,zl,"titleHeight",IJ,kJ,"titleBackground","selectWidth",A0,"orientation","separatorColor"],_expandIcon:N.accordionViewExpandIcon,_collapseIcon:N.accordionViewCollapseIcon,_titleHeight:Qh,_labelColor:N.accordionViewLabelColor,_labelFont:N.accordionViewLabelFont,_titleBackground:N.accordionViewTitleBackground,_selectBackground:N.accordionViewSelectBackground,_selectWidth:N.accordionViewSelectWidth,_orientation:"v",_separatorColor:N.accordionViewSeparatorColor,onPropertyChanged:function(p){this.iv()},getView:function(){return this._view},getTitles:function(){return this._21o},getCurrentTitle:function(){return this._10o},add:function(G,p,v,J){var $=this,S=yS(),p={content:p,div:S,canvas:xS(S),icon:J};if($._20o[G])throw G+" already exists";var O=p.downEventFunc=function(p){tA(p)},W=p.upEventFunc=function(p){tA(p),YA(p)&&($._10o===G?$.collapse():$.expand(G))};[Ql,ol].forEach(function(p){H0(S,p,O)}),[Gi,Fl].forEach(function(p){H0(S,p,W)}),S.style.cursor=Tl,KS($._view,S),$._20o[G]=p,$._21o.add(G),v&&$.expand(G),$.iv()},remove:function(p){var G,v=this._20o[p];v&&(G=v.div,KA(G),[Ql,ol].forEach(function(p){_0(G,p,v.downEventFunc)}),[Gi,Fl].forEach(function(p){_0(G,p,v.upEventFunc)}),delete this._20o[p],this._21o.remove(p),this.iv())},clear:function(){this._21o.toArray().forEach(this.remove,this),this._20o={},this._21o.clear(),this.iv()},isExpanded:function(p){return this._10o===p},expand:function(p){this._20o[p]&&this._10o!==p&&(this._10o=p,this.onExpanded(p),this.iv())},onExpanded:function(p){},collapse:function(){this._10o&&(this.onCollapsed(this._10o),delete this._10o,this.iv())},onCollapsed:function(p){},initCanvas:function(p,G,v){return mS(p,G,v),p=GE(p),vE(p,0,0,1),p.clearRect(0,0,G,v),p},drawTitle:function(p,G,v,J,$){var S=this,$=T($.icon),O=S.isExpanded(G),W=S._titleHeight,l=S._titleBackground,t=S._selectWidth,z=S._separatorColor,Z=T(O?S._expandIcon:S._collapseIcon),B=t+4;VE(p,0,0,v,J,l),O&&t&&VE(p,0,0,t,J,S._selectBackground),!O&&S._21o.get(S._21o.size()-1)===G||VE(p,0,J-1,v,1,z||_A(l)),$&&(ZA(p,$,B+Am($)/2,W/2),B+=Am($)+2),nA(p,G,S.getLabelFont(G),S.getLabelColor(G),B,0,0,W),Z&&ZA(p,Z,v-Am(Z)/2-4,W/2)},validateImpl:function(){var O=this,p=O._view,W=0,l=0,t=O.getWidth(),z=O.getHeight(),Z=O._titleHeight,B=O._21o.size()*Z,G=O._11o,v=O._9o,J=(delete O._11o,delete O._9o,O._21o.each(function(p){var G,v,J=O._20o[p],$=J.content,S=O._10o===p;Qi(O)?(P(J.div,W,0,Z,z),G=O.initCanvas(J.canvas,Z,z),JE(G,0,z),$E(G,-w0),O.drawTitle(G,p,z,Z,J),G.restore(),S?(v=J0(0,t-B),$&&(O._11o=$,O._9o=tE($),P($,W+Z,0,v,z)),W+=Z+v):W+=Z):(P(J.div,0,l,t,Z),G=O.initCanvas(J.canvas,t,Z),O.drawTitle(G,p,t,Z,J),G.restore(),S?(v=J0(0,z-B),$&&(O._11o=$,O._9o=tE($),P($,0,l+Z,t,v)),l+=Z+v):l+=Z)}),O._9o);G&&G!==O._11o&&G.endEditing&&G.endEditing(),J&&J!==v&&KS(p,J),v&&v!==J&&KA(v)}}),Tk.SplitView=function(p,G,v,J){var $=this,S=$._dividerDiv=yS(),O=$._60O=xS(),W=$._61O=xS(),O=O.style,W=W.style;$._view=ES(1,$),KS($._view,S),O.msTouchAction=Vl,O.pointerEvents=Vl,O.cursor=Tl,W.msTouchAction=Vl,W.pointerEvents=Vl,W.cursor=Tl,p&&$.setLeftView(p),G&&$.setRightView(G),v&&$.setOrientation(v),J!=v0&&$.setPosition(J),$.setStatus(MJ),new Fk($)},k4("SplitView",d,{ms_v:1,ms_fire:1,ms_ac:["continuousLayout","dividerSize","dividerBackground","toggleIcon","togglable","dragOpacity","orientation","draggable","status"],_continuousLayout:!1,_position:.5,_togglable:!0,_orientation:"h",_draggable:!0,_dividerSize:N.splitViewDividerSize,_dividerBackground:N.splitViewDividerBackground,_dragOpacity:N.splitViewDragOpacity,_toggleIcon:N.splitViewToggleIcon,onPropertyChanged:function(p){this.iv()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(p,G){var v=this._position;isNaN(p)||(G||(this._82O=p<0?-1:1<p?1:0),this._position=p,this.fp(Ll,v,p))},getLeftView:function(){return this._leftView},setLeftView:function(p){var G,v=this._leftView,J=this._view;this._leftView!==p&&(v&&v!==this._rightView&&(G=tE(v)).parentNode===J&&KA(G),(this._leftView=p)&&(G=tE(p)).parentNode!==J&&J.insertBefore(G,this._dividerDiv),this.fp("leftView",v,p))},getRightView:function(){return this._rightView},setRightView:function(p){var G,v=this._rightView,J=this._view;this._rightView!==p&&(v&&v!==this._leftView&&(G=tE(v)).parentNode===J&&KA(G),(this._rightView=p)&&(G=tE(p)).parentNode!==J&&J.insertBefore(G,this._dividerDiv),this.fp("rightView",v,p))},validateImpl:function(){var p,G,v,J,$=this,S=$._draggable,O=$._position,W=$.getWidth(),l=$.getHeight(),t=$._dividerSize,z=$._dividerBackground,Z=u0?18:8,B=$._dividerDiv,f=$._82O,X=$._60O,q=$._61O,g=$._toggleIcon,M=$._status,L=B.style,H=null,_=u0?20:4,b=g.comps[0],n=(Z<=t||0===t?$._coverDiv&&(KA($._coverDiv),delete $._coverDiv):$._coverDiv||($._coverDiv=yS(),R0&&($._coverDiv.style.background=El),KS(B,$._coverDiv)),$._togglable?X.parentNode||(KS(B,X),KS(B,q)):(KA(X),KA(q)),$._coverDiv),D=$._leftView,Y=$._rightView;Qi($)?(W<t&&(t=W),M===MJ?1===f?(J=$0(O,W),v=J0(0,W-t-J)):-1===f?(v=$0(-O,W),J=J0(0,W-t-v)):(J=b0((W-t)*O),v=J0(0,W-t-J)):"cl"===M?v=J0(J=0,W-t):"cr"===M&&(J=J0(v=0,W-t)),D&&P(D,0,0,J,l),Y&&P(Y,J+t,0,v,l),P(B,J,0,t,l),$._22o=J,n&&(P(n,t/2-Z/2,0,Z,l),n.style.cursor=S?al:""),B.style.cursor=S?al:"",v=B.clientHeight/2,J=B.clientWidth,mS(X,J,J),P(X,0,v-J-_,J,J),H=GE(X),vE(H,0,0,1),b.rotation=-w0,Im(H,g,0,0,J,J),H.restore(),mS(q,J,J),P(q,0,v+_,J,J),H=GE(q),vE(H,0,0,1),b.rotation=w0):(l<t&&(t=l),M===MJ?1===f?(p=$0(O,l),G=J0(0,l-t-p)):-1===f?(G=$0(-O,l),p=J0(0,l-t-G)):(p=b0((l-t)*O),G=J0(0,l-t-p)):"cl"===M?G=J0(p=0,l-t):"cr"===M&&(p=J0(G=0,l-t)),D&&P(D,0,0,W,p),Y&&P(Y,0,p+t,W,G),P(B,0,p,W,t),$._22o=p,n&&(P(n,0,t/2-Z/2,W,Z),n.style.cursor=S?ul:""),L.cursor=S?ul:"",v=B.clientWidth/2,J=B.clientHeight,mS(X,J,J),P(X,v-J-_,0,J,J),H=GE(X),vE(H,0,0,1),b.rotation=0,Im(H,g,0,0,J,J),H.restore(),mS(q,J,J),P(q,v+_,0,J,J),H=GE(q),vE(H,0,0,1),b.rotation=j),Im(H,g,0,0,J,J),H.restore(),L.background=z}}),function(p){this.sv=p,this.addListeners()}),Ck=(oA(Fk,d,{ms_listener:1,getView:function(){return this.sv.getView()},handle_touchstart:function(p){var G=this.sv,v=G._dividerDiv,J=G._60O,$=G._61O,S=G._status,O=p.target;O===J?S===MJ?G.setStatus("cl"):"cr"===S&&G.setStatus(MJ):O===$?S===MJ?G.setStatus("cr"):"cl"===S&&G.setStatus(MJ):!LE(p)||O!==v&&O!==G._coverDiv||(tA(p),G.isDraggable()&&(G.getLeftView(),G.getRightView(),(J=this.maskDiv=yS()).style.left=0,J.style.top=0,J.style.width=G.getWidth()+"px",J.style.height=G.getHeight()+"px",G.getView().appendChild(J),G.isContinuousLayout()||(($=this.resizeDiv=yS()).style.left=v.style.left,$.style.top=v.style.top,$.style.width=v.style.width,$.style.height=v.style.height,$.style.opacity=G.getDragOpacity(),$.style.background=G.getDividerBackground(),KS(this.getView(),$)),this._lastAbsPosition=G._22o,this._86o=Qi(G)?i(p).x:i(p).y,mA(this,p)))},handleWindowTouchMove:function(p){LE(p)&&this.update(p,this.sv.isContinuousLayout())},handleWindowTouchEnd:function(p){this.update(p,!0),this.sv.setStatus(MJ),this.maskDiv&&KA(this.maskDiv),this.resizeDiv&&KA(this.resizeDiv),this.maskDiv=this.resizeDiv=v0},handle_mousedown:function(p){YA(p)&&this.handle_touchstart(p)},handleWindowMouseMove:function(p){this.handleWindowTouchMove(p)},handleWindowMouseUp:function(p){this.handleWindowTouchEnd(p)},update:function(p,G){var v=this.sv,J=Qi(v)?v.getWidth():v.getHeight(),$=v._dividerSize,S=this._lastAbsPosition-this._86o;Qi(v)?((S=J-$<(S+=i(p).x)?J-$:S)<0&&(S=0),this.resizeDiv&&(this.resizeDiv.style.left=S+tJ)):((S=J-$<(S+=i(p).y)?J-$:S)<0&&(S=0),this.resizeDiv&&(this.resizeDiv.style.top=S+tJ)),G&&J!==$&&(1===v._82O?v.setPosition(S,1):-1===v._82O?v.setPosition(S-J+$,1):v.setPosition(S/(J-$),1))}}),Tk.TabView=function(){var p=this,G=p._view=ES(1,p),v=p._91O=yS(1),J=p._tabModel=new Cm,$=J.sm(),S=p.invalidate;p._7o=new o,p._canvas=xS(v),KS(G,v),KS(G,p._92O=yS(1)),$.setSelectionMode(V0),$.ms(p.handleSelectionChange,p),J.mm(S,p),J.mh(S,p),J.md(S,p),p._interactor=new Ck(p),p.iv()},k4("TabView",d,{ms_v:1,ms_fire:1,ms_tx:1,ms_ty:1,ms_lp:1,ms_ac:["movable","tabGap","tabHeight","tabPosition",IJ,kJ,"tabHPadding","tabBackground","selectWidth",A0,"moveBackground","insertColor"],_tabHPadding:0,_tabPosition:pJ,_tabHeight:Qh,_tabGap:N.tabViewTabGap,_labelColor:N.tabViewLabelColor,_labelFont:N.tabViewLabelFont,_tabBackground:N.tabViewTabBackground,_selectWidth:N.tabViewSelectWidth,_selectBackground:N.tabViewSelectBackground,_moveBackground:N.tabViewMoveBackground,_insertColor:N.tabViewInsertColor,_movable:!0,handleSelectionChange:function(){this._selectionChanged=!0,this.invalidate()},getContentDiv:function(){return this._92O},getTitleDiv:function(){return this._91O},getTabModel:function(){return this._tabModel},add:function(p,G,v){var J,$=this._tabModel;return p instanceof Vk?(J=p,G&&J.setView(G)):((J=new Vk).setName(p),J.setView(G)),$.add(J),v&&$.sm().ss(J),J},getLabel:function(p){return p.toLabel()},onPropertyChanged:function(p){this.iv()},_7Q:function(p){this._23o=p,this.iv()},get:function(G){var v,J=this,p=J._tabModel;return $S(G)?p._roots.get(G):JS(G)?(p.each(function(p){G===J.getLabel(p)&&(v=p)}),v):G instanceof Vk?G:v0},select:function(p){this._tabModel.sm().ss(this.get(p))},remove:function(p){var G;(p=this.get(p))&&(G=this._tabModel._roots.indexOf(p),this._tabModel.remove(p),this.selectByIndex(--G))},getCurrentTab:function(){return this._8o},hideTabView:function(p,G){G.parentNode===this._92O&&(XS(G)?(G.style.display=lJ,G._tab_=p):KA(G),ah())},showTabView:function(p,G){XS(G)&&(G.style.display="block",G._tab_=p),G.parentNode!==this._92O&&(KS(this._92O,G),ah())},_24o:function(){var p,G=this._8o,v=this._9o,J=this._tabModel.sm().ld();(p=J?tE(J.getView()):p)!==v&&(v&&(G.getView()&&G.getView().endEditing&&G.getView().endEditing(),this.hideTabView(G,v)),p&&this.showTabView(J,p)),this._8o=J,this._9o=p,G!==J&&this.onTabChanged(G,J)},onTabClosing:function(p){return!0},onTabChanged:function(p,G){},onTabClosed:function(p,G){this.selectByIndex(--G)},selectByIndex:function(p){var G=this._tabModel,v=G.size();if(v&&!G.sm().ld()){for(var J=p=(p=v<=(p=p==v0?0:p)?v-1:p)<0?0:p;0<=J;J--){var $=this.get(J);if(!$.isDisabled())return this.select($),$}for(J=p+1;J<v;J++)if(!($=this.get(J)).isDisabled())return this.select($),$}},getTabWidth:function(p){var G=4+2*this.getTabHPadding(),v=T(p.getIcon());return v&&(G+=Am(v,p)+4),(v=this.getLabel(p))&&(G+=DA(this.getLabelFont(p),v).width+4),p.isClosable()&&(G+=10),G},drawTab:function(p,G,v,J,$,S,O){var W,l=this._tabPosition,t=v+4+(H=this.getTabHPadding()),z=this._selectWidth,Z=T(G.getIcon()),B=G.isDisabled(),f=this.getLabelColor(G),X=this.getLabelFont(G),q=this.getLabel(G),g=this._selectBackground,M=l===C0+"-vertical",L=l===Q0+"-vertical",H=((M||L)&&(t=J+4+H),B&&(p.globalAlpha=yh),VE(p,v,J,$,S,O),G===this._8o&&z&&(l===pJ?VE(p,v,J+S-z,$,z,g):l===C0?VE(p,v+$-z,J,z,S,g):l===Q0?VE(p,v,J,z,S,g):M?VE(p,v+$-z,J,z,S,g):L?VE(p,v,J,z,S,g):VE(p,v,J,$,z,g)),$/2);return M&&(JE(p,H,J+S/2),$E(p,j),JE(p,-H,-J-S/2)),Z&&(O=km(Z,G),l=Am(Z,G),M||L?(JE(p,z=v+$/2,g=t+O/2),$E(p,w0),JE(p,-z,-g),ZA(p,Z,v+$/2,t+O/2,G,this),JE(p,z,g),$E(p,-w0),JE(p,-z,-g),t+=O+4):(ZA(p,Z,t+l/2,J+S/2,G,this),t+=l+4)),M||L?(JE(p,$/2,t+$/2),$E(p,w0),JE(p,-$/2,-t-$/2),nA(p,q,X,f,v,t,S,$),JE(p,$/2,t+$/2),$E(p,-w0),JE(p,-$/2,-t-$/2)):nA(p,q,X,f,t,J,$,S),M&&(JE(p,H,J+S/2),$E(p,-j),JE(p,-H,-J-S/2)),G.isClosable()&&this.drawCloseIcon(G,p,f,W=L?{x:v+$-12,y:J+S-12,width:12,height:12}:{x:v+$-12,y:J+2,width:12,height:12}),B&&(p.globalAlpha=1),W},drawCloseIcon:function(p,G,v,J){var $=J.x,J=J.y;G.strokeStyle=v,G.lineWidth=1,G.beginPath(),G.moveTo($+2,J+8),G.lineTo($+8,J+2),G.moveTo($+8,J+8),G.lineTo($+2,J+2),G.stroke()},getTabAt:function(p){return(p=this._interactor._8Q(p))?p.tab:null},validateImpl:function(){var J=this,p=(J._24o(),J._canvas),G=J._tabPosition,v=J._91O,$=J._92O,S=J._tabModel,O=J.getWidth(),W=J.getHeight(),l=J._tabHeight,t=J._7o,z=J._tabGap,Z=G===pJ,B=G===C0,f=G===Q0,X=G===C0+"-vertical",G=G===Q0+"-vertical",q=J._23o,g=0;if((B||f)&&S._roots.each(function(p){g=J0(J.getTabWidth(p),g)}),Z=Z?(P(v,0,0,O,l),{x:0,y:l,width:O,height:J0(0,W-l)}):B?(P(v,0,0,g,W),{x:g,y:0,width:J0(0,O-g),height:W}):f?(P(v,O-g,0,g,W),{x:0,y:0,width:J0(0,O-g),height:W}):X?(P(v,0,0,l,W),{x:l,y:0,width:J0(0,O-l),height:W}):G?(P(v,O-l,0,l,W),{x:0,y:0,width:J0(0,O-l),height:W}):(P(v,0,W-l,O,l),{x:0,y:0,width:O,height:J0(0,W-l)}),P($,Z),X||G){J._9o&&(Z.x=0,P(J._8o.getView(),Z)),mS(p,l,W);var M=GE(p),L=0;if(vE(M,0,J.ty(),1),M.clearRect(0,0,l,W),t.clear(),S._roots.each(function(p){var G,v;p.isVisible()&&(G=J.getTabWidth(p),q&&q.tab===p||(v=J.getTabBackground(p),v=J.drawTab(M,p,0,L,l,G,v)),t.add({_75o:v,tab:p,startY:L,endY:L+G,height:G}),L+=G+z)}),J._23Q=J0(0,L-z),q&&(b=q.position,J.drawTab(M,q.tab,0,q.startY,l,q.height,J._moveBackground),VE(M,0,b,l,1,J._insertColor)),M.restore(),J._selectionChanged){J._selectionChanged=!1;for(var H=J.ty(),_=0;_<t.size();_++)if((D=t.get(_)).tab===J._8o){if(D.endY+H<0){J.ty(-D.startY);break}if(D.startY+H>W){J.ty(W-D.endY);break}}}J.ty(J.ty())}else if(B||f){if(J._9o&&(Z.x=0,P(J._8o.getView(),Z)),mS(p,g,W),M=GE(p),vE(M,L=0,J.ty(),1),M.clearRect(0,0,g,W),t.clear(),S._roots.each(function(p){var G;p.isVisible()&&(q&&q.tab===p||(G=J.getTabBackground(p),G=J.drawTab(M,p,0,L,g,l,G)),t.add({_75o:G,tab:p,startY:L,endY:L+l,height:l}),L+=l+z)}),J._23Q=J0(0,L-z),q&&(b=q.position,J.drawTab(M,q.tab,0,q.startY,g,q.height,J._moveBackground),VE(M,0,b,g,1,J._insertColor)),M.restore(),J._selectionChanged)for(J._selectionChanged=!1,H=J.ty(),_=0;_<t.size();_++)if((D=t.get(_)).tab===J._8o){if(D.endY+H<0){J.ty(-D.startY);break}if(D.startY+H>W){J.ty(W-D.endY);break}}J.ty(J.ty())}else{J._9o&&(Z.y=0,P(J._8o.getView(),Z)),mS(p,O,l);var b,M=GE(p),n=0;if(vE(M,J.tx(),0,1),M.clearRect(0,0,O,l),t.clear(),S._roots.each(function(p){var G,v;p.isVisible()&&(G=J.getTabWidth(p),q&&q.tab===p||(v=J.getTabBackground(p),v=J.drawTab(M,p,n,0,G,l,v)),t.add({_75o:v,tab:p,startX:n,endX:n+G,width:G}),n+=G+z)}),J._64I=J0(0,n-z),q&&(b=q.position,J.drawTab(M,q.tab,q.startX,0,q.width,l,J._moveBackground),iS(M,J._insertColor,b,0,l)),M.restore(),J._selectionChanged){J._selectionChanged=!1;for(var D,Y=J.tx(),_=0;_<t.size();_++)if((D=t.get(_)).tab===J._8o){if(D.endX+Y<0){J.tx(-D.startX);break}if(D.startX+Y>O){J.tx(O-D.endX);break}}}J.tx(J.tx())}for(var s=[],c=$.children,_=0;_<c.length;_++){var h=c[_],w=h._tab_;w&&!S.contains(w)&&s.push(h)}s.forEach(function(p){$.removeChild(p)})}}),function(p){this.tv=p,this.addListeners()}),Qk=(oA(Ck,d,{ms_listener:1,getView:function(){return this.tv._91O},handle_mousewheel:function(p){this.handleScroll(p,p.wheelDelta/40*10)},handle_DOMMouseScroll:function(p){this.handleScroll(p,10*-p.detail)},handleScroll:function(p,G){tA(p);var v=(p=this.tv)._tabPosition;!p._40o()||v!==pJ&&v!==GJ||p.tx(this.tv.tx()+G),!p._41o()||v!==C0&&v!==Q0&&v!==C0+"-vertical"&&v!==Q0+"-vertical"||p.ty(this.tv.ty()+G)},_8Q:function(p){var G,v=this.tv,J=v._tabPosition,$=v._7o;if(J===pJ||J===GJ){for(var S=v.lp(p).x,O=0;O<$.size();O++)if((G=$.get(O)).startX<=S&&S<=G.endX)return G}else if(J===C0||J===Q0||J===C0+"-vertical"||J===Q0+"-vertical")for(var W=v.lp(p).y,O=0;O<$.size();O++)if((G=$.get(O)).startY<=W&&W<=G.endY)return G;return v0},isClickable:function(p){var G=this.tv,v=G._tabPosition,p=this._73o=this._8Q(p);return!(!G._40o()||v!==pJ&&v!==GJ)||!(!G._41o()||v!==C0&&v!==Q0&&v!==C0+"-vertical"&&v!==Q0+"-vertical")||p&&(!p.tab.isDisabled()||G.isMovable())},handle_mousemove:function(p){fE?this._74o=this._8Q(p):this.getView().style.cursor=this.isClickable(p)?Tl:""},handle_mousedown:function(p){this.handle_mousemove(p),this.handle_touchstart(p)},handle_touchstart:function(p){var G=this.tv,v=G._tabPosition;tA(p),YA(p)&&this.isClickable(p)&&(v===pJ||v===GJ?(this.x=i(p).x,this.lp=G.lp(p),this.tx=G.tx()):(this.y=i(p).y,this.lp=G.lp(p),this.ty=G.ty()),mA(this,p))},handle_mouseup:function(p){this.handle_touchend(p)},handle_touchend:function(p){var G,v,J;sA(p)&&(p=this._73o)&&(G=this.tv,v=G.getTabModel(),!(J=p.tab).isDisabled()&&J.isClosable()&&G.onTabClosing(J,p=function(){var p=v._roots.indexOf(J);v.remove(J),G.onTabClosed(J,p)})&&p())},handleWindowMouseMove:function(p){this.handleWindowTouchMove(p)},handleWindowTouchMove:function(p){var J,$,S,O,G=this,W=G.tv,v=W._tabPosition,l=G._73o;v===pJ||v===GJ?($=i(p).x-G.x,!G._25o&&!G.moving&&2<I($)&&(W._40o()&&!PA(p)?G._25o=1:l&&W.isMovable()&&(G.moving=1)),G._25o?W.tx(G.tx+$):G.moving&&(J=G.lp.x+$,O=W._tabGap/2,W._7o.each(function(p){var G=p.endX,v=J-p.startX<G-J;J>=p.startX&&J<=G&&W._7Q({tab:l.tab,startX:l.startX+$,width:l.width,front:v,insertTab:p.tab,position:v?J0(0,p.startX-O):$0(W._64I,G+O)})}))):($=i(p).y-G.y,!G._25o&&!G.moving&&2<I($)&&(W._41o()&&!PA(p)?G._25o=1:l&&W.isMovable()&&(G.moving=1)),G._25o?W.ty(G.ty+$):G.moving&&(S=G.lp.y+$,O=W._tabGap/2,W._7o.each(function(p){var G=p.endY,v=S-p.startY<G-S;S>=p.startY&&S<=G&&W._7Q({tab:l.tab,startY:l.startY+$,height:l.height,front:v,insertTab:p.tab,position:v?J0(0,p.startY-O):$0(W._23Q,G+O)})})))},handleWindowMouseUp:function(p){this.handleWindowTouchEnd(p)},handleWindowTouchEnd:function(p){var G,v,J,$,S=this,O=S.tv,W=O._tabPosition,l=O.getTabModel(),t=l._roots,z=S._73o;S.moving?((J=O._23o)&&J.insertTab!==J.tab&&(v=J.tab,$=t.remove(v),0<=(G=t.indexOf(J.insertTab))&&(J.front||G++,G<=t.size()&&(t.add(v,G),l._38I(v,$,G)))),O._7Q(v0),delete S.moving):!S._25o&&z&&(v=z.tab,(J=S._74o)&&J.tab!==v||(!v.isDisabled()&&AA(z._75o,S.lp)?O.onTabClosing(v,$=function(){var p=t.indexOf(v);l.remove(v),O.onTabClosed(v,p)})&&$():v.isDisabled()||O._8o===v||l.sm().ss(v))),S._25o=S._73o=S._74o=W===pJ||W===GJ?S.x=S.lp=S.tx=v0:S.y=S.lp=S.ty=v0}}),Tk.PropertyView=function(p){var G=this,v=(G._view=ES(1,G),G._canvas=xS(G._view),KS(G._view,G._79O=yS()),G._rows=new o,G._28o=new o,G._26o={},G._26Q={},G._propertyModel=new Cm),J=G.ivm;v.mm(J,G),v.md(J,G),v.mh(J,G),G.dm(p||new Cm),new Qk(G)},k4("PropertyView",d,{ms_ac:[IJ,EJ,kJ,fl,Xl,"categorizable",vl,Bl,ll,tl,zl,pl,Gl,QJ,"selectRowIndex",A0,"background",Jl,Wl,Sl,Ol,$l],ms_v:1,ms_dm:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,_45o:1,_47o:1,ms_tip:1,_29I:xi,_59I:0,_9I:0,_selectRowIndex:-1,_editable:!0,_batchEditable:!0,_categorizable:!0,_indent:Fh,_background:N.propertyViewBackground,_expandIcon:N.propertyViewExpandIcon,_collapseIcon:N.propertyViewCollapseIcon,_scrollBarColor:A4,_scrollBarSize:Z,_autoHideScrollBar:Nh,_selectBackground:N.propertyViewSelectBackground,_rowHeight:e4,_rowLineVisible:N.propertyViewRowLineVisible,_rowLineColor:N.propertyViewRowLineColor,_10I:.5,_columnLineVisible:N.propertyViewColumnLineVisible,_columnLineColor:N.propertyViewColumnLineColor,_labelColor:N.propertyViewLabelColor,_labelSelectColor:N.propertyViewLabelSelectColor,_labelFont:N.propertyViewLabelFont,getRows:function(){return this._rows},getColumnPosition:function(){return this._10I},setColumnPosition:function(p){var G=this._10I;this._10I=p=1<(p=p<0?0:p)?1:p,this.fp("columnPosition",G,p)},getPropertyName:function(p){return p.toLabel()},getLabelFont:function(p,G,v){return this._labelFont},getLabelColor:function(p,G,v){return v===this._selectRowIndex?this._labelSelectColor:this._labelColor},getPropertyFont:function(p,G){return this._labelFont},getPropertyColor:function(p,G){return G===this._selectRowIndex?this._labelSelectColor:p.getColor()||this._labelColor},getCategoryFont:function(p){return this._labelFont},getCategoryColor:function(p){return this._labelColor},adjustTranslateX:function(p){return 0},adjustTranslateY:function(p){var G=this.getHeight()-this._59I;return 0<(p=p<G?G:p)?0:b0(p)},isExpanded:function(p){if(!p)return!0;var G=this._26o[p];return G?G.isExpanded:!(!1===this._26Q[p])},toggle:function(p){this.isExpanded(p)?this.collapse(p):this.expand(p)},expandAll:function(){for(var p in this.validate(),this._26o)this.expand(p)},expand:function(p){var G;p&&p!==lJ&&(G=this._26o[p])&&!G.isExpanded&&(G.isExpanded=!0,this.onExpanded(p),this.ivm())},onExpanded:function(p){},collapseAll:function(){for(var p in this.validate(),this._26o)this.collapse(p)},collapse:function(p){var G;p&&p!==lJ&&(G=this._26o[p])&&G.isExpanded&&(G.isExpanded=!1,this.onCollapsed(p),this.ivm())},onCollapsed:function(p){},getCategoryName:function(p){return this.isCategorizable()&&(p=p.getCategoryName())||lJ},getPropertyModel:function(){return this._propertyModel},handleSelectionChange:function(){this.ivm()},setDataModel:function(p){var G=this,v=G._dataModel;v!==p&&(v&&(v.umd(G.handlePropertyChange,G),G._selectionModel||v.sm().ums(G.handleSelectionChange,G)),(G._dataModel=p).md(G.handlePropertyChange,G),G._selectionModel?G._selectionModel._21I(p):p.sm().ms(G.handleSelectionChange,G),G.fp(Dl,v,p))},isVisible:function(p){return!this._visibleFunc||this._visibleFunc(p)},onPropertyChanged:function(p){p=p.property,Nk[p]?this.ivm():this.iv(),p===nl&&this._43o()},getCurrentData:function(){return this._27o},updateCurrentData:function(){this._27o=this.sm().ld()},getRawProperties:function(){return this._27o?this._propertyModel._roots:om},handlePropertyChange:function(p){this._27o===p.data&&this.iv()},ivm:function(){this.invalidateModel()},invalidateModel:function(){this._96I||(this.setSelectRowIndex(-1),this._96I=1,this.iv())},redraw:function(){this.iv()},validateModel:function(){var p,J=this,$=J._rows,G=J._28o,S={},O=new o,v=J._27o;for(p in J.updateCurrentData(),v!==J._27o&&J.endEditing(),$.clear(),G.clear(),J.getRawProperties().each(function(p){J.isVisible(p)&&(O.add(p),p=J.getCategoryName(p),S[p]||(G.add(p,p===lJ?0:K),S[p]={isExpanded:J.isExpanded(p),properties:new o}))}),J._sortFunc&&O.sort(J._sortFunc),J._26o)J._26Q[p]=J.isExpanded(p);J._26o=S,G.each(function(G){G!==lJ&&$.add(G);var v=S[G];v.isExpanded&&O.each(function(p){J.getCategoryName(p)===G&&(v.properties.add(p),$.add({property:p,data:J._27o}))},J)})},validateImpl:function(){var p=this,G=(p._76o(),p._96I&&(p.validateModel(),delete p._96I),p._canvas),v=p.getWidth(),J=p.getHeight(),$=-p.ty(),S=p._rowHeight,O=p._indent,W=v-O,l=p._rows,t=l.size(),z=p._9I=O+W*p._10I,Z=p._59I=t*S,B=(mS(G,v,J),p._29I={x:0,y:$,width:v,height:J},p._31I=n0($/S),p._14I=D0(($+J)/S),p._31I<0&&(p._31I=0),p._14I>t&&(p._14I=t),GE(G)),f=p._background;vE(B,0,-$,1),B.beginPath(),B.rect(0,$,v,J),B.clip(),B.clearRect(0,$,v,J),p._93db(B),f&&VE(B,0,0,O,Z,f);for(var X=p._31I;X<p._14I;X++){var q,g,M,L,H=l.get(X),$=S*X;JS(H)?(f&&VE(B,O,$,W,S,f),(g=T(p.isExpanded(H)?p._expandIcon:p._collapseIcon))&&BA(B,g,kl,0,$,O,S),B.save(),B.beginPath(),B.rect(O,$,W,S),B.clip(),p.drawCategoryName(B,H,X,O,$,W,S),B.restore()):(q=H.property,H=H.data,g=T(q.getIcon()),M=p._selectRowIndex===X?p.getSelectBackground():v0,g&&BA(B,g,kl,0,$,O,S),M&&VE(B,O,$,W,S,M),B.save(),B.beginPath(),B.rect(O,$,z-O,S),B.clip(),p.drawPropertyName(B,q,X,O,$,z-O,S),B.restore(),p.isEditing(H,q)||(M=z+1,L=v-z-1,B.save(),B.beginPath(),B.rect(M,$,L,S),B.clip(),p._87o(p.drawPropertyValue(B,q,p.getValue(H,q),X,M,$,L,S,H),X,M,$,L,S),B.restore())),p._rowLineVisible&&VE(B,O,$+S-1,W,1,p._rowLineColor)}p._columnLineVisible&&(VE(B,z,0,1,Z,p._columnLineColor),VE(B,v-1,0,1,Z)),p._92db(B),p._93I(),B.restore(),p.ty(p.ty())},drawCategoryName:function(p,G,v,J,$,S,O){nA(p,G,this.getCategoryFont(G),this.getCategoryColor(G),J,$,S,O)},drawPropertyName:function(p,G,v,J,$,S,O){G.drawPropertyName?G.drawPropertyName(p,G,v,J,$,S,O,this):nA(p,this.getPropertyName(G),this.getPropertyFont(G,v),this.getPropertyColor(G,v),J,$,S,O)},drawPropertyValue:function(p,G,v,J,$,S,O,W,l){if(G.drawPropertyValue)return G.drawPropertyValue(p,G,v,J,$,S,O,W,l,this);Kk(p,v,G,this.getLabelFont(G,v,J),this.getLabelColor(G,v,J),$,S,O,W,l,this)},isPropertyEditable:function(p,G){return p.isEditable()&&this.isEditable()},setProperties:function(p){this._propertyModel.clear(),this.addProperties(p)},addProperties:function(p){var v;p&&(v=this._propertyModel,p.forEach(function(p){var G;p instanceof Uk||(G=LA(p.className),p=lA(G||Uk,p)),v.add(p)}))},getRowIndexAt:function(p){return 0<=(p=n0(this.lp(p).y/this._rowHeight))&&p<this._rows.size()?p:-1},getPropertyAt:function(p){return 0<=(p=this.getRowIndexAt(p))?this._rows.get(p).property:v0},getToolTip:function(p){var G=this.getPropertyAt(p),v=this._27o;return G&&v?G.getToolTip(v,this._9I<this.lp(p).x,this):v0}}),function(p){this.pv=p,this.addListeners()}),pM=(oA(Qk,d,{ms_listener:1,getView:function(){return this.pv._view},setCursor:function(p){this.getView().style.cursor=p},clear:function(){this._62O=this.cp=this.ty=this.p=v0,this.setCursor(T0)},handle_mousedown:function(p){this.handle_touchstart(p)},handle_touchstart:function(p){var G=this.pv;tA(p),G.setFocus(p)&&(YA(p)?(this.cp=i(p),this.ty=G.ty(),this.p=G.getColumnPosition(),this.handle_touchmove(p)):G.setSelectRowIndex(G.getRowIndexAt(p)))},handleWindowMouseUp:function(p){this.clear()},handleWindowTouchEnd:function(p){this.clear()},handle_mouseup:function(p){this.handle_touchend(p)},handle_touchend:function(p){var G,v,J,$,S,O,W,l,t,z;this.cp&&!this._62O&&(t=(l=(G=this.pv).lp(p)).x,l=l.y,W=G._indent,v=G.getRowIndexAt(p),J=G._9I,0<=v&&(z=($=G._rowHeight)*v,O=(S=G._rows.get(v)).property,JS(S)?(T(G.isExpanded(S)?G._expandIcon:G._collapseIcon)&&0<=t&&t<=W&&z<=l&&l<=z+$||wA(p))&&G.toggle(S):J<t&&G.isPropertyEditable(O,p)&&(l={x:(W={x:J+1,y:z,width:G.getWidth()-J-1,height:$}).x+G.tx(),y:W.y+G.ty(),width:W.width,height:W.height},t=0,z=G._29I,W.y<z.y?t=W.y-z.y:W.y+$>z.y+z.height&&(t=W.y+$-z.y-z.height),t&&(G.ty(G.ty()-t),l.y-=t),G.beginEditing({data:S.data,property:O,value:G.getValue(S.data,O),event:p,rect:W,editorRect:l,view:G}))),G.setSelectRowIndex(v)),this.clear()},handleWindowMouseMove:function(p){this.handleWindowTouchMove(p)},handleWindowTouchMove:function(p){var G,v,J=this.pv,$=this.ty,S=this.cp,p=i(p),O=this._62O;"p"===O?J.setTranslateY($+p.y-S.y):"c"===O?16<(v=J.getWidth()-J._indent)&&(G=this.p-(S.x-p.x)/v,J.setColumnPosition(G=1-(v=16/v)<(G=G<v?v:G)?1-v:G)):"s"===O&&J.setTranslateY($+(S.y-p.y)*J._59I/J._29I.height)},handle_mousemove:function(p){this.handle_touchmove(p)},handle_touchmove:function(p){var G,v,J;!fE&&YA(p)&&(v=(G=this).pv,J=I(v.lp(p).x-v._9I)<=(u0?8:3),G.cp?G._62O||(J?(G._62O="c",mA(G,p)):2<=I(i(p).y-G.cp.y)&&(G._62O=G.isV(p)?"s":"p",mA(G,p))):(J?G.setCursor(al):G.setCursor(T0),G.isV(p)&&v._43o()))},isV:function(p){var G=this.pv,v=G._29I;return G._41o()&&v.x+v.width-G.lp(p).x<vA},handle_mousewheel:function(p){this.handleScroll(p,p.wheelDelta/40)},handle_DOMMouseScroll:function(p){2===p.axis&&this.handleScroll(p,-p.detail)},handleScroll:function(p,G){var v=this.pv;tA(p),v.endEditing(),v.translate(0,G*v.getRowHeight())},handle_keydown:function(p){var G=this.pv,v=G._rows.size(),J=G._selectRowIndex+(hE(p)?-1:1);(hE(p)||dE(p))&&G.setSelectRowIndex(J=v<=(J=J<0?0:J)?v-1:J)}}),Tk.ListView=function(p){this._5o(p),new pM(this)},k4("ListView",d,{ms_ac:[IJ,EJ,kJ,Jl,vl,Wl,Sl,Bl,ll,pl,Gl,QJ,CJ,A0],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,_14Q:1,ms_dm:1,_45o:1,_checkMode:!1,_indent:Fh,_rowHeight:e4,_rowLineVisible:N.listViewRowLineVisible,_rowLineColor:N.listViewRowLineColor,_scrollBarColor:A4,_scrollBarSize:Z,_autoMakeVisible:E4,_autoHideScrollBar:Nh,_selectBackground:N.listViewSelectBackground,_labelColor:N.listViewLabelColor,_labelSelectColor:N.listViewLabelSelectColor,_labelFont:N.listViewLabelFont,isCheckMode:function(){return this._checkMode},setCheckMode:function(p){var G=this._checkMode;this._checkMode=p,this.fp(Zl,G,p)},drawRow:function(p,G,v,J,$,S,O){var W=0,l=this._indent,t=this.getIconWidth(G);this.drawRowBackground(p,G,v,J,$,S,O),this._checkMode&&(ZA(p,T(this.getCheckIcon(G)),W+l/2,$+O/2,G,this),W+=l),this.drawIcon(p,G,W,$,t,O),this.drawLabel(p,G,W+t,$,O)}}),function(p){this.list=p,this.addListeners()}),GM=(oA(pM,d,{ms_listener:1,getView:function(){return this.list._view},clear:function(p){var G=this,v=G.list;p&&"d"===G._62O&&!G.dragCancel&&v.handleDragAndDrop(p,"end"),v.draggingData&&(v.draggingData=null,v.redraw()),G.dragCancel=G._62O=G._isV=G._isH=G.cp=G.tx=G.ty=v0},handle_mousedown:function(p){this.handle_touchstart(p)},handle_touchstart:function(p){var G,v=this.list;tA(p),v.setFocus(p)&&(G=v.getDataAt(p),this.cp=i(p),this.tx=v.tx(),this.ty=v.ty(),YA(p)?G&&v.handleDragAndDrop&&!this.isV(p)&&!this.isH(p)&&v.isDraggable(G)&&(v.draggingData=G,v.redraw(),v.handleDragAndDrop(p,"prepare")):(G?this._33o(p,G):this._cancelDataDoubleSelect(),this.clear(p)))},handleWindowMouseUp:function(p){this.clear(p)},handleWindowTouchEnd:function(p){this.clear(p)},handle_mouseup:function(p){this.handle_touchend(p)},handle_touchend:function(p){var G,v=this.list;this._isV||this._isH||!this.cp||this._62O||((G=v.getDataAt(p))?(v.isCheckMode()?this._34o(p,G):this._33o(p,G),wA(p)?v.onDataDoubleClicked(G,p):v.onDataClicked(G,p)):(this._cancelDataDoubleSelect(),v.handleBackgroundClick(p))),this.clear(p)},handleWindowMouseMove:function(p){this.handleWindowTouchMove(p)},handleWindowTouchMove:function(p){var G=this.list,v=this._62O,J=this.tx,$=this.ty,S=this.cp,O=i(p),W=G._29I;"p"===v?G.setTranslate(J+O.x-S.x,$+O.y-S.y):"v"===v?G.ty($+(S.y-O.y)*G._59I/W.height):"h"===v?G.tx(J+(S.x-O.x)*G._91I/W.width):"d"!==v||this.dragCancel||G.handleDragAndDrop(p,"between")},handle_mousemove:function(p){this.handle_touchmove(p)},handle_touchmove:function(p){var G,v;!fE&&YA(p)&&(v=(G=this).list,G._isV=G.isV(p),G._isH=G.isH(p),G.cp?G._62O||iA(i(p),G.cp)<2||(G._isV?G._62O="v":G._isH?G._62O="h":v.draggingData&&!this.dragCancel?(G._62O="d",v.handleDragAndDrop(p,"begin")):G._62O="p",G._62O&&"d"!==G._62O&&v.draggingData&&(v.draggingData=null,v.redraw()),mA(G,p)):(G._isV&&v._43o(),G._isH&&v._42o()))},isV:function(p){var G=this.list,v=G._29I;return G._41o()&&v.x+v.width-G.lp(p).x<vA},isH:function(p){var G=this.list,v=G._29I;return G._40o()&&v.y+v.height-G.lp(p).y<vA},handle_mousewheel:function(p){this.handleScroll(p,p.wheelDelta/40,p.wheelDelta!==p.wheelDeltaX)},handle_DOMMouseScroll:function(p){this.handleScroll(p,-p.detail,1)},handleScroll:function(p,G,v){var J=this.list;tA(p),J.endEditing&&J.endEditing(),v&&J._41o()?J.translate(0,G*J.getRowHeight()):J._40o()&&J.translate(10*G,0)},handle_keydown:function(p){var G,v,J,$,S,O,W;N.isInput(p.target)||(v=(G=this.list).sm(),$=(J=G._rows).size(),_E(p)?G.selectAll():bE(p)?G.handleDelete&&G.handleDelete(p):iE(p)?"d"!==this._62O||this.dragCancel||(G.handleDragAndDrop(p,"cancel"),this.dragCancel=!0):PE(p)?G.isCheckMode()&&(W=G.getFocusData())&&G.checkData(W):(hE(p)||dE(p))&&((W=(S=G.isCheckMode())?G.getFocusData():v.ld())?0<=(O=G.getRowIndex(W))&&(hE(p)?0!==O&&(W=J.get(O-1),S?G.setFocusData(W):v.ss(W)):O!==$-1&&(W=J.get(O+1),S?G.setFocusData(W):v.ss(W))):0<$&&(W=J.get(0),S?G.setFocusData(W):v.ss(W))))},_34o:function(p,G){var v=this.list;0<=(p=v.lp(p).x)&&p<=v._indent?v.checkData(G):v.setFocusData(G)},_33o:function(p,G){var v=this.list,J=v.sm(),$=J.ld();if(v.canHandleSelectMode(p,G))if(PA(p))v.isSelected(G)?J.rs(G):J.as(G);else if(dA(p))if($)for(var S=v.getRowIndex($),O=v.getRowIndex(G);S!==O;)J.as(v._rows.get(S+=S<O?1:-1));else J.ss(G);else YA(p)?(J.contains(G)?v.handleDataDoubleSelect&&(this._handleDataDoubleSelect(p,G),wA(p)&&this._cancelDataDoubleSelect()):this._cancelDataDoubleSelect(),J.ss(G)):J.contains(G)||J.ss(G);else this._cancelDataDoubleSelect()},_handleDataDoubleSelect:function(p,G){this._cancelDataDoubleSelect(),this._doubleSelectTimer=I0(function(){this.list.handleDataDoubleSelect(p,G),this._doubleSelectTimer=K}.bind(this),N.doubleClickSpeed)},_cancelDataDoubleSelect:function(){this._doubleSelectTimer&&(E0(this._doubleSelectTimer),this._doubleSelectTimer=K)}}),Tk.TreeView=function(p){this._35o(),this._5o(p),new GM(this)},k4("TreeView",d,{ms_ac:[IJ,EJ,kJ,"rootVisible",Zl,"rootData",Bl,ll,pl,Gl,QJ,vl,Jl,Wl,Sl,tl,zl,CJ,A0,"loader","doubleClickToToggle"],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,_48o:1,_14Q:1,_45o:1,_checkMode:v0,_indent:Fh,_rowHeight:e4,_rowLineVisible:N.treeViewRowLineVisible,_rowLineColor:N.treeViewRowLineColor,_scrollBarColor:A4,_scrollBarSize:Z,_autoHideScrollBar:Nh,_expandIcon:N.treeViewExpandIcon,_collapseIcon:N.treeViewCollapseIcon,_autoMakeVisible:E4,_selectBackground:N.treeViewSelectBackground,_labelColor:N.treeViewLabelColor,_labelSelectColor:N.treeViewLabelSelectColor,_labelFont:N.treeViewLabelFont,_doubleClickToToggle:N.treeViewDoubleClickToToggle,drawRow:function(p,G,v,J,$,S,O){this.drawRowBackground(p,G,v,J,$,S,O),this.drawTree(p,G,v,0,$,S,O)},isOnToggleIcon:function(p){var G=this.getDataAt(p);if(G){var v=this.getIndent(),p=this.lp(p).x;if(T(this.getToggleIcon(G))&&(G=v*this.getLevel(G))<=p&&p<=G+v)return!0}return!1}}),function(p){bS(GM,this,[p])}),vM=(oA(GM,pM,{toggle:function(p,G,v,J){var $=this.list,S=$.lp(p).x;return T($.getToggleIcon(G))&&(J*=v)<=S&&S<=J+v?($.toggle(G),!0):!(!$.isDoubleClickToToggle()||!wA(p)||($.toggle(G),0))},_34o:function(p,G){var v=this.list,J=v.lp(p).x,$=v._levelMap[G._id],S=v._indent,O=S*($+1);O<=J&&J<=O+S?v.checkData(G):this.toggle(p,G,S,$)||v.setFocusData(G)},_33o:function(p,G){var v=this.list;if(!this.toggle(p,G,v._indent,v.getLevel(G)))if(dA(p)){var J=v.sm();if(0<J.size()){for(var $=v._rows,S=null,O=0,W=$.size();O<W;O++)if(v.isSelected($.get(O))){S=O;break}for(var l=null,O=$.size()-1;0<=O;O--)if(v.isSelected($.get(O))){l=O;break}for(var t,z=v.getRowIndex(G),Z=z<S?(t=z-1,S):l<z?(t=l,z):(t=S,l);t!==Z;)J.as(v._rows.get(++t))}else J.ss(G)}else GM.superClass._33o.call(this,p,G)},handle_keydown:function(p){var G,v,J,$,S;cE(p)||wE(p)?(v=(G=this.list)._rows,J=G.isCheckMode(),$=G.sm(),(S=J?G.getFocusData():$.ld())?S.hasChildren()&&(cE(p)?G.collapse(S):G.expand(S)):0<v.size()&&(S=v.get(0),J?G.setFocusData(S):$.ss(S))):GM.superClass.handle_keydown.call(this,p)}}),Tk.TableView=function(p){this._98I(),this._5o(p),new JM(this)}),JM=(k4("TableView",d,{ms_ac:[IJ,EJ,kJ,"sortMode",fl,Xl,Jl,Wl,Sl,Ol,$l,"sortColumn",Bl,ll,pl,Gl,QJ,CJ,A0],ms_v:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_45o:1,_47o:1,_sortMode:ql,_editable:!0,_batchEditable:!1,_rowHeight:e4,_rowLineVisible:N.tableViewRowLineVisible,_rowLineColor:N.tableViewRowLineColor,_columnLineVisible:N.tableViewColumnLineVisible,_columnLineColor:N.tableViewColumnLineColor,_scrollBarColor:A4,_scrollBarSize:Z,_autoHideScrollBar:Nh,_autoMakeVisible:E4,_selectBackground:N.tableViewSelectBackground,_labelColor:N.tableViewLabelColor,_labelSelectColor:N.tableViewLabelSelectColor,_labelFont:N.tableViewLabelFont,getCheckColumn:function(){var p;return this._31o||((p=this._31o=new ok).setEditable(!0),p.setWidth(40),p.getValue=this.getCheckColumValue,p.drawCell=this.drawCheckColumnCell),this._31o},isCheckMode:function(){return this._39o.contains(this._31o)},setCheckMode:function(p){var G=this._39o,v=this.getCheckColumn();p!==this.isCheckMode()&&(p?G.add(v,0):G.remove(v),this.fp(Zl,!p,p))},getCheckColumValue:function(p,G,v){return v.isSelected(p)},drawCheckColumnCell:function(p,G,v,J,$,S,O,W,l){ZA(p,l.getCheckIcon(G),$+O/2,S+W/2,G,l)}}),function(p){bS(JM,this,[p])}),$M=(oA(JM,pM,{_34o:function(p,G){var v=this.list,J=v._31o;if(v.isCellEditable(G,J,p)){var $=v._3Q(J),S=v.lp(p).x;if($&&S>=$.startX&&S<$.startX+J.getWidth())return void v.checkData(G)}v._37O(G,p),v.setFocusData(G)},_33o:function(p,G){this.list._37O(G,p),JM.superClass._33o.apply(this,arguments)}}),Tk.TreeTableView=function(p){var G=this._4o=new ok;this._35o(),this._98I(),this._5o(p),G.setDisplayName("Name"),G.setEditable(!0),G.setWidth(180),G.drawCell=SM,G.getValue=OM,this._39o.add(G),new WM(this)}),SM=function(p,G,v,J,$,S,O,W,l){l.drawTree(p,G,v,$,S,O,W)},OM=function(p,G,v){return v.getLabel(p)},WM=(k4("TreeTableView",d,{ms_ac:[IJ,EJ,kJ,"sortMode",fl,Xl,vl,Zl,"rootData","rootVisible",Bl,ll,"sortColumn",tl,zl,pl,Gl,QJ,CJ,Sl,Jl,Wl,Ol,$l,A0,"loader"],ms_v:1,ms_bnb:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_48o:1,_14Q:1,_45o:1,_47o:1,_sortMode:ql,_checkMode:v0,_editable:!0,_batchEditable:!1,_indent:Fh,_rowHeight:e4,_rowLineVisible:N.treeTableViewRowLineVisible,_rowLineColor:N.treeTableViewRowLineColor,_columnLineVisible:N.treeTableViewColumnLineVisible,_columnLineColor:N.treeTableViewColumnLineColor,_expandIcon:N.treeTableViewExpandIcon,_collapseIcon:N.treeTableViewCollapseIcon,_scrollBarColor:A4,_scrollBarSize:Z,_autoHideScrollBar:Nh,_autoMakeVisible:E4,_selectBackground:N.treeTableViewSelectBackground,_labelColor:N.treeTableViewLabelColor,_labelSelectColor:N.treeTableViewLabelSelectColor,_labelFont:N.treeTableViewLabelFont,getTreeColumn:function(){return this._4o}}),function(p){bS(WM,this,[p])}),lM=(oA(WM,pM,{_34o:function(p,G){var v=this.list,J=v._4o,$=v._3Q(J),S=v.lp(p).x;if($){var O=v._indent,$=$.startX+O*v.getLevel(G);if(T(v.getToggleIcon(G))&&$<=S&&S<=$+O)return void v.toggle(G);if(v.isCellEditable(G,J)&&($+=O)<=S&&S<=$+O)return void v.checkData(G)}v._37O(G,p),v.setFocusData(G)},_33o:function(p,G){var v=this.list,J=v.lp(p).x;if(T(v.getToggleIcon(G))&&($=v._3Q(v._4o))){var $,S=v._indent;if(($=$.startX+S*v.getLevel(G))<=J&&J<=$+S)return void v.toggle(G)}v._37O(G,p),WM.superClass._33o.apply(this,arguments)}}),Tk.TableHeader=function(p){var G=this,v=G._view=ES(1,G),J=G._39o=p.getColumnModel(),$=G.iv;G.tv=G._tableView=p,G._60I=new o,G._canvas=xS(v),v.style.background=N.tableHeaderBackground||"",v.style.height=Ch+tJ,J.mm($,G),J.md($,G),J.mh($,G),p.mp(function(p){Ek[p.property]&&G.iv()},G),new tM(G),G.iv()}),tM=(k4("TableHeader",d,{ms_v:1,ms_lp:1,ms_fire:1,ms_ac:["checkIcon","sortDescIcon","sortAscIcon",IJ,kJ,vl,"moveBackground","insertColor",Ol,$l,"resizable","movable"],_checkIcon:YJ,_movable:!0,_resizable:!0,_labelColor:N.tableHeaderLabelColor,_labelFont:N.tableHeaderLabelFont,_columnLineColor:N.tableHeaderColumnLineColor,_columnLineVisible:N.tableHeaderColumnLineVisible,_sortDescIcon:N.tableHeaderSortDescIcon,_sortAscIcon:N.tableHeaderSortAscIcon,_moveBackground:N.tableHeaderMoveBackground,_insertColor:N.tableHeaderInsertColor,_indent:Fh,getCheckIcon:function(){return this._checkIcon},getTableView:function(){return this.tv},getLabel:function(p){return p.toLabel()},getLabelFont:function(p){return this._labelFont},getLabelColor:function(p){return p.getColor()||this._labelColor},getLabelAlign:function(p){return p._align},onPropertyChanged:function(p){this.iv()},_5Q:function(p){this._61I=p,this.iv()},getLogicalPoint:function(p){return RA(p,this._canvas,this.tv.tx())},validateImpl:function(){var p,J=this,G=J._canvas,v=J.getWidth(),$=J.getHeight(),S=J.tv,O=J._60I,W=J._61I,l=-S.tx(),t=0,z=(v===G.clientWidth&&$===G.clientHeight||mS(G,v,$),O.clear(),J._39o._roots.each(function(p){var G;p.isVisible()&&(G=t+p.getWidth(),t<=l+v&&l<=G&&O.add({column:p,startX:t}),t=G)}),GE(G));vE(z,-l,0,1),z.beginPath(),z.rect(l,0,v,$),z.clip(),z.clearRect(l,0,v,$),O.each(function(p){var G=p.column,p=p.startX,v=G.getWidth();0<v&&(z.save(),z.beginPath(),z.rect(p,0,v,$),z.clip(),W&&W.column===G||J.drawColumn(z,G,p,0,v,$),J._columnLineVisible&&VE(z,p+v-1,0,1,$,J._columnLineColor),z.restore())}),W&&(S=W.column,t=W.startX,G=W.position,p=S.getWidth(),z.save(),z.beginPath(),z.rect(t,0,p,$),z.clip(),z.fillStyle=J._moveBackground,z.fill(),J.drawColumn(z,S,t,0,p,$),z.restore(),iS(z,J._insertColor,G,0,$)),z.restore()},_6Q:function(p){var G=this.tv;return G._31o===p&&G.sm().getSelectionMode()===o0},drawColumn:function(p,G,v,J,$,S){var O,W,l,t,z,Z=this,B=Z.tv,f=T(G.getIcon()),X=Z.getLabelAlign(G);Z._6Q(G)?(z=T(Z._checkIcon),ZA(p,z,v+$/2,J+S/2,G,Z)):(z=Z.getLabel(G),O=Z.getLabelFont(G),W=Z.getLabelColor(G),l=DA(O,z).width,t=f?Z._indent:0,X===C0?(f&&BA(p,f,kl,v,J,t,S),nA(p,z,O,W,v+t,J,$,S,C0)):X===Q0?(f&&BA(p,f,kl,v+$-l-t,J,t,S),nA(p,z,O,W,v,J,$,S,Q0)):(f&&BA(p,f,kl,v+($-l-t)/2,J,t,S),nA(p,z,O,W,v+($-l+t)/2,J,0,S,C0))),G.isSortable()&&B.getSortColumn()===G&&(f=T(G.getSortOrder()===gl?Z._sortAscIcon:Z._sortDescIcon))&&(z=Am(f,G)/2+2,ZA(p,f,X===Q0?v+z:v+$-z,J+S/2,G,B))}}),function(p){this.th=p,this.tv=p._tableView,this.addListeners()}),zM=(oA(tM,d,{ms_listener:1,getView:function(){return this.th.getView()},setCursor:function(p){this.getView().style.cursor=p},handle_mousemove:function(p){if(!fE){delete this._29o,this.setCursor(T0);for(var G=this.th,v=G._60I,J=G.lp(p).x,$=v.size()-1;0<=$;$--){var S=v.get($),O=S.column,W=S.startX+O.getWidth();if(G.isResizable()&&I(W-J)<=(u0?10:3))return this._29o=S,void this.setCursor(al);J>S.startX&&J<W&&(this._29o=S),(O.isClickable()||O.isSortable()||G.isMovable()||this.tv.getCheckColumn&&O===this.tv.getCheckColumn())&&J>S.startX&&J<W&&this.setCursor(Tl)}}},handle_mousedown:function(p){this.handle_touchstart(p)},handle_touchstart:function(p){tA(p),this.tv.endEditing(),this.handle_mousemove(p),this._29o&&(this.x=i(p).x,this.lx=this.th.lp(p).x,this.w=this._29o.column.getWidth(),mA(this,p))},handleWindowMouseMove:function(p){this.handleWindowTouchMove(p)},handleWindowTouchMove:function(p){var J,G=this,$=G.th,v=G.getView().style.cursor,S=G._29o,O=i(p).x-G.x;G.resizing||G.moving||(v===al?G.resizing=1:$.isMovable()&&v===Tl&&2<I(O)&&(G.moving=1)),G.resizing?S.column.setWidth(G.w+O):G.moving&&(J=G.lx+O,$._60I.each(function(p){var G=p.startX,v=G+p.column.getWidth();G<=J&&J<=v&&((p={column:S.column,startX:S.startX+O,front:J-G<v-J,insertColumn:p.column}).front?p.position=G:p.position=v,$._5Q(p))}))},_16Q:function(p,G){var v=this.tv,J=this.th,$=J._checkIcon;if(J._6Q(p)){var S=T($),O=this.lx,W=p.getWidth();if(G+W/2-(S=Am(S,p))<=O&&O<=G+W/2+S)return J.setCheckIcon($===DJ?YJ:DJ),O=v.sm(),G=v._rows,$===DJ?O.rs(G):O.ss(G),v.onCheckColumnClicked(p),!0}return!1},handleWindowMouseUp:function(p){this.handleWindowTouchEnd(p)},handleWindowTouchEnd:function(p){var G,v,J,$,S,O=this,W=O.tv,l=O.th,t=O._29o;O.moving?((v=l._61I)&&v.insertColumn!==v.column&&(G=v.column,$=(J=W.getColumnModel()._roots).remove(G),0<=(S=J.indexOf(v.insertColumn))&&(v.front||S++,S<=J.size()&&(J.add(G,S),W.getColumnModel()._38I(G,$,S)))),l._5Q(v0),delete O.moving):!O.resizing&&t&&(G=t.column,v=l.lp(p).x,J=t.startX,$=!0,($=(!l.onColumnClicked||!1!==l.onColumnClicked(G,p,J))&&$)&&J<=v&&v<=J+G.getWidth()&&(O._16Q(G,J)||(G.isSortable()&&(S=W.getSortMode(),t=G.getSortOrder(),S===ql?W.getSortColumn()===G?(t===Ml&&W.setSortColumn(v0),G.setSortOrder(t===gl?Ml:gl)):W.setSortColumn(G):"bistate"===S&&(W.getSortColumn()===G?G.setSortOrder(t===gl?Ml:gl):W.setSortColumn(G))),W.onColumnClicked(G,p,J)))),O._29o=O.resizing=O.x=O.lx=O.w=v0}}),Tk.TablePane=function(p){this.init(new vM(p))},k4("TablePane",d,{ms_v:1,_44o:1}),Tk.TreeTablePane=function(p){this.init(new $M(p))},k4("TreeTablePane",d,{ms_v:1,_44o:1}),Tk.Toolbar=function(p){var J=this,G=J._view=ES(1,J),v=G.style;v.background=N.toolbarBackground||"",v.height=Qh+tJ,J._canvas=xS(G),J._30o=new o,J._90I=new o,J.setItems(p||[]),G.handleGroupSelectedChanged=function(G){var v;G.isSelected()&&null!=(v=G.getGroupId())&&J._items.forEach(function(p){(p=p.element)&&p!==G&&p.setSelected&&p.getGroupId&&p.getGroupId()===v&&p.setSelected(!1)})},new zM(J)},k4("Toolbar",d,{ms_v:1,ms_fire:1,ms_tx:1,ms_lp:1,ms_tip:1,ms_value:1,ms_ac:[gJ,IJ,kJ,EJ,A0,"itemGap","separatorColor","currentItem","stickToRight"],_labelColor:N.toolbarLabelColor,_labelSelectColor:N.toolbarLabelSelectColor,_labelFont:N.toolbarLabelFont,_selectBackground:N.toolbarSelectBackground,_itemGap:N.toolbarItemGap,_separatorColor:N.toolbarSeparatorColor,_stickToRight:!1,getSumWidth:function(p){return this._64I},getToolTip:function(p){return(p=this.getItemInfoAt(p))?p.item.toolTip:v0},getLabelColor:function(p){return p&&p.selected&&p.type!==DJ&&"radio"!==p.type?this._labelSelectColor:this._labelColor},onPropertyChanged:function(p){this.iv(),p.property===gJ&&this._items.forEach(function(p){IS(p)})},redraw:function(){this.iv()},addItem:function(p,G){var v=this._items;G==v0?v.push(p):v.splice(G,0,p),this.fp(gJ,v0,v)},removeItem:function(p){if(p)for(var G=this._items,v=0;v<G.length;v++)p===G[v]&&(G.splice(v,1),this.fp(gJ,v0,G))},removeItemById:function(p){if(p!=v0)for(var G,v=this._items,J=0;J<v.length;J++)if(p===v[J].id)return G=v.splice(J,1)[0],this.fp(gJ,v0,v),G},getItemById:function(p){if(p!=v0)for(var G=this._items,v=0;v<G.length;v++){var J=G[v];if(p===J.id)return J}},setItemVisible:function(p,G){(p=this.getItemById(p))&&(p.visible=G)},getItemInfos:function(){return this._30o},getItemInfoAt:function(p){var G=0,v=this._30o,J=(p=this.lp(p)).x;if(0<=(p=p.y)&&p<=this.getHeight())for(;G<v.size();G++){var $=v.get(G);if($.startX<=J&&J<=$.endX)return $}return v0},drawItem:function(p,G,v,J,$){if(!1===G.visible)return 0;if(WS(G.visible)&&!G.visible())return 0;var S=G.disabled,$=(S&&(p.globalAlpha=yh),this.drawItemImpl(p,G,v,J,$)),O=this._itemGap;return S&&(p.globalAlpha=1),this._currentItem!==G||"separator"===G||!0===G.separator||G.unfocusable||J4(p,this._separatorColor,v-O/2,0,$+O,J),$},drawItemImpl:function(p,G,v,J,$){var S,O,W=this,l=W._view,t=W._itemGap,z=J/2,Z=G.type,B=G.element,f=G.label,X=(JS(B)&&(f=B,B=v0),W.getLabelFont(G)),q=W.getLabelColor(G),g=G.selected,M=T(G.icon),L=Am(M,G),H=L+(f?DA(X,f).width:0);return"separator"===G||!0===G.separator?(iS(p,W._separatorColor,v,J/4,z),1):B?(M&&ZA(p,M,v+L/2,z,G,W),nA(p,f,X,q,v+L,0,0,J),O=tE(B),$||W._90I.add(O),O.parentNode!==l&&KS(l,O),B.iv&&B.iv(),B.validate&&B.validate(),l=($=O.getBoundingClientRect()).width,B=O.style,NS(O),B.left=W.tx()+v+H+tJ,B.top=(J-$.height)/2+tJ,H+l):("radio"===Z?S=T(g?sJ:cJ):Z===DJ&&(S=T(g?DJ:YJ)),S?(O=Am(S,G),ZA(p,S,v+O/2,z,G,W),v+=O,H+=O):g&&VE(p,v-t/2,0,H+t,J,W.getSelectBackground(G)),M&&ZA(p,M,v+L/2,z,G,W),nA(p,f,X,q,v+L,0,0,J),H)},validateImpl:function(){var v=this,p=v._canvas,G=v.getWidth(),J=v.getHeight(),$=v._30o,S=v._items,O=(mS(p,G,J),GE(p)),W=v._itemGap,l=W/2,t=(vE(O,v.tx(),0,1),O.clearRect(0,0,G,J),v._90I),t=(v._90I=new o,$.clear(),S.forEach(function(p){var G=v.drawItem(O,p,l,J);$.add({item:p,startX:l,endX:l+G,width:G}),G&&(l+=G+W)}),t.each(function(p){v._90I.contains(p)||KA(p)}),v._64I);v._64I=J0(0,l-W/2),O.restore(),v._stickToRight?(v._65O=0,O=GE(p),l=G-v._64I+W/2,vE(O,0,0,1),O.clearRect(0,0,G,J),$.clear(),S.forEach(function(p){var G=v.drawItem(O,p,l,J,!0);$.add({item:p,startX:l,endX:l+G,width:G}),G&&(l+=G+W)}),O.restore()):v.tx(v.tx()),t!==v._64I&&v.onSumWidthChanged(t,v._64I)},onSumWidthChanged:function(p,G){},handleClick:function(G,p){var v=G.type,J=G.action,$=G.groupId,S=G.selected;G.disabled||($!=v0?S||(G.selected=!0,this._items.forEach(function(p){p.groupId===$&&G!==p&&(p.selected=!1)}),J&&G.action(G,this,p)):(v!==DJ&&"toggle"!==v||(G.selected=!S),J&&G.action(G,this,p))),ah(),this.iv()}}),function(p){this.tb=p,this.addListeners()});oA(zM,d,{ms_listener:1,getView:function(){return this.tb._view},handle_mousewheel:function(p){this.handleScroll(p,p.wheelDelta/40*10)},handle_DOMMouseScroll:function(p){this.handleScroll(p,10*-p.detail)},handleScroll:function(p,G){tA(p),(p=this.tb).isScrollable()&&!p._stickToRight&&(p.tx(p.tx()+G),BE())},handle_mousemove:function(p){fE||this.setItem(p)},handle_mouseout:function(p){p.target===this.getView()?this.tb.setCurrentItem(v0):this.handle_mousemove(p)},handle_mousedown:function(p){this.handle_mousemove(p),this.handle_touchstart(p)},handle_touchstart:function(p){var G=this.tb,v=p.target;!YA(p)||v!==this.getView()&&v!==G._canvas||(tA(p),G.setFocus(p)&&(this.setItem(p,!0),(G.isScrollable()||this.info&&!this.info.item.disabled)&&(this.x=i(p).x,this.tx=G.tx(),mA(this,p))))},handleWindowMouseMove:function(p){this.handleWindowTouchMove(p)},handleWindowTouchMove:function(p){var G=this.tb;G._stickToRight||(p=i(p).x-this.x,!this._25o&&2<I(p)&&G.isScrollable()&&(this._25o=1),this._25o&&G.tx(this.tx+p))},handleWindowMouseUp:function(p){this.handleWindowTouchEnd(p)},handleWindowTouchEnd:function(p){var G=this.tb,v=this.info,J=this.tb.getItemInfoAt(p);!this._25o&&v&&(v=v.item,J&&J.item===v&&G.handleClick(v,p)),this._25o=this.x=this.tx=v0,this.setItem()},setItem:function(p,G){var v=this.tb,J=(J=this.info=p?v.getItemInfoAt(p):v0)?J.item:v0;v.setCurrentItem(J),G&&J&&WS(J.onDown)&&J.onDown(p)}}),Tk.BorderPane=function(){this._view=ES(1,this),this.iv()},k4("BorderPane",d,{ms_v:1,ms_ac:["topHeight","bottomHeight","leftWidth","rightWidth"],ms_fire:1,getLeftView:function(){return this._leftView},setLeftView:function(p,G){this._12o("leftView",p),G!=v0&&this.setLeftWidth(G)},getRightView:function(){return this._rightView},setRightView:function(p,G){this._12o("rightView",p),G!=v0&&this.setRightWidth(G)},getTopView:function(){return this._topView},setTopView:function(p,G){this._12o("topView",p),G!=v0&&this.setTopHeight(G)},getBottomView:function(){return this._bottomView},setBottomView:function(p,G){this._12o("bottomView",p),G!=v0&&this.setBottomHeight(G)},getCenterView:function(){return this._centerView},setCenterView:function(p){this._12o("centerView",p)},_12o:function(p,G){var v="_"+p,J=this._view,$=this[v];$!==G&&($&&($.getView?KA($.getView()):KA($)),(this[v]=G)&&(G.getView?KS(J,G.getView(),1):KS(J,G,1)),this.fp(p,$,G))},onPropertyChanged:function(p){this.iv()},validateImpl:function(){var p=(q=this)._topView,G=q._bottomView,v=q._leftView,J=q._rightView,$=q._centerView,S=q.getWidth(),O=0,W=0,l=S,t=X=q.getHeight(),z=0,Z=0,B=0,f=0,X=(p&&(W=z=q._topHeight==v0?CS(p):q._topHeight),G&&(t=X-(Z=q._bottomHeight==v0?CS(G):q._bottomHeight)),v&&(O=B=q._leftWidth==v0?FS(v):q._leftWidth),J&&(l=S-(f=q._rightWidth==v0?FS(J):q._rightWidth)),J0(0,l-O)),q=J0(0,t-W);p&&P(p,0,0,S,z),G&&P(G,0,t,S,Z),v&&P(v,0,W,B,q),J&&P(J,l,W,f,q),$&&P($,O,W,X,q)}})}function ZM(p){tA(p),p.stopPropagation()}function BM(p){tA(p)}function fM(p,G){var v=p.length,J=p[0];if(JS(p)||J&&1!==J.length)return p;for(var $=new Array(v),S=0;S<v;S++)$[S]=p[S];var O=$[J="L"===$[0]?5:7],W=$[1+J],l=$[2+J],t=$[3+J],z=$[4+J],Z=$[5+J],B=G[0],f=G[1],X=G[2],q=G[3],g=G[4],G=G[5];return $[J]=B*O+X*W,$[1+J]=f*O+q*W,$[2+J]=B*l+X*t,$[3+J]=f*l+q*t,$[4+J]=B*z+X*Z+g,$[5+J]=f*z+q*Z+G,$}function XM(p,G){return G===p.substring(0,G.length)}function qM(p){return parseFloat(p)||0}function gM(p,G){G==K&&(G=new m),p=(p=p.split(/\s+/)).map(qM),G.set(p[0]||0,p[1]||0,p[2]||0)}function MM(p){var G=p.substr(p.lastIndexOf(".")+1),v=(p=N.convertURL?N.convertURL(p):p,jL[G]||G);return{postfix:G,url:"url("+p+') format("'+v+'")'}}function LM(p,G){return iL[p.postfix]-iL[G.postfix]}function HM(p,G,v){p.x=G.x,p.y=G.e||v,p.z=G.y}function _M(p){p.duration&&(p.startTime=Vi()),p.timeId=XA(p.tick,v0,v0,p.interval)}function bM(p){p.details=0,p.timeout=null,p.lastPoint=null}function nM(v,J){v.getValue&&v.getValue.compType===J||(v.getValue=function(p){var G=R(v,p);return G===K&&J.properties&&(p=J.properties[p])?p.defaultValue:G},v.getColor=function(p,G){return DM(!0===G?p:v.getValue(p))},v.getValue.compType=J)}function DM(p,G){return G=G?R(p,G):p,x&&x.compGray&&G?N.toGrayColor(G):J1&&G?IE(G,J1,$1):G}function YM(p){if(lS(p)){for(var G=new o,v=p.length,J=0;J<v;J+=2)G.add({x:p[J],y:p[J+1]});p=G}return p}function sM(p,G,v){if(G){var J,$,S,O={x:G.x,y:G.y,width:G.width,height:G.height},W=S1(p),l=R(p,"layoutH"),t=R(p,"layoutV"),z=1,Z=1,B=0,f=0,X=1,q=1;switch(l){case"left":break;case"right":O.x+=v.width-v.rw;break;case"center":O.x+=.5*(v.width-v.rw);break;default:(J=R(p,KJ)||0)&&(B=Math.abs(f=Math.sin(J)),X=Math.abs(q=Math.cos(J))),"leftright"!==l?(z+=X*(v.widthScale-1),Z+=B*(v.widthScale-1)):(z+=O.width?X*(v.width-v.rw)/O.width:0,Z+=O.height?B*(v.width-v.rw)/O.height:0,$=-Math.min(-W.x*q+W.y*f,-W.x*q-(1-W.y)*f,(1-W.x)*q+W.y*f,(1-W.x)*q-(1-W.y)*f))}switch(t){case"top":break;case"bottom":O.y+=v.height-v.rh;break;case"center":O.y+=.5*(v.height-v.rh);break;default:J==v0&&(J=R(p,KJ))&&(B=Math.abs(f=Math.sin(J)),X=Math.abs(q=Math.cos(J))),"topbottom"!==t?(z+=B*(v.heightScale-1),Z+=X*(v.heightScale-1)):(z+=O.width?B*(v.height-v.rh)/O.width:0,Z+=O.height?X*(v.height-v.rh)/O.height:0,S=-Math.min(-W.x*f-W.y*q,-W.x*f+(1-W.y)*q,(1-W.x)*f-W.y*q,(1-W.x)*f+(1-W.y)*q))}return 1===z&&1===Z||("scale"!==l&&l?"leftright"===l&&(O.x+=O.width*(1-z)*W.x+$*(v.width-v.rw)):O.x+=O.x*(v.widthScale-1)+W.x*O.width*(v.widthScale-z),"scale"!==t&&t?"topbottom"===t&&(O.y+=O.height*(1-Z)*W.y+S*(v.height-v.rh)):O.y+=O.y*(v.heightScale-1)+W.y*O.height*(v.heightScale-Z),O.width*=z,O.height*=Z),O.width<0&&(O.width=0),O.height<0&&(O.height=0),O}}function cM(p){return lS(p)?new o(p):p}function hM(p,G,v,J,$,S,O){var W=x.interactiveInfo,l=p.transform;if(l)return x.save(),x.setTransform(l.a,l.b,l.c,l.d,l.tx,l.ty),W&&W.compInfos.push({comp:p,rect:G,matrix:l.clone(),prefix:hm,refRect:W.refRect}),!0;if($===K&&($=1),S===K&&(S=1),l=R(p,"clipPercentage"),YS(v,G)&&!J&&1===$&&1===S&&l==K)return W&&W.compInfos.push({comp:p,rect:G,matrix:W.matrix.clone(),prefix:hm,refRect:W.refRect}),!1;var t=G.x+G.width*(O=O||rm).x,z=G.y+G.height*O.y,Z=v.x+v.width*O.x,O=v.y+v.height*O.y,$=v.width?$*(G.width/v.width):1,S=v.height?S*(G.height/v.height):1;return x.save(),W&&(W.matrix.appendTranslate(t,z).appendRotate(J).appendScale($,S).appendTranslate(-Z,-O),W.compInfos.push({comp:p,rect:G,matrix:W.matrix.clone(),prefix:hm,refRect:W.refRect})),JE(x,t,z),$E(x,J||0),SE(x,$,S),JE(x,-Z,-O),l!=K&&(G=jS(v,R(p,"clipDirection"),l),x.beginPath(),x.rect(G.x,G.y,G.width,G.height),x.clip()),!0}function wM(){x.restore()}function dM(p,G,v,J){var $,S,O,W,l,t,z,Z,B,f,X,q,g,M,L,H,_,b,n,k,I,D,Y,s,c,h,w,d,P=R(p,hJ,YM),j=R(p,KJ),i=S1(p),J=(P&&J.fitSize&&($=new o,J=sM(p,r=rA(P),J),S=r.x+i.x*r.width,O=r.y+i.y*r.height,W=J.x+i.x*J.width,l=J.y+i.y*J.height,t=r.width?J.width/r.width:1,z=r.height?J.height/r.height:1,P.each(function(p){$.add({x:W+(p.x-S)*t,y:l+(p.y-O)*z})}),P=$,p.unionRect=null),R(p,"scaleX")),r=R(p,"scaleY"),e=G===qJ,A=v0;!v&&e&&((v=p.unionRect)||(v=rA(P),p.points.func||(p.unionRect=v)),A=v),v&&(e?(A=A||p.unionRect)||(A=rA(P),p.points.func||(p.unionRect=A)):A=v,v=hM(p,v,A,j,J,r,i),j=R(p,"borderPattern"),J=Hm(x,j),r=DM(p,"background"),i=T(R(p,"repeatImage"),J1,$1),Z=R(p,"gradientPack"),B=R(p,"borderGradientPack"),f=DM(p,"borderColor"),X=R(p,"borderWidth"),q=T(R(p,"borderRepeatImage"),J1,$1),g=R(p,"segments",cM),d=R(p,"gradient"),M=DM(p,"gradientColor"),L=R(p,"border3d"),H=DM(p,"border3dColor"),_=R(p,"border3dAccuracy"),b=R(p,"closePath"),n=R(p,"fillRule")||"nonzero",k=x.lineJoin,I=x.lineCap,x.lineJoin=R(p,"borderJoin")||Vh,x.lineCap=R(p,"borderCap")||Th,e?r||i||Z?((h=R(p,"fillClipPercentage"))!=K&&(w=jS(A,R(p,"fillClipDirection"),h),x.save(),x.beginPath(),x.rect(w.x,w.y,w.width,w.height),x.clip()),KE(x,P,g,b),Z?NE(x,Z,DM,!1,A):i?FE(x,i,J1,$1,p1,G1):UE(x,r,d,M,A),x.fill(n),Z&&x.restore(),h!=K&&x.restore(),J!==x&&KE(J,P,g,b)):KE(J,P,g,b):("roundRect"===G?D=R(p,"cornerRadius"):"polygon"===G?(D=R(p,"polygonSide"),Y=R(p,"cornerRadius"),s=R(p,"regular")):"arc"===G&&(D=R(p,"arcFrom"),Y=R(p,"arcTo"),s=R(p,"arcClose"),c=R(p,"arcOval")),r||i||Z?((h=R(p,"fillClipPercentage"))!=K&&(w=jS(A,R(p,"fillClipDirection"),h),x.save(),x.beginPath(),x.rect(w.x,w.y,w.width,w.height),x.clip()),oE(x,G,A,D,Y,s,c),Z?NE(x,Z,DM,!1,A):i?FE(x,i,J1,$1,p1,G1):UE(x,r,d,M,A),x.fill(n),Z&&x.restore(),h!=K&&x.restore(),x!==J&&oE(J,G,A,D,Y,s,c)):oE(J,G,A,D,Y,s,c)),(w=R(p,"borderWidthAbsolute"))&&(x.save(),x.setTransform(1,0,0,1,0,0)),X&&(f||q||B)&&(x.lineWidth=X,B?NE(x,B,DM,!0,A):q?CE(x,q,J1,$1,p1,G1):x.strokeStyle=f,x.stroke(),B&&x.restore(),L&&uE(x,f,H,X,v1,_)),_m(x,j),R(p,"dash")&&0<(i=R(p,"dashWidth")||X)&&(j=R(p,"dashPattern")||uh,J=Hm(x,j,R(p,"dashOffset")),d=DM(p,"dashColor")||DM(D4),J!==x&&(e?KE(J,P,g,b):oE(J,G,A,D,Y,s,c)),x.strokeStyle=d,x.lineWidth=i,x.stroke(),R(p,"dash3d")&&uE(x,d,DM(p,"dash3dColor"),i,v1,R(p,"dash3dAccuracy")),_m(x,j)),w&&x.restore(),G===y&&$4(x,r,R(p,"depth"),A),x.lineJoin=k,x.lineCap=I,v&&wM())}function PM(p){x=p[0],p1=p[1],G1=p[2],v1=p[3],J1=p[4],$1=p[5]}function jM(p,G){if("function"!=typeof G&&null!==G)throw new TypeError("Super expression must either be null or a function");p.prototype=d.create(G&&G.prototype,{constructor:{value:p,writable:!0,configurable:!0}}),G&&Em(p,G)}function iM(p){return"Array]"===(p=d.prototype.toString.call(p)).substring(p.length-6)}function rM(p,G,v,J,$,S){G=G||[],v=v||[],J=J||[];try{G.push(p);var O=Function.apply(0,G);return v[v.length]="return "+O,Function.apply(0,v).apply(0,J)}catch(p){return S&&S(p),$}}function eM(p){return p}function AM(p,G){return G}function kM(p,G,v,J){var $=p?p.path.slice(0):[];G&&$.push(G),this.desc=v,this.name=G,this.path=xm($),this.getter=(v=$)&&v.length?new Function("o",["return o['",v.join("']['"),"'];"].join("")):eM,this.setter=(G=$)&&G.length?new Function("o","v",["return o['",G.join("']['"),"'] = v;"].join("")):AM,this.isLeaf=J,this.parent=p,this.children=[],this.childMap={}}function IM(p){var G=[];return p.forEach(function(p){G.push({x:p.x,y:p.y}),G.push({x:p.x+p.width,y:p.y+p.height}),G.push({x:p.x+p.width,y:p.y}),G.push({x:p.x,y:p.y+p.height})}),G}function EM(p,G){return 0<p.dot(G)}function yM(){this._vertexMap={},this._lineMap={},this._lineList=[]}function xM(p,G,v,J,$,S,O){v=[v,$],p[0]===J&&v.reverse(),$=[v[0]._key,v[1]._key].join("|"),(J=p._triangles[$])||(p._triangles[$]=J={}),J[v=[S._key,O._key].join("|")]||(J[v]=[S,O])}function RM(p,G,v){var J=p._planes[v._key];if(!J)for(var $ in p._planes)if(($=p._planes[$])._normal.angleTo(v)<.001){J=$;break}J?J._vertices.indexOf(G)<0&&J._vertices.push(G):p._planes[v._key]={_normal:v,_vertices:[G]}}function NM(p,G){return 0===G?"0|0|0":(Math.abs(G)===1/0?[p.x,p.y,p.z]:[Math.round(b1.angleTo(p)*G),Math.round(n1.angleTo(p)*G),Math.round(D1.angleTo(p)*G)]).join("|")}function mM(p){for(var G=p.length,v=0,J=G-1,$=0;$<G;J=$++)v+=p[J].x*p[$].y-p[$].x*p[J].y;return.5*v}function KM(p){return(p%=W0)<0&&(p+=W0),j<p?W0-p:p}function aM(p,G){return KM(p[0]-G[0])+KM(p[1]-G[1])+KM(p[2]-G[2])}function uM(p,G,v,J,$,S){G=new H(G.get(v)),S=S.apply(G),p.push({local:G,world:S,type:$,index:v,realIndex:J})}function TM(p,G){var v=p.x-G.x;return v*v+(p=p.y-G.y)*p}function VM(G,v,p){return{def:G,getter:p?function(p){return 1<Ys.for(p).version?p.getParameter(v):G}:function(p){return p.getParameter(v)},setter:p?function(p,G){1<Ys.for(p).version&&p.pixelStorei(v,G)}:function(p,G){p.pixelStorei(v,G)}}}function oM(p){return"string"==typeof p?yE(p):p.r!==K?(A3[0]=p.r,A3[1]=p.g,A3[2]=p.b,A3[3]=p.a,A3):p.red!==K?(A3[0]=p.red,A3[1]=p.green,A3[2]=p.blue,A3[3]=p.alpha,A3):p}function UM(p){return iM(p)?Array.prototype.slice.call(p,0):p}function FM(p,G,v){this.gl=G,this._record=v||{},this._branches={},this._leafSync={};for(var J=(this._struct=p).children,$=J.length;$--;){var S=J[$],O=S.name;S.isLeaf?(this._leafSync[O]=!1,this._record[O]=UM(S.desc.def)):this._record[O]={}}}function CM(p){if(p.match(u3))return r0(p);var G=N3[p];return G||(G=new RegExp("#define\\s+"+p+"\\s+(\\d+)"),G=m3.match(G),N3[p]=G?r0(G[1]):0)}function QM(p,G,v){v=CM(v);for(var J="",$=0;$<v;$++)J+=G+$+";";return J}function pr(p,G,v,J){for(var $="",S=CM(G);S<CM(v);S++)$+=J.replace(/\[\s*i\s*\]/g,"["+S+"]").replace(/\[\s*I\s*\]/g,S);return $}function Gr(p){for(var G=1;G<arguments.length;G++){var v=arguments[G];p.push(v.x,v.y,v.z)}}function vr(p,G,v,J,$){var S=-J*S0($),J=J*O0($);return new a(p.x+S*v.x+J*G.x,p.y+S*v.y+J*G.y,p.z+S*v.z+J*G.z)}function Jr(p,G,v,J,$,S,O,W,l){l=l||W0;var t=G?p.top_vs:p.bottom_vs;if(t)for(var z,Z,B=G?p.top_uv:p.bottom_uv,f=l/O,X=0;X<O;X++)G?(z=X*f+W,Z=(X+1)*f+W):(Z=X*f+W,z=(X+1)*f+W),Gr(t,vr(v,J,$,S,z),vr(v,J,$,S,Z),v),B&&B.push(.5-.5*S0(z),.5-.5*O0(z),.5-.5*S0(Z),.5-.5*O0(Z),.5,.5)}function $r(v){var J={};return{get:function(p){if(J[p]!==K)return J[p];var G;switch(p){case"WEBGL_depth_texture":G=v.getExtension("WEBGL_depth_texture")||v.getExtension("MOZ_WEBGL_depth_texture")||v.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":G=v.getExtension("EXT_texture_filter_anisotropic")||v.getExtension("MOZ_EXT_texture_filter_anisotropic")||v.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":G=v.getExtension("WEBGL_compressed_texture_s3tc")||v.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||v.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":G=v.getExtension("WEBGL_compressed_texture_pvrtc")||v.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":G=v.getExtension("WEBGL_compressed_texture_etc1");break;default:G=v.getExtension(p)}return J[p]=G}}}function Sr(G,v,p){var J;function $(p){if("highp"===p){if(0<G.getShaderPrecisionFormat(G.VERTEX_SHADER,G.HIGH_FLOAT).precision&&0<G.getShaderPrecisionFormat(G.FRAGMENT_SHADER,G.HIGH_FLOAT).precision)return"highp";p="mediump"}return"mediump"===p&&0<G.getShaderPrecisionFormat(G.VERTEX_SHADER,G.MEDIUM_FLOAT).precision&&0<G.getShaderPrecisionFormat(G.FRAGMENT_SHADER,G.MEDIUM_FLOAT).precision?"mediump":"lowp"}p=p||{};var S,O="undefined"!=typeof WebGL2RenderingContext&&G instanceof WebGL2RenderingContext,W=p.precision!==K?p.precision:"highp",l=((l=$(W))!==W&&(console.warn("WebGL:",W,"not supported, using",l,"instead."),W=l),!0===p.logarithmicDepthBuffer),p=G.getParameter(G.MAX_TEXTURE_IMAGE_UNITS),t=G.getParameter(G.MAX_VERTEX_TEXTURE_IMAGE_UNITS),z=G.getParameter(G.MAX_TEXTURE_SIZE),Z=G.getParameter(G.MAX_CUBE_MAP_TEXTURE_SIZE),B=G.getParameter(G.MAX_VERTEX_ATTRIBS),f=G.getParameter(G.MAX_VERTEX_UNIFORM_VECTORS),X=G.getParameter(G.MAX_VARYING_VECTORS),q=G.getParameter(G.MAX_FRAGMENT_UNIFORM_VECTORS),g=0<t,M=O||!!v.get("OES_texture_float"),L=(O||!!v.get("OES_element_index_uint"))&&"undefined"!=typeof Uint32Array,H=g&&M,_=O?G.getParameter(G.MAX_SAMPLES):0,b=!1;return O?b=!0:(S=v.get("ANGLE_instanced_arrays"))&&(b=!0,G.vertexAttribDivisor=function(p,G){return S.vertexAttribDivisorANGLE(p,G)},G.drawElementsInstanced=function(p,G,v,J,$){return S.drawElementsInstancedANGLE(p,G,v,J,$)},G.drawArraysInstanced=function(p,G,v,J){return S.drawArraysInstancedANGLE(p,G,v,J)}),{getMaxAnisotropy:function(){if(J!==K)return J;var p=v.get("EXT_texture_filter_anisotropic");return J=null!==p?G.getParameter(p.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:$,precision:W,logarithmicDepthBuffer:l,maxTextures:p,maxVertexTextures:t,maxTextureSize:z,maxCubemapSize:Z,maxAttributes:B,maxVertexUniforms:f,maxVaryings:X,maxFragmentUniforms:q,vertexTextures:g,floatFragmentTextures:M,elementTypeUint:L,floatVertexTextures:H,maxSamples:_,instancedArray:b}}function Or(p,G,v){v instanceof E.Node&&(We.fromArray(Xm(v,G.getMat(v))),G=v.getAnchor3d(),p.push((new m).set(0-G.x,0-G.y,0-G.z).applyMatrix4(We)),p.push((new m).set(0-G.x,0-G.y,1-G.z).applyMatrix4(We)),p.push((new m).set(0-G.x,1-G.y,0-G.z).applyMatrix4(We)),p.push((new m).set(0-G.x,1-G.y,1-G.z).applyMatrix4(We)),p.push((new m).set(1-G.x,0-G.y,0-G.z).applyMatrix4(We)),p.push((new m).set(1-G.x,0-G.y,1-G.z).applyMatrix4(We)),p.push((new m).set(1-G.x,1-G.y,0-G.z).applyMatrix4(We)),p.push((new m).set(1-G.x,1-G.y,1-G.z).applyMatrix4(We)))}function Wr(p,G,v){var J=p[G];J&&J.releaseTexture(),p[G]=v}function lr(){return["vec4 sRGBToLinear( in vec4 value ) {","return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );","}","vec4 LinearTosRGB( in vec4 value ) {","return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );","}","vec4 inputTexelToLinear( vec4 value ) { return sRGBToLinear( value ); }","vec4 linearToOutputTexel( vec4 value ) { return LinearTosRGB( value ); }","vec4 envMapTexelToLinear( vec4 color ) { return inputTexelToLinear( color ); }"].join("")}function tr(){return["precision mediump float;\n","precision mediump int;\n","attribute vec3 position;","attribute vec2 uv;","attribute float faceIndex;","varying vec3 vOutputDirection;","vec3 getDirection( vec2 uv, float face ) {","uv = 2.0 * uv - 1.0;","vec3 direction = vec3( uv, 1.0 );","if ( face == 0.0 ) { direction = direction.zyx; } ","else if ( face == 1.0 ) { direction = direction.xzy; direction.xz *= -1.0; } ","else if ( face == 2.0 ) { direction.x *= -1.0; }","else if ( face == 3.0 ) { direction = direction.zyx; direction.xz *= -1.0; } ","else if ( face == 4.0 ) { direction = direction.xzy; direction.xy *= -1.0; } ","else if ( face == 5.0 ) { direction.z *= -1.0; }","return direction;","}","void main() {","vOutputDirection = getDirection( uv, faceIndex );","gl_Position = vec4( position, 1.0 );","}"].join("")}function zr(p,G){return p.z!==G.z?G.z-p.z:p.id-G.id}function Zr(){var p=new m;return p.subVectors(Ne,Re),ue.subVectors(xe,Re),p.cross(ue).normalize(),p}function Br(p,G,v){p[v]=G[0],p[v+1]=G[1],p[v+2]=G[2]}function fr(p,G,v){p[0]=G[v=v||0],p[1]=G[v+1],p[2]=G[v+2]}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);